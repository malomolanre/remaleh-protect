import{r as i,a as Dt,R as js}from"./vendor-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();var gt={exports:{}},Ds={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ut=i,Ot=Symbol.for("react.element"),Ft=Symbol.for("react.fragment"),Bt=Object.prototype.hasOwnProperty,zt=Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ht={key:!0,ref:!0,__self:!0,__source:!0};function pt(t,s,a){var n,l={},o=null,m=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(m=s.ref);for(n in s)Bt.call(s,n)&&!Ht.hasOwnProperty(n)&&(l[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)l[n]===void 0&&(l[n]=s[n]);return{$$typeof:Ot,type:t,key:o,ref:m,props:l,_owner:zt.current}}Ds.Fragment=Ft;Ds.jsx=pt;Ds.jsxs=pt;gt.exports=Ds;var e=gt.exports,Js={},tt=Dt;Js.createRoot=tt.createRoot,Js.hydrateRoot=tt.hydrateRoot;/*! Capacitor: https://capacitorjs.com/ - MIT License */var Ns;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Ns||(Ns={}));class zs extends Error{constructor(s,a,n){super(s),this.message=s,this.code=a,this.data=n}}const Gt=t=>{var s,a;return t!=null&&t.androidBridge?"android":!((a=(s=t==null?void 0:t.webkit)===null||s===void 0?void 0:s.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},Wt=t=>{const s=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},n=a.Plugins=a.Plugins||{},l=()=>s!==null?s.name:Gt(t),o=()=>l()!=="web",m=A=>{const T=p.get(A);return!!(T!=null&&T.platforms.has(l())||x(A))},x=A=>{var T;return(T=a.PluginHeaders)===null||T===void 0?void 0:T.find(B=>B.name===A)},v=A=>t.console.error(A),p=new Map,S=(A,T={})=>{const B=p.get(A);if(B)return console.warn(`Capacitor plugin "${A}" already registered. Cannot register plugins twice.`),B.proxy;const z=l(),g=x(A);let Q;const b=async()=>(!Q&&z in T?Q=typeof T[z]=="function"?Q=await T[z]():Q=T[z]:s!==null&&!Q&&"web"in T&&(Q=typeof T.web=="function"?Q=await T.web():Q=T.web),Q),P=(L,G)=>{var H,re;if(g){const ne=g==null?void 0:g.methods.find(he=>G===he.name);if(ne)return ne.rtype==="promise"?he=>a.nativePromise(A,G.toString(),he):(he,fe)=>a.nativeCallback(A,G.toString(),he,fe);if(L)return(H=L[G])===null||H===void 0?void 0:H.bind(L)}else{if(L)return(re=L[G])===null||re===void 0?void 0:re.bind(L);throw new zs(`"${A}" plugin is not implemented on ${z}`,Ns.Unimplemented)}},N=L=>{let G;const H=(...re)=>{const ne=b().then(he=>{const fe=P(he,L);if(fe){const se=fe(...re);return G=se==null?void 0:se.remove,se}else throw new zs(`"${A}.${L}()" is not implemented on ${z}`,Ns.Unimplemented)});return L==="addListener"&&(ne.remove=async()=>G()),ne};return H.toString=()=>`${L.toString()}() { [capacitor code] }`,Object.defineProperty(H,"name",{value:L,writable:!1,configurable:!1}),H},M=N("addListener"),y=N("removeListener"),k=(L,G)=>{const H=M({eventName:L},G),re=async()=>{const he=await H;y({eventName:L,callbackId:he},G)},ne=new Promise(he=>H.then(()=>he({remove:re})));return ne.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await re()},ne},j=new Proxy({},{get(L,G){switch(G){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return g?k:M;case"removeListener":return y;default:return N(G)}}});return n[A]=j,p.set(A,{name:A,proxy:j,platforms:new Set([...Object.keys(T),...g?[z]:[]])}),j};return a.convertFileSrc||(a.convertFileSrc=A=>A),a.getPlatform=l,a.handleError=v,a.isNativePlatform=o,a.isPluginAvailable=m,a.registerPlugin=S,a.Exception=zs,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a},Vt=t=>t.Capacitor=Wt(t),ss=Vt(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),gs=ss.registerPlugin;class ft{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(s,a){let n=!1;this.listeners[s]||(this.listeners[s]=[],n=!0),this.listeners[s].push(a);const o=this.windowListeners[s];o&&!o.registered&&this.addWindowListener(o),n&&this.sendRetainedArgumentsForEvent(s);const m=async()=>this.removeListener(s,a);return Promise.resolve({remove:m})}async removeAllListeners(){this.listeners={};for(const s in this.windowListeners)this.removeWindowListener(this.windowListeners[s]);this.windowListeners={}}notifyListeners(s,a,n){const l=this.listeners[s];if(!l){if(n){let o=this.retainedEventArguments[s];o||(o=[]),o.push(a),this.retainedEventArguments[s]=o}return}l.forEach(o=>o(a))}hasListeners(s){var a;return!!(!((a=this.listeners[s])===null||a===void 0)&&a.length)}registerWindowListener(s,a){this.windowListeners[a]={registered:!1,windowEventName:s,pluginEventName:a,handler:n=>{this.notifyListeners(a,n)}}}unimplemented(s="not implemented"){return new ss.Exception(s,Ns.Unimplemented)}unavailable(s="not available"){return new ss.Exception(s,Ns.Unavailable)}async removeListener(s,a){const n=this.listeners[s];if(!n)return;const l=n.indexOf(a);this.listeners[s].splice(l,1),this.listeners[s].length||this.removeWindowListener(this.windowListeners[s])}addWindowListener(s){window.addEventListener(s.windowEventName,s.handler),s.registered=!0}removeWindowListener(s){s&&(window.removeEventListener(s.windowEventName,s.handler),s.registered=!1)}sendRetainedArgumentsForEvent(s){const a=this.retainedEventArguments[s];a&&(delete this.retainedEventArguments[s],a.forEach(n=>{this.notifyListeners(s,n)}))}}const at=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),rt=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class qt extends ft{async getCookies(){const s=document.cookie,a={};return s.split(";").forEach(n=>{if(n.length<=0)return;let[l,o]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");l=rt(l).trim(),o=rt(o).trim(),a[l]=o}),a}async setCookie(s){try{const a=at(s.key),n=at(s.value),l=`; expires=${(s.expires||"").replace("expires=","")}`,o=(s.path||"/").replace("path=",""),m=s.url!=null&&s.url.length>0?`domain=${s.url}`:"";document.cookie=`${a}=${n||""}${l}; path=${o}; ${m};`}catch(a){return Promise.reject(a)}}async deleteCookie(s){try{document.cookie=`${s.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}}async clearCookies(){try{const s=document.cookie.split(";")||[];for(const a of s)document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(s){return Promise.reject(s)}}async clearAllCookies(){try{await this.clearCookies()}catch(s){return Promise.reject(s)}}}gs("CapacitorCookies",{web:()=>new qt});const Yt=async t=>new Promise((s,a)=>{const n=new FileReader;n.onload=()=>{const l=n.result;s(l.indexOf(",")>=0?l.split(",")[1]:l)},n.onerror=l=>a(l),n.readAsDataURL(t)}),Jt=(t={})=>{const s=Object.keys(t);return Object.keys(t).map(l=>l.toLocaleLowerCase()).reduce((l,o,m)=>(l[o]=t[s[m]],l),{})},Kt=(t,s=!0)=>t?Object.entries(t).reduce((n,l)=>{const[o,m]=l;let x,v;return Array.isArray(m)?(v="",m.forEach(p=>{x=s?encodeURIComponent(p):p,v+=`${o}=${x}&`}),v.slice(0,-1)):(x=s?encodeURIComponent(m):m,v=`${o}=${x}`),`${n}&${v}`},"").substr(1):null,Qt=(t,s={})=>{const a=Object.assign({method:t.method||"GET",headers:t.headers},s),l=Jt(t.headers)["content-type"]||"";if(typeof t.data=="string")a.body=t.data;else if(l.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[m,x]of Object.entries(t.data||{}))o.set(m,x);a.body=o.toString()}else if(l.includes("multipart/form-data")||t.data instanceof FormData){const o=new FormData;if(t.data instanceof FormData)t.data.forEach((x,v)=>{o.append(v,x)});else for(const x of Object.keys(t.data))o.append(x,t.data[x]);a.body=o;const m=new Headers(a.headers);m.delete("content-type"),a.headers=m}else(l.includes("application/json")||typeof t.data=="object")&&(a.body=JSON.stringify(t.data));return a};class Zt extends ft{async request(s){const a=Qt(s,s.webFetchExtra),n=Kt(s.params,s.shouldEncodeUrlParams),l=n?`${s.url}?${n}`:s.url,o=await fetch(l,a),m=o.headers.get("content-type")||"";let{responseType:x="text"}=o.ok?s:{};m.includes("application/json")&&(x="json");let v,p;switch(x){case"arraybuffer":case"blob":p=await o.blob(),v=await Yt(p);break;case"json":v=await o.json();break;case"document":case"text":default:v=await o.text()}const S={};return o.headers.forEach((A,T)=>{S[T]=A}),{data:v,headers:S,status:o.status,url:o.url}}async get(s){return this.request(Object.assign(Object.assign({},s),{method:"GET"}))}async post(s){return this.request(Object.assign(Object.assign({},s),{method:"POST"}))}async put(s){return this.request(Object.assign(Object.assign({},s),{method:"PUT"}))}async patch(s){return this.request(Object.assign(Object.assign({},s),{method:"PATCH"}))}async delete(s){return this.request(Object.assign(Object.assign({},s),{method:"DELETE"}))}}const Rs=gs("CapacitorHttp",{web:()=>new Zt}),$e="https://api.remalehprotect.remaleh.com.au";console.log("ðŸŒ API Configuration - Production API Base URL:",$e);const be={AUTH:{REGISTER:"/api/auth/register",LOGIN:"/api/auth/login",PROFILE:"/api/auth/profile",REFRESH:"/api/auth/refresh",LOGOUT:"/api/auth/logout",CHANGE_PASSWORD:"/api/auth/change-password",VERIFY_EMAIL:"/api/auth/verify-email",RESEND_VERIFICATION:"/api/auth/resend-verification",REQUEST_PASSWORD_RESET:"/api/auth/request-password-reset"},ADMIN:{USERS:"/api/admin/users",CREATE_USER:"/api/admin/users",USER_DETAILS:"/api/admin/users",USER_UPDATE:"/api/admin/users",USER_SUSPEND:"/api/admin/users",USER_ACTIVATE:"/api/admin/users",USER_DELETE:"/api/admin/users",USER_RESET_PASSWORD:"/api/admin/users",BULK_ACTION:"/api/admin/users/bulk-action",BULK_RESET_PASSWORD:"/api/admin/users/bulk-reset-password",DASHBOARD:"/api/admin/dashboard",MAINTENANCE:"/api/admin/maintenance",COMMUNITY_REPORTS:"/api/admin/community-reports",COMMUNITY_REPORTS_VERIFY:"/api/admin/community-reports",COMMUNITY_REPORTS_REJECT:"/api/admin/community-reports",COMMUNITY_REPORTS_ESCALATE:"/api/admin/community-reports",COMMUNITY_REPORTS_DELETE:"/api/admin/community-reports",COMMUNITY_REPORTS_BULK_ACTION:"/api/admin/community-reports/bulk-action"},THREAT_INTELLIGENCE:{DASHBOARD:"/api/threat_intelligence/dashboard",THREATS:"/api/threat_intelligence/threats",ALERTS:"/api/threat_intelligence/alerts",TRENDS:"/api/threat_intelligence/stats/trends"},RISK_PROFILE:{PROFILE:"/api/risk_profile/profile",SCANS:"/api/risk_profile/scans",LEARNING:"/api/risk_profile/learning/modules",RECOMMENDATIONS:"/api/risk_profile/recommendations"},LEARNING:{MODULES:"/api/learning/modules",PROGRESS:"/api/learning/progress",NEXT_LESSON:"/api/learning/next-lesson"},COMMUNITY:{REPORTS:"/api/community/reports",TRENDING:"/api/community/trending",STATS:"/api/community/stats",ALERTS:"/api/community/alerts",LEADERBOARD:"/api/community/leaderboard",MY_STATS:"/api/community/my-stats"},PUBLIC:{BLOG_FEED:"/api/public/blog-feed"},SCAM:"/api/scam/comprehensive",BREACH:"/api/breach/check",LINK:"/api/link/analyze",CHAT:"/api/chat/"},As=async(t,s={})=>{const a=localStorage.getItem("authToken");console.log("ðŸŒ API Call - Endpoint:",t),console.log("ðŸŒ API Call - Token present:",!!a),console.log("ðŸŒ API Call - Token value:",a?`${a.substring(0,20)}...`:"None");const n={"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`}},l={headers:n,...s};console.log("ðŸŒ API Call - Request headers:",l.headers),console.log("ðŸŒ API Call - Full URL:",`${$e}${t}`);try{let o;if(ss&&ss.getPlatform()!=="web"){const m=(l.method||"GET").toUpperCase(),x=l.body?JSON.parse(l.body):void 0,v=await Rs.request({url:`${$e}${t}`,method:m,headers:n,data:x});o={ok:v.status>=200&&v.status<300,status:v.status,headers:new Map(Object.entries(v.headers||{})),json:async()=>v.data,text:async()=>typeof v.data=="string"?v.data:JSON.stringify(v.data)}}else o=await fetch(`${$e}${t}`,l);if(console.log("ðŸŒ API Call - Response status:",o.status),console.log("ðŸŒ API Call - Response headers:",Object.fromEntries(o.headers.entries())),!o.ok){if(o.status===401){console.log("ðŸŒ API Call - 401 Unauthorized, attempting token refresh...");const x=localStorage.getItem("refreshToken");if(x){console.log("ðŸŒ API Call - Refresh token found, attempting refresh...");const v=await fetch(`${$e}${be.AUTH.REFRESH}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:x})});if(v.ok){const{access_token:p}=await v.json();return console.log("ðŸŒ API Call - Token refresh successful, retrying request..."),localStorage.setItem("authToken",p),l.headers.Authorization=`Bearer ${p}`,await fetch(`${$e}${t}`,l)}else console.log("ðŸŒ API Call - Token refresh failed, removing tokens")}localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken")}let m="Something went wrong. Please try again.";try{const x=await o.json(),v=x&&(x.error||x.message);v&&(m=v)}catch{}throw new Error(m)}return o}catch(o){throw console.error("ðŸŒ API Call - Request failed:",o),o}},Ae=t=>As(t,{method:"GET"}),Re=(t,s)=>As(t,{method:"POST",body:JSON.stringify(s)}),rs=(t,s)=>(console.log("ðŸ”§ apiPut called with:",{endpoint:t,data:s}),console.log("ðŸ”§ HTTP method will be: PUT"),As(t,{method:"PUT",body:JSON.stringify(s)})),ds=t=>As(t,{method:"DELETE"}),Qe={get:t=>Ae(t),post:(t,s)=>Re(t,s),put:(t,s)=>rs(t,s),delete:t=>ds(t),request:t=>{const{method:s="GET",url:a,data:n,...l}=t;return s==="GET"?Ae(a):s==="POST"?Re(a,n):s==="PUT"?rs(a,n):s==="DELETE"?ds(a):As(a,{method:s,body:n?JSON.stringify(n):void 0,...l})}};function ue({children:t,className:s="",padding:a="p-4",shadow:n="shadow-sm",hover:l=!1,onClick:o,interactive:m=!1,...x}){const T=`bg-white rounded-xl border border-gray-200 ${n==="shadow"?"shadow":n==="shadow-lg"?"shadow-lg":"shadow-sm"} ${l?"hover:shadow-lg transition-all duration-200":""} ${m?"active:scale-95 transition-transform duration-100":""} ${a} ${s}`.trim(),B=o?"button":"div";return e.jsx(B,{className:T,onClick:o,...x,children:t})}function Je({children:t,className:s=""}){return e.jsx("div",{className:`mb-3 ${s}`,children:t})}function ts({children:t,className:s=""}){return e.jsx("div",{className:s,children:t})}function ke({label:t,error:s,helperText:a,fullWidth:n=!1,className:l="",...o}){const m=`w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${s?"border-red-300 focus:ring-red-500 focus:border-red-500":""} ${n?"w-full":""} ${l}`;return e.jsxs("div",{className:`${n?"w-full":""}`,children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t}),e.jsx("input",{className:m,...o}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s}),a&&!s&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a})]})}function Ks({label:t,error:s,helperText:a,fullWidth:n=!1,rows:l=4,className:o="",...m}){const x=`w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none ${s?"border-red-300 focus:ring-red-500 focus:border-red-500":""} ${n?"w-full":""} ${o}`;return e.jsxs("div",{className:`${n?"w-full":""}`,children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t}),e.jsx("textarea",{className:x,rows:l,...m}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s}),a&&!s&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a})]})}function Is({label:t,error:s,helperText:a,options:n=[],fullWidth:l=!1,className:o="",...m}){const x=`w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 appearance-none bg-white ${s?"border-red-300 focus:ring-red-500 focus:border-red-500":""} ${l?"w-full":""} ${o}`;return e.jsxs("div",{className:`${l?"w-full":""} relative`,children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t}),e.jsx("select",{className:x,...m,children:n.map(v=>e.jsx("option",{value:v.value,children:v.label},v.value))}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s}),a&&!s&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a})]})}function yt({placeholder:t="Search...",onSearch:s,className:a="",...n}){const[l,o]=js.useState(""),m=x=>{x.preventDefault(),s&&l.trim()&&s(l.trim())};return e.jsx("form",{onSubmit:m,className:`relative ${a}`,children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l,onChange:x=>o(x.target.value),placeholder:t,className:"w-full pl-12 pr-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",...n}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})})}function me({variant:t="primary",size:s="md",children:a,className:n="",disabled:l=!1,loading:o=!1,...m}){const x="inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",v={primary:"bg-gradient-to-r from-[#21a1ce] to-[#1a80a3] text-white hover:shadow-lg focus:ring-[#21a1ce]",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-600",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-600",warning:"bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-600",outline:"border-2 border-[#21a1ce] text-[#21a1ce] hover:bg-[#21a1ce] hover:text-white focus:ring-[#21a1ce]"},p={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"},S=`${x} ${v[t]} ${p[s]} ${n}`.trim();return e.jsxs("button",{className:S,disabled:l||o,...m,children:[o&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})}var Xt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ea=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sa=(t,s)=>{const a=i.forwardRef(({color:n="currentColor",size:l=24,strokeWidth:o=2,absoluteStrokeWidth:m,children:x,...v},p)=>i.createElement("svg",{ref:p,...Xt,width:l,height:l,stroke:n,strokeWidth:m?Number(o)*24/Number(l):o,className:`lucide lucide-${ea(t)}`,...v},[...s.map(([S,A])=>i.createElement(S,A)),...(Array.isArray(x)?x:[x])||[]]));return a.displayName=`${t}`,a};var Ee=sa;const nt=Ee("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Es=Ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ls=Ee("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),ws=Ee("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),fs=Ee("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),lt=Ee("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),ta=Ee("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ys=Ee("HelpingHand",[["path",{d:"m3 15 5.12-5.12A3 3 0 0 1 10.24 9H13a2 2 0 1 1 0 4h-2.5m4-.68 4.17-4.89a1.88 1.88 0 0 1 2.92 2.36l-4.2 5.94A3 3 0 0 1 14.96 17H9.83a2 2 0 0 0-1.42.59L7 19",key:"nitrv7"}],["path",{d:"m2 14 6 6",key:"g6j1uo"}]]),aa=Ee("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),bt=Ee("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ra=Ee("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Us=Ee("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Hs=Ee("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Ms=Ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),vs=Ee("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),na=Ee("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),la=Ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ie=Ee("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),jt=Ee("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),wt=Ee("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]),vt=Ee("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),Ls=Ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Nt=Ee("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),hs=Ee("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Ts=Ee("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),xs=Ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),oa=Ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ia=16,as={lower:"abcdefghjkmnpqrstuvwxyz",upper:"ABCDEFGHJKMNPQRSTUVWXYZ",digits:"23456789",symbols:"!@#$%^&*()-_=+[]{};:,.?/|~",similar:"ilIoO01"};function Gs(t){const s=new Uint32Array(t);return crypto.getRandomValues(s),s}function kt(t){let s="";return t.lower&&(s+=as.lower+(t.similar?"il":"")),t.upper&&(s+=as.upper+(t.similar?"IO":"")),t.digits&&(s+=(t.similar?"01":"")+as.digits),t.symbols&&(s+=as.symbols),t.ambiguous&&(s+="{}[]()/\\\\'\\\"`~,;:.<>"),t.similar||(s=[...s].filter(a=>!as.similar.includes(a)).join("")),s}function ca(t,s){const a=kt(s);if(!a.length)throw new Error("No character sets selected");const n=[];s.lower&&n.push(as.lower),s.upper&&n.push(as.upper),s.digits&&n.push(s.similar?as.digits+"01":as.digits),s.symbols&&n.push(as.symbols),s.ambiguous&&n.push("{}[]()/\\\\'\\\"`~,;:.<>");const l=[];n.forEach(x=>{const v=Gs(1)[0]%x.length;l.push(x[v])});const o=Math.max(t-l.length,0),m=Gs(o);for(let x=0;x<o;x++){const v=m[x]%a.length;l.push(a[v])}for(let x=l.length-1;x>0;x--){const v=Gs(1)[0]%(x+1);[l[x],l[v]]=[l[v],l[x]]}return l.join("")}function da(t,s){const a=kt(s),n=Math.max(a.length,1);return Math.round(t*Math.log2(n))}function ma({bits:t}){let s="Weak",a=25;return t>=80?(s="Very strong",a=100):t>=60?(s="Strong",a=75):t>=40&&(s="Okay",a=50),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded",children:e.jsx("div",{className:`h-2 rounded ${a>=75?"bg-green-500":a>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a}%`}})}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Strength: ",s," (",t," bits)"]})]})}function ua({onUse:t}){const[s,a]=i.useState(ia),[n,l]=i.useState({lower:!0,upper:!0,digits:!0,symbols:!0,ambiguous:!1,similar:!1}),[o,m]=i.useState(""),[x,v]=i.useState(!1),p=i.useRef(null),S=i.useMemo(()=>da(s,n),[s,n]);function A(g){l(Q=>({...Q,[g]:!Q[g]}))}function T(){try{const g=ca(s,n);m(g),v(!1)}catch(g){console.error("Failed to generate password:",g)}}async function B(){if(o)try{await navigator.clipboard.writeText(o),v(!0),setTimeout(()=>v(!1),2e3)}catch(g){console.error("Failed to copy password:",g)}}function z(){t&&o&&t(o)}return e.jsxs(ue,{className:"mb-6",children:[e.jsxs(Je,{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(bt,{className:"w-5 h-5 text-blue-600"}),"Password Generator"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate secure, random passwords"})]}),e.jsx(ts,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Generated Password"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ke,{ref:p,value:o,readOnly:!0,className:"flex-1 font-mono text-sm",placeholder:"Click 'Generate' to create a password"}),e.jsx(me,{onClick:B,variant:"outline",size:"sm",className:"px-3",children:x?"Copied!":"Copy"})]}),o&&e.jsx(ma,{bits:S})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password Length: ",s]}),e.jsx("input",{type:"range",min:"8",max:"64",value:s,onChange:g=>a(parseInt(g.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"8"}),e.jsx("span",{children:"16"}),e.jsx("span",{children:"32"}),e.jsx("span",{children:"64"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Character Sets"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(n).map(([g,Q])=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:()=>A(g),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 capitalize",children:g==="lower"?"Lowercase":g==="upper"?"Uppercase":g==="digits"?"Numbers":g==="symbols"?"Symbols":g==="ambiguous"?"Ambiguous":g==="similar"?"Similar":g})]},g))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(me,{onClick:T,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"Generate Password"}),o&&t&&e.jsx(me,{onClick:z,variant:"outline",className:"flex-1",children:"Use This Password"})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-1",children:"Security Tips"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Use at least 16 characters for maximum security"}),e.jsx("li",{children:"â€¢ Include uppercase, lowercase, numbers, and symbols"}),e.jsx("li",{children:"â€¢ Avoid similar-looking characters (l, 1, I, O, 0)"}),e.jsx("li",{children:"â€¢ Store passwords in a secure password manager"})]})]})]})})]})}const ot={passwords:{keywords:["password","passwords","strong password","secure password","passphrase","password manager"],response:`**Password Protection**

â€¢ Use at least 16 characters when possible
â€¢ Combine uppercase letters, lowercase letters, numbers, and symbols
â€¢ Avoid personal information (birthdays, names, etc.)
â€¢ Don't use common words or patterns
â€¢ Consider using passphrases (e.g., "KangarooJumping2025!Sydney")
â€¢ Use a different password for each account
â€¢ Consider using a password manager like LastPass, 1Password, or Bitwarden
â€¢ Enable multi-factor authentication (MFA) whenever possible`,source:"Expert Knowledge"}};function ha(){const[t,s]=i.useState([]),[a,n]=i.useState(""),[l,o]=i.useState(!1),[m,x]=i.useState(!1);return{chatMessages:t,inputMessage:a,isTyping:l,chatError:m,setInputMessage:n,formatChatMessage:S=>S?S.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/^â€¢ /gm,"<br>â€¢ ").replace(/^\* /gm,"<br>â€¢ ").replace(/^- /gm,"<br>â€¢ ").replace(/^### (.*$)/gm,'<h4 style="margin: 15px 0 8px 0; color: #374151; font-size: 16px;">$1</h4>').replace(/^## (.*$)/gm,'<h3 style="margin: 15px 0 10px 0; color: #1f2937; font-size: 18px;">$1</h3>').replace(/^# (.*$)/gm,'<h2 style="margin: 15px 0 10px 0; color: #111827; font-size: 20px;">$1</h2>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" style="color: #21a1ce; text-decoration: underline;">$1</a>').replace(/\n\n/g,"<br><br>").replace(/\n/g,"<br>"):"",handleChatSubmit:async S=>{if(S.preventDefault(),!a.trim())return;x(!1);const A={text:a,sender:"user"};s(B=>[...B,A]);const T=a;n(""),o(!0);try{let B=!1,z="",g="";const Q=T.toLowerCase();if(["connect me with a remaleh guardian","connect me with remaleh guardian","remaleh guardian","speak to a guardian","contact guardian","talk to a guardian","connect me with a guardian"].some(P=>Q.includes(P))&&(z=`**Remaleh Guardian Support**

Please contact us directly and a Guardian will assist you:

[Contact Remaleh Guardian](https://www.remaleh.com.au/contact-us)`,g="Remaleh Guardians",B=!0),!B)for(const P in ot){const{keywords:N,response:M,source:y}=ot[P];for(const k of N)if(Q.includes(k.toLowerCase())){z=M,g=y,B=!0;break}if(B)break}if(!B)try{const P=await fetch(`${$e}/api/chat/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:T})});if(!P.ok)throw new Error(`API status ${P.status}`);const N=await P.json();N.success&&(z=N.response,g=N.source==="expert_knowledge"?"Expert Knowledge":"AI Analysis",B=!0)}catch{}B||(z="I don't have specific information about that topic yet. For complex cybersecurity questions, I recommend consulting with a security professional.",g="AI Analysis"),setTimeout(()=>{const P={text:z,sender:"assistant",source:g};s(N=>[...N,P]),o(!1)},600)}catch{x(!0);const z={text:"Sorry, I encountered an error processing your request. Please try again.",sender:"assistant",source:"System"};s(g=>[...g,z]),o(!1)}}}}function xa({setActiveTab:t}){const{chatMessages:s,inputMessage:a,isTyping:n,chatError:l,setInputMessage:o,formatChatMessage:m,handleChatSubmit:x}=ha(),v=i.useRef(null);return i.useEffect(()=>{const p=v.current;if(p)try{p.scrollTo({top:p.scrollHeight,behavior:"smooth"})}catch{p.scrollTop=p.scrollHeight}},[s,n]),e.jsx("div",{className:"p-2 md:p-4",children:e.jsx(ue,{className:"mb-2",children:e.jsx(ts,{children:e.jsxs("div",{className:"border border-gray-200 rounded-lg h-96 md:h-[32rem] flex flex-col",children:[e.jsxs("div",{ref:v,className:"flex-1 p-4 overflow-y-auto space-y-4",children:[s.length===0&&e.jsxs("div",{className:"text-center text-gray-500 mt-8",children:[e.jsx(Us,{className:"mx-auto mb-2 text-gray-300",size:48}),e.jsx("p",{className:"text-sm md:text-base",children:"Ask me anything about cybersecurity!"}),e.jsx("p",{className:"text-xs md:text-sm mt-2 text-gray-400",children:"Try asking about passwords, phishing, or device security."})]}),s.map((p,S)=>e.jsx("div",{className:`flex ${p.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] px-3 py-2 rounded-lg ${p.sender==="user"?"bg-[#21a1ce] text-white":"bg-gray-100 text-gray-800"}`,children:[p.sender==="assistant"&&e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(Ie,{className:"w-4 h-4 mr-1 text-[#21a1ce]"}),e.jsx("span",{className:"text-xs text-[#21a1ce] font-medium",children:p.source||"AI Assistant"})]}),e.jsx("div",{className:"text-sm",dangerouslySetInnerHTML:{__html:p.sender==="assistant"?m(p.text):p.text}})]})},S)),n&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-100 text-gray-800 px-3 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ie,{className:"w-4 h-4 mr-1 text-[#21a1ce]"}),e.jsx("span",{className:"text-xs text-[#21a1ce] font-medium mr-2",children:"AI Assistant"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})]}),e.jsx("form",{onSubmit:x,className:"border-t border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsxs("div",{className:"flex w-full max-w-md space-x-2",children:[e.jsx(ke,{type:"text",value:a,onChange:p=>o(p.target.value),placeholder:"Type your cybersecurity question...",disabled:n,className:"flex-1"}),e.jsx(me,{type:"submit",disabled:n||!a.trim(),className:"bg-[#21a1ce] hover:bg-[#1a80a3] text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]}),l&&e.jsx("p",{className:"text-red-500 text-sm",children:"Connection error. Please check your internet and try again."})]})})]})})})})}const ga="modulepreload",pa=function(t,s){return new URL(t,s).href},it={},Os=function(s,a,n){if(!a||a.length===0)return s();const l=document.getElementsByTagName("link");return Promise.all(a.map(o=>{if(o=pa(o,n),o in it)return;it[o]=!0;const m=o.endsWith(".css"),x=m?'[rel="stylesheet"]':"";if(!!n)for(let S=l.length-1;S>=0;S--){const A=l[S];if(A.href===o&&(!m||A.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${x}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":ga,m||(p.as="script",p.crossOrigin=""),p.href=o,document.head.appendChild(p),m)return new Promise((S,A)=>{p.addEventListener("load",S),p.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>s()).catch(o=>{const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=o,window.dispatchEvent(m),!m.defaultPrevented)throw o})};function xe({children:t,variant:s="primary",size:a="md",fullWidth:n=!1,disabled:l=!1,loading:o=!1,className:m="",...x}){const v="inline-flex items-center justify-center font-medium rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100",p={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-sm",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500"},S={sm:"px-3 py-2 text-sm min-h-[44px]",md:"px-4 py-3 text-base min-h-[48px]",lg:"px-6 py-4 text-lg min-h-[56px]",xl:"px-8 py-5 text-xl min-h-[64px]"},A=n?"w-full":"",T=`${v} ${p[s]} ${S[a]} ${A} ${m}`.trim();return e.jsxs("button",{className:T,disabled:l||o,...x,children:[o&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t]})}const ms=()=>{const[t,s]=i.useState(null),[a,n]=i.useState(!1),[l,o]=i.useState(!0),[m,x]=i.useState(null),v=i.useCallback(async()=>{try{const N=localStorage.getItem("refreshToken");if(!N)return{success:!1,error:"No refresh token available"};const M=await Re(be.AUTH.REFRESH,{refresh_token:N});if(M.ok){const y=await M.json(),{access_token:k,refresh_token:j}=y;return localStorage.setItem("authToken",k),j&&localStorage.setItem("refreshToken",j),{success:!0}}else return{success:!1,error:"Token refresh failed"}}catch(N){return console.error("Token refresh error:",N),{success:!1,error:"Token refresh failed"}}},[]),p=i.useCallback(async()=>{if(localStorage.getItem("authToken"))try{const M=await Ae(be.AUTH.PROFILE);if(M.ok){const y=await M.json(),k=y.user||y;s(k),n(!0)}else M.status===401&&(await v()).success||(localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),s(null),n(!1))}catch{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),s(null),n(!1)}else s(null),n(!1);o(!1)},[v]);i.useEffect(()=>{p();const N=()=>p();return window.addEventListener("remaleh-auth-changed",N),()=>window.removeEventListener("remaleh-auth-changed",N)},[p]);const S=i.useCallback(async(N,M)=>{try{x(null),o(!0),console.log("Attempting login to:",be.AUTH.LOGIN);const y=await Re(be.AUTH.LOGIN,{email:N,password:M});if(y.ok){const k=await y.json();console.log("Login response:",k);const{access_token:j,refresh_token:L,user:G}=k;localStorage.setItem("authToken",j),localStorage.setItem("refreshToken",L);const H=G||k.user;return console.log("Setting user:",H),console.log("User is_admin:",H==null?void 0:H.is_admin),console.log("User role:",H==null?void 0:H.role),s(H),n(!0),window.dispatchEvent(new Event("remaleh-auth-changed")),{success:!0}}else{let k="Login failed. Please check your email and password.";try{const j=await y.json(),L=j.error||j.message||"";L.toLowerCase().includes("email not verified")?k="Please verify your email to sign in. Check your inbox for the code.":L.toLowerCase().includes("invalid email or password")?k="Incorrect email or password. Please try again.":L.toLowerCase().includes("deactivated")&&(k="Your account is deactivated. Contact support for assistance.")}catch{}return x(k),{success:!1,error:k}}}catch(y){console.error("Login error details:",y);let k="We couldn't reach the server. Please check your connection and try again.";return y.name==="TypeError"&&y.message.includes("fetch")?k="Cannot connect to server. Please check your internet connection or server status.":y.message&&(k=y.message),x(k),{success:!1,error:k}}finally{o(!1)}},[]),A=i.useCallback(async N=>{try{x(null),o(!0);const M=await Re(be.AUTH.REGISTER,N);if(M.ok){const y=await M.json();if(y.requires_verification)return{success:!0,requires_verification:!0,user:y.user};const{access_token:k,refresh_token:j,user:L}=y;return localStorage.setItem("authToken",k),localStorage.setItem("refreshToken",j),s(L),n(!0),window.dispatchEvent(new Event("remaleh-auth-changed")),{success:!0}}else{let y="Registration failed";try{const k=await M.json();y=k.error||k.message||y}catch{}return x(y),{success:!1,error:y}}}catch{const y="We couldn't reach the server. Please check your connection and try again.";return x(y),{success:!1,error:y}}finally{o(!1)}},[]),T=i.useCallback(async(N,M)=>{try{x(null),o(!0);const y=await Re(be.AUTH.VERIFY_EMAIL,{email:N,code:M});if(y.ok){const k=await y.json(),{access_token:j,refresh_token:L,user:G}=k;return localStorage.setItem("authToken",j),localStorage.setItem("refreshToken",L),s(G),n(!0),window.dispatchEvent(new Event("remaleh-auth-changed")),{success:!0}}else{const k=await y.json();return x(k.error||k.message||"Verification failed"),{success:!1,error:k.error||k.message}}}catch{const k="We couldn't reach the server. Please check your connection and try again.";return x(k),{success:!1,error:k}}finally{o(!1)}},[]),B=i.useCallback(async N=>{try{x(null);const M=await Re(be.AUTH.RESEND_VERIFICATION,{email:N});if(M.ok)return{success:!0};{const y=await M.json();return x(y.error||y.message||"Resend failed"),{success:!1,error:y.error||y.message}}}catch{const y="We couldn't reach the server. Please check your connection and try again.";return x(y),{success:!1,error:y}}},[]),z=i.useCallback(async N=>{try{x(null);const M=await Re(be.AUTH.REQUEST_PASSWORD_RESET,{email:N});if(M.ok)return{success:!0,message:(await M.json()).message||"If this email exists, a temporary password has been sent."};{let y="Please wait before trying again.";try{const k=await M.json();y=k.error||k.message||y}catch{}return x(y),{success:!1,error:y}}}catch{const y="We couldn't reach the server. Please check your connection and try again.";return x(y),{success:!1,error:y}}},[]),g=i.useCallback(async()=>{try{localStorage.getItem("authToken")&&await Re(be.AUTH.LOGOUT)}catch(N){console.error("Logout error:",N)}finally{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),s(null),n(!1),window.dispatchEvent(new Event("remaleh-auth-changed"))}},[]),Q=i.useCallback(async N=>{try{x(null),o(!0);const M={};if(typeof(N==null?void 0:N.name)=="string"){const j=N.name.trim().split(/\s+/);M.first_name=j[0]||"",M.last_name=j.length>1?j.slice(1).join(" "):""}typeof(N==null?void 0:N.first_name)=="string"&&(M.first_name=N.first_name),typeof(N==null?void 0:N.last_name)=="string"&&(M.last_name=N.last_name),typeof(N==null?void 0:N.bio)=="string"&&(M.bio=N.bio);const y=await rs(be.AUTH.PROFILE,M);if(y.ok){const k=await y.json(),j=k.user||k;return s(j),{success:!0,user:j}}else{const k=await y.json();return x(k.message||"Profile update failed"),{success:!1,error:k.message}}}catch{const y="We couldn't reach the server. Please check your connection and try again.";return x(y),{success:!1,error:y}}finally{o(!1)}},[]),b=i.useCallback(async(N,M)=>{try{x(null),o(!0);const y=await Re(be.AUTH.CHANGE_PASSWORD,{current_password:N,new_password:M});if(y.ok)return{success:!0};{const k=await y.json();return x(k.message||"Password change failed"),{success:!1,error:k.message}}}catch{const k="We couldn't reach the server. Please check your connection and try again.";return x(k),{success:!1,error:k}}finally{o(!1)}},[]),P=i.useCallback(()=>{console.log("=== USER AUTH DEBUG ==="),console.log("User object:",t),console.log("Is authenticated:",a),console.log("Is loading:",l),console.log("User is_admin:",t==null?void 0:t.is_admin),console.log("User role:",t==null?void 0:t.role),console.log("User email:",t==null?void 0:t.email),console.log("Local storage token:",localStorage.getItem("authToken")),console.log("========================")},[t,a,l]);return{user:t,isAuthenticated:a,isLoading:l,error:m,login:S,register:A,verifyEmail:T,resendVerification:B,requestPasswordReset:z,logout:g,updateProfile:Q,changePassword:b,refreshAuthToken:v,clearError:()=>x(null),debugUserState:P}};async function Ct(t,{cloudName:s,uploadPreset:a,folder:n="app_uploads"}={}){var S;const l=s||"dhdly65li",o=a||"remaleh_unsigned";if(!l||!o)throw new Error("Cloudinary env not configured");const m=new FormData;m.append("file",t),m.append("upload_preset",o),m.append("folder",n);const x=await fetch(`https://api.cloudinary.com/v1_1/${l}/auto/upload`,{method:"POST",body:m}),v=await x.text();let p=null;try{p=v?JSON.parse(v):null}catch{}if(!x.ok){const A=p&&(((S=p.error)==null?void 0:S.message)||p.message)||`Upload failed (HTTP ${x.status})`;throw new Error(A)}if(!p||!p.secure_url)throw new Error("Upload failed: no URL returned");return{url:p.secure_url,public_id:p.public_id,resource_type:p.resource_type||"image"}}const Oe={MODULES:"/api/learning/modules",MODULE:t=>`/api/learning/modules/${t}`,LESSONS:t=>`/api/learning/modules/${t}/lessons`,LESSON:(t,s)=>`/api/learning/modules/${t}/lessons/${s}`,PROGRESS:t=>`/api/learning/modules/${t}/progress`,PROGRESS_OVERVIEW:"/api/learning/progress/overview",EXPORT:"/api/learning/content/export",IMPORT:"/api/learning/content/import",LEARNING_MEDIA:"/api/learning/media"},$s="learning_content_fallback",Ue=async(t=!1)=>{try{const s=t?`${Oe.MODULES}?t=${Date.now()}`:Oe.MODULES;console.log("ðŸ”„ getAllModules called with forceRefresh:",t,"endpoint:",s);const a=await Ae(s);if(a.ok){const n=await a.json();return console.log("ðŸ”„ getAllModules fresh data received:",n),localStorage.setItem($s,JSON.stringify(n)),n.modules||[]}}catch(s){console.warn("Backend unavailable, using fallback data:",s)}if(!t)try{const s=localStorage.getItem($s);if(s)return console.log("ðŸ”„ getAllModules using fallback data"),JSON.parse(s).modules||[]}catch(s){console.warn("Fallback data unavailable:",s)}return[]},St=async t=>{try{const s=await Ae(Oe.MODULE(t));if(s.ok)return await s.json()}catch(s){console.warn("Backend unavailable, using fallback data:",s)}try{const s=localStorage.getItem($s);if(s)return(JSON.parse(s).modules||[]).find(n=>n.id===t)}catch(s){console.warn("Fallback data unavailable:",s)}return null},fa=async(t,s)=>{try{const a=await St(t);if(a&&a.content&&a.content.lessons)return a.content.lessons.find(n=>n.id===s)}catch(a){console.warn("Error getting lesson:",a)}return null},Et=async t=>{try{const s=await Ae(Oe.PROGRESS(t));if(s.ok)return await s.json()}catch(s){console.warn("Backend unavailable, using local progress:",s)}try{const s=localStorage.getItem(`module_progress_${t}`);if(s)return JSON.parse(s)}catch(s){console.warn("Local progress unavailable:",s)}return{module_id:t,completed:!1,score:0,started_at:null,completed_at:null}},_s=async()=>{try{const t=await Ae(Oe.PROGRESS_OVERVIEW);if(t.ok)return await t.json()}catch(t){console.warn("Backend unavailable, using local progress:",t)}try{const t=await Ue(),s=t.filter(a=>{const n=localStorage.getItem(`module_progress_${a.id}`);return n&&JSON.parse(n).completed}).length;return{total_modules:t.length,completed_modules:s,completion_percentage:t.length>0?s/t.length*100:0,total_score:0,average_score:0}}catch(t){return console.warn("Local progress calculation failed:",t),{total_modules:0,completed_modules:0,completion_percentage:0,total_score:0,average_score:0}}},ya=async()=>{var t,s,a;try{const n=await Ue(),l=await _s();for(const o of n)if(!(await Et(o.id)).completed)return{module_id:o.id,module_title:o.title,lesson_id:1,lesson_title:((a=(s=(t=o.content)==null?void 0:t.lessons)==null?void 0:s[0])==null?void 0:a.title)||"Introduction"};return null}catch(n){return console.warn("Error getting next recommended lesson:",n),null}},Ps=(t,s)=>{var a;try{if(!Array.isArray(t)||!s)return null;const n=new Set((s.lesson_progress_records||[]).filter(l=>l.completed).map(l=>`${l.module_id}_${l.lesson_id}`));for(const l of t){const o=((a=l==null?void 0:l.content)==null?void 0:a.lessons)||[];for(const m of o){const x=`${l.id}_${m.id}`;if(!n.has(x))return{module_id:l.id,module_title:l.title,lesson_id:m.id,lesson_title:m.title}}}return null}catch(n){return console.warn("Error computing next recommended lesson:",n),null}},ba=async()=>{try{const t=await _s(),s=await Ue();return{...t,total_lessons:s.reduce((a,n)=>{var l,o;return a+(((o=(l=n.content)==null?void 0:l.lessons)==null?void 0:o.length)||0)},0),estimated_total_time:s.reduce((a,n)=>a+(n.estimated_time||0),0)}}catch(t){return console.warn("Error getting learning stats:",t),{total_modules:0,completed_modules:0,completion_percentage:0,total_lessons:0,estimated_total_time:0}}},ja=async t=>{try{const s=await Ue(),a=[],n=t.toLowerCase();for(const l of s)if((l.title.toLowerCase().includes(n)||l.description.toLowerCase().includes(n))&&a.push({type:"module",id:l.id,title:l.title,description:l.description,difficulty:l.difficulty}),l.content&&l.content.lessons)for(const o of l.content.lessons)(o.title.toLowerCase().includes(n)||o.content.toLowerCase().includes(n))&&a.push({type:"lesson",module_id:l.id,module_title:l.title,id:o.id,title:o.title,content:o.content.substring(0,100)+"..."});return a}catch(s){return console.warn("Error searching content:",s),[]}},wa=async t=>{try{return(await Ue()).filter(a=>a.difficulty===t)}catch(s){return console.warn("Error getting content by difficulty:",s),[]}},va=async()=>{try{const t=await Ue(),s=[];for(const a of t)if(a.content&&a.content.lessons&&a.content.lessons.length>0){const n=a.content.lessons[0];s.push({module_id:a.id,module_title:a.title,lesson_id:n.id,lesson_title:n.title,content:n.content.substring(0,150)+"...",difficulty:a.difficulty,estimated_time:a.estimated_time})}return s}catch(t){return console.warn("Error getting quick tips:",t),[]}},Na=async()=>{try{const t=await Ae(Oe.EXPORT);if(t.ok)return(await t.json()).metadata}catch(t){console.warn("Backend unavailable, using fallback data:",t)}try{const t=localStorage.getItem($s);if(t)return JSON.parse(t).metadata||{version:"1.0",last_updated:new Date().toISOString(),total_modules:0,total_lessons:0}}catch(t){console.warn("Fallback data unavailable:",t)}return{version:"1.0",last_updated:new Date().toISOString(),total_modules:0,total_lessons:0}},Lt=async t=>{try{const s=await Re(Oe.MODULES,t);if(s.ok){const a=await s.json();return await Ue(),a}else throw new Error("Failed to create module")}catch(s){throw console.error("Error creating module:",s),s}},_t=async(t,s)=>{try{console.log("ðŸ”„ updateModule called with:",{moduleId:t,moduleData:s}),console.log("ðŸŒ API endpoint:",Oe.MODULE(t));const a=await rs(Oe.MODULE(t),s);if(console.log("ðŸŒ Response status:",a.status),console.log("ðŸŒ Response ok:",a.ok),a.ok){const n=await a.json();return console.log("âœ… Module updated successfully:",n),await Ue(),n}else throw console.error("âŒ Failed to update module, status:",a.status),new Error("Failed to update module")}catch(a){throw console.error("âŒ Error in updateModule:",a),a}},At=async t=>{try{if((await ds(Oe.MODULE(t))).ok)return await Ue(),{message:"Module deleted successfully"};throw new Error("Failed to delete module")}catch(s){throw console.error("Error deleting module:",s),s}},Rt=async(t,s)=>{try{console.log("ðŸ”„ contentManager.addLesson called with:",{moduleId:t,lessonData:s}),console.log("ðŸ”„ API endpoint:",Oe.LESSONS(t));const a=await Re(Oe.LESSONS(t),s);if(console.log("ðŸ”„ API response received:",a),console.log("ðŸ”„ Response status:",a.status),console.log("ðŸ”„ Response ok:",a.ok),a.ok){const n=await a.json();return console.log("ðŸ”„ Response data:",n),await Ue(),n}else{console.log("âŒ Response not ok, status:",a.status);let n="Failed to add lesson";try{const l=await a.json();console.log("âŒ Error response body:",l),n=l.error||l.message||n}catch{}throw new Error(n)}}catch(a){throw console.error("âŒ Error in addLesson:",a),a}},Mt=async t=>{try{const s=await Ct(t,{folder:"learning_content"});return{url:s.url,public_id:s.public_id,resource_type:s.resource_type}}catch(s){throw console.error("âŒ Error uploading lesson media:",s),s}},Tt=async(t,s,a)=>{try{const n=await rs(Oe.LESSON(t,s),a);if(n.ok){const l=await n.json();return await Ue(),l}else throw new Error("Failed to update lesson")}catch(n){throw console.error("Error updating lesson:",n),n}},Pt=async(t,s)=>{try{console.log("ðŸ”„ contentManager.deleteLesson called with:",{moduleId:t,lessonId:s}),console.log("ðŸ”„ API endpoint:",Oe.LESSON(t,s));const a=await ds(Oe.LESSON(t,s));if(console.log("ðŸ”„ API response received:",a),console.log("ðŸ”„ Response status:",a.status),console.log("ðŸ”„ Response ok:",a.ok),a.ok)return console.log("âœ… Lesson deleted successfully from API"),await Ue(),{message:"Lesson deleted successfully"};{console.log("âŒ API response not ok, status:",a.status);const n=await a.json();throw console.log("âŒ Error response body:",n),new Error(n.error||`HTTP error! status: ${a.status}`)}}catch(a){throw console.error("âŒ Error in deleteLesson:",a),a}},ka=async(t,s,a)=>{try{console.log("ðŸ”„ contentManager.updateLessonProgress called with:",{moduleId:t,lessonId:s,progressData:a});const n=`/api/learning/modules/${t}/lessons/${s}/progress`;console.log("ðŸ”„ API endpoint:",n);const l=await Re(n,a);if(console.log("ðŸ”„ API response received:",l),console.log("ðŸ”„ Response status:",l.status),console.log("ðŸ”„ Response ok:",l.ok),l.ok){const o=await l.json();return console.log("âœ… Lesson progress updated successfully:",o),o}else{console.log("âŒ API response not ok, status:",l.status);const o=await l.json();throw console.log("âŒ Error response body:",o),new Error(o.error||`HTTP error! status: ${l.status}`)}}catch(n){console.warn("Backend unavailable, storing progress locally:",n);const l={module_id:t,lesson_id:s,completed:a.completed||!1,score:a.score||0,started_at:new Date().toISOString(),completed_at:a.completed?new Date().toISOString():null};return localStorage.setItem(`lesson_progress_${t}_${s}`,JSON.stringify(l)),{progress:l}}},Ca=async(t,s)=>{try{const a=await Re(Oe.PROGRESS(t),s);if(a.ok){const n=await a.json();return localStorage.setItem(`module_progress_${t}`,JSON.stringify(n.progress)),n}else throw new Error("Failed to update progress")}catch(a){console.warn("Backend unavailable, storing progress locally:",a);const n={module_id:t,completed:s.completed||!1,score:s.score||0,started_at:new Date().toISOString(),completed_at:s.completed?new Date().toISOString():null};return localStorage.setItem(`module_progress_${t}`,JSON.stringify(n)),{progress:n}}},Sa=async()=>{try{const t=await Ae(Oe.EXPORT);if(t.ok)return await t.json();throw new Error("Failed to export content")}catch(t){throw console.error("Error exporting content:",t),t}},Ea=async t=>{try{const s=await Re(Oe.IMPORT,t);if(s.ok){const a=await s.json();return await Ue(),a}else throw new Error("Failed to import content")}catch(s){throw console.error("Error importing content:",s),s}},La=Object.freeze(Object.defineProperty({__proto__:null,addLesson:Rt,computeNextRecommendedLesson:Ps,createModule:Lt,deleteLesson:Pt,deleteModule:At,exportContent:Sa,getAllModules:Ue,getContentByDifficulty:wa,getContentUpdateInfo:Na,getLearningStats:ba,getLessonById:fa,getModuleById:St,getModuleProgress:Et,getNextRecommendedLesson:ya,getOverallProgress:_s,getQuickTips:va,importContent:Ea,searchLearningContent:ja,updateLesson:Tt,updateLessonProgress:ka,updateModule:_t,updateProgress:Ca,uploadLessonMedia:Mt},Symbol.toStringTag,{value:"Module"}));function Fs({onRefresh:t,children:s,threshold:a=80,className:n=""}){const[l,o]=i.useState(!1),[m,x]=i.useState(0),[v,p]=i.useState(!1),S=i.useRef(null),A=i.useRef(0),T=i.useRef(0);i.useEffect(()=>{const g=S.current;if(!g)return;const Q=N=>{g.scrollTop===0&&(A.current=N.touches[0].clientY,o(!0))},b=N=>{if(!l)return;T.current=N.touches[0].clientY;const M=Math.max(0,T.current-A.current);M>0&&(x(M),N.preventDefault())},P=async()=>{if(l){if(m>=a&&t){p(!0);try{await t()}catch(N){console.error("Pull to refresh failed:",N)}finally{p(!1)}}o(!1),x(0)}};return g.addEventListener("touchstart",Q,{passive:!1}),g.addEventListener("touchmove",b,{passive:!1}),g.addEventListener("touchend",P),()=>{g.removeEventListener("touchstart",Q),g.removeEventListener("touchmove",b),g.removeEventListener("touchend",P)}},[l,m,a,t]);const B=Math.min(m/a,1),z=l&&m>20;return e.jsxs("div",{className:`relative ${n}`,children:[z&&e.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 flex items-center justify-center bg-blue-50 border-b border-blue-200 transition-all duration-200",style:{height:`${Math.min(m,a)}px`,opacity:B},children:e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx(vs,{className:`w-5 h-5 transition-transform duration-200 ${B>=1?"animate-spin":""}`,style:{transform:`rotate(${B*180}deg)`}}),e.jsx("span",{className:"text-sm font-medium",children:B>=1?"Release to refresh":"Pull to refresh"})]})}),v&&e.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 flex items-center justify-center bg-blue-50 border-b border-blue-200 h-16",children:e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx(vs,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"Refreshing..."})]})}),e.jsx("div",{ref:S,className:"h-full overflow-auto",style:{transform:z?`translateY(${Math.min(m,a)}px)`:"translateY(0)",transition:z?"none":"transform 0.3s ease-out"},children:s})]})}function _a({setActiveTab:t}){var ne,he,fe,se,ce,Me,E,te;const{isAuthenticated:s}=ms(),[a,n]=i.useState(null),[l,o]=i.useState(null),[m,x]=i.useState(""),[v,p]=i.useState("all"),[S,A]=i.useState([]);i.useState(!1);const[T,B]=i.useState([]),[z,g]=i.useState({completed:0,total:0,progress:0}),[Q,b]=i.useState(null),[P,N]=i.useState(!0),[M,y]=i.useState(null),k=R=>{const U=((R==null?void 0:R.type)||"").toLowerCase();if(U==="quiz")return"Quiz";if(U==="assessment")return"Assessment";switch(((R==null?void 0:R.contentType)||"").toLowerCase()){case"info":return"Information";case"tips":return"Tips";case"example":return"Example";case"list":return"List";case"warning":return"Warning";case"warning-signs":return"Warning Signs";case"steps":return"Steps";case"action-list":return"Actions";case"warning-list":return"Warning List";case"markdown":case"html":return"Information";default:return"Information"}},j=R=>{try{if(R==null)return"â€”";if(typeof R=="number")return`${Math.max(0,R)} min`;const U=String(R).trim(),q=U.toLowerCase();if(/[a-z]/.test(q))return/(^|\s)(m|mins?)($|\s)/.test(q)?U.replace(/\bm\b/i,"min"):/(^|\s)(s|secs?)($|\s)/.test(q)?U.replace(/\bs\b/i,"sec"):/(^|\s)(h|hrs?)($|\s)/.test(q)?U.replace(/\bh\b/i,"hr"):U;const f=parseInt(U,10);return isNaN(f)?U:`${f} min`}catch{return String(R)}};i.useEffect(()=>{s?L():N(!1)},[s]);const L=async()=>{try{N(!0),y(null);const[R,U]=await Promise.all([Ue(),_s()]);B(R),g(U),b(Ps(R,U))}catch{y("Failed to load learning content. Please try again.")}finally{N(!1)}};i.useEffect(()=>{if(z.lesson_progress_records&&z.lesson_progress_records.length>0){const R=z.lesson_progress_records.filter(f=>f.completed).map(f=>`${f.module_id}_${f.lesson_id}`),U=new Set(R),q=new Set(S);if(R.filter(f=>!q.has(f)),S.filter(f=>!U.has(f)),R.length>S.length)A(R);else if(R.length===S.length){const f=R.filter(V=>!S.includes(V));if(f.length>0){const V=[...new Set([...S,...f])];A(V)}}}},[z]);const G=async(R,U)=>{var q,f,V;try{const _=T.find(w=>String(w.id)===String(R));if(!_)return;const C=`${String(_.id)}_${String(U)}`;if(S.includes(C))return;const O={completed:!0,score:100,completed_at:new Date().toISOString()},{updateLessonProgress:F}=await Os(()=>Promise.resolve().then(()=>La),void 0,import.meta.url),ee=await F(_.id,U,O),ye=`${String(((q=ee==null?void 0:ee.progress)==null?void 0:q.module_id)??_.id)}_${String(((f=ee==null?void 0:ee.progress)==null?void 0:f.lesson_id)??U)}`,He=!!(((V=ee==null?void 0:ee.progress)==null?void 0:V.completed)??!0)?ye:`${String(_.id)}_${String(U)}`;A(w=>[...new Set([...w,He])]),g(w=>{var Z,ae;const W=[...Array.isArray(w==null?void 0:w.lesson_progress_records)?w.lesson_progress_records:[]],ve=((Z=ee==null?void 0:ee.progress)==null?void 0:Z.module_id)||_.id,Ce=((ae=ee==null?void 0:ee.progress)==null?void 0:ae.lesson_id)||U,Te=W.findIndex(le=>le.module_id===ve&&le.lesson_id===Ce);Te>=0?W[Te]={...W[Te],completed:!0,score:100}:W.push({module_id:ve,lesson_id:Ce,completed:!0,score:100});const Ne=W.filter(le=>le.completed).length,De=(w==null?void 0:w.total_lessons)||T.reduce((le,We)=>{var Ke,Xe;return le+(((Xe=(Ke=We.content)==null?void 0:Ke.lessons)==null?void 0:Xe.length)||0)},0),Ge=De>0?Ne/De*100:(w==null?void 0:w.completion_percentage)||0,h={...w,lesson_progress_records:W,completed_lessons:Ne,completion_percentage:Ge};return b(Ps(T,h)),h});const Le=await _s(),Ze=new Set([...S||[],He]),we=Array.isArray(Le==null?void 0:Le.lesson_progress_records)?[...Le.lesson_progress_records]:[];for(const w of Ze){const[$,W]=w.split("_"),ve=Number($),Ce=Number(W),Te=we.findIndex(Ne=>Ne.module_id===ve&&Ne.lesson_id===Ce);Te>=0?we[Te]={...we[Te],completed:!0,score:100}:we.push({module_id:ve,lesson_id:Ce,completed:!0,score:100})}const Ye=we.filter(w=>w.completed).length,ge=(Le==null?void 0:Le.total_lessons)||T.reduce((w,$)=>{var W,ve;return w+(((ve=(W=$.content)==null?void 0:W.lessons)==null?void 0:ve.length)||0)},0),d=ge>0?Ye/ge*100:(Le==null?void 0:Le.completion_percentage)||0,I={...Le,lesson_progress_records:we,completed_lessons:Ye,completion_percentage:d};g(I),b(Ps(T,I))}catch{const C=`${(a==null?void 0:a.id)||"unknown"}_${U}`;A(O=>[...new Set([...O,C])]);try{const O=[...new Set([...S,C])];localStorage.setItem("remaleh-completed-lessons",JSON.stringify(O))}catch{}}},re=(()=>{let R=T;if(v!=="all"&&(R=R.filter(U=>(U.difficulty||"").toLowerCase()===v)),m){const U=m.toLowerCase();R=R.filter(q=>q.title.toLowerCase().includes(U)||q.description&&q.description.toLowerCase().includes(U))}return R})();return s?e.jsxs("div",{className:"flex flex-col p-4 max-w-none mx-auto w-full overflow-x-hidden break-words min-h-screen",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center",children:e.jsx(ls,{className:"w-6 h-6 text-white"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Learning Hub"}),e.jsx("div",{className:"mt-2",children:e.jsxs("button",{onClick:L,disabled:P,className:"inline-flex items-center px-3 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50 transition-all disabled:opacity-50 text-sm text-gray-700",title:"Refresh content",children:[e.jsx(vs,{className:`w-4 h-4 text-gray-600 mr-2 ${P?"animate-spin":""}`}),"Refresh"]})})]}),M&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-red-800",children:M}),e.jsx("button",{onClick:L,className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:"Try again"})]}),e.jsxs(ue,{className:"mb-4",children:[e.jsx(Je,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Your Progress"}),e.jsx("div",{className:"text-sm text-gray-600",children:P?"Loading...":`${z.completed_modules||0}/${z.total_modules||0} modules`})]})}),e.jsxs(ts,{children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-[#21a1ce] h-2 rounded-full transition-all duration-300",style:{width:`${z.completion_percentage||0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:P?"Loading...":`${Math.round(z.completion_percentage||0)}% Complete`}),Q&&e.jsxs("span",{className:"text-sm text-[#21a1ce] font-medium",children:["Next: ",Q.lesson_title]})]})]})]}),e.jsxs(ue,{className:"mb-4",children:[e.jsx(Je,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center",children:e.jsx(Ie,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Need Help Implementing?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Don't struggle alone - get expert guidance"})]})]}),e.jsx("a",{href:"https://www.remaleh.com.au/contact-us",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center bg-[#21a1ce] hover:bg-[#1a8bb8] text-white rounded-md px-3 py-1.5 text-sm font-medium whitespace-nowrap self-start sm:self-auto",children:"Connect with a Remaleh Guardian"})]})}),e.jsxs(ts,{children:[e.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:"Learning is just the first step. When you're ready to implement cybersecurity measures, our Remaleh Guardians are here to guide you through every step of the process."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-[#21a1ce] rounded-full mt-2"}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Personal Guidance:"})," One-on-one support for your specific situation"]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-[#21a1ce] rounded-full mt-2"}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Step-by-Step Implementation:"})," We'll walk you through each process"]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-[#21a1ce] rounded-full mt-2"}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Ongoing Support:"})," We're here until you feel confident and empowered"]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(la,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(ke,{type:"text",placeholder:"Search learning content...",value:m,onChange:R=>x(R.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(xe,{onClick:()=>p("all"),variant:v==="all"?"primary":"secondary",className:"text-sm px-3 py-2",children:"All"}),e.jsx(xe,{onClick:()=>p("beginner"),variant:v==="beginner"?"primary":"secondary",className:"text-sm px-3 py-2",children:"Beginner"}),e.jsx(xe,{onClick:()=>p("intermediate"),variant:v==="intermediate"?"primary":"secondary",className:"text-sm px-3 py-2",children:"Intermediate"}),e.jsx(xe,{onClick:()=>p("advanced"),variant:v==="advanced"?"primary":"secondary",className:"text-sm px-3 py-2",children:"Advanced"})]})]}),e.jsx(Fs,{onRefresh:L,className:"flex-1 min-h-0",children:e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:a?l?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>o(null),className:"flex items-center text-[#21a1ce] hover:underline text-sm",children:[e.jsx(Es,{className:"w-4 h-4 mr-1"}),"Back to lessons"]}),!S.includes(`${String(a.id)}_${String(l.id)}`)&&e.jsx(xe,{onClick:()=>G(a.id,l.id),variant:"primary",size:"sm",children:"Mark Complete"})]}),e.jsxs(ue,{children:[e.jsxs(Je,{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx("span",{children:j(l.duration)}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:k(l)})]})]}),e.jsx(ts,{children:e.jsx(Aa,{lesson:l})})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsxs("button",{onClick:()=>n(null),className:"flex items-center text-[#21a1ce] hover:underline text-sm",children:[e.jsx(Es,{className:"w-4 h-4 mr-1"}),"Back to modules"]})}),e.jsxs(ue,{children:[e.jsx(Je,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white",style:{backgroundColor:a.color},children:e.jsx(ls,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.title}),e.jsx("p",{className:"text-gray-600",children:a.description}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[((he=(ne=a.content)==null?void 0:ne.lessons)==null?void 0:he.filter(R=>S.includes(`${String(a.id)}_${String(R.id)}`)).length)||0,"/",((se=(fe=a.content)==null?void 0:fe.lessons)==null?void 0:se.length)||0," lessons"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-[#21a1ce] h-2 rounded-full transition-all duration-300",style:{width:`${((Me=(ce=a.content)==null?void 0:ce.lessons)==null?void 0:Me.length)>0?a.content.lessons.filter(R=>S.includes(`${String(a.id)}_${String(R.id)}`)).length/a.content.lessons.length*100:0}%`}})})]})]})]})}),e.jsx(ts,{children:e.jsx("div",{className:"space-y-3",children:(te=(E=a.content)==null?void 0:E.lessons)==null?void 0:te.map(R=>{const U=`${String(a.id)}_${String(R.id)}`,q=S.includes(U);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>o(R),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[q?e.jsx(ws,{className:"w-5 h-5 text-green-500"}):e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 rounded-full"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:R.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[j(R.duration)," â€¢ ",k(R)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[R.contentType==="warning"&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),R.contentType==="example"&&e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx(Es,{className:"w-4 h-4 text-gray-400 transform rotate-180"})]})]},R.id)})})})]})]}):e.jsx("div",{className:"space-y-4",children:P?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#21a1ce] mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Loading learning modules..."})]}):re.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ls,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No learning modules found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Check back later for new content"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:re.map(R=>{var V,_,C,O;const U=((_=(V=R.content)==null?void 0:V.lessons)==null?void 0:_.length)||0,q=((O=(C=R.content)==null?void 0:C.lessons)==null?void 0:O.filter(F=>S.includes(`${String(R.id)}_${String(F.id)}`)).length)||0,f=U>0?q/U*100:0;return e.jsxs(ue,{className:"cursor-pointer transition-colors hover:bg-gray-50 overflow-hidden",padding:"p-3",onClick:()=>n(R),children:[e.jsx(Je,{className:"mb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-9 h-9 bg-[#21a1ce] rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(ls,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"min-w-0 break-words",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 truncate",children:R.title}),e.jsx("p",{className:"text-xs text-gray-600 leading-5 max-h-[2.5rem] overflow-hidden break-words",children:R.description}),e.jsxs("div",{className:"flex items-center space-x-3 text-[11px] text-gray-500 mt-1",children:[e.jsxs("span",{children:[U," lessons"]}),e.jsxs("span",{children:[R.estimated_time," min"]}),e.jsx("span",{className:"capitalize",children:R.difficulty})]})]})]}),e.jsxs("div",{className:"text-right ml-2 flex-shrink-0",children:[e.jsxs("div",{className:"text-xs font-medium text-[#21a1ce]",children:[Math.round(f),"%"]}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[q,"/",U]})]})]})}),e.jsx(ts,{children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-[#21a1ce] h-1.5 rounded-full transition-all duration-300",style:{width:`${f}%`}})})})]},R.id)})})})})})]}):e.jsx("div",{className:"space-y-6 p-4",children:e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ls,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please log in to access the Learning Hub and track your progress."}),e.jsx(xe,{onClick:()=>t("login"),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:"Go to Login"})]})})})}function Aa({lesson:t}){const s=o=>{if(!o)return"";let m=o.replace(/<\/(?:script|style)>/gi,`
`);return m=m.replace(/<\s*(script|style)[^>]*>[\s\S]*?<\s*\/\s*\1\s*>/gi,""),m=m.replace(/ on[a-z]+\s*=\s*"[^"]*"/gi,""),m=m.replace(/ on[a-z]+\s*=\s*'[^']*'/gi,""),m=m.replace(/ on[a-z]+\s*=\s*[^\s>]+/gi,""),m=m.replace(/<\s*a\b[^>]*>/gi,'<span class="text-[#21a1ce] underline cursor-default" data-role="educational-link">'),m=m.replace(/<\s*\/\s*a\s*>/gi,"</span>"),m},a=o=>{if(!o)return"";let m=o;return m=m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),m=m.replace(/^### (.*)$/gm,'<h4 class="font-semibold text-gray-900 mb-2">$1</h4>').replace(/^## (.*)$/gm,'<h3 class="font-semibold text-gray-900 mb-2">$1</h3>').replace(/^# (.*)$/gm,'<h2 class="font-bold text-gray-900 mb-2">$1</h2>'),m=m.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),m=m.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<span class="text-[#21a1ce] underline cursor-default" data-role="educational-link" data-url="$2">$1</span>'),m=m.replace(/^(?:- |\* )(.*)$/gm,"<li>$1</li>"),m=m.replace(/(<li>.*<\/li>\n?)+/g,x=>`<ul class="list-disc list-inside space-y-1">${x}
</ul>`),m=m.replace(/\n\n/g,"<br/><br/>").replace(/\n/g,"<br/>"),m},n=o=>{switch(o){case"blue":return"bg-blue-50 border-blue-200";case"yellow":return"bg-yellow-50 border-yellow-200";case"red":return"bg-red-50 border-red-200";case"green":return"bg-green-50 border-green-200";default:return"bg-gray-50 border-gray-200"}},l=()=>{var o,m,x,v,p;switch(t.contentType){case"tips":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words",children:t.content}),e.jsx("div",{className:"space-y-3",children:(o=t.tips)==null?void 0:o.map((S,A)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"p-1 rounded-full mr-3 mt-1 bg-green-100",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium whitespace-pre-line",children:S.title}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:S.description})]})]},A))})]});case"warning-signs":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words",children:t.content}),e.jsx("div",{className:"space-y-3",children:(m=t.signs)==null?void 0:m.map((S,A)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`p-1 rounded-full mr-3 mt-1 ${S.danger?"bg-red-100":"bg-green-100"}`,children:e.jsx("div",{className:`w-2 h-2 rounded-full ${S.danger?"bg-red-500":"bg-green-500"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium whitespace-pre-line",children:S.title}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:S.description})]})]},A))})]});case"steps":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words",children:t.content}),e.jsx("div",{className:"space-y-2",children:(x=t.steps)==null?void 0:x.map((S,A)=>e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#21a1ce] text-white text-sm font-bold flex items-center justify-center mr-3 mt-0.5",children:A+1}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:S})]},A))})]});case"list":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-gray-700 whitespace-pre-line",children:t.content}),e.jsx("ul",{className:"space-y-2 ml-4",children:(v=t.items)==null?void 0:v.map((S,A)=>e.jsxs("li",{className:"text-gray-700 whitespace-pre-line",children:["â€¢ ",S]},A))})]});case"warning":case"warning-list":return e.jsxs("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:[e.jsx("h4",{className:"font-bold mb-2 text-red-800",children:"Important"}),e.jsx("div",{className:"text-red-700 mb-3 whitespace-pre-line break-words",children:t.content}),t.items&&e.jsx("ul",{className:"space-y-1 text-red-700",children:t.items.map((S,A)=>e.jsxs("li",{className:"whitespace-pre-line",children:["â€¢ ",S]},A))})]});case"action-list":return e.jsxs("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:[e.jsx("h4",{className:"font-bold mb-2 text-green-800",children:"Actions to Take"}),e.jsx("div",{className:"text-green-700 mb-3 whitespace-pre-line break-words",children:t.content}),e.jsx("ul",{className:"space-y-1 text-green-700",children:(p=t.actions)==null?void 0:p.map((S,A)=>e.jsxs("li",{className:"whitespace-pre-line",children:["â€¢ ",S]},A))})]});case"example":return e.jsxs("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:[e.jsx("h4",{className:"font-bold mb-2",children:"Real-World Example"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words",children:t.content})]});case"markdown":return e.jsx("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:e.jsx("div",{className:"prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:s(a(t.content))}})});case"html":return e.jsx("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:e.jsx("div",{className:"prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:s(t.content)}})});default:return e.jsx("div",{className:`p-4 rounded-lg border ${n(t.contentStyle)} break-words`,children:e.jsx("div",{className:"text-gray-700 whitespace-pre-line break-words",children:t.content})})}};return e.jsxs("div",{className:"space-y-6 break-words",children:[l(),Array.isArray(t.media)&&t.media.length>0&&e.jsx("div",{className:"space-y-3",children:t.media.map((o,m)=>e.jsxs("div",{className:"space-y-2",children:[o.type==="image"?e.jsx("img",{src:o.url,alt:o.caption||t.title,className:"w-full max-h-72 object-cover rounded-lg border border-gray-200",loading:"lazy"}):o.type==="video"?e.jsxs("video",{controls:!0,className:"w-full max-h-80 rounded-lg border border-gray-200",children:[e.jsx("source",{src:o.url}),"Your browser does not support the video tag."]}):null,o.caption&&e.jsx("div",{className:"text-xs text-gray-500",children:o.caption})]},m))})]})}const It=()=>{const[t,s]=i.useState([]),[a,n]=i.useState([]),[l,o]=i.useState(null),[m,x]=i.useState([]),[v,p]=i.useState([]),[S,A]=i.useState([]),[T,B]=i.useState(null),[z,g]=i.useState(!1),[Q,b]=i.useState(null),[P,N]=i.useState(null),[M,y]=i.useState(!0),k=i.useCallback(async(_={},C=!1)=>{try{g(!0),b(null);const O=new URLSearchParams(_).toString(),F=`${be.COMMUNITY.REPORTS}${O?`?${O}`:""}`,ee=await Ae(F);if(ee.ok){const ye=await ee.json();return C&&ye.reports?s(pe=>[...pe,...ye.reports]):s(ye.reports||ye),ye.pagination&&(N(ye.pagination),y(ye.pagination.has_next)),ye}else throw new Error("Failed to fetch community reports")}catch(O){b(O.message),console.error("Error fetching reports:",O)}finally{g(!1)}},[]),j=i.useCallback(async()=>{try{g(!0),b(null);const _=await Ae(be.COMMUNITY.TRENDING);if(_.ok){const C=await _.json();return n(C.trending_threats||C),C}else throw new Error("Failed to fetch trending threats")}catch(_){b(_.message),console.error("Error fetching trending threats:",_)}finally{g(!1)}},[]),L=i.useCallback(async()=>{try{g(!0),b(null);const _=new URLSearchParams({per_page:50,sort:"newest",include_all:"true"}).toString(),C=await Ae(`${be.COMMUNITY.REPORTS}?${_}`);if(C.ok){const ye=((await C.json()).reports||[]).filter(pe=>(pe.status==="APPROVED"||pe.status==="VERIFIED")&&pe.verified===!0&&pe.urgency==="HIGH").slice(0,10);return A(ye),{reports:ye}}else throw new Error("Failed to fetch latest reports")}catch(_){b(_.message),console.error("Error fetching latest reports:",_)}finally{g(!1)}},[]),G=i.useCallback(async _=>{try{g(!0),b(null);const C=await Ae(`${be.COMMUNITY.REPORTS}/${_}`);if(C.ok)return{success:!0,report:await C.json()};{const O=await C.json();throw new Error(O.message||"Failed to fetch report")}}catch(C){return b(C.message),{success:!1,error:C.message}}finally{g(!1)}},[]),H=i.useCallback(async(_,{page:C=1,per_page:O=20}={})=>{try{g(!0),b(null);const F=new URLSearchParams({page:C,per_page:O}).toString(),ee=await Ae(`${be.COMMUNITY.REPORTS}/${_}/comments?${F}`);if(ee.ok)return{success:!0,...await ee.json()};{const ye=await ee.json();throw new Error(ye.message||"Failed to fetch comments")}}catch(F){return b(F.message),{success:!1,error:F.message}}finally{g(!1)}},[]),re=i.useCallback(async _=>{try{g(!0),b(null);const C=await ds(`/api/community/comments/${_}`);if(C.ok)return{success:!0};{const O=await C.json();throw new Error(O.message||"Failed to delete comment")}}catch(C){return b(C.message),{success:!1,error:C.message}}finally{g(!1)}},[]),ne=i.useCallback(async()=>{try{g(!0),b(null);const _=await Ae(be.COMMUNITY.STATS);if(_.ok){const C=await _.json();return o(C),C}else throw new Error("Failed to fetch community statistics")}catch(_){b(_.message),console.error("Error fetching community stats:",_)}finally{g(!1)}},[]),he=i.useCallback(async()=>{try{g(!0),b(null);const _=await Ae(be.COMMUNITY.ALERTS);if(_.ok){const C=await _.json();return x(C.alerts||C),C}else throw new Error("Failed to fetch community alerts")}catch(_){b(_.message),console.error("Error fetching alerts:",_)}finally{g(!1)}},[]),fe=i.useCallback(async({period:_="90d"}={})=>{try{g(!0),b(null);const C=new URLSearchParams({period:_}).toString(),O=await Ae(`${be.COMMUNITY.LEADERBOARD}?${C}`);if(O.ok){const F=await O.json();return p(F&&F.leaderboard?F.leaderboard:Array.isArray(F)?F:[]),F}else throw new Error("Failed to fetch leaderboard")}catch(C){b(C.message),console.error("Error fetching leaderboard:",C)}finally{g(!1)}},[]),se=i.useCallback(async({period:_="90d"}={})=>{try{g(!0),b(null);const C=new URLSearchParams({period:_}).toString(),O=await Ae(`${be.COMMUNITY.MY_STATS}?${C}`);if(O.ok){const F=await O.json();return B(F),F}else throw new Error("Failed to fetch my stats")}catch(C){b(C.message),console.error("Error fetching my stats:",C)}finally{g(!1)}},[]),ce=i.useCallback(async _=>{try{g(!0),b(null);const C={threat_type:_.threat_type,description:_.description,location:_.location,urgency:_.urgency||"MEDIUM"},O=await Re(be.COMMUNITY.REPORTS,C);if(O.ok){const{report:F}=await O.json();return s(ee=>[F,...ee]),{success:!0,report:F}}else{const F=await O.json();throw new Error(F.message||"Failed to create report")}}catch(C){return b(C.message),{success:!1,error:C.message}}finally{g(!1)}},[]),Me=i.useCallback(async(_,C)=>{try{g(!0),b(null);let O;if(C instanceof File){const F=await Ct(C,{folder:"community_reports"});O=await Re(`${be.COMMUNITY.REPORTS}/${_}/media`,{media_url:F.url,media_type:F.resource_type==="video"?"video":"image"})}else O=await Re(`${be.COMMUNITY.REPORTS}/${_}/media`,{media_url:String(C),media_type:"image"});if(O.ok){const F=await O.json(),ee=F.media||F;return s(ye=>ye.map(pe=>pe.id===_?{...pe,media:[...pe.media||[],ee]}:pe)),{success:!0,media:ee}}else{const F=await O.json();throw new Error(F.error||F.message||"Failed to upload media")}}catch(O){return b(O.message),{success:!1,error:O.message}}finally{g(!1)}},[s]),E=i.useCallback(async _=>{try{g(!0),b(null);const C=await ds(`${be.COMMUNITY.REPORTS}/${_}`);if(C.ok)return s(O=>O.filter(F=>F.id!==_)),{success:!0};{const O=await C.json();throw new Error(O.message||"Failed to delete report")}}catch(C){return b(C.message),{success:!1,error:C.message}}finally{g(!1)}},[]),te=i.useCallback(async(_,C)=>{try{g(!0),b(null);const O=await Re(`${be.COMMUNITY.REPORTS}/${_}/vote`,{vote_type:C});if(O.ok){const F=await O.json(),ee=F.report||F;return s(ye=>ye.map(pe=>pe.id===_?{...ee}:pe)),{success:!0,data:ee}}else{const F=await O.json();throw new Error(F.message||"Failed to vote on report")}}catch(O){return b(O.message),{success:!1,error:O.message}}finally{g(!1)}},[]),R=i.useCallback(async(_,C)=>{try{g(!0),b(null);const O=await Re(`${be.COMMUNITY.REPORTS}/${_}/verify`,C);if(O.ok){const F=await O.json(),ee=F.report||F;return s(ye=>ye.map(pe=>pe.id===_?{...ee}:pe)),{success:!0,data:ee}}else{const F=await O.json();throw new Error(F.message||"Failed to verify report")}}catch(O){return b(O.message),{success:!1,error:O.message}}finally{g(!1)}},[]),U=i.useCallback(async(_,C)=>{try{g(!0),b(null);const O=await Re(`${be.COMMUNITY.REPORTS}/${_}/comment`,C);if(O.ok){const ee={id:(await O.json()).comment_id,comment:C.comment};return s(ye=>ye.map(pe=>pe.id===_?{...pe,comments:[...pe.comments||[],ee]}:pe)),{success:!0,comment:ee}}else{const F=await O.json();throw new Error(F.message||"Failed to add comment")}}catch(O){return b(O.message),{success:!1,error:O.message}}finally{g(!1)}},[]),q=i.useCallback(async _=>{try{g(!0),b(null);const C={message:_.message,severity:(_.priority||"medium").toUpperCase(),threat_type:_.title},O=await Re(be.COMMUNITY.ALERTS,C);if(O.ok){const{alert:F}=await O.json();return x(ee=>[F,...ee]),{success:!0,alert:F}}else{const F=await O.json();throw new Error(F.message||"Failed to create alert")}}catch(C){return b(C.message),{success:!1,error:C.message}}finally{g(!1)}},[]),f=i.useCallback(async({period:_="90d"}={})=>{await Promise.all([k({},!1),j(),L(),ne(),he(),fe({period:_}),se({period:_})])},[k,j,L,ne,he,fe,se]),V=i.useCallback(()=>b(null),[]);return{reports:t,trendingThreats:a,communityStats:l,alerts:m,leaderboard:v,latestReports:S,myStats:T,isLoading:z,error:Q,pagination:P,hasMore:M,fetchReports:k,fetchTrendingThreats:j,fetchLatestReports:L,fetchComments:H,deleteComment:re,fetchReportById:G,fetchCommunityStats:ne,fetchAlerts:he,fetchLeaderboard:fe,fetchMyStats:se,createReport:ce,voteOnReport:te,verifyReport:R,addComment:U,createAlert:q,uploadReportMedia:Me,deleteReport:E,loadAllData:f,clearError:V}};function ks({isOpen:t,onClose:s,title:a,children:n,showCloseButton:l=!0,fullScreen:o=!1,hideOnDesktop:m=!0}){return i.useEffect(()=>{const x=v=>{v.key==="Escape"&&s()};return t&&(document.addEventListener("keydown",x),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",x),document.body.style.overflow="unset"}},[t,s]),t?e.jsxs("div",{className:`fixed inset-0 z-50 ${m?"md:hidden":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:`absolute inset-0 bg-white ${o?"rounded-none":"rounded-t-3xl"} transform transition-transform duration-300 ease-out ${t?"translate-y-0":"translate-y-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:a}),l&&e.jsx(me,{variant:"ghost",size:"sm",onClick:s,className:"p-2 rounded-full hover:bg-gray-100",children:e.jsx(oa,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n}),e.jsx("div",{className:"h-4 bg-white"})]})]}):null}const Ws=gs("Browser",{web:()=>Os(()=>import("./web-20a77bb9.js"),["./web-20a77bb9.js","./vendor-b1791c80.js"],import.meta.url).then(t=>new t.BrowserWeb)}),ct=gs("App",{web:()=>Os(()=>import("./web-b60bebff.js"),["./web-b60bebff.js","./vendor-b1791c80.js"],import.meta.url).then(t=>new t.AppWeb)}),Qs=gs("SocialLogin",{web:()=>Os(()=>import("./web-50afe46f.js"),["./web-50afe46f.js","./vendor-b1791c80.js"],import.meta.url).then(t=>new t.SocialLoginWeb)}),Ra=gs("AppleSignInPlugin"),Ma=({onLoginSuccess:t,onSwitchToRegister:s})=>{const[a,n]=i.useState({email:"",password:""}),[l,o]=i.useState(!1),{login:m,error:x,user:v,isAuthenticated:p,requestPasswordReset:S}=ms(),[A,T]=i.useState(""),[B,z]=i.useState(!1),g=i.useRef(null),Q=async N=>{try{if(!N)return!1;const M="com.googleusercontent.apps.453799187435-8omnd1nnnb92c3g2qos0qd43ch7c3h3r:/oauthredirect",y=N.startsWith("remalehprotect://auth-callback"),k=N.startsWith(M);if(!y&&!k)return!1;const j=N.indexOf("?"),L=new URLSearchParams(j>=0?N.slice(j):""),G=L.get("provider")||"google",H=L.get("token")||L.get("access_token")||L.get("id_token"),re=L.get("refresh_token")||"",ne=L.get("code"),he=L.get("state")||"",fe="https://api.remalehprotect.remaleh.com.au";if(H)return localStorage.setItem("authToken",H),re&&localStorage.setItem("refreshToken",re),window.dispatchEvent(new Event("remaleh-auth-changed")),!0;if(ne){const se=await fetch(`${fe}/api/auth/oauth/${G}/exchange`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:ne,redirect_uri:k?`${M}`:"remalehprotect://auth-callback",state:he})});if(se.ok){const ce=await se.json();if(ce.token)return localStorage.setItem("authToken",ce.token),ce.refresh_token&&localStorage.setItem("refreshToken",ce.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed")),!0}}return!1}catch(M){return console.error("OAuth finalize error:",M),!1}};i.useEffect(()=>{p&&v&&t&&t()},[p,v,t]),i.useEffect(()=>(ss.getPlatform()==="ios"&&(g.current=ct.addListener("appUrlOpen",async({url:N})=>{if(await Q(N)){try{await Ws.close()}catch{}window.location.reload()}})),()=>{g.current&&g.current.remove&&g.current.remove()}),[]);const b=async N=>{if(N.preventDefault(),!(!a.email.trim()||!a.password.trim())){o(!0);try{const M=await m(a.email,a.password);M.success||console.error("Login failed:",M.error)}catch(M){console.error("Login error:",M)}finally{o(!1)}}},P=N=>{n({...a,[N.target.name]:N.target.value})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:"/remaleh-logo.png",alt:"Remaleh Protect",className:"h-12 w-auto"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Access your digital security dashboard"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[e.jsxs("form",{className:"space-y-6",onSubmit:b,children:[x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:x})})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a.email,onChange:P,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your email"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a.password,onChange:P,className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your password"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx("button",{type:"button",onClick:async()=>{if(!a.email.trim()){T("Enter your email above, then click reset.");return}const N=await S(a.email.trim());T(N.message||"If this email exists, a temporary password has been sent.")},className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),A&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:A}),e.jsxs("div",{className:"relative my-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"bg-white px-2 text-gray-500",children:"or"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("button",{type:"button",onClick:async()=>{var N,M;try{z(!0);const y="https://api.remalehprotect.remaleh.com.au";if(ss.getPlatform()==="ios")try{const k=await Qs.login({provider:"google",options:{scopes:["openid","email","profile"]}}),j=(k==null?void 0:k.result)||k;if(console.log("[OAuth][Google] plugin result keys:",Object.keys(j||{})),j&&(j.serverAuthCode||j.authorizationCode)){const H=j.serverAuthCode||j.authorizationCode,re=await fetch(`${y}/api/auth/oauth/google/exchange`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:H,redirect_uri:"com.googleusercontent.apps.453799187435-8omnd1nnnb92c3g2qos0qd43ch7c3h3r:/oauthredirect"})});if(re.ok){const ne=await re.json();if(ne.token){localStorage.setItem("authToken",ne.token),ne.refresh_token&&localStorage.setItem("refreshToken",ne.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed")),window.location.reload();return}}}const L=(j==null?void 0:j.idToken)||(j==null?void 0:j.id_token)||((N=j==null?void 0:j.authentication)==null?void 0:N.idToken);if(L){console.log("[OAuth][Google] Posting id_token to backend");const H=await fetch(`${y}/api/auth/oauth/google/idtoken`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id_token:L})});if(H.ok){const re=await H.json();if(re.token){localStorage.setItem("authToken",re.token),re.refresh_token&&localStorage.setItem("refreshToken",re.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed")),window.location.reload();return}}}const G=((M=j==null?void 0:j.accessToken)==null?void 0:M.token)||(j==null?void 0:j.access_token);if(G){console.log("[OAuth][Google] Sending access_token to backend...",{url:`${y}/api/auth/oauth/google/access-token`});const H=await fetch(`${y}/api/auth/oauth/google/access-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:G})});if(console.log("[OAuth][Google] access-token response status:",H.status),H.ok){const re=await H.json();if(re.token){localStorage.setItem("authToken",re.token),re.refresh_token&&localStorage.setItem("refreshToken",re.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed")),window.location.reload();return}}else try{const re=await H.text();console.log("[OAuth][Google] access-token error body:",re)}catch{}}T("Google sign-in could not complete.")}catch{T("Google sign-in is not available right now.")}else{const k=await fetch(`${y}/api/auth/oauth/google/start`);if(!k.ok)throw new Error("google start failed");const j=await k.json();if(!j.auth_url)throw new Error("no auth url");if(ss.getPlatform()==="ios"){const L=await ct.addListener("appUrlOpen",async({url:H})=>{try{const re=await Q(H);await Ws.close(),re&&window.location.reload()}catch{}}),G=j.auth_url+(j.auth_url.includes("?")?"&":"?")+"deeplink=1";await Ws.open({url:G,presentationStyle:"popover"}),setTimeout(()=>L.remove&&L.remove(),12e4)}else window.location.href=j.auth_url}}catch{T("Google sign-in is not available right now.")}finally{z(!1)}},disabled:B,className:"w-full flex items-center justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium bg-white hover:bg-gray-50 disabled:opacity-50",children:[e.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"w-4 h-4 mr-2"}),"Continue with Google"]}),e.jsxs("button",{type:"button",onClick:async()=>{var N,M;try{z(!0);const y="https://api.remalehprotect.remaleh.com.au";if(ss.getPlatform()==="ios")try{const k=await Qs.login({provider:"apple",options:{scopes:["email","name"]}}),j=(k==null?void 0:k.result)||k;if(j&&(j.authorizationCode||j.identityToken||(N=j.accessToken)!=null&&N.token)){if(j.authorizationCode){const G=await Rs.request({url:`${y}/api/auth/oauth/apple/exchange`,method:"POST",headers:{"Content-Type":"application/json"},data:{code:j.authorizationCode,redirect_uri:"https://api.remalehprotect.remaleh.com.au/api/auth/oauth/apple/callback"}});if(G.status>=200&&G.status<300){const H=G.data;if(H.token){localStorage.setItem("authToken",H.token),H.refresh_token&&localStorage.setItem("refreshToken",H.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed"));return}}}const L=j.identityToken||((M=j.accessToken)==null?void 0:M.token);if(L){const G=await Rs.request({url:`${y}/api/auth/oauth/apple/idtoken`,method:"POST",headers:{"Content-Type":"application/json"},data:{id_token:L,nonce:j.nonce||void 0}});if(G.status>=200&&G.status<300){const H=G.data;if(H.token){localStorage.setItem("authToken",H.token),H.refresh_token&&localStorage.setItem("refreshToken",H.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed"));return}}}}T("Apple sign-in could not complete.")}catch{T("Apple sign-in is not available right now.")}else if(ss.getPlatform()==="ios"){const k=await Ra.signIn(),j={identity_token:k.identityToken,authorization_code:k.authorizationCode,nonce:k.nonce||void 0,email:k.email||void 0,name:k.fullName||void 0,apple_user:k.user||void 0},L=await Rs.request({url:`${y}/api/auth/oauth/apple/native`,method:"POST",headers:{"Content-Type":"application/json"},data:j});if(L.status>=200&&L.status<300){const G=L.data;if(G.token){localStorage.setItem("authToken",G.token),G.refresh_token&&localStorage.setItem("refreshToken",G.refresh_token),window.dispatchEvent(new Event("remaleh-auth-changed"));return}}T("Apple sign-in could not complete.")}else{const k=await fetch(`${y}/api/auth/oauth/apple/start`);if(k.ok){const j=await k.json();j.auth_url&&(window.location.href=j.auth_url)}else T("Apple sign-in is not available right now.")}}catch{T("Apple sign-in is not available right now.")}finally{z(!1)}},disabled:B,className:"w-full flex items-center justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium bg-white hover:bg-gray-50 disabled:opacity-50",children:[e.jsx("svg",{viewBox:"0 0 24 24",className:"w-4 h-4 mr-2",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{d:"M16.365 1.43c0 1.14-.495 2.294-1.293 3.184-.822.914-2.2 1.622-3.364 1.53-.146-1.12.51-2.314 1.315-3.19.823-.892 2.26-1.646 3.342-1.524zM20.66 17.03c-.836 1.93-1.85 3.84-3.338 3.865-1.464.03-1.934-.93-3.607-.93-1.673 0-2.19.9-3.565.96-1.43.06-2.513-2.08-3.36-4.01-1.832-4.038-1.01-9.19 1.288-11.71.85-.94 1.98-1.55 3.168-1.58 1.3-.03 2.52.89 3.603.89 1.085 0 2.4-1.1 4.05-.94.69.03 2.62.28 3.864 2.12-.1.06-2.31 1.35-2.2 4.02.1 3.23 2.84 4.3 2.94 4.35z"})}),"Continue with Apple"]})]}),A&&e.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800",children:A}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"New to Remaleh Protect?"})})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>{s&&s()},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create an account"})})]})]})})]})};function Ta({setActiveTab:t}){const[s,a]=i.useState("reports"),{reports:n,latestReports:l,fetchLatestReports:o,fetchReports:m,leaderboard:x,trendingThreats:v,myStats:p,loadAllData:S,isLoading:A,pagination:T,hasMore:B,createReport:z,uploadReportMedia:g,deleteReport:Q,voteOnReport:b,addComment:P,fetchReportById:N,fetchComments:M,deleteComment:y,fetchLeaderboard:k,fetchMyStats:j}=It(),{user:L,isAuthenticated:G}=ms(),[H,re]=i.useState(!1),[ne,he]=i.useState({description:"",threat_type:"SCAM",urgency:"MEDIUM",location:""}),[fe,se]=i.useState([]),[ce,Me]=i.useState(!1),[E,te]=i.useState(null),[R,U]=i.useState(!1),[q,f]=i.useState([]),[V,_]=i.useState(0),[C,O]=i.useState(!1),[F,ee]=i.useState(null),[ye,pe]=i.useState(1),[He,Le]=i.useState(!1),[Ze,we]=i.useState({}),[Ye,ge]=i.useState("90d"),[d,I]=i.useState("ALL"),[w,$]=i.useState(""),[W,ve]=i.useState("ALL"),[Ce,Te]=i.useState("ALL"),[Ne,De]=i.useState(!1);i.useEffect(()=>{G&&S({period:Ye})},[G,S,Ye]),i.useEffect(()=>{G&&s==="my_reports"&&m({include_own:"true"},!1)},[s,G,m]),i.useEffect(()=>{const c=()=>{if(s!=="feed")return;if(window.innerHeight+window.scrollY>=document.body.offsetHeight-200&&!A&&B&&T){const J=T.next_num;J&&m({page:J},!0)}};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[s,A,B,T,m]);const Ge=i.useMemo(()=>!n||n.length===0?[]:n.filter(c=>{const X=w?(c.description||"").toLowerCase().includes(w.toLowerCase())||(c.location||"").toLowerCase().includes(w.toLowerCase())||(c.threat_type||"").toLowerCase().includes(w.toLowerCase()):!0,J=W==="ALL"?!0:c.threat_type===W,oe=Ce==="ALL"?!0:c.urgency===Ce,Y=Ne?!!c.verified:!0;return X&&J&&oe&&Y}),[n,w,W,Ce,Ne]),h=c=>{if(!c)return"";if(c.startsWith("http"))return c;try{return new URL(c,$e).toString()}catch{return`${$e}${c}`}},Z=c=>!c||!c.media_type?!0:c.media_type.toLowerCase().startsWith("image"),ae=c=>!c||!c.media_type?!1:c.media_type.toLowerCase().startsWith("video"),le=(c,X=0)=>{const J=(c||[]).filter(Z).map(oe=>({id:oe.id,src:h(oe.media_url)})).filter(oe=>!!oe.src);J.length>0&&(f(J),_(Math.max(0,Math.min(X,J.length-1))),U(!0))},We=async c=>{var J,oe;pe(1);const X=await M(c,{page:1,per_page:20});X.success&&(ee({id:c,comments:X.comments||[]}),Le((((J=X.pagination)==null?void 0:J.page)||1)<(((oe=X.pagination)==null?void 0:oe.pages)||1)),O(!0))},Ke=async()=>{var J,oe;if(!F)return;const c=ye+1,X=await M(F.id,{page:c,per_page:20});X.success&&(ee(Y=>({...Y,comments:[...Y.comments||[],...X.comments||[]]})),pe(c),Le((((J=X.pagination)==null?void 0:J.page)||c)<(((oe=X.pagination)==null?void 0:oe.pages)||c)))},Xe=async c=>{(await y(c)).success&&ee(J=>({...J,comments:(J.comments||[]).filter(oe=>oe.id!==c)}))},ns=[{id:"reports",label:"Report Scam",icon:lt},{id:"feed",label:"Community Reports",icon:xs},{id:"my_reports",label:"My Reports",icon:ws},{id:"leaderboard",label:"Leaderboard",icon:hs},{id:"latest",label:"Latest Scams",icon:Nt}],ps=()=>{switch(s){case"reports":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Report a Scam"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Help protect others by reporting scams you encounter"})]}),e.jsx(ue,{className:"bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(lt,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Your Reporting Stats"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Keep reporting to climb the leaderboard!"})]})]}),e.jsx("div",{className:"flex justify-end mb-2",children:e.jsxs("select",{value:Ye,onChange:c=>{const X=c.target.value;ge(X),j({period:X}),k({period:X})},className:"text-xs border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"all",children:"All time"})]})}),(()=>{const c=((p==null?void 0:p.tier)||"").toString(),X=c.toLowerCase(),J=!!c,oe=J?"grid-cols-4":"grid-cols-3";let Y="bg-gray-100 text-gray-700",K="text-gray-600",de=null;return X.includes("helper")?(Y="bg-blue-100 text-blue-700",K="text-blue-600",de=e.jsx(ys,{className:`w-4 h-4 ${K}`})):X.includes("ally")?(Y="bg-purple-100 text-purple-700",K="text-purple-600",de=e.jsx(Ie,{className:`w-4 h-4 ${K}`})):X.includes("champion")?(Y="bg-yellow-100 text-yellow-700",K="text-yellow-600",de=e.jsx(hs,{className:`w-4 h-4 ${K}`})):X.includes("guardian")&&(Y="bg-emerald-100 text-emerald-700",K="text-emerald-600",de=e.jsxs("span",{className:"relative inline-block w-5 h-5",children:[e.jsx(Ie,{className:`w-5 h-5 absolute inset-0 ${K}`}),e.jsx(fs,{className:"w-3 h-3 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("div",{className:`grid ${oe} gap-4 text-center`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(p==null?void 0:p.report_count)??0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Reports"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(p==null?void 0:p.points)??0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Points"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p!=null&&p.rank?`#${p.rank}`:"â€”"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Rank"})]}),J&&e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full ${Y}`,children:[de,e.jsx("span",{className:"text-xs font-medium",children:c})]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Tier"})]})]})})()]})}),e.jsxs(xe,{onClick:()=>re(!0),className:"w-full bg-red-600 hover:bg-red-700 text-white py-3",children:[e.jsx(Ms,{className:"w-5 h-5 mr-2"}),"Report New Scam"]})]});case"feed":return e.jsxs("div",{className:"flex flex-col min-h-[70vh]",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Community Reports"}),e.jsx("p",{className:"text-sm text-gray-600",children:"See a scam? Share it."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{onChange:c=>m({sort:c.target.value},!1),className:"text-xs border border-gray-300 rounded px-2 py-1",defaultValue:"newest",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"top",children:"Top"}),e.jsx("option",{value:"verified",children:"Verified first"})]}),e.jsx(me,{onClick:()=>m({},!1),variant:"outline",size:"sm",children:"Refresh"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsx(yt,{placeholder:"Search reports...",onSearch:c=>$(c)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{value:W,onChange:c=>ve(c.target.value),options:[{value:"ALL",label:"All categories"},{value:"PHISHING",label:"Phishing"},{value:"MALWARE",label:"Malware"},{value:"SCAM",label:"Scam"},{value:"SOCIAL_ENGINEERING",label:"Social Eng."},{value:"OTHER",label:"Other"}],className:"flex-1"}),e.jsx(Is,{value:Ce,onChange:c=>Te(c.target.value),options:[{value:"ALL",label:"All severity"},{value:"LOW",label:"Caution"},{value:"MEDIUM",label:"Scam"},{value:"HIGH",label:"Ongoing Scam"}],className:"flex-1"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:Ne,onChange:c=>De(c.target.checked)}),"Verified only"]}),(w||Ne||W!=="ALL"||Ce!=="ALL")&&e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>{$(""),ve("ALL"),Te("ALL"),De(!1)},children:"Clear"})]})]})]}),e.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:e.jsxs(Fs,{onRefresh:async()=>{await m({},!1)},className:"h-full",children:[T&&e.jsxs("div",{className:"text-center text-xs text-gray-500 mb-2",children:["Showing ",Ge.length," of ",T.total," reports",B&&e.jsx("span",{className:"ml-2",children:"â€¢ Scroll to load more"})]}),e.jsxs("div",{className:"space-y-3",children:[Ge&&Ge.length>0?Ge.map(c=>{var X,J,oe;return e.jsx(ue,{className:"border-gray-200",children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-700",children:c.threat_type}),e.jsx("span",{className:"text-xs text-gray-500",children:c.created_at?new Date(c.created_at).toLocaleDateString():""}),c.verified&&e.jsx(ws,{className:"w-3.5 h-3.5 text-green-600"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-2",children:[e.jsxs("span",{children:["by ",((X=c.creator)==null?void 0:X.name)||"Anonymous"]}),(()=>{var os;const Y=(((os=c.creator)==null?void 0:os.tier)||"").toString();if(!Y)return null;const K=Y.toLowerCase();let de="bg-gray-100 text-gray-700",_e="text-gray-600",es=null;return K.includes("helper")?(de="bg-blue-100 text-blue-700",_e="text-blue-600",es=e.jsx(ys,{className:`w-3.5 h-3.5 ${_e}`})):K.includes("ally")?(de="bg-purple-100 text-purple-700",_e="text-purple-600",es=e.jsx(Ie,{className:`w-3.5 h-3.5 ${_e}`})):K.includes("champion")?(de="bg-yellow-100 text-yellow-700",_e="text-yellow-600",es=e.jsx(hs,{className:`w-3.5 h-3.5 ${_e}`})):K.includes("guardian")&&(de="bg-emerald-100 text-emerald-700",_e="text-emerald-600",es=e.jsxs("span",{className:"relative inline-block w-4 h-4",children:[e.jsx(Ie,{className:`w-4 h-4 absolute inset-0 ${_e}`}),e.jsx(fs,{className:"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${de}`,children:[es,e.jsx("span",{className:"text-[10px] font-medium leading-none",children:Y})]})})()]}),((J=c.creator)==null?void 0:J.bio)&&e.jsx("div",{className:"text-xs text-gray-500 italic mb-1",children:c.creator.bio}),e.jsx("p",{className:"text-sm text-gray-800",children:c.description}),c.media&&c.media.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2",children:c.media.filter(Y=>Z(Y)||ae(Y)).slice(0,3).map((Y,K,de)=>{const _e=K===de.length-1&&c.media.length>3,es=c.media.length-3,os=h(Y.media_url);return e.jsxs("button",{type:"button",onClick:()=>le(c.media,K),className:"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none",children:[os&&(ae(Y)?e.jsx("video",{src:os,className:"w-full h-full object-cover",muted:!0,playsInline:!0}):e.jsx("img",{src:os,alt:"report media",className:"w-full h-full object-cover",loading:"lazy",onError:Cs=>{const Ss=Y.media_url||"";Ss&&Cs.currentTarget.src!==Ss?Cs.currentTarget.src=Ss:Cs.currentTarget.style.display="none"}})),_e&&es>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-semibold",children:["+",es]})})]},Y.id||K)})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(me,{onClick:()=>b(c.id,"up"),variant:"ghost",size:"sm",className:c.user_vote==="up"?"text-green-600":"",children:[e.jsx(vt,{className:"w-4 h-4 mr-1"})," ",c.votes_up||0]}),e.jsxs(me,{onClick:()=>b(c.id,"down"),variant:"ghost",size:"sm",className:c.user_vote==="down"?"text-red-600":"",children:[e.jsx(wt,{className:"w-4 h-4 mr-1"})," ",c.votes_down||0]})]}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Us,{className:"w-3.5 h-3.5"})," ",((oe=c.comments)==null?void 0:oe.length)||0]})]}),c.comments&&c.comments.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[c.comments.slice(0,2).map((Y,K)=>e.jsxs("div",{className:"text-xs text-gray-700 bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"font-medium",children:[Y.user_name||"Anonymous",":"]})," ",Y.comment]},Y.id||K)),e.jsx("div",{children:e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>We(c.id),children:"View all comments"})})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(ke,{placeholder:"Add a comment...",value:Ze[c.id]||"",onChange:Y=>we(K=>({...K,[c.id]:Y.target.value})),className:"flex-1"}),e.jsx(me,{size:"sm",disabled:!(Ze[c.id]||"").trim(),onClick:async()=>{const Y=(Ze[c.id]||"").trim();Y&&(await P(c.id,{comment:Y}),we(K=>({...K,[c.id]:""})))},children:"Comment"})]}),c.user_id===(L==null?void 0:L.id)&&e.jsx("div",{className:"mt-2 text-right",children:e.jsx(me,{variant:"outline",size:"sm",onClick:async()=>{if(confirm("Delete this report? This cannot be undone.")){const Y=await Q(c.id);Y.success||alert(Y.error||"Failed to delete")}},children:"Delete report"})})]})})})},c.id)}):e.jsx("p",{className:"text-gray-500 text-center py-6",children:"No reports to display yet."}),A&&B&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading more reports..."})]}),B&&!A&&e.jsx("div",{className:"text-center py-3",children:e.jsx(me,{variant:"outline",size:"sm",onClick:()=>{T!=null&&T.next_num&&m({page:T.next_num},!0)},children:"Load more"})})]})]})})]});case"my_reports":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"My Reports"}),e.jsx("p",{className:"text-sm text-gray-600",children:"See the status of your submitted reports"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-base font-semibold text-green-700",children:(p==null?void 0:p.approved_count)??0}),e.jsx("div",{className:"text-xs text-green-700",children:"Approved"})]}),e.jsxs("div",{className:"p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-base font-semibold text-blue-700",children:(p==null?void 0:p.verified_count)??0}),e.jsx("div",{className:"text-xs text-blue-700",children:"Verified"})]}),e.jsxs("div",{className:"p-2 bg-yellow-50 rounded",children:[e.jsx("div",{className:"text-base font-semibold text-yellow-700",children:(p==null?void 0:p.pending_count)??0}),e.jsx("div",{className:"text-xs text-yellow-700",children:"Pending"})]}),e.jsxs("div",{className:"p-2 bg-red-50 rounded",children:[e.jsx("div",{className:"text-base font-semibold text-red-700",children:(p==null?void 0:p.rejected_count)??0}),e.jsx("div",{className:"text-xs text-red-700",children:"Rejected"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{id:"ALL",label:"All"},{id:"PENDING",label:"Pending"},{id:"APPROVED",label:"Approved"},{id:"VERIFIED",label:"Verified"},{id:"REJECTED",label:"Rejected"}].map(c=>e.jsx(me,{size:"sm",variant:d===c.id?"default":"outline",onClick:()=>I(c.id),children:c.label},c.id))}),e.jsx("div",{className:"space-y-3",children:n&&n.length>0?n.filter(c=>c.user_id===(L==null?void 0:L.id)).filter(c=>d==="ALL"?!0:c.status===d).map(c=>{var X;return e.jsx(ue,{className:"border-gray-200",children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 pr-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${c.status==="APPROVED"||c.status==="VERIFIED"?"bg-green-100 text-green-700":c.status==="REJECTED"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:c.status}),c.urgency==="HIGH"&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 text-red-700",children:"Ongoing Scam"}),c.verified&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700",children:"Verified"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-2",children:[e.jsxs("span",{children:["by ",((X=c.creator)==null?void 0:X.name)||"You"]}),(()=>{var _e;const J=(((_e=c.creator)==null?void 0:_e.tier)||(L==null?void 0:L.tier)||"").toString();if(!J)return null;const oe=J.toLowerCase();let Y="bg-gray-100 text-gray-700",K="text-gray-600",de=null;return oe.includes("helper")?(Y="bg-blue-100 text-blue-700",K="text-blue-600",de=e.jsx(ys,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("ally")?(Y="bg-purple-100 text-purple-700",K="text-purple-600",de=e.jsx(Ie,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("champion")?(Y="bg-yellow-100 text-yellow-700",K="text-yellow-600",de=e.jsx(hs,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("guardian")&&(Y="bg-emerald-100 text-emerald-700",K="text-emerald-600",de=e.jsxs("span",{className:"relative inline-block w-4 h-4",children:[e.jsx(Ie,{className:`w-4 h-4 absolute inset-0 ${K}`}),e.jsx(fs,{className:"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${Y}`,children:[de,e.jsx("span",{className:"text-[10px] font-medium leading-none",children:J})]})})(),e.jsxs("span",{children:["â€¢ Submitted ",new Date(c.created_at).toLocaleString()]})]}),e.jsx("p",{className:"text-sm text-gray-800",children:c.description}),c.media&&c.media.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2",children:c.media.filter(J=>!J.media_type||J.media_type.startsWith("image")).slice(0,3).map((J,oe,Y)=>{const K=oe===Y.length-1&&c.media.length>3,de=c.media.length-3,_e=J.media_url&&(J.media_url.startsWith("http")?J.media_url:`${$e}${J.media_url}`);return e.jsxs("button",{type:"button",onClick:()=>le(c.media,oe),className:"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none",children:[_e&&e.jsx("img",{src:_e,alt:"report media",className:"w-full h-full object-cover",loading:"lazy"}),K&&de>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-semibold",children:["+",de]})})]},J.id||oe)})})]})})})},c.id)}):e.jsx("p",{className:"text-gray-500 text-center py-6",children:"No reports found"})})]});case"leaderboard":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Top Reporters"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Community heroes protecting others from scams"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("select",{value:Ye,onChange:c=>{const X=c.target.value;ge(X),k({period:X})},className:"text-xs border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"all",children:"All time"})]})}),e.jsx("div",{className:"space-y-2",children:x.map((c,X)=>e.jsx(ue,{className:"border-gray-200",children:e.jsx("div",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${X===0?"bg-yellow-100 text-yellow-800":X===1?"bg-gray-100 text-gray-800":X===2?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:X===0?"ðŸ¥‡":X===1?"ðŸ¥ˆ":X===2?"ðŸ¥‰":c.rank}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:c.username||c.name}),(()=>{const J=(c.tier||"").toString();if(!J)return null;const oe=J.toLowerCase();let Y="bg-gray-100 text-gray-700",K="text-gray-600",de=null;return oe.includes("helper")?(Y="bg-blue-100 text-blue-700",K="text-blue-600",de=e.jsx(ys,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("ally")?(Y="bg-purple-100 text-purple-700",K="text-purple-600",de=e.jsx(Ie,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("champion")?(Y="bg-yellow-100 text-yellow-700",K="text-yellow-600",de=e.jsx(hs,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("guardian")&&(Y="bg-emerald-100 text-emerald-700",K="text-emerald-600",de=e.jsxs("span",{className:"relative inline-block w-4 h-4",children:[e.jsx(Ie,{className:`w-4 h-4 absolute inset-0 ${K}`}),e.jsx(fs,{className:"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${Y}`,children:[de,e.jsx("span",{className:"text-[10px] font-medium leading-none",children:J})]})})()]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[c.points??0," pts"]})]})]}),X<3&&e.jsx(jt,{className:"w-5 h-5 text-yellow-500"})]})})},c.id))})]});case"latest":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Latest Scams"})}),e.jsx("div",{className:"space-y-3",children:l&&l.length>0?l.map(c=>{var X;return e.jsx(ue,{className:"border-gray-200",children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 pr-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${c.status==="APPROVED"||c.status==="VERIFIED"?"bg-green-100 text-green-700":c.status==="REJECTED"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:c.status}),c.verified&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700",children:"Verified"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-2",children:[e.jsxs("span",{children:["by ",((X=c.creator)==null?void 0:X.name)||"Anonymous"]}),(()=>{var _e;const J=(((_e=c.creator)==null?void 0:_e.tier)||"").toString();if(!J)return null;const oe=J.toLowerCase();let Y="bg-gray-100 text-gray-700",K="text-gray-600",de=null;return oe.includes("helper")?(Y="bg-blue-100 text-blue-700",K="text-blue-600",de=e.jsx(ys,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("ally")?(Y="bg-purple-100 text-purple-700",K="text-purple-600",de=e.jsx(Ie,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("champion")?(Y="bg-yellow-100 text-yellow-700",K="text-yellow-600",de=e.jsx(hs,{className:`w-3.5 h-3.5 ${K}`})):oe.includes("guardian")&&(Y="bg-emerald-100 text-emerald-700",K="text-emerald-600",de=e.jsxs("span",{className:"relative inline-block w-4 h-4",children:[e.jsx(Ie,{className:`w-4 h-4 absolute inset-0 ${K}`}),e.jsx(fs,{className:"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${Y}`,children:[de,e.jsx("span",{className:"text-[10px] font-medium leading-none",children:J})]})})(),e.jsxs("span",{children:["â€¢ ",new Date(c.created_at).toLocaleString()]})]}),e.jsx("p",{className:"text-sm text-gray-800",children:c.description}),c.media&&c.media.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2",children:c.media.filter(J=>!J.media_type||J.media_type.startsWith("image")).slice(0,3).map((J,oe,Y)=>{const K=oe===Y.length-1&&c.media.length>3,de=c.media.length-3,_e=J.media_url&&(J.media_url.startsWith("http")?J.media_url:`${$e}${J.media_url}`);return e.jsxs("button",{type:"button",onClick:()=>le(c.media,oe),className:"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none",children:[_e&&e.jsx("img",{src:_e,alt:"report media",className:"w-full h-full object-cover",loading:"lazy"}),K&&de>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-semibold",children:["+",de]})})]},J.id||oe)})})]})})})},c.id)}):e.jsx("p",{className:"text-gray-500 text-center py-6",children:"No recent reports."})})]});default:return null}};return e.jsx("div",{className:"space-y-4 p-4 max-w-none mx-auto min-h-screen",children:G?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center",children:e.jsx(xs,{className:"w-6 h-6 text-white"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Community Hub"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Spot it. Share it. Stay safe."})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:ns.map(c=>{const X=c.icon;return e.jsxs("button",{onClick:()=>a(c.id),className:`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${s===c.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:c.label})]},c.id)})}),ps(),s!=="feed"&&e.jsx("div",{className:"mt-6",children:e.jsx(ue,{className:"bg-orange-50 border-orange-200",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"ðŸ¤ Community Benefits"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"â€¢ Report scams to protect others"}),e.jsx("li",{children:"â€¢ Earn points and climb the leaderboard"}),e.jsx("li",{children:"â€¢ Stay updated on latest scams"}),e.jsx("li",{children:"â€¢ Build a safer digital community"})]})]})})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Report New Scam"}),G?e.jsxs("form",{onSubmit:async c=>{c.preventDefault();try{Me(!0);const X=await z(ne);if(!X.success)throw new Error(X.error||"Failed to create report");for(const J of fe){const oe=await g(X.report.id,J);if(!oe.success)throw new Error(oe.error||"Failed to upload media")}re(!1),he({description:"",threat_type:"SCAM",urgency:"MEDIUM",location:""}),se([]),te({type:"success",message:"Report submitted successfully"}),setTimeout(()=>te(null),3e3),S()}catch(X){te({type:"error",message:X.message||"Submission failed"}),setTimeout(()=>te(null),4e3)}finally{Me(!1)}},className:"space-y-4",children:[e.jsx(Ks,{placeholder:"Detailed Description",value:ne.description,onChange:c=>he({...ne,description:c.target.value}),required:!0,rows:4}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:ne.threat_type,onChange:c=>he({...ne,threat_type:c.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"PHISHING",children:"Phishing"}),e.jsx("option",{value:"MALWARE",children:"Malware"}),e.jsx("option",{value:"SCAM",children:"Scam"}),e.jsx("option",{value:"SOCIAL_ENGINEERING",children:"Social Engineering"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Severity"}),e.jsxs("select",{value:ne.urgency,onChange:c=>he({...ne,urgency:c.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2","aria-describedby":"severity-help",children:[e.jsx("option",{value:"LOW",children:"Caution"}),e.jsx("option",{value:"MEDIUM",children:"Scam"}),e.jsx("option",{value:"HIGH",children:"Ongoing Scam"})]}),e.jsx("button",{type:"button","aria-label":"Severity help",title:"About severity levels",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onClick:()=>alert(`Severity levels:
â€¢ Caution: suspicious or low-risk
â€¢ Scam: confirmed scam but not active
â€¢ Ongoing Scam: active scam happening now or immediate risk`),children:e.jsx(ta,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Attach Photos (optional)"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:c=>se(Array.from(c.target.files||[])),className:"block w-full text-sm text-gray-700"}),fe.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[fe.length," file(s) selected"]})]}),e.jsx(ke,{placeholder:"Location/URL",value:ne.location,onChange:c=>he({...ne,location:c.target.value})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(me,{type:"submit",className:"flex-1",disabled:ce,children:ce?"Submitting...":"Submit Report"}),e.jsx(me,{type:"button",variant:"outline",onClick:()=>re(!1),className:"flex-1",children:"Cancel"})]})]}):e.jsx("div",{className:"text-center text-gray-600",children:"Please log in to submit a community report."})]})}),E&&e.jsx("div",{className:`fixed bottom-6 left-1/2 -translate-x-1/2 px-4 py-3 rounded-lg shadow-md text-sm z-50 ${E.type==="success"?"bg-green-600 text-white":"bg-red-600 text-white"}`,children:E.message}),e.jsx(ks,{isOpen:R,onClose:()=>U(!1),title:"Preview",fullScreen:!0,hideOnDesktop:!1,children:q.length>0&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-[60vh] bg-black flex items-center justify-center mb-3",children:e.jsx("img",{src:q[V].src,alt:"preview",className:"max-h-full max-w-full object-contain"})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(me,{onClick:()=>_(c=>Math.max(0,c-1)),disabled:V===0,variant:"outline",size:"sm",children:"Prev"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[V+1," / ",q.length]}),e.jsx(me,{onClick:()=>_(c=>Math.min(q.length-1,c+1)),disabled:V>=q.length-1,variant:"outline",size:"sm",children:"Next"})]})]})}),e.jsx(ks,{isOpen:C,onClose:()=>O(!1),title:"All Comments",hideOnDesktop:!1,children:F?e.jsxs("div",{className:"space-y-3",children:[F.comments&&F.comments.length>0?F.comments.map(c=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded border border-gray-200 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsxs("span",{className:"font-medium",children:[c.user_name||"Anonymous",":"]})," ",c.comment]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:c.created_at?new Date(c.created_at).toLocaleString():""})]}),((L==null?void 0:L.id)===c.user_id||(L==null?void 0:L.is_admin))&&e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>Xe(c.id),title:"Delete comment",children:e.jsx(Ls,{className:"w-4 h-4 text-red-600"})})]},c.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No comments yet."}),He&&e.jsx("div",{className:"pt-2",children:e.jsx(me,{onClick:Ke,variant:"outline",size:"sm",children:"Load more"})})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."})})]}):e.jsx("div",{className:"space-y-6",children:e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please log in to access the Community Hub, report scams, and view the feed."}),e.jsx(xe,{onClick:()=>t("login"),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:"Go to Login"})]})})})})}function Pa({setActiveTab:t}){var Ge;const{isAuthenticated:s,user:a}=ms(),{reports:n,trendingThreats:l,communityStats:o,alerts:m,isLoading:x,error:v,loadAllData:p,createReport:S,voteOnReport:A,verifyReport:T,addComment:B,createAlert:z,uploadReportMedia:g,fetchReportById:Q,fetchComments:b,deleteComment:P,clearError:N}=It(),[M,y]=i.useState(!1),[k,j]=i.useState(!1),[L,G]=i.useState({description:"",threat_type:"SCAM",urgency:"MEDIUM",location:""}),[H,re]=i.useState({title:"",message:"",priority:"medium"}),[ne,he]=i.useState(""),[fe,se]=i.useState([]),[ce,Me]=i.useState(""),[E,te]=i.useState("ALL"),[R,U]=i.useState("ALL"),[q,f]=i.useState(!1),[V,_]=i.useState(!1),[C,O]=i.useState([]),[F,ee]=i.useState(0),[ye,pe]=i.useState(!1),[He,Le]=i.useState(null),[Ze,we]=i.useState(1),[Ye,ge]=i.useState(!1);i.useEffect(()=>{if(s&&(p(),typeof localStorage<"u"&&localStorage.getItem("openNewReport")==="1"||typeof sessionStorage<"u"&&sessionStorage.getItem("openNewReport")==="1"||typeof window<"u"&&window.__openNewReport===!0)){y(!0);try{localStorage.removeItem("openNewReport")}catch{}try{sessionStorage.removeItem("openNewReport")}catch{}try{delete window.__openNewReport}catch{}}},[p,s]);const d=(n||[]).filter(h=>{const Z=ce?(h.description||"").toLowerCase().includes(ce.toLowerCase())||(h.location||"").toLowerCase().includes(ce.toLowerCase())||(h.threat_type||"").toLowerCase().includes(ce.toLowerCase()):!0,ae=E==="ALL"?!0:h.threat_type===E,le=R==="ALL"?!0:h.urgency===R,We=q?!!h.verified:!0;return Z&&ae&&le&&We}),I=async h=>{h.preventDefault();const Z=await S(L);if(Z.success){for(const ae of fe)await g(Z.report.id,ae);y(!1),G({description:"",threat_type:"SCAM",urgency:"MEDIUM",location:""}),se([])}},w=async h=>{h.preventDefault(),(await z(H)).success&&(j(!1),re({title:"",message:"",priority:"medium"}))},$=async(h,Z)=>{await A(h,Z)},W=async h=>{await T(h,{verified:!0})},ve=async h=>{ne.trim()&&(await B(h,{comment:ne}),he(""))},Ce=async h=>{var ae,le;we(1);const Z=await b(h,{page:1,per_page:20});Z.success&&(Le({id:h,comments:Z.comments||[]}),ge((((ae=Z.pagination)==null?void 0:ae.page)||1)<(((le=Z.pagination)==null?void 0:le.pages)||1)),pe(!0))},Te=async()=>{var ae,le;if(!He)return;const h=Ze+1,Z=await b(He.id,{page:h,per_page:20});Z.success&&(Le(We=>({...We,comments:[...We.comments||[],...Z.comments||[]]})),we(h),ge((((ae=Z.pagination)==null?void 0:ae.page)||h)<(((le=Z.pagination)==null?void 0:le.pages)||h)))},Ne=async h=>{(await P(h)).success&&Le(ae=>({...ae,comments:(ae.comments||[]).filter(le=>le.id!==h)}))},De=(h,Z=0)=>{const ae=(h||[]).filter(le=>!le.media_type||le.media_type==="image").map(le=>({id:le.id,src:le.media_url&&(le.media_url.startsWith("http")?le.media_url:`${$e}${le.media_url}`)})).filter(le=>!!le.src);ae.length>0&&(O(ae),ee(Math.max(0,Math.min(Z,ae.length-1))),_(!0))};if(!s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(bt,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Login required to access Community"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Please log in to view and contribute to community reports"})]})});if(x)return e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading community data..."})]})});if(v){const h=v.includes("Token is missing")||v.includes("401")||v.includes("Unauthorized");return e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(nt,{className:"h-5 w-5 text-red-400 mr-2"}),e.jsx("span",{className:"text-red-800",children:h?"Authentication Required":v})]}),e.jsx("p",{className:"text-red-700 text-sm mt-2",children:h?"Please log in to access community features. Your session may have expired.":""}),e.jsx("div",{className:"flex gap-2 mt-3",children:h?e.jsx(me,{onClick:()=>window.location.reload(),variant:"outline",size:"sm",children:"Go to Login"}):e.jsx(me,{onClick:N,variant:"outline",size:"sm",children:"Dismiss"})})]})}return e.jsxs("div",{className:"space-y-6 p-4 max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:()=>t("community"),className:"p-2 mr-3 text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx(Es,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Community Reports"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Report and track security threats"})]})]}),o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ue,{className:"p-4",children:e.jsxs(Je,{className:"flex items-center",children:[e.jsx(xs,{className:"h-8 w-8 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Reports"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.total_reports||0})]})]})}),e.jsx(ue,{className:"p-4",children:e.jsxs(Je,{className:"flex items-center",children:[e.jsx(nt,{className:"h-8 w-8 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.status_breakdown&&o.status_breakdown.VERIFIED||0})]})]})}),e.jsx(ue,{className:"p-4",children:e.jsxs(Je,{className:"flex items-center",children:[e.jsx(ws,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.status_breakdown&&o.status_breakdown.PENDING||0})]})]})}),e.jsx(ue,{className:"p-4",children:e.jsxs(Je,{className:"flex items-center",children:[e.jsx(xs,{className:"h-8 w-8 text-purple-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Top Reporter"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.top_contributors&&((Ge=o.top_contributors[0])==null?void 0:Ge.name)||"â€”"})]})]})})]}),e.jsxs(ue,{className:"p-6",children:[e.jsxs(Je,{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Trending Threats"}),e.jsx(Nt,{className:"h-5 w-5 text-orange-500"})]}),e.jsx(ts,{children:e.jsx("div",{className:"space-y-3",children:l&&l.length>0?l.map((h,Z)=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(jt,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:h.threat_type}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Reports: ",h.report_count," â€¢ Trend: ",h.trend," â€¢ Urgency score: ",h.urgency_score]})]})]})},Z)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No trending threats at the moment"})})})]}),e.jsxs(ue,{className:"p-6",children:[e.jsxs(Je,{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Reports"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{onClick:()=>y(!0),size:"sm",children:"Report New Scam"}),e.jsx(me,{onClick:p,variant:"outline",size:"sm",children:"Refresh"})]})]}),e.jsx(ts,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsx(yt,{placeholder:"Search reports...",onSearch:h=>Me(h)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{value:E,onChange:h=>te(h.target.value),options:[{value:"ALL",label:"All categories"},{value:"PHISHING",label:"Phishing"},{value:"MALWARE",label:"Malware"},{value:"SCAM",label:"Scam"},{value:"SOCIAL_ENGINEERING",label:"Social Eng."},{value:"OTHER",label:"Other"}],className:"flex-1"}),e.jsx(Is,{value:R,onChange:h=>U(h.target.value),options:[{value:"ALL",label:"All severity"},{value:"LOW",label:"Caution"},{value:"MEDIUM",label:"Scam"},{value:"HIGH",label:"Ongoing Scam"}],className:"flex-1"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-700",children:[e.jsx("input",{type:"checkbox",className:"rounded",checked:q,onChange:h=>f(h.target.checked)}),"Verified only"]}),(ce||q||E!=="ALL"||R!=="ALL")&&e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>{Me(""),te("ALL"),U("ALL"),f(!1)},children:"Clear"})]})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mb-1",children:["Showing ",d.length,Array.isArray(n)?" of "+n.length:""," reports"]}),e.jsx(Fs,{onRefresh:p,className:"h-[60vh] sm:h-[65vh] md:h-[70vh]",children:e.jsx("div",{className:"space-y-4",children:d&&d.length>0?d.map(h=>{var Z;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:h.threat_type}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:h.description}),h.media&&h.media.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2",children:h.media.filter(ae=>!ae.media_type||ae.media_type==="image").slice(0,3).map((ae,le,We)=>{const Ke=le===We.length-1&&h.media.length>3,Xe=h.media.length-3,ns=ae.media_url&&(ae.media_url.startsWith("http")?ae.media_url:`${$e}${ae.media_url}`);return e.jsxs("button",{type:"button",onClick:()=>De(h.media,le),className:"relative w-full h-20 bg-gray-100 rounded overflow-hidden focus:outline-none",children:[ns&&e.jsx("img",{src:ns,alt:"report media",className:"w-full h-full object-cover",loading:"lazy"}),Ke&&Xe>0&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-semibold",children:["+",Xe]})})]},ae.id||le)})}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Urgency: ",h.urgency]}),e.jsxs("span",{children:["Location: ",h.location||"N/A"]}),e.jsxs("span",{children:["Reported: ",h.created_at?new Date(h.created_at).toLocaleDateString():"N/A"]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:h.verified&&e.jsx(ws,{className:"h-4 w-4 text-green-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(me,{onClick:()=>$(h.id,"up"),variant:"ghost",size:"sm",className:h.user_vote==="up"?"text-green-600":"",children:[e.jsx(vt,{className:"h-4 w-4 mr-1"}),h.votes_up||0]}),e.jsxs(me,{onClick:()=>$(h.id,"down"),variant:"ghost",size:"sm",className:h.user_vote==="down"?"text-red-600":"",children:[e.jsx(wt,{className:"h-4 w-4 mr-1"}),h.votes_down||0]})]}),(a==null?void 0:a.is_admin)&&!h.verified&&e.jsxs(me,{onClick:()=>W(h.id),variant:"outline",size:"sm",children:[e.jsx(ws,{className:"h-4 w-4 mr-1"}),"Verify"]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:((Z=h.creator)==null?void 0:Z.name)||"Anonymous"})]}),h.comments&&h.comments.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Comments"}),e.jsx("div",{className:"space-y-2",children:h.comments.map((ae,le)=>e.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[e.jsxs("span",{className:"font-medium",children:[ae.user_name||"Anonymous",":"]})," ",ae.comment]},le))}),e.jsx("div",{className:"mt-2",children:e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>Ce(h.id),children:"View all comments"})})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ke,{placeholder:"Add a comment...",value:ne,onChange:ae=>he(ae.target.value),className:"flex-1"}),e.jsx(me,{onClick:()=>ve(h.id),size:"sm",disabled:!ne.trim(),children:"Comment"})]})})]},h.id)}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No reports yet. Be the first to report a threat!"})})})]})})]}),e.jsxs(ue,{className:"p-6",children:[e.jsx(Je,{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Community Alerts"})}),e.jsx(ts,{children:e.jsx("div",{className:"space-y-3",children:m&&m.length>0?m.map(h=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(Us,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:h.threat_type||"Community Alert"}),e.jsx("p",{className:"text-sm text-blue-800",children:h.message}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-blue-600",children:[e.jsxs("span",{children:["Severity: ",h.severity]}),e.jsx("span",{children:h.created_at?new Date(h.created_at).toLocaleDateString():""})]})]})]},h.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No active alerts"})})})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Report New Threat"}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsx(Ks,{placeholder:"Detailed Description",value:L.description,onChange:h=>G({...L,description:h.target.value}),required:!0,rows:4}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{value:L.threat_type,onChange:h=>G({...L,threat_type:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"PHISHING",children:"Phishing"}),e.jsx("option",{value:"MALWARE",children:"Malware"}),e.jsx("option",{value:"SCAM",children:"Scam"}),e.jsx("option",{value:"SOCIAL_ENGINEERING",children:"Social Engineering"}),e.jsx("option",{value:"OTHER",children:"Other"})]}),e.jsxs("select",{value:L.urgency,onChange:h=>G({...L,urgency:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Attach Photos (optional)"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:h=>se(Array.from(h.target.files||[])),className:"block w-full text-sm text-gray-700"}),fe.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[fe.length," file(s) selected"]})]}),e.jsx(ke,{placeholder:"Location/URL",value:L.location,onChange:h=>G({...L,location:h.target.value})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(me,{type:"submit",className:"flex-1",children:"Submit Report"}),e.jsx(me,{type:"button",variant:"outline",onClick:()=>y(!1),className:"flex-1",children:"Cancel"})]})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create Community Alert"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsx(ke,{placeholder:"Alert Title",value:H.title,onChange:h=>re({...H,title:h.target.value}),required:!0}),e.jsx(Ks,{placeholder:"Alert Message",value:H.message,onChange:h=>re({...H,message:h.target.value}),required:!0,rows:4}),e.jsxs("select",{value:H.priority,onChange:h=>re({...H,priority:h.target.value}),className:"border border-gray-300 rounded-md px-3 py-2 w-full",children:[e.jsx("option",{value:"low",children:"Low Priority"}),e.jsx("option",{value:"medium",children:"Medium Priority"}),e.jsx("option",{value:"high",children:"High Priority"}),e.jsx("option",{value:"urgent",children:"Urgent"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(me,{type:"submit",className:"flex-1",children:"Create Alert"}),e.jsx(me,{type:"button",variant:"outline",onClick:()=>j(!1),className:"flex-1",children:"Cancel"})]})]})]})}),e.jsx(ks,{isOpen:ye,onClose:()=>pe(!1),title:"All Comments",children:He?e.jsxs("div",{className:"space-y-3",children:[He.comments&&He.comments.length>0?He.comments.map(h=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded border border-gray-200 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-800",children:[e.jsxs("span",{className:"font-medium",children:[h.user_name||"Anonymous",":"]})," ",h.comment]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h.created_at?new Date(h.created_at).toLocaleString():""})]}),((a==null?void 0:a.id)===h.user_id||(a==null?void 0:a.is_admin))&&e.jsx(me,{variant:"ghost",size:"sm",onClick:()=>Ne(h.id),title:"Delete comment",children:e.jsx(Ls,{className:"w-4 h-4 text-red-600"})})]},h.id)):e.jsx("div",{className:"text-sm text-gray-500",children:"No comments yet."}),Ye&&e.jsx("div",{className:"pt-2",children:e.jsx(me,{onClick:Te,variant:"outline",size:"sm",children:"Load more"})})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."})}),e.jsx(ks,{isOpen:V,onClose:()=>_(!1),title:"Preview",fullScreen:!0,children:C.length>0&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-[60vh] bg-black flex items-center justify-center mb-3",children:e.jsx("img",{src:C[F].src,alt:"preview",className:"max-h-full max-w-full object-contain"})}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(me,{onClick:()=>ee(h=>Math.max(0,h-1)),disabled:F===0,variant:"outline",size:"sm",children:"Prev"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[F+1," / ",C.length]}),e.jsx(me,{onClick:()=>ee(h=>Math.min(C.length-1,h+1)),disabled:F>=C.length-1,variant:"outline",size:"sm",children:"Next"})]})]})})]})}const bs=js.forwardRef(({className:t="",...s},a)=>{const l=`flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50 ${t}`;return e.jsx("textarea",{className:l,ref:a,...s})});bs.displayName="Textarea";const qe={USERS:"/api/admin/users",USER:t=>`/api/admin/users/${t}`,UPDATE_STATUS:t=>`/api/admin/users/${t}/status`,UPDATE_ROLE:t=>`/api/admin/users/${t}/role`,DELETE_USER:t=>`/api/admin/users/${t}`,HARD_DELETE_USER:t=>`/api/admin/users/${t}/hard-delete`,DELETED_USERS:"/api/admin/users/deleted"},Ia=async(t={})=>{try{const s=new URLSearchParams;t.page&&s.append("page",t.page),t.per_page&&s.append("per_page",t.per_page),t.status&&s.append("status",t.status),t.role&&s.append("role",t.role);const a=`${qe.USERS}?${s.toString()}`,n=await Ae(a);if(n.ok){const l=await n.json();return{users:l.users||[],pagination:l.pagination||{},success:!0}}else throw new Error("Request failed. Please try again.")}catch(s){return console.error("Error fetching users:",s),{users:[],pagination:{},success:!1,error:s.message}}},$a=async()=>{try{const t=await Ae(qe.DELETED_USERS);if(t.ok)return{users:(await t.json()).users||[],success:!0};throw new Error("Request failed. Please try again.")}catch(t){return console.error("Error fetching deleted users:",t),{users:[],success:!1,error:t.message}}},Vs=async(t,s)=>{try{console.log("ðŸ”„ userManager.updateUserStatus called with:",{userId:t,newStatus:s}),console.log("ðŸ”„ API endpoint:",qe.UPDATE_STATUS(t));const a=await rs(qe.UPDATE_STATUS(t),{status:s});if(console.log("ðŸ”„ API response received:",a),console.log("ðŸ”„ Response status:",a.status),console.log("ðŸ”„ Response ok:",a.ok),a.ok){const n=await a.json();return console.log("ðŸ”„ Response data:",n),{success:!0,message:n.message||"User status updated successfully",user:n.user}}else{console.log("âŒ Response not ok, status:",a.status);const n=await a.json();throw console.log("âŒ Error response body:",n),new Error(n.error||n.message||"Request failed. Please try again.")}}catch(a){return console.error("âŒ Error in updateUserStatus:",a),{success:!1,error:a.message}}},qs=async(t,s)=>{try{console.log("ðŸ”„ userManager.updateUserRole called with:",{userId:t,newRole:s}),console.log("ðŸ”„ API endpoint:",qe.UPDATE_ROLE(t));const a=await rs(qe.UPDATE_ROLE(t),{role:s});if(console.log("ðŸ”„ API response received:",a),console.log("ðŸ”„ Response status:",a.status),console.log("ðŸ”„ Response ok:",a.ok),a.ok){const n=await a.json();return console.log("ðŸ”„ Response data:",n),{success:!0,message:n.message||"User role updated successfully",user:n.user}}else{console.log("âŒ Response not ok, status:",a.status);const n=await a.json();throw console.log("âŒ Error response body:",n),new Error(n.error||n.message||"Request failed. Please try again.")}}catch(a){return console.error("âŒ Error in updateUserRole:",a),{success:!1,error:a.message}}},dt=async(t,s)=>{try{const a=await rs(qe.USER(t),s);if(a.ok){const n=await a.json();return{success:!0,message:n.message||"User information updated successfully",user:n.user}}else{const n=await a.json();throw new Error(n.error||n.message||"Request failed. Please try again.")}}catch(a){return console.error("Error updating user information:",a),{success:!1,error:a.message}}},Da=async(t,s)=>{try{const a=await rs(`${qe.USER(t)}/password`,{password:s});if(a.ok)return{success:!0,message:(await a.json()).message||"User password updated successfully"};{const n=await a.json();throw new Error(n.error||n.message||"Request failed. Please try again.")}}catch(a){return console.error("Error updating user password:",a),{success:!1,error:a.message}}},mt=async t=>{try{const s=await ds(qe.DELETE_USER(t));if(s.ok)return{success:!0,message:(await s.json()).message||"User deleted successfully"};{const a=await s.json();throw new Error(a.error||a.message||"Request failed. Please try again.")}}catch(s){return console.error("Error deleting user:",s),{success:!1,error:s.message}}},Ua=async t=>{try{const s=await ds(qe.HARD_DELETE_USER(t));if(s.ok)return{success:!0,message:(await s.json()).message||"User permanently deleted"};{const a=await s.json();throw new Error(a.error||a.message||"Request failed. Please try again.")}}catch(s){return console.error("Error hard-deleting user:",s),{success:!1,error:s.message}}},Oa=async t=>{try{const s=await Re(qe.USERS,t);if(s.ok){const a=await s.json();return{success:!0,message:a.message||"User created successfully",user:a.user}}else{const a=await s.json();throw new Error(a.error||a.message||"Request failed. Please try again.")}}catch(s){return console.error("Error creating user:",s),{success:!1,error:s.message}}},Fa=async()=>{try{const t=await Ae(qe.USERS);if(t.ok){const a=(await t.json()).users||[];return{stats:{total:a.length,active:a.filter(l=>l.status==="ACTIVE").length,suspended:a.filter(l=>l.status==="SUSPENDED").length,banned:a.filter(l=>l.status==="BANNED").length,admins:a.filter(l=>l.is_admin||l.role==="ADMIN").length,moderators:a.filter(l=>l.role==="MODERATOR").length,regular:a.filter(l=>l.role==="USER").length},success:!0}}else throw new Error("Request failed. Please try again.")}catch(t){return console.error("Error fetching user stats:",t),{stats:{total:0,active:0,suspended:0,banned:0,admins:0,moderators:0,regular:0},success:!1,error:t.message}}},ut=async t=>{try{console.log("ðŸ”„ userManager.restoreUser called with:",{userId:t}),console.log("ðŸ”„ API endpoint:",qe.USER(t)+"/restore");const s=await rs(`${qe.USER(t)}/restore`,{});if(console.log("ðŸ”„ API response received:",s),console.log("ðŸ”„ Response status:",s.status),console.log("ðŸ”„ Response ok:",s.ok),s.ok){const a=await s.json();return console.log("ðŸ”„ Response data:",a),{success:!0,message:a.message||"User restored successfully",user:a.user}}else{console.log("âŒ Response not ok, status:",s.status);const a=await s.json();throw console.log("âŒ Error response body:",a),new Error(a.error||a.message||"Request failed. Please try again.")}}catch(s){return console.error("âŒ Error in restoreUser:",s),{success:!1,error:s.message}}},ht=({initialFilters:t})=>{const[s,a]=i.useState([]),[n,l]=i.useState({}),[o,m]=i.useState(!0),[x,v]=i.useState(null),[p,S]=i.useState(null),[A,T]=i.useState([]),[B,z]=i.useState([]),[g,Q]=i.useState(!1),[b,P]=i.useState(null),[N,M]=i.useState(!1),[y,k]=i.useState(""),[j,L]=i.useState({page:1,per_page:20,status:"",urgency:"",threat_type:"",verified:""});i.useEffect(()=>{t&&Object.keys(t).length>0&&L(E=>({...E,...t,page:1}))},[]),i.useEffect(()=>{G()},[j]);const G=async()=>{try{m(!0);const E=new URLSearchParams;Object.entries(j).forEach(([U,q])=>{q&&E.append(U,q)});const R=await(await Qe.get(`/api/admin/reports?${E}`)).json();a(R.reports||[]),l(R.pagination||{}),v(null)}catch(E){v("Failed to load community reports"),console.error("Reports error:",E)}finally{m(!1)}},H=async(E,te)=>{var R,U;try{let q;if(te==="verify")q=await Qe.request({method:"POST",url:`/api/community/reports/${E}/verify`});else{const f={reject:"REJECTED",escalate:"FLAGGED",approve:"APPROVED"},V=f[te]||f.approve;q=await Qe.request({method:"PUT",url:`/api/admin/reports/${E}/moderate`,data:{action:V}})}if(!q.ok){const f=await q.json().catch(()=>({}));throw new Error(f.error||`Failed to ${te} report`)}G(),z([])}catch(q){console.error("Report action error:",q),alert(`Failed to ${te} report: ${((U=(R=q.response)==null?void 0:R.data)==null?void 0:U.error)||q.message}`)}},re=async()=>{var E,te;if(!(!y||B.length===0)){T([]);try{if(y==="delete"&&!window.confirm(`Delete ${B.length} report(s)? This cannot be undone.`))return;let R;if(y==="delete"){R=[];for(const f of B)try{let V=!0;try{V=(await Qe.request({method:"GET",url:`/api/community/reports/${f}`})).ok}catch{V=!1}if(!V){R.push({status:"fulfilled",value:{id:f}});continue}let _=await Qe.request({method:"DELETE",url:`/api/admin/reports/${f}`});if(_.ok||(await _.json().catch(()=>({})),_=await Qe.request({method:"DELETE",url:`/api/community/reports/${f}`})),!_.ok){const C=await _.json().catch(()=>({}));if(_.status===404)R.push({status:"fulfilled",value:{id:f}});else throw new Error(C.error||C.details||`Failed to delete report ${f}`)}R.push({status:"fulfilled",value:{id:f}})}catch(V){R.push({status:"rejected",reason:V})}}else R=await Promise.allSettled(B.map(async f=>{if(y==="verify"){const O=await Qe.request({method:"POST",url:`/api/community/reports/${f}/verify`});if(!O.ok){const F=await O.json().catch(()=>({}));throw new Error(F.error||`Failed to verify report ${f}`)}return{id:f}}const V={reject:"REJECTED",approve:"APPROVED"},_=V[y]||V.approve,C=await Qe.request({method:"PUT",url:`/api/admin/reports/${f}/moderate`,data:{action:_}});if(!C.ok){const O=await C.json().catch(()=>({}));throw new Error(O.error||`Failed to ${y} report ${f}`)}return{id:f}}));const U=R.map((f,V)=>({r:f,id:B[V]})).filter(f=>f.r.status==="rejected").map(f=>{var V;return{id:f.id,error:((V=f.r.reason)==null?void 0:V.message)||"Unknown error"}}),q=R.filter(f=>f.status==="fulfilled").length;G(),z([]),M(!1),k(""),U.length>0?(T(U),S({type:"error",message:`Bulk ${y}: ${q} succeeded, ${U.length} failed`})):S({type:"success",message:`Bulk ${y}: ${q} succeeded`}),setTimeout(()=>S(null),3500)}catch(R){console.error("Bulk action error:",R),S({type:"error",message:((te=(E=R.response)==null?void 0:E.data)==null?void 0:te.error)||R.message||"Bulk action failed"}),setTimeout(()=>S(null),4500)}}},ne=E=>{z(te=>te.includes(E)?te.filter(R=>R!==E):[...te,E])},he=()=>{B.length===s.length?z([]):z(s.map(E=>E.id))},fe=E=>{L(te=>({...te,...E,page:1}))},se=({report:E})=>e.jsx("div",{className:"bg-white border rounded-lg p-4 mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:B.includes(E.id),onChange:()=>ne(E.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.urgency==="HIGH"?"bg-red-100 text-red-800":E.urgency==="MEDIUM"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:E.urgency==="HIGH"?"Ongoing Scam":E.urgency==="MEDIUM"?"Scam":"Caution"}),E.status!=="VERIFIED"&&e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E.status==="PENDING"?"bg-yellow-100 text-yellow-800":E.status==="REJECTED"?"bg-red-100 text-red-800":E.status==="ESCALATED"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:E.status}),(E.verified||E.status==="VERIFIED")&&e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:"âœ“ Verified"})]}),e.jsx("h4",{className:"font-medium text-gray-900",children:E.threat_type}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:E.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Location: ",E.location||"N/A"]}),e.jsxs("span",{children:["Votes: +",E.votes_up," / -",E.votes_down]}),e.jsxs("span",{children:["Created: ",new Date(E.created_at).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{P(E),Q(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{onChange:te=>H(E.id,te.target.value),className:"text-sm border rounded px-2 py-1",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Actions"}),E.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"approve",children:"Approve"}),e.jsx("option",{value:"verify",children:"Verify"}),e.jsx("option",{value:"reject",children:"Reject"}),e.jsx("option",{value:"escalate",children:"Flag"})]}),E.status==="APPROVED"&&e.jsx(e.Fragment,{children:e.jsx("option",{value:"verify",children:"Verify"})})]})})]})]})}),ce=()=>{const E=b&&b.reporter&&typeof b.reporter=="object"?b.reporter:null,te=b?b.creator&&(b.creator.username||b.creator.name)||b.creator_name||b.user_name||E&&(E.username||E.email||E.name)||b.user&&(b.user.username||b.user.name)||b.user_email||b.email||(typeof b.reporter=="string"?b.reporter:"")||"Anonymous":"",R=b&&(b.creator&&b.creator.tier||b.creator_tier||b.user&&b.user.tier||E&&E.tier||b.tier)||"";return e.jsx(ks,{isOpen:g,onClose:()=>Q(!1),title:"Report Details",hideOnDesktop:!1,fullScreen:!0,children:b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Threat Type"}),e.jsx("p",{className:"text-gray-900",children:b.threat_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reporter"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-900",children:[e.jsx("span",{children:te}),R&&(()=>{const U=String(R).toLowerCase();let q="bg-gray-100 text-gray-700",f="text-gray-600",V=null;return U.includes("helper")?(q="bg-blue-100 text-blue-700",f="text-blue-600",V=e.jsx(ys,{className:`w-3.5 h-3.5 ${f}`})):U.includes("ally")?(q="bg-purple-100 text-purple-700",f="text-purple-600",V=e.jsx(Ie,{className:`w-3.5 h-3.5 ${f}`})):U.includes("champion")?(q="bg-yellow-100 text-yellow-700",f="text-yellow-600",V=e.jsx(hs,{className:`w-3.5 h-3.5 ${f}`})):U.includes("guardian")&&(q="bg-emerald-100 text-emerald-700",f="text-emerald-600",V=e.jsxs("span",{className:"relative inline-block w-4 h-4",children:[e.jsx(Ie,{className:`w-4 h-4 absolute inset-0 ${f}`}),e.jsx(fs,{className:"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700"})]})),e.jsxs("span",{className:`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-xs ${q}`,children:[V,e.jsx("span",{className:"leading-none",children:R})]})})()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Urgency"}),e.jsx("p",{className:"text-gray-900",children:b.urgency})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"text-gray-900",children:b.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Verified"}),e.jsx("p",{className:"text-gray-900",children:b.verified?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),e.jsx("p",{className:"text-gray-900",children:b.location||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:new Date(b.created_at).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("p",{className:"text-gray-900",children:b.description})]}),b.media&&b.media.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attachments"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:b.media.map((U,q)=>{var V;const f=(V=U.media_url)!=null&&V.startsWith("http")?U.media_url:`${$e}${U.media_url}`;return e.jsx("a",{href:f,target:"_blank",rel:"noreferrer",className:"block w-full h-24 bg-gray-100 rounded overflow-hidden",children:e.jsx("img",{src:f,alt:"attachment",className:"w-full h-full object-cover",onError:_=>{_.currentTarget.style.display="none"}})},U.id||q)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Up Votes"}),e.jsx("p",{className:"text-gray-900",children:b.votes_up})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Down Votes"}),e.jsx("p",{className:"text-gray-900",children:b.votes_down})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Quick Actions"}),e.jsxs("div",{className:"flex space-x-2",children:[b.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{H(b.id,"approve"),Q(!1)},className:"bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700",children:"Approve"}),e.jsx("button",{onClick:()=>{H(b.id,"verify"),Q(!1)},className:"bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700",children:"Verify"}),e.jsx("button",{onClick:()=>{H(b.id,"reject"),Q(!1)},className:"bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700",children:"Reject"})]}),b.status==="APPROVED"&&e.jsx("button",{onClick:()=>{H(b.id,"verify"),Q(!1)},className:"bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700",children:"Verify"}),e.jsx("button",{onClick:async()=>{if(confirm("Delete this report?"))try{let U=await Qe.request({method:"DELETE",url:`/api/admin/reports/${b.id}`});if(U.ok||(await U.json().catch(()=>({})),U=await Qe.request({method:"DELETE",url:`/api/community/reports/${b.id}`})),!U.ok&&U.status!==404&&(await Qe.request({method:"PUT",url:`/api/admin/reports/${b.id}/moderate`,data:{action:"REJECTED"}}).catch(()=>({})),U=await Qe.request({method:"DELETE",url:`/api/admin/reports/${b.id}`})),!U.ok&&U.status!==404)throw new Error("Delete failed");Q(!1),G()}catch(U){alert("Failed to delete report: "+(U.message||"Unknown error"))}},className:"bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700",children:"Delete"})]})]})]})})},Me=()=>e.jsx(ks,{isOpen:N,onClose:()=>M(!1),title:"Bulk Actions",hideOnDesktop:!1,fullScreen:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Action for ",B.length," selected reports"]}),e.jsxs("select",{value:y,onChange:E=>k(E.target.value),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select action..."}),e.jsx("option",{value:"approve",children:"Approve"}),e.jsx("option",{value:"verify",children:"Verify"}),e.jsx("option",{value:"reject",children:"Reject"}),e.jsx("option",{value:"delete",children:"Delete"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:re,disabled:!y,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:"Apply Action"}),e.jsx("button",{onClick:()=>M(!1),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Cancel"})]})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Community Reports"}),e.jsx("p",{className:"text-gray-600",children:"Manage and moderate community threat reports"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex space-x-2",children:[B.length>0&&e.jsxs("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),M(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:["Bulk Actions (",B.length,")"]}),e.jsx("button",{onClick:G,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Refresh"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:j.status,onChange:E=>fe({status:E.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"VERIFIED",children:"Verified"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"ESCALATED",children:"Escalated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Severity"}),e.jsxs("select",{value:j.urgency,onChange:E=>fe({urgency:E.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Severity"}),e.jsx("option",{value:"HIGH",children:"Ongoing Scam"}),e.jsx("option",{value:"MEDIUM",children:"Scam"}),e.jsx("option",{value:"LOW",children:"Caution"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:j.threat_type,onChange:E=>fe({threat_type:E.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"PHISHING",children:"Phishing"}),e.jsx("option",{value:"MALWARE",children:"Malware"}),e.jsx("option",{value:"SCAM",children:"Scam"}),e.jsx("option",{value:"SOCIAL_ENGINEERING",children:"Social Engineering"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verified"}),e.jsxs("select",{value:j.verified,onChange:E=>fe({verified:E.target.value}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Verified Only"}),e.jsx("option",{value:"false",children:"Unverified Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Per Page"}),e.jsxs("select",{value:j.per_page,onChange:E=>fe({per_page:parseInt(E.target.value)}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Reports (",n.total||0,")"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:B.length===s.length&&s.length>0,onChange:he,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Select All"})]})]})}),e.jsx("div",{className:"p-6",children:o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):x?e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("div",{className:"text-red-500 mb-4",children:["âš ï¸ ",x]}),e.jsx("button",{onClick:G,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Retry"})]}):s.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No reports found matching your criteria"}):e.jsx("div",{children:s.map(E=>e.jsx(se,{report:E},E.id))})})]}),n.pages>1&&e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(n.page-1)*n.per_page+1," to"," ",Math.min(n.page*n.per_page,n.total)," of"," ",n.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>fe({page:n.page-1}),disabled:n.page<=1,className:"px-3 py-2 border rounded-lg disabled:bg-gray-100 disabled:text-gray-400",children:"Previous"}),e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:["Page ",n.page," of ",n.pages]}),e.jsx("button",{onClick:()=>fe({page:n.page+1}),disabled:n.page>=n.pages,className:"px-3 py-2 border rounded-lg disabled:bg-gray-100 disabled:text-gray-400",children:"Next"})]})]})}),e.jsx(ce,{}),e.jsx(Me,{}),p&&e.jsx("div",{className:`fixed bottom-6 left-1/2 -translate-x-1/2 px-4 py-3 rounded-lg shadow-md text-sm z-50 ${p.type==="success"?"bg-green-600 text-white":p.type==="error"?"bg-red-600 text-white":"bg-gray-800 text-white"}`,children:p.message}),A.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 p-4 rounded",children:[e.jsx("div",{className:"font-medium mb-2",children:"Some items failed:"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:A.map(E=>e.jsxs("li",{children:["#",E.id,": ",E.error]},E.id))})]})]})};function Ba({setActiveTab:t}){var Xs,et;const{user:s,isAuthenticated:a,isLoading:n}=ms(),[l,o]=i.useState("overview"),[m,x]=i.useState(!1),[v,p]=i.useState(!1),[S,A]=i.useState(null),[T,B]=i.useState(null),[z,g]=i.useState(!1),[Q,b]=i.useState(!1),[P,N]=i.useState({title:"",description:"",difficulty:"BEGINNER",estimated_time:10}),[M,y]=i.useState({first_name:"",last_name:"",email:"",role:"USER",password:""}),[k,j]=i.useState([]),[L,G]=i.useState([]),[H,re]=i.useState([]),[ne,he]=i.useState({total:0,active:0,suspended:0,banned:0,admins:0,moderators:0,regular:0}),[fe,se]=i.useState(null),[ce,Me]=i.useState("checking"),[E,te]=i.useState([]),R=r=>E.includes(r),U=r=>te(u=>u.includes(r)?u.filter(D=>D!==r):[...u,r]),q=()=>{const r=H.map(D=>D.id),u=r.every(D=>E.includes(D));te(u?E.filter(D=>!r.includes(D)):Array.from(new Set([...E,...r])))},f=()=>te([]),[V,_]=i.useState([]),[C,O]=i.useState(""),[F,ee]=i.useState(""),ye=r=>V.includes(r),pe=r=>{_(u=>u.includes(r)?u.filter(D=>D!==r):[...u,r])},He=()=>{const r=L.map(D=>D.id),u=r.every(D=>V.includes(D));_(u?V.filter(D=>!r.includes(D)):Array.from(new Set([...V,...r])))},Le=()=>{_([]),O(""),ee("")},Ze=async()=>{if(V.length===0){alert("Select at least one user");return}if(!C){alert("Choose a bulk action");return}if((C==="status"||C==="role")&&!F){alert("Choose a value for the selected action");return}if(C==="delete"&&!confirm(`Delete ${V.length} user(s)?`))return;g(!0);const r={success:0,failed:0,errors:[]};for(const D of V)try{if(C==="status"){const ie=await Vs(D,F);if(!ie.success)throw new Error(ie.error||"Failed")}else if(C==="role"){const ie=await qs(D,F);if(!ie.success)throw new Error(ie.error||"Failed")}else if(C==="delete"){const ie=await mt(D);if(!ie.success)throw new Error(ie.error||"Failed")}r.success+=1}catch(ie){r.failed+=1,r.errors.push(`#${D}: ${ie.message||"Error"}`)}await Z(),await ae(),g(!1),Le();const u=`Bulk ${C}: ${r.success} succeeded, ${r.failed} failed${r.errors.length?`
${r.errors.join(`
`)}`:""}`;alert(u)},[we,Ye]=i.useState(null),[ge,d]=i.useState(null),[I,w]=i.useState({title:"",type:"info",content:"",contentType:"info",contentStyle:"default",duration:5,media:[]}),[$,W]=i.useState(null),[ve,Ce]=i.useState(!1),[Te,Ne]=i.useState(""),[De,Ge]=i.useState(0);js.useEffect(()=>{if(Te){const r=setTimeout(()=>{Ne("")},3e3);return()=>clearTimeout(r)}},[Te]),js.useEffect(()=>{var r,u,D;console.log("ðŸ”„ selectedModuleForLessons state changed:",ge),ge&&(console.log("ðŸ”„ New selectedModuleForLessons lessons:",(r=ge.content)==null?void 0:r.lessons),console.log("ðŸ”„ New selectedModuleForLessons lesson count:",((D=(u=ge.content)==null?void 0:u.lessons)==null?void 0:D.length)||0))},[ge]);const h=async()=>{try{se(null);const r=await Ue();j(r)}catch(r){console.error("Failed to load modules:",r),se(`Failed to load modules: ${r.message}`),(r.message.includes("Failed to fetch")||r.message.includes("NetworkError"))&&Me("disconnected")}},Z=async()=>{try{b(!0),se(null),console.log("ðŸ”„ loadUsers called");const r=await Ia();console.log("ðŸ”„ getAllUsers result:",r),r.success?(console.log("âœ… Setting users state with:",r.users),G(r.users)):(console.error("âŒ Failed to load users:",r.error),se(`Failed to load users: ${r.error}`))}catch(r){console.error("âŒ Error in loadUsers:",r),se(`Failed to load users: ${r.message}`),(r.message.includes("Failed to fetch")||r.message.includes("NetworkError"))&&Me("disconnected")}finally{b(!1)}},ae=async()=>{try{console.log("ðŸ”„ loadDeletedUsers called");const r=await $a();console.log("ðŸ”„ getDeletedUsers result:",r),r.success?(console.log("âœ… Setting deletedUsers state with:",r.users),re(r.users)):console.error("âŒ Failed to load deleted users:",r.error)}catch(r){console.error("âŒ Error in loadDeletedUsers:",r)}},le=async()=>{try{se(null);const r=await Fa();r.success?he(r.stats):(console.error("Failed to load user stats:",r.error),se(`Failed to load user stats: ${r.error}`))}catch(r){console.error("Failed to load user stats:",r),se(`Failed to load user stats: ${r.message}`),(r.message.includes("Failed to fetch")||r.message.includes("NetworkError"))&&Me("disconnected")}},We=async()=>{if(!P.title.trim()||!P.description.trim()){alert("Please fill in all required fields");return}try{g(!0);const r={...P,content:{lessons:[]}};await Lt(r),N({title:"",description:"",difficulty:"BEGINNER",estimated_time:10}),x(!1),await h(),alert("Module created successfully!")}catch(r){console.error("Failed to create module:",r),alert(`Failed to create module: ${r.message}`)}finally{g(!1)}},Ke=async r=>{if(confirm("Are you sure you want to delete this module? This will also delete all lessons within it. This action cannot be undone."))try{g(!0),await At(r),alert("Module deleted successfully!"),await h()}catch(u){console.error("Failed to delete module:",u),alert(`Failed to delete module: ${u.message}`)}finally{g(!1)}},Xe=async(r,u)=>{try{g(!0),console.log("ðŸ”„ Updating user status:",{userId:r,newStatus:u});const D=await Vs(r,u);console.log("ðŸ”„ updateUserStatus result:",D),D.success?(console.log("âœ… User status updated successfully"),alert("User status updated successfully!"),await Z(),await le()):(console.log("âŒ User status update failed:",D.error),alert(`Failed to update user status: ${D.error}`))}catch(D){console.error("âŒ Error updating user status:",D),alert(`Failed to update user status: ${D.message}`)}finally{g(!1)}},ns=async(r,u)=>{try{g(!0),console.log("ðŸ”„ Updating user role:",{userId:r,newRole:u});const D=await qs(r,u);console.log("ðŸ”„ updateUserRole result:",D),D.success?(console.log("âœ… User role updated successfully"),alert("User role updated successfully!"),await Z(),await le()):(console.log("âŒ User role update failed:",D.error),alert(`Failed to update user role: ${D.error}`))}catch(D){console.error("âŒ Error updating user role:",D),alert(`Failed to update user role: ${D.message}`)}finally{g(!1)}},ps=async r=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{g(!0);const u=await mt(r);u.success?(alert("User deleted successfully!"),await Z(),await ae(),await le()):alert(`Failed to delete user: ${u.error}`)}catch(u){console.error("Failed to delete user:",u),alert(`Failed to delete user: ${u.message}`)}finally{g(!1)}},c=async r=>{if(confirm("Are you sure you want to restore this user? They will be able to access the system again."))try{g(!0);const u=await ut(r);u.success?(alert("User restored successfully!"),await Z(),await ae(),await le()):alert(`Failed to restore user: ${u.error}`)}catch(u){console.error("Failed to restore user:",u),alert(`Failed to restore user: ${u.message}`)}finally{g(!1)}},X=async()=>{if(E.length===0){alert("Select at least one user to restore");return}try{g(!0);const r={success:0,failed:0,errors:[]};for(const u of E)try{const D=await ut(u);if(!D.success)throw new Error(D.error||"Failed");r.success++}catch(D){r.failed++,r.errors.push(`#${u}: ${D.message||"Error"}`)}await Z(),await ae(),alert(`Bulk restore: ${r.success} succeeded, ${r.failed} failed${r.errors.length?`
${r.errors.join(`
`)}`:""}`)}finally{g(!1),te([])}},J=async()=>{if(!M.first_name.trim()||!M.last_name.trim()||!M.email.trim()||!M.password.trim()){alert("Please fill in all required fields");return}try{g(!0),se(null);const r=await Oa(M);r.success?(alert("User created successfully!"),y({first_name:"",last_name:"",email:"",role:"USER",password:""}),p(!1),await Z(),await le()):se(r.error||"Failed to create user")}catch(r){console.error("Failed to create user:",r),se(r.message||"Failed to create user")}finally{g(!1)}},oe=async r=>{var u,D,ie,Se,Pe;try{g(!0),se(null);const je=T,Be=[];if(je.first_name!==((u=L.find(Fe=>Fe.id===r))==null?void 0:u.first_name)||je.last_name!==((D=L.find(Fe=>Fe.id===r))==null?void 0:D.last_name)||je.email!==((ie=L.find(Fe=>Fe.id===r))==null?void 0:ie.email)){const Fe={first_name:je.first_name,last_name:je.last_name,email:je.email};Be.push(dt(r,Fe))}if(je.role&&je.role!==((Se=L.find(Fe=>Fe.id===r))==null?void 0:Se.role)&&Be.push(qs(r,je.role)),je.status&&je.status!==((Pe=L.find(Fe=>Fe.id===r))==null?void 0:Pe.status)&&Be.push(Vs(r,je.status)),je.newPassword&&Be.push(Da(r,je.newPassword)),Be.length>0){const Fe=await Promise.all(Be);if(Fe.some(Ve=>!Ve.success)){const Ve=Fe.filter(is=>!is.success).map(is=>is.error).join(", ");se(`Failed to update user: ${Ve}`);return}}alert("User updated successfully!"),B(null),await Z(),await le()}catch(je){console.error("Failed to update user:",je),se(je.message||"Failed to update user")}finally{g(!1)}},Y=async r=>{try{console.log("ðŸ”„ handleUpdateModule called with moduleId:",r),console.log("ðŸ”„ editingModule state:",S),g(!0),se(null);const u=S;console.log("ðŸ”„ moduleToUpdate:",u);const D={title:u.title,description:u.description,difficulty:u.difficulty,estimated_time:u.estimated_time};console.log("ðŸ”„ moduleData to send:",D),console.log("ðŸ”„ Calling updateModule from contentManager..."),await _t(r,D),alert("Module updated successfully!"),A(null),await h()}catch(u){console.error("âŒ Failed to update module:",u),se(u.message||"Failed to update module")}finally{g(!1)}},K=async r=>{var u,D,ie,Se,Pe,je,Be,us,Fe,Bs;try{Ce(!0),Ne(""),console.log("ðŸ”„ Adding lesson with data:",{moduleId:r,newLessonData:I});const Ve=await Rt(r,I);if(console.log("ðŸ”„ addLesson response:",Ve),Ve&&Ve.message){console.log("âœ… Lesson added successfully, response:",Ve),w({title:"",type:"info",content:"",contentType:"info",contentStyle:"default",duration:5,media:[]}),await h(),console.log("ðŸ”„ After loadModules, modules state:",k);const is=await Ue(!0);console.log("ðŸ”„ getAllModules result:",is),console.log("ðŸ”„ All modules content:",is.map(cs=>{var st;return{id:cs.id,title:cs.title,content:cs.content,lessons:(st=cs.content)==null?void 0:st.lessons}}));const ze=is.find(cs=>cs.id===r);console.log("ðŸ”„ Found updated module:",ze),console.log("ðŸ”„ Module content:",ze==null?void 0:ze.content),console.log("ðŸ”„ Module lessons:",(u=ze==null?void 0:ze.content)==null?void 0:u.lessons),console.log("ðŸ”„ Lesson count:",((ie=(D=ze==null?void 0:ze.content)==null?void 0:D.lessons)==null?void 0:ie.length)||0),console.log("ðŸ”„ Current selectedModuleForLessons state:",ge),console.log("ðŸ”„ Current selectedModuleForLessons lessons:",(Se=ge==null?void 0:ge.content)==null?void 0:Se.lessons),console.log("ðŸ”„ Current selectedModuleForLessons lesson count:",((je=(Pe=ge==null?void 0:ge.content)==null?void 0:Pe.lessons)==null?void 0:je.length)||0),ze?(console.log("ðŸ”„ Setting selectedModuleForLessons to:",ze),console.log("ðŸ”„ Current lesson count before update:",((us=(Be=ge==null?void 0:ge.content)==null?void 0:Be.lessons)==null?void 0:us.length)||0),console.log("ðŸ”„ New lesson count after update:",((Bs=(Fe=ze==null?void 0:ze.content)==null?void 0:Fe.lessons)==null?void 0:Bs.length)||0),d(ze),j(is),Ge(cs=>cs+1),setTimeout(()=>{console.log("ðŸ”„ After state update - selectedModuleForLessons:",ge),console.log("ðŸ”„ After state update - modules state:",k),console.log("ðŸ”„ After state update - forceUpdate value:",De)},100)):console.log("âŒ Could not find updated module with ID:",r),Ne("Lesson added successfully!")}else console.log("âŒ Lesson add failed, response:",Ve),se((Ve==null?void 0:Ve.error)||"Failed to add lesson")}catch(Ve){console.error("âŒ Error adding lesson:",Ve),se("Failed to add lesson")}finally{Ce(!1)}},de=async(r,u,D)=>{try{Ce(!0),Ne("");const ie=await Tt(r,u,D);if(ie&&ie.message){W(null),await h();const Se=await Ue(!0),Pe=Se.find(je=>je.id===r);Pe&&(d(Pe),j(Se),Ge(je=>je+1)),Ne("Lesson updated successfully!")}else se((ie==null?void 0:ie.error)||"Failed to update lesson")}catch(ie){console.error("Error updating lesson:",ie),se("Failed to update lesson")}finally{Ce(!1)}},_e=async(r,u)=>{var D,ie,Se;if(window.confirm("Are you sure you want to delete this lesson?"))try{Ce(!0),Ne(""),console.log("ðŸ”„ handleDeleteLesson called with:",{moduleId:r,lessonId:u});const Pe=await Pt(r,u);if(console.log("ðŸ”„ deleteLesson response:",Pe),Pe&&Pe.message){console.log("âœ… Lesson deleted successfully, refreshing data..."),await h();const je=await Ue(!0),Be=je.find(us=>us.id===r);Be&&(console.log("ðŸ”„ Found updated module:",Be),console.log("ðŸ”„ Module content:",Be.content),console.log("ðŸ”„ Module lessons:",(D=Be.content)==null?void 0:D.lessons),console.log("ðŸ”„ Lesson count:",((Se=(ie=Be.content)==null?void 0:ie.lessons)==null?void 0:Se.length)||0),d(Be),j(je),Ge(us=>us+1)),Ne("Lesson deleted successfully!")}else console.log("âŒ Failed to delete lesson:",Pe==null?void 0:Pe.error),se((Pe==null?void 0:Pe.error)||"Failed to delete lesson")}catch(Pe){console.error("âŒ Error deleting lesson:",Pe),se("Failed to delete lesson")}finally{Ce(!1)}},es=async()=>{try{Me("checking");const u=await fetch("https://api.remalehprotect.remaleh.com.au/api/health",{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(u.ok){const D=await u.json();console.log("Health check response:",D),Me(D.database==="healthy"?"connected":"disconnected"),D.database!=="healthy"?se(`Database status: ${D.database}`):se(null)}else console.error("Health check failed with status:",u.status),Me("disconnected"),se(`Backend health check failed: ${u.status}`)}catch(r){console.error("Database connection check failed:",r),Me("disconnected"),r.name==="AbortError"?se("Backend connection timeout - service may be unavailable"):r.message.includes("Failed to fetch")?se("Cannot connect to backend - check if service is running"):se(`Connection error: ${r.message}`)}};if(js.useEffect(()=>{h(),Z(),ae(),le(),es(),(async()=>{try{const r=await Ae("/api/admin/stats");if(r.ok){const u=await r.json();Ye(u)}}catch{}})()},[]),n)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#21a1ce] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Checking authentication..."})]})});if(!a)return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#21a1ce] to-[#1a8bb8] rounded-2xl p-6 text-white shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ie,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Authentication Required"}),e.jsx("p",{className:"text-white text-lg",children:"Please log in to access the Admin Dashboard."})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ie,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You must be logged in to access the admin panel."}),e.jsx(xe,{onClick:()=>t("login"),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:"Go to Login"})]})})]});if(!(s!=null&&s.is_admin)&&(s==null?void 0:s.role)!=="ADMIN"&&(s==null?void 0:s.role)!=="MODERATOR")return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-2xl p-6 text-white shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ie,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-white text-lg",children:"You don't have permission to access the Admin Dashboard."})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ie,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Insufficient Privileges"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Only administrators can access this panel."}),e.jsx(xe,{onClick:()=>t("home"),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:"Return to Home"})]})})]});const os=()=>{var r,u;return e.jsx("div",{className:"space-y-6",children:e.jsx(ue,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"System Overview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(ue,{children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx(ls,{className:"w-8 h-8 text-blue-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:k.length}),e.jsx("p",{className:"text-sm text-gray-600",children:"Learning Modules"})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx(xs,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ne.total}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Users"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-3 gap-y-1 text-xs text-gray-600",children:[e.jsxs("span",{children:["Active: ",e.jsx("span",{className:"font-medium",children:ne.active??0})]}),e.jsxs("span",{children:["Admins: ",e.jsx("span",{className:"font-medium",children:ne.admins??0})]}),e.jsxs("span",{children:["Moderators: ",e.jsx("span",{className:"font-medium",children:ne.moderators??0})]}),e.jsxs("span",{children:["Deleted: ",e.jsx("span",{className:"font-medium",children:(H==null?void 0:H.length)??0})]}),e.jsxs("span",{children:["Suspended: ",e.jsx("span",{className:"font-medium",children:ne.suspended??0})]}),e.jsxs("span",{children:["Banned: ",e.jsx("span",{className:"font-medium",children:ne.banned??0})]})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx(Us,{className:"w-8 h-8 text-orange-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:((r=we==null?void 0:we.reports)==null?void 0:r.total)??0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Community Reports"}),(we==null?void 0:we.reports)&&e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("span",{className:"px-2 py-1 rounded-full bg-yellow-50 text-yellow-700 text-center",children:["Pending: ",e.jsx("span",{className:"font-medium",children:we.reports.pending??0})]}),e.jsxs("span",{className:"px-2 py-1 rounded-full bg-green-50 text-green-700 text-center",children:["Approved: ",e.jsx("span",{className:"font-medium",children:we.reports.approved??0})]}),e.jsxs("span",{className:"px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-center",children:["Verified: ",e.jsx("span",{className:"font-medium",children:we.reports.verified??0})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-center gap-2",children:[e.jsx(xe,{onClick:()=>o("reports"),className:"bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 text-xs",children:"Go to Reports"}),((u=we==null?void 0:we.reports)==null?void 0:u.pending)>0&&e.jsx(xe,{onClick:()=>{o("reports"),window.__ADMIN_REPORTS_INITIAL_FILTERS__={status:"PENDING"}},className:"bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 text-xs",children:"Review Pending"})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx(Ie,{className:"w-8 h-8 text-purple-500 mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Active"}),e.jsx("p",{className:"text-sm text-gray-600",children:"System Status"}),e.jsxs("div",{className:"mt-3 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Backend:"}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full ${ce==="connected"?"bg-green-100 text-green-700":ce==="disconnected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${ce==="connected"?"bg-green-500":ce==="disconnected"?"bg-red-500":"bg-yellow-500"}`}),ce==="connected"?"Connected":ce==="disconnected"?"Disconnected":"Checking..."]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Database:"}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full ${ce==="connected"?"bg-green-100 text-green-700":ce==="disconnected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${ce==="connected"?"bg-green-500":ce==="disconnected"?"bg-red-500":"bg-yellow-500"}`}),ce==="connected"?"Connected":ce==="disconnected"?"Disconnected":"Checking..."]})]}),e.jsx("button",{onClick:es,className:"block mx-auto mt-1 text-[11px] text-blue-600 hover:text-blue-800 underline",children:"Check connection"})]})]})})]})]})})})},Cs=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Learning Content Management"}),e.jsxs(xe,{onClick:()=>x(!0),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Add Module"]})]}),e.jsx("div",{className:"space-y-4",children:k.length===0?e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ls,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Modules Yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first learning module to get started."}),e.jsxs(xe,{onClick:()=>x(!0),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Create First Module"]})]})}):k.map(r=>{var u,D;return e.jsx(ue,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:r.title}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>d(r),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Manage Lessons",children:e.jsx(ls,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Module",children:e.jsx(Hs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Ke(r.id),disabled:z,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Delete Module",children:e.jsx(Ls,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:r.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:[((D=(u=r.content)==null?void 0:u.lessons)==null?void 0:D.length)||0," lessons"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:r.difficulty}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:[r.estimated_time," min"]})]})]})},r.id)})})]}),Ss=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Management"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(xe,{onClick:Z,disabled:z,className:"bg-gray-600 hover:bg-gray-700 text-white",children:[e.jsx(vs,{className:`w-4 h-4 mr-2 ${z?"animate-spin":""}`}),"Refresh"]}),e.jsxs(xe,{onClick:()=>p(!0),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Ms,{className:"w-4 h-4 mr-2"}),"Add User"]})]})]}),Q?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#21a1ce] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading users..."})]})}):L.length===0?e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Users Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"There are no users in the system yet."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-3 flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:He,className:"px-2 py-1 text-sm border rounded",children:L.every(r=>V.includes(r.id))&&L.length>0?"Unselect All":"Select All"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",V.length]}),e.jsxs("select",{value:C,onChange:r=>{O(r.target.value),ee("")},className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"Bulk action..."}),e.jsx("option",{value:"status",children:"Set Status"}),e.jsx("option",{value:"role",children:"Set Role"}),e.jsx("option",{value:"delete",children:"Delete"})]}),C==="status"&&e.jsxs("select",{value:F,onChange:r=>ee(r.target.value),className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"Choose status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"SUSPENDED",children:"Suspended"}),e.jsx("option",{value:"BANNED",children:"Banned"})]}),C==="role"&&e.jsxs("select",{value:F,onChange:r=>ee(r.target.value),className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"Choose role"}),e.jsx("option",{value:"USER",children:"User"}),e.jsx("option",{value:"MODERATOR",children:"Moderator"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]}),e.jsx(xe,{onClick:Ze,disabled:z||V.length===0||!C||(C==="status"||C==="role")&&!F,className:"px-3 py-1",children:"Apply"}),V.length>0&&e.jsx("button",{onClick:Le,className:"text-sm text-gray-600 hover:underline ml-auto",children:"Clear"})]}),L.map(r=>{var u;return e.jsx(ue,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:ye(r.id),onChange:()=>pe(r.id),className:"mt-1 h-4 w-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:r.first_name&&r.last_name?`${r.first_name} ${r.last_name}`:((u=r.email)==null?void 0:u.split("@")[0])||"Unknown User"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.email}),r.created_at&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Joined: ",new Date(r.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>B(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit User",children:e.jsx(Hs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ps(r.id),disabled:z,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Delete User",children:e.jsx(Ls,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm mb-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.is_admin||r.role==="ADMIN"?"bg-purple-100 text-purple-800":r.role==="MODERATOR"?"bg-orange-100 text-orange-800":"bg-blue-100 text-blue-800"}`,children:r.role||"USER"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.status==="ACTIVE"?"bg-green-100 text-green-800":r.status==="SUSPENDED"?"bg-yellow-100 text-yellow-800":r.status==="BANNED"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:r.status||"UNKNOWN"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("select",{value:r.status||"ACTIVE",onChange:D=>Xe(r.id,D.target.value),disabled:z,className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"SUSPENDED",children:"Suspended"}),e.jsx("option",{value:"BANNED",children:"Banned"})]}),e.jsxs("select",{value:r.role||"USER",onChange:D=>ns(r.id,D.target.value),disabled:z,className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx("option",{value:"USER",children:"User"}),e.jsx("option",{value:"MODERATOR",children:"Moderator"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]}),e.jsxs("label",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:!!r.email_verified,onChange:async D=>{try{g(!0),await dt(r.id,{email_verified:D.target.checked}),await Z()}catch(ie){alert("Failed to update verification flag: "+(ie.message||"Unknown error"))}finally{g(!1)}},className:"h-4 w-4"}),e.jsx("span",{children:"Email verified"})]})]})]})},r.id)})]})]}),$t=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Deleted Users"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-3 flex flex-wrap items-center gap-2",children:[e.jsx("button",{onClick:q,className:"px-2 py-1 text-sm border rounded",children:H.every(r=>E.includes(r.id))&&H.length>0?"Unselect All":"Select All"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Selected: ",E.length]}),e.jsx(xe,{onClick:X,disabled:z||E.length===0,className:"px-3 py-1",children:"Restore Selected"}),e.jsx(xe,{onClick:async()=>{if(E.length===0){alert("Select at least one user");return}if(confirm(`Permanently delete ${E.length} user(s)? This cannot be undone.`))try{g(!0);const r={success:0,failed:0,errors:[]};for(const u of E)try{const D=await Ua(u);if(!D.success)throw new Error(D.error||"Failed");r.success++}catch(D){r.failed++,r.errors.push(`#${u}: ${D.message||"Error"}`)}await Z(),await ae(),alert(`Bulk permanent delete: ${r.success} succeeded, ${r.failed} failed${r.errors.length?`
${r.errors.join(`
`)}`:""}`)}finally{g(!1),te([])}},disabled:z||E.length===0,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white",children:"Permanently Delete"}),E.length>0&&e.jsx("button",{onClick:f,className:"text-sm text-gray-600 hover:underline ml-auto",children:"Clear"})]}),H.map(r=>{var u;return e.jsx(ue,{children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:R(r.id),onChange:()=>U(r.id),className:"mt-1 h-4 w-4"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.first_name&&r.last_name?`${r.first_name} ${r.last_name}`:((u=r.email)==null?void 0:u.split("@")[0])||"Unknown User"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.email}),r.created_at&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Joined: ",new Date(r.created_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:()=>c(r.id),disabled:z,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Restore User",children:e.jsx(vs,{className:"w-4 h-4"})})})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800",children:r.role||"USER"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"DELETED"})]})]})},r.id)}),H.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No deleted users"})})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:((s==null?void 0:s.role)||"").toUpperCase()==="MODERATOR"&&!(s!=null&&s.is_admin)?"Moderator Dashboard":"Admin Dashboard"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",(s==null?void 0:s.name)||(((s==null?void 0:s.role)||"").toUpperCase()==="MODERATOR"?"Moderator":"Admin")]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Backend:"}),e.jsxs("div",{className:`flex items-center space-x-1 ${ce==="connected"?"text-green-600":ce==="disconnected"?"text-red-600":"text-yellow-600"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${ce==="connected"?"bg-green-500":ce==="disconnected"?"bg-red-500":"bg-yellow-500"}`}),e.jsx("span",{className:"text-xs font-medium capitalize",children:ce==="connected"?"Connected":ce==="disconnected"?"Disconnected":"Checking..."})]})]})]}),e.jsx("button",{onClick:()=>t("home"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl",children:[((s==null?void 0:s.is_admin)||(s==null?void 0:s.role)==="ADMIN")&&e.jsx("button",{onClick:()=>o("overview"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${l==="overview"?"bg-white text-[#21a1ce] shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Overview"}),e.jsx("button",{onClick:()=>o("content"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${l==="content"?"bg-white text-[#21a1ce] shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Content"}),((s==null?void 0:s.is_admin)||(s==null?void 0:s.role)==="ADMIN")&&e.jsx("button",{onClick:()=>o("users"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${l==="users"?"bg-white text-[#21a1ce] shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Users"}),e.jsx("button",{onClick:()=>o("reports"),className:`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${l==="reports"?"bg-white text-[#21a1ce] shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Reports"})]}),((s==null?void 0:s.is_admin)||(s==null?void 0:s.role)==="ADMIN")&&l==="overview"&&os(),l==="content"&&Cs(),((s==null?void 0:s.is_admin)||(s==null?void 0:s.role)==="ADMIN")&&l==="users"&&e.jsxs(e.Fragment,{children:[Ss(),$t()]}),l==="reports"&&(window.__ADMIN_REPORTS_INITIAL_FILTERS__?(()=>{const r=window.__ADMIN_REPORTS_INITIAL_FILTERS__;return delete window.__ADMIN_REPORTS_INITIAL_FILTERS__,e.jsx(ht,{initialFilters:r})})():e.jsx(ht,{})),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Module"}),e.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Module Title *"}),e.jsx(ke,{type:"text",value:P.title,onChange:r=>N(u=>({...u,title:r.target.value})),placeholder:"Enter module title",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx(bs,{value:P.description,onChange:r=>N(u=>({...u,description:r.target.value})),placeholder:"Enter module description",className:"w-full",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty"}),e.jsxs("select",{value:P.difficulty,onChange:r=>N(u=>({...u,difficulty:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"BEGINNER",children:"Beginner"}),e.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),e.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimated Time (minutes)"}),e.jsx(ke,{type:"number",value:P.estimated_time,onChange:r=>N(u=>({...u,estimated_time:parseInt(r.target.value)||10})),placeholder:"10",min:"1",max:"120",className:"w-full"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(xe,{onClick:()=>x(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(xe,{onClick:We,disabled:z,className:"flex-1 bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:z?"Creating...":"Create Module"})]})]})]})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New User"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx(ke,{type:"text",placeholder:"Enter full name",value:M.first_name,onChange:r=>y(u=>({...u,first_name:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(ke,{type:"email",placeholder:"Enter email address",value:M.email,onChange:r=>y(u=>({...u,email:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:M.role,onChange:r=>y(u=>({...u,role:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"USER",children:"User"}),e.jsx("option",{value:"MODERATOR",children:"Moderator"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx(ke,{type:"password",placeholder:"Enter password",value:M.password,onChange:r=>y(u=>({...u,password:r.target.value})),className:"w-full"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(xe,{onClick:()=>p(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(xe,{onClick:J,disabled:z,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:z?"Creating...":"Create User"})]})]})]})})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:()=>B(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx(ke,{type:"text",placeholder:"Enter first name",value:T.first_name||"",onChange:r=>B(u=>({...u,first_name:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx(ke,{type:"text",placeholder:"Enter last name",value:T.last_name||"",onChange:r=>B(u=>({...u,last_name:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(ke,{type:"email",placeholder:"Enter email address",value:T.email||"",onChange:r=>B(u=>({...u,email:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsxs("select",{value:T.role||"USER",onChange:r=>B(u=>({...u,role:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"USER",children:"User"}),e.jsx("option",{value:"MODERATOR",children:"Moderator"}),e.jsx("option",{value:"ADMIN",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:T.status||"ACTIVE",onChange:r=>B(u=>({...u,status:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"SUSPENDED",children:"Suspended"}),e.jsx("option",{value:"BANNED",children:"Banned"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password (leave blank to keep current)"}),e.jsx(ke,{type:"password",placeholder:"Enter new password",value:T.newPassword||"",onChange:r=>B(u=>({...u,newPassword:r.target.value})),className:"w-full"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(xe,{onClick:()=>B(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(xe,{onClick:()=>oe(T.id),disabled:z,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:z?"Updating...":"Update User"})]})]})]})})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Module"}),e.jsx("button",{onClick:()=>A(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),e.jsx(ke,{type:"text",placeholder:"Enter module title",value:S.title||"",onChange:r=>A(u=>({...u,title:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx(bs,{placeholder:"Enter module description",value:S.description||"",onChange:r=>A(u=>({...u,description:r.target.value})),className:"w-full",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty"}),e.jsxs("select",{value:S.difficulty||"BEGINNER",onChange:r=>A(u=>({...u,difficulty:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"BEGINNER",children:"Beginner"}),e.jsx("option",{value:"INTERMEDIATE",children:"Intermediate"}),e.jsx("option",{value:"ADVANCED",children:"Advanced"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimated Time (minutes)"}),e.jsx(ke,{type:"number",placeholder:"10",value:S.estimated_time||10,onChange:r=>A(u=>({...u,estimated_time:parseInt(r.target.value)||10})),min:"1",max:"120",className:"w-full"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(xe,{onClick:()=>A(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(xe,{onClick:()=>Y(S.id),disabled:z,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:z?"Updating...":"Update Module"})]})]})]})})}),ge&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Manage Lessons: ",ge.title]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleTimeString()," (Render: ",De,")"]}),e.jsx("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Lesson"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),e.jsx(ke,{type:"text",placeholder:"Enter lesson title",value:I.title,onChange:r=>w(u=>({...u,title:r.target.value})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:I.type,onChange:r=>w(u=>({...u,type:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"info",children:"Information"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"interactive",children:"Interactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content Type"}),e.jsxs("select",{value:I.contentType,onChange:r=>w(u=>({...u,contentType:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"info",children:"Plain Text"}),e.jsx("option",{value:"tips",children:"Tips (title + description list)"}),e.jsx("option",{value:"warning-signs",children:"Warning Signs"}),e.jsx("option",{value:"steps",children:"Steps (numbered)"}),e.jsx("option",{value:"list",children:"Bullet List"}),e.jsx("option",{value:"warning",children:"Warning Box"}),e.jsx("option",{value:"warning-list",children:"Warning Box + List"}),e.jsx("option",{value:"action-list",children:"Actions To Take"}),e.jsx("option",{value:"example",children:"Real-world Example"}),e.jsx("option",{value:"markdown",children:"Markdown"}),e.jsx("option",{value:"html",children:"HTML (sanitized)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This controls how the lesson renders in the Learn Hub."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),e.jsx(ke,{type:"number",placeholder:"5",value:I.duration,onChange:r=>w(u=>({...u,duration:parseInt(r.target.value)||5})),min:"1",max:"60",className:"w-full"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx(bs,{placeholder:"Enter lesson content",value:I.content,onChange:r=>w(u=>({...u,content:r.target.value})),className:"w-full",rows:4})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Media (optional)"}),e.jsxs("div",{className:"space-y-3",children:[(I.media||[]).map((r,u)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 items-center",children:[e.jsxs("select",{value:r.type||"image",onChange:D=>w(ie=>{const Se=[...ie.media||[]];return Se[u]={...Se[u],type:D.target.value},{...ie,media:Se}}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"video",children:"Video"})]}),e.jsx("input",{type:"url",placeholder:"https://cdn.example.com/path/to/media",value:r.url||"",onChange:D=>w(ie=>{const Se=[...ie.media||[]];return Se[u]={...Se[u],url:D.target.value},{...ie,media:Se}}),className:"md:col-span-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent"}),e.jsx("input",{type:"text",placeholder:"Caption (optional)",value:r.caption||"",onChange:D=>w(ie=>{const Se=[...ie.media||[]];return Se[u]={...Se[u],caption:D.target.value},{...ie,media:Se}}),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>w(D=>({...D,media:(D.media||[]).filter((ie,Se)=>Se!==u)})),className:"text-red-600 text-sm hover:underline",children:"Remove"})]},u)),e.jsx("button",{type:"button",onClick:()=>w(r=>({...r,media:[...r.media||[],{type:"image",url:"",caption:""}]})),className:"text-[#21a1ce] text-sm hover:underline",children:"+ Add media"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:async r=>{var D;const u=(D=r.target.files)==null?void 0:D[0];if(u)try{Ce(!0);const ie=await Mt(u),Se=ie.url,Pe=ie.resource_type||"image";w(je=>({...je,media:[...je.media||[],{type:Pe,url:Se,caption:""}]}))}catch(ie){alert("Upload failed: "+(ie.message||"Unknown error"))}finally{Ce(!1),r.target.value=""}},className:"text-sm"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Upload to Cloudinary and auto-add to list"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(xe,{onClick:()=>K(ge.id),disabled:ve,className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:ve?"Adding...":"Add Lesson"}),Te&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-green-800 font-medium",children:Te})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Existing Lessons"}),ve&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(vs,{className:"w-4 h-4 text-blue-600 mr-2 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Updating lessons..."})]})}),((et=(Xs=ge.content)==null?void 0:Xs.lessons)==null?void 0:et.length)>0?e.jsx("div",{className:"space-y-3",children:ge.content.lessons.map(r=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.title}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>W(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Lesson",children:e.jsx(Hs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_e(ge.id,r.id),disabled:ve,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Delete Lesson",children:e.jsx(Ls,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 mr-2",children:r.type}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 mr-2",children:[r.duration," min"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800",children:r.contentType})]}),e.jsx("p",{className:"text-gray-700 text-sm line-clamp-2",children:r.content})]},r.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ls,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{children:"No lessons yet. Add your first lesson above!"})]})]})]})})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Lesson"}),e.jsx("button",{onClick:()=>W(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),e.jsx(ke,{type:"text",placeholder:"Enter lesson title",value:$.title||"",onChange:r=>W(u=>({...u,title:r.target.value})),className:"w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:$.type||"info",onChange:r=>W(u=>({...u,type:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"info",children:"Information"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"interactive",children:"Interactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),e.jsx(ke,{type:"number",placeholder:"5",value:$.duration||5,onChange:r=>W(u=>({...u,duration:parseInt(r.target.value)||5})),min:"1",max:"60",className:"w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content Type"}),e.jsxs("select",{value:$.contentType||"info",onChange:r=>W(u=>({...u,contentType:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent",children:[e.jsx("option",{value:"info",children:"Plain Text"}),e.jsx("option",{value:"tips",children:"Tips (title + description list)"}),e.jsx("option",{value:"warning-signs",children:"Warning Signs"}),e.jsx("option",{value:"steps",children:"Steps (numbered)"}),e.jsx("option",{value:"list",children:"Bullet List"}),e.jsx("option",{value:"warning",children:"Warning Box"}),e.jsx("option",{value:"warning-list",children:"Warning Box + List"}),e.jsx("option",{value:"action-list",children:"Actions To Take"}),e.jsx("option",{value:"example",children:"Real-world Example"}),e.jsx("option",{value:"markdown",children:"Markdown"}),e.jsx("option",{value:"html",children:"HTML (sanitized)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx(bs,{placeholder:"Enter lesson content",value:$.content||"",onChange:r=>W(u=>({...u,content:r.target.value})),className:"w-full",rows:6})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(xe,{onClick:()=>W(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Cancel"}),e.jsx(xe,{onClick:()=>de(ge.id,$.id,$),disabled:ve,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:ve?"Updating...":"Update Lesson"})]})]})]})})})]})}function za({setActiveTab:t}){const{user:s,updateProfile:a,changePassword:n}=ms(),[l,o]=i.useState(!1),[m,x]=i.useState(!1),[v,p]=i.useState(!1),[S,A]=i.useState({name:(s==null?void 0:s.name)||`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`.trim(),email:(s==null?void 0:s.email)||"",bio:(s==null?void 0:s.bio)||""}),[T,B]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""}),z=P=>{const{name:N,value:M}=P.target;A(y=>({...y,[N]:M}))},g=P=>{const{name:N,value:M}=P.target;B(y=>({...y,[N]:M}))},Q=async()=>{p(!0);try{await a(S),o(!1)}catch(P){console.error("Failed to update profile:",P)}finally{p(!1)}},b=async()=>{if(T.newPassword!==T.confirmPassword){alert("New passwords do not match");return}p(!0);try{await n(T.currentPassword,T.newPassword),x(!1),B({currentPassword:"",newPassword:"",confirmPassword:""})}catch(P){console.error("Failed to change password:",P)}finally{p(!1)}};return s?e.jsxs("div",{className:"space-y-6",children:[(()=>(`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`.trim()||s!=null&&s.name,null))(),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>t("home"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Es,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your account information"})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Profile Information"}),e.jsx(xe,{onClick:()=>o(!l),variant:l?"secondary":"primary",className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:l?"Cancel":"Edit Profile"})]}),l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx(ke,{type:"text",name:"name",value:S.name,onChange:z,placeholder:"Enter your full name",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(ke,{type:"email",name:"email",value:S.email,disabled:!0,className:"w-full bg-gray-50 cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email changes are not supported from here."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx(bs,{name:"bio",value:S.bio,onChange:z,placeholder:"Tell us about yourself",rows:3,className:"w-full"})]}),e.jsxs(xe,{onClick:Q,disabled:v,loading:v,className:"w-full bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ts,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),e.jsx("p",{className:"font-medium text-gray-900",children:`${(s==null?void 0:s.first_name)||""} ${(s==null?void 0:s.last_name)||""}`.trim()||(s==null?void 0:s.name)||"Not set"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ra,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.email})]})]}),s.bio&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ts,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Bio"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.bio})]})]})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Security"}),e.jsx(xe,{onClick:()=>x(!m),variant:m?"secondary":"primary",className:"bg-green-600 hover:bg-green-700 text-white",children:m?"Cancel":"Change Password"})]}),m?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),e.jsx(ke,{type:"password",name:"currentPassword",value:T.currentPassword,onChange:g,placeholder:"Enter current password",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),e.jsx(ke,{type:"password",name:"newPassword",value:T.newPassword,onChange:g,placeholder:"Enter new password",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),e.jsx(ke,{type:"password",name:"confirmPassword",value:T.confirmPassword,onChange:g,placeholder:"Confirm new password",className:"w-full"})]}),e.jsxs(xe,{onClick:b,disabled:v,loading:v,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(aa,{className:"w-4 h-4 mr-2"}),"Update Password"]})]}):e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ie,{className:"w-5 h-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Password"}),e.jsx("p",{className:"font-medium text-gray-900",children:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]})]})]})}),e.jsx(ue,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Account Type"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.is_admin||s.role==="ADMIN"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:s.is_admin||s.role==="ADMIN"?"Admin":"User"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Member Since"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.created_at?new Date(s.created_at).toLocaleDateString():"Unknown"})]})]})]})})]}):e.jsx("div",{className:"space-y-6",children:e.jsx(ue,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ts,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Profile Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please log in to access your profile."}),e.jsx(xe,{onClick:()=>t("login"),className:"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white",children:"Go to Login"})]})})})}const Ha=({onRegisterSuccess:t,onSwitchToLogin:s})=>{const[a,n]=i.useState({first_name:"",last_name:"",email:"",password:"",confirm_password:""}),[l,o]=i.useState({}),[m,x]=i.useState(!1),{register:v,verifyEmail:p,resendVerification:S,error:A,user:T,isAuthenticated:B}=ms(),[z,g]=i.useState(!1),[Q,b]=i.useState(""),[P,N]=i.useState("");i.useEffect(()=>{B&&T&&t&&t()},[B,T,t]);const M=()=>{const j={};return a.first_name.trim()||(j.first_name="First name is required"),a.last_name.trim()||(j.last_name="Last name is required"),a.email.trim()?/\S+@\S+\.\S+/.test(a.email)||(j.email="Email is invalid"):j.email="Email is required",a.password?a.password.length<8&&(j.password="Password must be at least 8 characters"):j.password="Password is required",a.password!==a.confirm_password&&(j.confirm_password="Passwords do not match"),o(j),Object.keys(j).length===0},y=async j=>{if(j.preventDefault(),!!M()){x(!0);try{const L={first_name:a.first_name.trim(),last_name:a.last_name.trim(),email:a.email.trim().toLowerCase(),password:a.password},G=await v(L);G.success?G.requires_verification&&(g(!0),N("We sent a 6-digit code to your email. Enter it below to verify your account.")):(console.error("Registration failed:",G.error),G.error&&G.error.toLowerCase().includes("email")&&o(H=>({...H,email:G.error})))}catch(L){console.error("Registration error:",L)}finally{x(!1)}}},k=j=>{n({...a,[j.target.name]:j.target.value}),l[j.target.name]&&o({...l,[j.target.name]:""})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:"/remaleh-logo.png",alt:"Remaleh Protect",className:"h-12 w-auto"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join Remaleh Protect for enhanced digital security"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[!z&&e.jsxs("form",{className:"space-y-6",onSubmit:y,children:[A&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:A})})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700",children:"First name"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"first_name",name:"first_name",type:"text",autoComplete:"given-name",required:!0,value:a.first_name,onChange:k,className:`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${l.first_name?"border-red-300":"border-gray-300"}`,placeholder:"Enter your first name"})}),l.first_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.first_name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700",children:"Last name"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"last_name",name:"last_name",type:"text",autoComplete:"family-name",required:!0,value:a.last_name,onChange:k,className:`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${l.last_name?"border-red-300":"border-gray-300"}`,placeholder:"Enter your last name"})}),l.last_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.last_name})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a.email,onChange:k,className:`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${l.email?"border-red-300":"border-gray-300"}`,placeholder:"Enter your email address"})}),l.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:a.password,onChange:k,className:`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${l.password?"border-red-300":"border-gray-300"}`,placeholder:"Create a strong password"})}),l.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.password}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 8 characters long"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm_password",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"confirm_password",name:"confirm_password",type:"password",autoComplete:"new-password",required:!0,value:a.confirm_password,onChange:k,className:`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${l.confirm_password?"border-red-300":"border-gray-300"}`,placeholder:"Confirm your password"})}),l.confirm_password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.confirm_password})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating account..."]}):"Create account"})})]}),z&&e.jsxs("div",{className:"space-y-4",children:[P&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:e.jsx("p",{className:"text-sm text-blue-800",children:P})}),A&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-800",children:A})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Verification code"}),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,value:Q,onChange:j=>b(j.target.value.replace(/\D/g,"")),className:"mt-1 appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300",placeholder:"Enter 6-digit code"})]}),e.jsx("button",{onClick:async()=>{if(!a.email||Q.length!==6)return;(await p(a.email.trim().toLowerCase(),Q)).success&&t&&t()},className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none",children:"Verify and continue"}),e.jsx("button",{type:"button",onClick:async()=>{a.email&&(await S(a.email.trim().toLowerCase()),N("A new code has been sent to your email."))},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Resend code"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Already have an account?"})})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>{s?s():t&&t()},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign in instead"})})]})]})})]})};function Ga(){const[t,s]=i.useState("home"),[a,n]=i.useState(""),[l,o]=i.useState([]),[m,x]=i.useState(""),[v,p]=i.useState(null),[S,A]=i.useState(!1),[T,B]=i.useState(""),[z,g]=i.useState(!1),[Q,b]=i.useState(!1),{user:P,isAuthenticated:N,logout:M}=ms(),[y,k]=i.useState(""),[j,L]=i.useState(!1),[G,H]=i.useState([]),re=async()=>{try{localStorage.removeItem("authToken"),localStorage.removeItem("refreshToken"),s("home"),window.location.reload()}catch(d){console.error("Global logout error:",d),window.location.reload()}};i.useEffect(()=>(window.logoutUser=re,()=>{delete window.logoutUser}),[]),i.useEffect(()=>{try{const d=new URLSearchParams(window.location.search),I=d.get("oauth"),w=d.get("access_token"),$=d.get("refresh_token");I&&w&&$&&(localStorage.setItem("authToken",w),localStorage.setItem("refreshToken",$),window.history.replaceState({},document.title,window.location.pathname),window.dispatchEvent(new Event("remaleh-auth-changed")),s("home"))}catch{}},[]),i.useEffect(()=>{n((()=>{const I=new Date().getHours();return I<12?"Good morning!":I<17?"Good afternoon!":"Good evening!"})())},[]),i.useEffect(()=>{(async()=>{try{if(!N)return;const I=await Ae("/api/enhanced-scam/forwarding-address");if(I.ok){const w=await I.json();k(w.forwarding_address||"")}}catch{}})()},[N]),i.useEffect(()=>{const d=async()=>{try{if(!N)return;const w=await Ae("/api/enhanced-scam/recent-scans?limit=10");if(w.ok){const $=await w.json();H(Array.isArray($.items)?$.items:[])}}catch{}};d();const I=setInterval(d,15e3);return()=>clearInterval(I)},[N]),i.useEffect(()=>{(async()=>{try{const I=await fetch(`${$e}${be.PUBLIC.BLOG_FEED}?limit=8`);if(I.ok){const h=await I.json();if(Array.isArray(h.items)&&h.items.length>0){o(h.items);return}}const w="https://www.remaleh.com.au/blog/blog-feed.xml",$=[h=>`${$e}/api/public/rss-proxy?url=${encodeURIComponent(h)}`,h=>`https://api.allorigins.win/raw?url=${encodeURIComponent(h)}`,h=>"https://r.jina.ai/http://www.remaleh.com.au/blog/blog-feed.xml"];let W="";for(const h of $)try{const Z=await fetch(h(w),{cache:"no-store"});if(Z.ok&&(W=await Z.text(),W&&W.length>100))break}catch{}if(!W)return;const Ce=new DOMParser().parseFromString(W,"text/xml"),Te=Ce.querySelector("rss > channel");let Ne=[];Te?Ne=Array.from(Te.querySelectorAll("item")):Ne=Array.from(Ce.querySelectorAll("entry"));const De=(h,Z)=>{const ae=h.querySelector(Z);return ae&&ae.textContent?ae.textContent.trim():""},Ge=Ne.slice(0,8).map(h=>{const Z=De(h,"title");let ae="";const le=h.querySelector("link");le&&(ae=le.getAttribute("href")||le.textContent||"");const We=De(h,"pubDate")||De(h,"updated")||De(h,"published"),Ke=De(h,"description")||De(h,"content\\:encoded")||De(h,"summary")||De(h,"content"),Xe=Ke?Ke.replace(/<[^>]+>/g,"").slice(0,240):"";let ns="";const ps=(Ke||"").match(/<img[^>]+src=["']([^"']+)["']/i);return ps&&(ns=ps[1]),{title:Z,link:ae,pubDate:We,excerpt:Xe,image:ns}});o(Ge)}catch{}})()},[]);const ne=d=>{try{if(!d)return"";const I=new Date(d);return isNaN(I)?"":I.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch{return""}},he=()=>{if(P!=null&&P.name){const d=P.name.split(" ");return d.length>=2?`${d[0][0]}${d[d.length-1][0]}`.toUpperCase():d[0][0].toUpperCase()}return P!=null&&P.email?P.email[0].toUpperCase():"U"},fe=()=>{b(!Q)},se=()=>{M(),b(!1),s("home")};i.useEffect(()=>{const d=w=>{Q&&!w.target.closest(".profile-dropdown")&&b(!1)},I=w=>{w.key==="Escape"&&Q&&b(!1)};return document.addEventListener("mousedown",d),document.addEventListener("keydown",I),()=>{document.removeEventListener("mousedown",d),document.removeEventListener("keydown",I)}},[Q]);const ce=[{id:"home",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{id:"breach",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})},{id:"scam",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})},{id:"learn",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),label:"Learning Hub"},{id:"community",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{id:"chat",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})},{id:"admin",icon:e.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756 2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a0 3 3 0 11-6 0 3 3 0 016 0z"})]}),label:"Admin"}],Me=async()=>{if(!m||!m.includes("@")){B("Please enter a valid email address");return}A(!0),B(""),p(null);try{const d=await Re(be.BREACH,{email:m}),I=await d.json();d.ok?p(I):B(I.error||"Failed to check for breaches")}catch(d){console.error("Breach check error:",d),B("We couldn't reach the breach service. Please check your connection and try again.")}finally{A(!1)}},E=d=>{console.log("Generated password:",d),g(!1)},[te,R]=i.useState(""),[U,q]=i.useState("message"),[f,V]=i.useState(null),[_,C]=i.useState(!1),[O,F]=i.useState(""),ee=async()=>{if(!te.trim()){F("Please enter content to analyze");return}C(!0),F(""),V(null);try{let d,I=U,w="";if(U==="link"){const $=/^https?:\/\/[^\s]+$/i,W=/https?:\/\/[^\s]+/gi.test(te);$.test(te.trim())?(d=await ye(te),w="Analyzed as single URL"):W?(d=await Le(te),I="message",w="Detected message with URLs - used Enhanced Scam Detection Engine"):(d=await Le(te),I="message",w="No URLs detected - analyzed with Enhanced Scam Detection Engine")}else if(U==="email"){const $=/^[^\s]+@[^\s]+\.[^\s]+/i,W=/^(from|to|subject|date):/im.test(te);$.test(te.split(`
`)[0])||W?(d=await pe(te),w="Analyzed as email content"):(d=await Le(te),I="message",w="Content doesn't appear to be email - used Enhanced Scam Detection Engine")}else d=await Le(te),w="Analyzed with Enhanced Scam Detection Engine";w&&(d.contentTypeNote=w,d.detectedContentType=I),V(d)}catch(d){console.error("Scam analysis error:",d),d.message.includes("Failed to fetch")?F("Unable to connect to security APIs. Please check your internet connection and try again."):d.message.includes("HTTP error")?F("Security service temporarily unavailable. Please try again later."):F("Analysis failed. Please try again.")}finally{C(!1)}},ye=async d=>{var I;try{const w=await fetch(`${$e}/api/link/analyze-url`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:d})});if(!w.ok)throw new Error("Service temporarily unavailable");const $=await w.json();if(!$.success)throw new Error($.error||"Link analysis failed");const W=$.result;return{riskLevel:((I=W.risk_level)==null?void 0:I.toLowerCase())||"medium",riskScore:W.risk_score||50,indicators:W.indicators||[],recommendations:W.recommendations||["Be cautious of this link","Verify the destination before clicking","Check for HTTPS and legitimate domain"],analysis:d.substring(0,100)+(d.length>100?"...":""),linkDetails:W}}catch(w){return console.error("Link analysis error:",w),we(d,"link")}},pe=async d=>{var I;try{const w=await fetch(`${$e}/api/enhanced-scam/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:d})});if(!w.ok)throw new Error("Service temporarily unavailable");const $=await w.json();if(!$.success)throw new Error($.error||"Email analysis failed");const W=$.result;return{riskLevel:((I=W.risk_level)==null?void 0:I.toLowerCase())||"medium",riskScore:Math.round(W.risk_score*100)||50,indicators:W.indicators||[],recommendations:He(W.risk_level,W.indicators),analysis:d.substring(0,100)+(d.length>100?"...":""),emailDetails:W}}catch(w){return console.error("Email analysis error:",w),we(d,"email")}},He=(d,I)=>{const w=[];return d==="SCAM"?(w.push("Do not respond to this email"),w.push("Delete immediately and contact Remaleh Guardians"),w.push("Do not click any links or attachments"),w.push("If you clicked any links, reach out to Remaleh Guardians via chat immediately")):d==="SUSPICIOUS"?(w.push("Exercise extreme caution with this email"),w.push("Verify sender authenticity before responding"),w.push("Do not share personal information"),w.push("Contact Remaleh Guardians if you need assistance")):(w.push("Review this email carefully"),w.push("Check sender authenticity"),w.push("Avoid clicking suspicious links")),I.some($=>$.includes("financial"))&&(w.push("Never send money or financial information via email"),w.push("Contact Remaleh Guardians if you have financial concerns")),I.some($=>$.includes("urgency"))&&w.push("Be cautious of urgent requests - legitimate organizations rarely pressure you"),w},Le=async d=>{var I;try{const w=await fetch(`${$e}/api/enhanced-scam/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:d})});if(!w.ok)throw new Error("Service temporarily unavailable");const $=await w.json();if(!$.success)throw new Error($.error||"Enhanced scam analysis failed");const W=$.result;return{riskLevel:((I=W.risk_level)==null?void 0:I.toLowerCase())||"medium",riskScore:Math.round(W.risk_score*100)||50,indicators:W.indicators||[],recommendations:Ze(W.risk_level,W.indicators,W.patterns),analysis:d.substring(0,100)+(d.length>100?"...":""),messageDetails:W}}catch(w){return console.error("Enhanced message analysis error:",w),we(d,"message")}},Ze=(d,I,w)=>{const $=[];return d==="SCAM"?($.push("Do not respond to this message"),$.push("Delete immediately and contact Remaleh Guardians"),$.push("Do not click any links or attachments"),$.push("If you clicked any links, reach out to Remaleh Guardians via chat immediately")):d==="SUSPICIOUS"?($.push("Exercise extreme caution with this message"),$.push("Verify authenticity before responding"),$.push("Do not share personal information"),$.push("Contact Remaleh Guardians if you need assistance")):d==="SAFE"?($.push("Content appears safe - no obvious threats detected"),$.push("Continue to exercise normal caution"),$.push("If you have concerns, contact Remaleh Guardians via chat")):($.push("Review this message carefully"),$.push("Check sender authenticity"),$.push("Avoid clicking suspicious links")),w&&w.includes("suspicious_domain")&&$.push("Contains suspicious domain (.buzz, .tk, etc.) - high risk"),w&&w.includes("url")&&$.push("Contains URLs - verify before clicking"),w&&w.includes("phone_number")&&$.push("Contains phone numbers - do not call unknown numbers"),$.some(ve=>ve.includes("Remaleh Guardians"))||$.push("Contact Remaleh Guardians via chat for immediate assistance"),[...new Set($)]},we=(d,I)=>{const w={urgency:/(urgent|immediate|now|quick|fast|hurry|deadline|limited time|expires|last chance)/gi,money:/(\$[\d,]+|money|payment|bank|account|credit card|paypal|bitcoin|crypto|investment|profit|return)/gi,personal:/(password|login|verify|confirm|update|social security|ssn|birthday|address|phone)/gi,threats:/(suspended|blocked|locked|deleted|expired|legal action|police|fbi|irs|tax)/gi,suspicious:/(click here|verify now|login|password|bank|urgent|free|winner|prize|lottery)/gi},$={};let W=0;Object.entries(w).forEach(([Ce,Te])=>{const Ne=d.match(Te);Ne&&($[Ce]=Ne.length,W+=Ne.length*2)}),I==="link"&&((d.includes("bit.ly")||d.includes("tinyurl"))&&(W+=5),d.includes("http://")&&!d.includes("https://")&&(W+=3)),I==="email"&&d.includes("@")&&!d.includes("@gmail.com")&&!d.includes("@yahoo.com")&&(W+=2);const ve=W<10?"safe":W<20?"suspicious":"scam";return{riskLevel:ve,riskScore:W,indicators:$,recommendations:Ye(ve,$,I),analysis:d.substring(0,100)+(d.length>100?"...":"")}},Ye=(d,I,w)=>{const $=[];return d==="scam"&&($.push("Do not click any links or provide personal information"),$.push("Contact Remaleh Guardians immediately"),$.push("Delete the message immediately"),$.push("If you clicked any links, reach out to Remaleh Guardians via chat")),I.urgency&&$.push("Be cautious of urgent requests - legitimate organizations rarely pressure you"),I.money&&$.push("Never send money to unknown sources or for urgent requests"),I.personal&&$.push("Never share passwords, SSN, or other sensitive information via message"),w==="link"&&($.push("Hover over links to verify the actual destination"),$.push("Use link scanning tools before clicking")),$.some(ve=>ve.includes("Remaleh Guardians"))||$.push("Contact Remaleh Guardians via chat for immediate assistance"),[...new Set($)]},ge=()=>{switch(t){case"home":return e.jsx(Fs,{onRefresh:async()=>{try{await(loadBlogFeed==null?void 0:loadBlogFeed()),await(loadRecentScans==null?void 0:loadRecentScans())}catch{}},className:"",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-black mb-2",children:a}),e.jsx("p",{className:"text-gray-600",children:"Welcome to Remaleh Protect"})]}),e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 scrollbar-hide",children:[(l.length>0?l:[]).map((d,I)=>e.jsxs("a",{href:d.link||"https://www.remaleh.com.au/blog",target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 w-80 bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200",children:[d.image&&e.jsx("img",{src:d.image,alt:d.title||"Blog image",className:"w-full h-40 object-cover",onError:w=>{w.currentTarget.style.display="none"}}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1 line-clamp-2",children:d.title}),d.excerpt&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-3",children:d.excerpt}),e.jsx("div",{className:"flex items-center text-xs text-gray-500",children:e.jsx("span",{children:ne(d.pubDate)})})]})]},`${d.link||I}`)),l.length===0&&e.jsx("a",{href:"https://www.remaleh.com.au/blog",target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0 w-80 bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Visit the Remaleh Blog"}),e.jsx("span",{className:"text-gray-500 text-xs",children:"Latest insights and security tips"})]}),e.jsx("div",{className:"text-blue-400 ml-3",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0L17 8.586a1 1 0 010 1.414l-5.293 5.293a1 1 0 01-1.414-1.414L13.586 10H4a1 1 0 110-2h9.586l-3.293-3.293a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})})]}),e.jsx("div",{className:"flex justify-center mt-4 space-x-2",children:[1,2,3,4,5].map((d,I)=>e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300"},I))})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{onClick:()=>s("breach"),className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:"Breach Check"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Check if your email has been compromised in data breaches"})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),e.jsx("div",{onClick:()=>s("scam"),className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:"Scam Analysis"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Analyze suspicious messages and links for potential scams"})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),e.jsx("div",{onClick:()=>s("learn"),className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:"Learning Hub"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Learn how to stay safe online, the easy way."})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),e.jsx("div",{onClick:()=>s("community"),className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:"Community"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Report scams. Protect your community."})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})}),e.jsx("div",{onClick:()=>s("chat"),className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:"Chat"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Chat with our Cyber Assistant and a Remaleh Guardian's just a message away"})]}),e.jsx("div",{className:"text-gray-400",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})})]})]})});case"breach":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),e.jsx("h1",{className:"text-2xl font-bold text-black mb-2",children:"Breach Checker"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Check if your email has been compromised"})]})}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"Check Your Email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),e.jsx("input",{type:"email",id:"email",value:m,onChange:d=>x(d.target.value),onKeyDown:d=>{d.key==="Enter"&&!S&&m&&m.includes("@")&&Me()},placeholder:"Enter your email address",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent transition-all duration-200",disabled:S})]})]}),T&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-red-800 text-sm",children:T})]})}),e.jsx("button",{onClick:Me,disabled:S||!m,className:"w-full bg-[#21a1ce] text-white py-3 px-6 rounded-xl font-medium hover:bg-[#1a8bb8] transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:S?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Check for Breaches"]})})]})]}),v&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[v.breached?e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}):e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mr-4",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-black",children:v.breached?"Breaches Found":"No Breaches Detected"}),e.jsx("p",{className:"text-gray-600",children:v.breached?`${v.breach_count} breach(es) found`:"Your email is secure"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Checked: ",m]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:`text-lg ${v.breached?"text-red-700":"text-green-700"}`,children:v.message})}),v.breached&&v.breaches&&v.breaches.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Affected Services:"}),v.breaches.map((d,I)=>e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-1",children:d.name}),e.jsx("p",{className:"text-red-700 text-sm mb-2",children:d.domain}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-red-600 text-xs",children:["Breached: ",d.date]}),e.jsx("span",{className:"text-red-600 text-xs",children:"â€¢"}),e.jsx("span",{className:"text-red-600 text-xs",children:d.data.join(", ")})]})]}),e.jsx("div",{className:"text-red-400 ml-3",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})},I))]}),v.demo_mode&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-blue-800 text-sm",children:"Demo mode - Results are simulated for testing purposes"})]})}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Security Recommendations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"Enable Multi-Factor Authentication (MFA)"}),e.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"Add an extra layer of security to your accounts with MFA apps like Google Authenticator, Authy, or Microsoft Authenticator."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:"Google Authenticator"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:"Authy"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:"Microsoft Authenticator"})]})]})]})}),e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-1",children:"Use Strong, Unique Passwords"}),e.jsx("p",{className:"text-green-700 text-sm mb-3",children:"Generate secure passwords for each account to prevent credential stuffing attacks."}),e.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Generate Secure Password"]})]})]})}),e.jsx("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-purple-800 mb-1",children:"Monitor Your Accounts Regularly"}),e.jsx("p",{className:"text-purple-700 text-sm mb-3",children:"Use Remaleh Protect regularly to check for new breaches and stay updated on security threats."}),e.jsxs("div",{className:"flex items-center text-purple-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Check back monthly for new breaches"]})]})]})}),e.jsx("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-orange-800 mb-1",children:"Use a Password Manager"}),e.jsx("p",{className:"text-orange-700 text-sm mb-3",children:"Store and manage your passwords securely with trusted password managers."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full",children:"Bitwarden"}),e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full",children:"1Password"}),e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full",children:"LastPass"}),e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full",children:"Dashlane"})]})]})]})})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{x(""),p(null),B("")},className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl font-medium hover:bg-gray-200 transition-all duration-200",children:"Check Another Email"})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"How It Works"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"1"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Enter Email"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Provide your email address securely"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"2"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Scan Database"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"We check against known breaches"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"3"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Get Results"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Instant results and recommendations"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"Security Features"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-green-800 text-sm",children:"Your data is never stored or shared"})]}),e.jsxs("div",{className:"flex items-center p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("span",{className:"text-blue-800 text-sm",children:"Real-time breach database updates"})]}),e.jsxs("div",{className:"flex items-center p-3 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{className:"text-purple-800 text-sm",children:"Instant results and notifications"})]})]})]})]});case"scam":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsx("h1",{className:"text-2xl font-bold text-black mb-2",children:"Scam Analysis"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Analyze suspicious content for potential scams"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-gray-600",children:"Connected to Remaleh Protect Security Engine"}),e.jsx("button",{onClick:async()=>{try{const d=await fetch(`${$e}/api/security/status`);if(d.ok){const I=await d.json();console.log("Security Engine Status:",I),alert(`Security Engine Status: ${I.status}
Version: ${I.version}
Services: ${Object.keys(I.available_services).length} available`)}}catch(d){console.error("Status check failed:",d),alert("Unable to check Security Engine status")}},className:"ml-2 text-xs text-[#21a1ce] hover:text-[#1a8bb8] underline cursor-pointer",children:"Check Status"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"Analyze Content"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content Type"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{id:"message",label:"Message",icon:"ðŸ’¬"},{id:"link",label:"Link",icon:"ðŸ”—"},{id:"email",label:"Email",icon:"ðŸ“§"}].map(d=>e.jsx("button",{onClick:()=>q(d.id),className:`p-3 rounded-xl border-2 transition-all duration-200 ${U===d.id?"border-[#21a1ce] bg-[#21a1ce] bg-opacity-10":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:d.icon}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:d.label})]})},d.id))})]}),U==="email"?e.jsx("div",{className:"space-y-3",children:N?e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Forward emails for analysis:"}),e.jsx("div",{className:"mt-1 select-all break-all",children:y||"Generating..."})]}),e.jsx("button",{onClick:()=>{y&&navigator.clipboard.writeText(y).then(()=>{L(!0),setTimeout(()=>L(!1),1500)})},className:"ml-3 text-xs bg-[#21a1ce] text-white px-3 py-2 rounded-lg hover:bg-[#1a8bb8]",children:j?"Copied":"Copy"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Forward suspicious emails (including attachments) to this address. We'll analyze them and show results below."})]}):e.jsx("p",{className:"text-sm text-gray-600",children:"Sign in to get your personal forwarding address."})}):e.jsxs("div",{children:[e.jsx("label",{htmlFor:"scamInput",className:"block text-sm font-medium text-gray-700 mb-2",children:U==="message"?"Message Content":"URL or Link"}),e.jsxs("div",{className:"relative",children:[U==="link"?e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}):e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("textarea",{id:"scamInput",value:te,onChange:d=>R(d.target.value),placeholder:U==="message"?"Paste the suspicious message here...":"Enter the URL or link to analyze...",rows:4,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent transition-all duration-200 resize-none",disabled:_})]})]}),O&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-red-800 text-sm",children:O})]})}),U!=="email"&&e.jsx("button",{onClick:ee,disabled:_||!te.trim(),className:"w-full bg-[#21a1ce] text-white py-3 px-6 rounded-xl font-medium hover:bg-[#1a8bb8] transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:_?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Analyzing with ",U==="link"?"Link Analysis Engine":"Comprehensive Scam Analysis Engine","..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Analyze for Scams"]})})]}),e.jsx("div",{className:"mt-3 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Sometimes our scanners miss the mark, so double check to stay safe."})})]}),f&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mr-4 ${f.riskLevel==="scam"?"bg-red-100":f.riskLevel==="suspicious"?"bg-yellow-100":(f.riskLevel==="safe","bg-green-100")}`,children:e.jsx("svg",{className:`w-6 h-6 ${f.riskLevel==="scam"?"text-red-600":f.riskLevel==="suspicious"?"text-yellow-600":(f.riskLevel==="safe","text-green-600")}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-black",children:["Risk Level: ",f.riskLevel==="safe"?"Safe âœ…":f.riskLevel==="scam"?"Scam ðŸš¨":f.riskLevel==="suspicious"?"Suspicious âš ï¸":f.riskLevel.charAt(0).toUpperCase()+f.riskLevel.slice(1),f.riskLevel==="scam"?" - IMMEDIATE ACTION REQUIRED":"",f.riskLevel==="safe"?" - No threats detected":"",f.riskLevel==="suspicious"?" - Exercise caution":""]}),e.jsxs("p",{className:"text-gray-600",children:["Risk Score: ",f.riskScore,"/100",f.riskScore>=70?" - IMMEDIATE ACTION REQUIRED":"",f.riskLevel==="safe"?" - Content appears safe":"",f.riskLevel==="suspicious"?" - Review carefully":""]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Analyzed with ",U==="link"?"Link Analysis Engine":U==="email"?"Enhanced Scam Detection Engine":"Comprehensive Scam Analysis Engine"]}),f.contentTypeNote&&e.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-blue-800 text-xs",children:[e.jsx("strong",{children:"Content Detection:"})," ",f.contentTypeNote]})]})})]})]}),(f.riskLevel==="scam"||f.riskScore>=70)&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border-2 border-red-300 rounded-xl",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("svg",{className:"w-6 h-6 text-red-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("h3",{className:"text-lg font-bold text-red-800",children:"ðŸš¨ SCAM DETECTED"})]}),e.jsxs("div",{className:"space-y-2 text-red-700",children:[e.jsx("p",{className:"font-medium",children:"This content shows multiple signs of being a scam:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[f.riskLevel==="scam"&&e.jsx("li",{children:"Scam risk level - immediate action required"}),f.riskScore>=70&&e.jsxs("li",{children:["Very high risk score (",f.riskScore,"/100)"]}),f.indicators&&f.indicators.length>0&&e.jsx("li",{children:"Multiple suspicious indicators detected"}),e.jsx("li",{children:"Do NOT click any links or respond to this message"}),e.jsx("li",{children:"Contact Remaleh Guardians via chat immediately"})]})]})]}),f.riskLevel==="suspicious"&&e.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-xl",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("svg",{className:"w-6 h-6 text-yellow-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("h3",{className:"text-lg font-bold text-yellow-800",children:"âš ï¸ SUSPICIOUS CONTENT DETECTED"})]}),e.jsxs("div",{className:"space-y-2 text-yellow-700",children:[e.jsx("p",{className:"font-medium",children:"This content shows some concerning signs:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsx("li",{children:"Exercise caution with this content"}),e.jsx("li",{children:"Verify authenticity before responding"}),e.jsx("li",{children:"Do not share personal information"}),e.jsx("li",{children:"Contact Remaleh Guardians via chat if you need assistance"})]})]})]}),f.riskLevel==="safe"&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border-2 border-green-300 rounded-xl",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("svg",{className:"w-6 h-6 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-bold text-green-800",children:"âœ… CONTENT APPEARS SAFE"})]}),e.jsxs("div",{className:"space-y-2 text-green-700",children:[e.jsx("p",{className:"font-medium",children:"This content shows no obvious signs of being a scam:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:["Low risk score (",f.riskScore,"/100)"]}),e.jsx("li",{children:"No suspicious patterns detected"}),e.jsx("li",{children:"Continue to exercise normal caution"}),e.jsx("li",{children:"If you have concerns, contact Remaleh Guardians via chat"})]})]})]}),f.indicators&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Detected Indicators:"}),Object.keys(f.indicators).length>0&&!Array.isArray(f.indicators)&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(f.indicators).map(([d,I])=>e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:d.replace(/([A-Z])/g," $1").trim()}),e.jsx("span",{className:"text-xs bg-[#21a1ce] text-white px-2 py-1 rounded-full",children:I})]})},d))}),Array.isArray(f.indicators)&&f.indicators.length>0&&e.jsx("div",{className:"space-y-2",children:f.indicators.map((d,I)=>e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 text-yellow-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-yellow-800 text-sm",children:d})]})},I))}),(!f.indicators||Array.isArray(f.indicators)&&f.indicators.length===0||!Array.isArray(f.indicators)&&Object.keys(f.indicators).length===0)&&e.jsx("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-green-800 text-sm",children:"No suspicious indicators detected"})]})})]}),f.linkDetails&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Link Analysis Details:"}),e.jsx("div",{className:"space-y-2",children:f.linkDetails.indicators&&f.linkDetails.indicators.map((d,I)=>e.jsx("div",{className:"p-2 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsx("span",{className:"text-yellow-800 text-sm",children:d})},I))})]}),f.emailDetails&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Email Analysis Details:"}),e.jsx("div",{className:"space-y-2",children:f.emailDetails.scam_categories&&f.emailDetails.scam_categories.map((d,I)=>e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg border border-purple-200",children:e.jsx("span",{className:"text-purple-800 text-sm",children:d})},I))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Security Recommendations:"}),e.jsx("div",{className:"space-y-2",children:f.recommendations.map((d,I)=>e.jsxs("div",{className:"flex items-start p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-blue-800 text-sm",children:d})]},I))})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{R(""),V(null),F("")},className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl font-medium hover:bg-gray-200 transition-all duration-200",children:"Analyze Another Item"})})]}),N&&U==="email"&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-3",children:"Recently forwarded emails"}),G.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No forwarded emails analyzed yet."}):e.jsx("div",{className:"space-y-2",children:G.map(d=>{var I;return e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"mr-3 flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:d.subject||"Email"}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2",children:[e.jsx("span",{children:(I=d.scanned_at)==null?void 0:I.replace("T"," ").slice(0,16)}),typeof d.attachments=="number"&&e.jsxs("span",{children:["â€¢ ",d.attachments," attachment",d.attachments===1?"":"s"]})]}),d.preview&&e.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:d.preview}),Array.isArray(d.indicators)&&d.indicators.length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:d.indicators.map((w,$)=>e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700",children:w},$))}),Array.isArray(d.recommendations)&&d.recommendations.length>0&&e.jsx("ul",{className:"mt-2 list-disc list-inside text-[11px] text-gray-600 space-y-0.5",children:d.recommendations.map((w,$)=>e.jsx("li",{children:w},$))})]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${d.risk_level==="SCAM"?"bg-red-100 text-red-700":d.risk_level==="SUSPICIOUS"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:[d.risk_level," ",typeof d.risk_score=="number"?`(${d.risk_score})`:""]})]},d.id)})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"How Scam Analysis Works"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"1"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Input Content"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Paste suspicious messages, links, or forward email"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"2"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"AI Analysis"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Advanced pattern recognition scans for threats"})]}),e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-[#21a1ce] font-bold text-lg",children:"3"})}),e.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Get Results"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Risk assessment and security recommendations"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold text-black mb-4",children:"Detection Capabilities"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-red-800 text-sm",children:"Phishing attempts and social engineering"})]}),e.jsxs("div",{className:"flex items-center p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("span",{className:"text-yellow-800 text-sm",children:"Suspicious links and URLs"})]}),e.jsxs("div",{className:"flex items-center p-3 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("svg",{className:"w-5 h-5 text-purple-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("span",{className:"text-yellow-800 text-sm",children:"Financial fraud and money scams"})]})]})]})]});case"chat":return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-10 h-10 bg-[#21a1ce] bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("svg",{className:"w-5 h-5 text-[#21a1ce]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Your AI cybersecurity assistant for instant help and guidance"}),e.jsx("div",{className:"bg-[#21a1ce] bg-opacity-10 px-3 py-2 rounded-lg border border-[#21a1ce] border-opacity-20 inline-block",children:e.jsxs("p",{className:"text-[#21a1ce] text-xs font-medium",children:["ðŸ’¡ ",e.jsx("strong",{children:"Need human help?"}),' Send "connect me with a Remaleh Guardian"']})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:e.jsx(xa,{setActiveTab:s})})]});case"learn":return e.jsx(_a,{setActiveTab:s});case"admin":return e.jsx(Ba,{setActiveTab:s});case"login":return e.jsx(Ma,{onLoginSuccess:()=>s("home"),onSwitchToRegister:()=>s("register")});case"register":return e.jsx(Ha,{onRegisterSuccess:()=>s("home"),onSwitchToLogin:()=>s("login")});case"profile":return e.jsx(za,{setActiveTab:s});case"community":return e.jsx(Ta,{setActiveTab:s});case"community_reports":return e.jsx(Pa,{setActiveTab:s});default:return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h1",{className:"text-2xl font-bold text-black mb-4",children:"Welcome to Remaleh Protect"}),e.jsx("p",{className:"text-gray-700",children:"Your digital security companion"})]})}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"safe-top-bar"}),e.jsx("header",{className:"bg-[#21a1ce] px-6 py-4",style:{position:"sticky",top:0,zIndex:30},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 text-center",children:e.jsx("img",{src:"/Remaleh-logo-full-2.jpg",alt:"Remaleh",className:"h-8 w-auto mx-auto"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:fe,className:"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",children:N?e.jsx("span",{className:"text-[#21a1ce] font-semibold text-sm",children:he()}):e.jsx(Ts,{className:"w-4 h-4 text-[#21a1ce]","aria-hidden":"true"})}),Q&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50 profile-dropdown",children:N?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:(P==null?void 0:P.name)||"User"}),e.jsx("p",{className:"text-xs text-gray-500",children:P==null?void 0:P.email})]}),e.jsx("button",{onClick:()=>s("profile"),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Profile Settings"}),((P==null?void 0:P.is_admin)||(P==null?void 0:P.role)==="ADMIN"||(P==null?void 0:P.role)==="MODERATOR")&&e.jsx("button",{onClick:()=>{s("admin"),b(!1)},className:"w-full text-left px-4 py-2 text-sm text-purple-700 hover:bg-purple-50 transition-colors border-t border-gray-100 bg-purple-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756 2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a0 3 3 0 11-6 0 3 3 0 016 0z"})]}),(P==null?void 0:P.role)==="MODERATOR"&&!(P!=null&&P.is_admin)?"Go to Moderator Dashboard":"Go to Admin Dashboard"]})}),e.jsx("button",{onClick:se,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Sign Out"}),e.jsx("a",{href:"/privacy.html",className:"block w-full text-left px-4 py-2 text-xs text-gray-500 hover:bg-gray-50 transition-colors border-t border-gray-100",children:"Privacy Policy"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{s("login"),b(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Sign In"}),e.jsx("button",{onClick:()=>{s("register"),b(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Create Account"}),e.jsx("a",{href:"/privacy.html",className:"block w-full text-left px-4 py-2 text-xs text-gray-500 hover:bg-gray-50 transition-colors border-t border-gray-100",children:"Privacy Policy"})]})})]})]})}),e.jsx("main",{className:"px-6 py-6 pb-24 max-w-none",children:ge()}),z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Password Generator"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(ua,{onUse:E})]})})}),e.jsx("nav",{className:"fixed left-0 right-0 bg-white border-t border-gray-200 px-4 pt-2 pb-6 pb-safe",style:{bottom:"calc(env(safe-area-inset-bottom) + 12px)"},children:e.jsx("div",{className:"flex justify-around",children:ce.filter(d=>d.id==="admin"?(P==null?void 0:P.is_admin)||(P==null?void 0:P.role)==="ADMIN"||(P==null?void 0:P.role)==="MODERATOR":!0).map(d=>e.jsx("button",{onClick:()=>s(d.id),className:`flex items-center justify-center w-12 h-12 rounded-2xl transition-all duration-200 ${t===d.id?"text-[#21a1ce] bg-[#21a1ce] bg-opacity-15 shadow-lg scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:e.jsx("span",{className:"text-2xl",children:d.icon})},d.id))})})]})}var Zs;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Zs||(Zs={}));var xt;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(xt||(xt={}));const Ys=gs("StatusBar");function Wa(){return i.useEffect(()=>{if(ss.getPlatform()==="ios"){Ys.setOverlaysWebView({overlay:!1}).catch(()=>{}),Ys.setStyle({style:Zs.Dark}).catch(()=>{}),Ys.setBackgroundColor({color:"#21a1ce"}).catch(()=>{});try{const t={}.VITE_GOOGLE_IOS_CLIENT_ID;t&&Qs.initialize({google:{iOSClientId:t}}).then(()=>{console.log("[SocialLogin] Initialized with iOSClientId")}).catch(s=>{console.log("[SocialLogin] init error",s)})}catch{}}},[]),e.jsx(Ga,{})}Js.createRoot(document.getElementById("root")).render(e.jsx(js.StrictMode,{children:e.jsx(Wa,{})}));export{ft as W};
//# sourceMappingURL=index-a2d8b0f7.js.map
