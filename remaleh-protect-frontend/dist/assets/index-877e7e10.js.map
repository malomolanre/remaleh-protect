{"version":3,"mappings":"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","names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","ExceptionCode","CapacitorException","message","code","data","getPlatformId","win","_a","_b","createCapacitor","capCustomPlatform","cap","Plugins","getPlatform","isNativePlatform","isPluginAvailable","pluginName","plugin","registeredPlugins","getPluginHeader","handleError","err","registerPlugin","jsImplementations","registeredPlugin","platform","pluginHeader","jsImplementation","loadPluginImplementation","createPluginMethod","impl","prop","methodHeader","options","callback","createPluginMethodWrapper","remove","wrapper","args","fn","addListener","removeListener","addListenerNative","eventName","call","callbackId","resolve","proxy","_","filePath","initCapacitorGlobal","Capacitor","WebPlugin","listenerFunc","firstListener","windowListener","listener","retainUntilConsumed","listeners","windowEventName","pluginEventName","event","msg","index","handle","arg","encode","str","decode","CapacitorCookiesPluginWeb","cookies","cookieMap","cookie","key","value","encodedKey","encodedValue","expires","path","domain","error","readBlobAsBase64","blob","reject","reader","base64String","normalizeHttpHeaders","headers","originalKeys","acc","buildUrlParams","params","shouldEncode","accumulator","entry","item","buildRequestInit","extra","output","type","form","CapacitorHttpPluginWeb","requestInit","urlParams","url","response","contentType","responseType","CapacitorHttp","API","API_ENDPOINTS","apiCall","endpoint","token","defaultHeaders","defaultOptions","method","nativeResp","refreshToken","refreshResponse","access_token","friendly","ej","apiGet","apiPost","apiPut","apiDelete","api","rest","MobileCard","children","className","padding","shadow","hover","onClick","interactive","props","classes","Component","jsx","MobileCardHeader","MobileCardContent","MobileInput","label","helperText","fullWidth","inputClasses","MobileTextarea","rows","textareaClasses","MobileSelect","selectClasses","option","MobileSearchInput","placeholder","onSearch","query","setQuery","React","handleSubmit","jsxs","Button","variant","size","disabled","loading","baseClasses","variants","sizes","defaultAttributes","toKebabCase","string","createLucideIcon","iconName","iconNode","forwardRef","color","strokeWidth","absoluteStrokeWidth","ref","createElement","tag","attrs","createLucideIcon$1","AlertTriangle","ArrowLeft","BookOpen","CheckCircle","Eye","Flag","HelpCircle","HelpingHand","Key","Lock","Mail","MessageSquare","PenLine","Plus","RefreshCw","Save","Search","Shield","Star","ThumbsDown","ThumbsUp","Trash2","TrendingUp","Trophy","User","Users","X","DEFAULT_LENGTH","CHARSETS","getRandomValues","len","arr","buildAlphabet","opts","alphabet","generatePassword","length","requiredPools","out","pool","r","remaining","rv","i","idx","estimateEntropy","N","StrengthBar","bits","pct","PasswordGenerator","onUse","setLength","useState","setOpts","setValue","copied","setCopied","inputRef","useRef","entropy","useMemo","toggle","prev","handleGenerate","password","handleCopy","handleUse","enabled","CYBER_KB","useChatAssistant","chatMessages","setChatMessages","inputMessage","setInputMessage","isTyping","setIsTyping","chatError","setChatError","text","userMessage","messageToProcess","responseFound","source","lowercaseInput","keywords","kbResponse","kbSource","apiResponse","botMessage","errorMessage","ChatAssistant","setActiveTab","formatChatMessage","handleChatSubmit","scrollRef","useEffect","el","MobileButton","variantClasses","sizeClasses","widthClasses","useAuth","user","setUser","isAuthenticated","setIsAuthenticated","isLoading","setIsLoading","setError","refreshAuthToken","useCallback","responseData","newRefreshToken","checkAuth","userData","newUser","handler","login","email","refresh_token","errorData","apiMsg","register","resp","errorText","verifyEmail","verifiedUser","resendVerification","requestPasswordReset","logout","updateProfile","profileData","payload","parts","updatedUser","changePassword","currentPassword","newPassword","debugUserState","cloudinaryUnsignedUpload","file","cloudName","uploadPreset","folder","name","preset","res","id","moduleId","lessonId","FALLBACK_STORAGE_KEY","getAllModules","forceRefresh","fallbackData","getModuleById","getLessonById","module","getModuleProgress","localProgress","getOverallProgress","modules","completedModules","progress","getNextRecommendedLesson","overallProgress","_c","computeNextRecommendedLesson","completedSet","lessons","lesson","getLearningStats","total","searchLearningContent","results","searchTerm","getContentByDifficulty","difficulty","getQuickTips","tips","firstLesson","getContentUpdateInfo","createModule","moduleData","updateModule","deleteModule","addLesson","lessonData","uploadLessonMedia","updateLesson","deleteLesson","updateLessonProgress","progressData","updateProgress","exportContent","importContent","contentData","MobilePullToRefresh","onRefresh","threshold","isPulling","setIsPulling","pullDistance","setPullDistance","isRefreshing","setIsRefreshing","containerRef","startY","currentY","container","handleTouchStart","handleTouchMove","distance","handleTouchEnd","pullProgress","shouldShowIndicator","LearnHub","selectedModule","setSelectedModule","selectedLesson","setSelectedLesson","setSearchTerm","difficultyFilter","setDifficultyFilter","completedLessons","setCompletedLessons","setModules","setOverallProgress","nextLesson","setNextLesson","setLoading","getLessonTypeLabel","rawType","formatDuration","lower","num","loadData","modulesData","backendCompletedKeys","record","backendCompletedSet","frontendCompletedSet","newKeys","updatedKeys","markLessonComplete","lessonKeyPre","__vitePreload","contentManager","result","backendKey","lessonKey","updatedRecords","targetModuleId","targetLessonId","existingIndex","completedCount","totalLessons","percentage","next","refreshedProgress","localCompletedSet","mergedRecords","mIdStr","lIdStr","mId","lId","mergedCompletedCount","totalLessonsMerged","mergedPercentage","mergedProgress","fallbackKey","tentative","filteredModules","filtered","searchLower","LessonContent","_d","_f","_e","_h","_g","isCompleted","lessonCount","completedLessonsInModule","progressPercent","sanitizeHtml","html","safe","markdownToHtml","md","getContentStyle","style","renderContent","tip","sign","step","action","useCommunity","reports","setReports","trendingThreats","setTrendingThreats","communityStats","setCommunityStats","alerts","setAlerts","leaderboard","setLeaderboard","latestReports","setLatestReports","myStats","setMyStats","pagination","setPagination","hasMore","setHasMore","fetchReports","filters","append","queryParams","fetchTrendingThreats","fetchLatestReports","topTen","fetchReportById","reportId","fetchComments","page","per_page","deleteComment","commentId","fetchCommunityStats","fetchAlerts","fetchLeaderboard","period","qs","fetchMyStats","createReport","reportData","report","uploadReportMedia","fileOrUrl","uploaded","media","deleteReport","voteOnReport","voteType","updatedReport","verifyReport","verificationData","addComment","commentData","newComment","createAlert","alertData","alert","loadAllData","clearError","MobileModal","isOpen","onClose","title","showCloseButton","fullScreen","hideOnDesktop","handleEscape","Browser","App","SocialLogin","AppleSignIn","Login","onLoginSuccess","onSwitchToRegister","formData","setFormData","infoMsg","setInfoMsg","oauthLoading","setOauthLoading","deepLinkListenerRef","finalizeOAuthFromUrl","googleReversed","isAppScheme","isGoogleScheme","qsIndex","provider","state","apiBase","CapApp","handleChange","exchange","idTok","verify","accessTok","errText","ok","ar","possibleIdToken","body","CommunityHub","activeTab","setActiveTabLocal","showNewReport","setShowNewReport","newReport","setNewReport","newReportFiles","setNewReportFiles","isSubmitting","setIsSubmitting","toast","setToast","lightboxOpen","setLightboxOpen","lightboxImages","setLightboxImages","lightboxIndex","setLightboxIndex","commentsModalOpen","setCommentsModalOpen","commentsReport","setCommentsReport","commentsPage","setCommentsPage","commentsHasMore","setCommentsHasMore","commentTexts","setCommentTexts","pointsPeriod","setPointsPeriod","myStatusFilter","setMyStatusFilter","searchQuery","setSearchQuery","filterThreatType","setFilterThreatType","filterUrgency","setFilterUrgency","verifiedOnly","setVerifiedOnly","handleScroll","nextPage","filteredFeedReports","matchesSearch","matchesType","matchesUrgency","matchesVerified","resolveMediaUrl","isImageMedia","isVideoMedia","openLightbox","mediaList","startIndex","images","handleViewAllComments","handleLoadMoreComments","handleDeleteComment","tabs","v","tierRaw","t","hasTier","gridCols","badgeBg","iconColor","iconEl","isLastAndExtra","extraCount","src","fallback","opt","Fragment","tab","Icon","up","CommunityReporting","showNewAlert","setShowNewAlert","newAlert","setNewAlert","commentText","setCommentText","filteredReports","handleSubmitReport","handleSubmitAlert","handleVote","handleVerify","handleAddComment","isAuthError","threat","comment","Textarea","USER_ENDPOINTS","getAllUsers","getDeletedUsers","updateUserStatus","userId","newStatus","updateUserRole","newRole","updateUserInfo","updateUserPassword","deleteUser","hardDeleteUser","createUser","getUserStats","users","u","restoreUser","CommunityReports","initialFilters","bulkErrors","setBulkErrors","selectedReports","setSelectedReports","showReportModal","setShowReportModal","selectedReport","setSelectedReport","showBulkModal","setShowBulkModal","bulkAction","setBulkAction","setFilters","handleReportAction","actionMap","mapped","errData","handleBulkAction","exists","failed","x","succeeded","handleReportSelect","handleSelectAll","updateFilters","newFilters","ReportRow","ReportDetailModal","reporterObj","reporterName","reporterTier","BulkActionModal","AdminDashboard","authLoading","activeSection","setActiveSection","showAddModule","setShowAddModule","showAddUser","setShowAddUser","editingModule","setEditingModule","editingUser","setEditingUser","actionLoading","setActionLoading","loadingUsers","setLoadingUsers","newModuleData","setNewModuleData","newUserData","setNewUserData","setUsers","deletedUsers","setDeletedUsers","userStats","setUserStats","dbConnectionStatus","setDbConnectionStatus","selectedDeletedUserIds","setSelectedDeletedUserIds","isDeletedUserSelected","toggleDeletedUserSelected","selectAllDeletedUsersOnPage","pageIds","allSelected","clearDeletedSelection","selectedUserIds","setSelectedUserIds","bulkActionType","setBulkActionType","bulkActionValue","setBulkActionValue","isUserSelected","toggleUserSelected","selectAllUsersOnPage","clearBulkSelection","handleBulkApply","loadUsers","loadDeletedUsers","summary","adminStats","setAdminStats","selectedModuleForLessons","setSelectedModuleForLessons","newLessonData","setNewLessonData","editingLesson","setEditingLesson","lessonActionLoading","setLessonActionLoading","lessonSuccessMessage","setLessonSuccessMessage","forceUpdate","setForceUpdate","timer","loadModules","usersData","deletedUsersData","loadUserStats","statsData","handleCreateModule","handleDeleteModule","handleUpdateUserStatus","handleUpdateUserRole","handleDeleteUser","handleRestoreUser","handleBulkRestoreDeleted","handleCreateUser","handleUpdateUser","userToUpdate","updatePromises","basicInfo","errors","handleUpdateModule","moduleToUpdate","handleAddLesson","updatedModules","updatedModule","_j","_i","handleUpdateLesson","handleDeleteLesson","checkDatabaseConnection","renderOverview","renderContentManagement","Edit3","renderUserManagement","renderDeletedUsers","ProfileSettings","isEditing","setIsEditing","isChangingPassword","setIsChangingPassword","passwordData","setPasswordData","handleInputChange","handlePasswordChange","handleSaveProfile","handleChangePassword","Register","onRegisterSuccess","onSwitchToLogin","formErrors","setFormErrors","needsVerification","setNeedsVerification","verificationCode","setVerificationCode","verifyMsg","setVerifyMsg","validateForm","greeting","setGreeting","blogItems","setBlogItems","breachEmail","setBreachEmail","breachResult","setBreachResult","isChecking","setIsChecking","breachError","setBreachError","showPasswordGenerator","setShowPasswordGenerator","showProfileDropdown","setShowProfileDropdown","forwardingAddress","setForwardingAddress","copiedForward","setCopiedForward","recentScans","setRecentScans","handleGlobalLogout","oauth","access","refresh","hour","loadScans","feedUrl","proxies","xmlText","make","doc","rssChannel","entries","pick","sel","items","link","linkEl","pubDate","desc","excerpt","img","imgInHtml","formatDate","dateStr","getUserInitials","names","handleProfileClick","handleLogout","handleClickOutside","handleEscapeKey","handleBreachCheck","handlePasswordUse","scamInput","setScamInput","scamType","setScamType","scamResult","setScamResult","isAnalyzing","setIsAnalyzing","scamError","setScamError","handleScamAnalysis","analysis","detectedContentType","contentTypeNote","urlPattern","containsUrls","analyzeLink","analyzeMessage","emailPattern","containsEmailHeaders","analyzeEmail","analyzeScamContent","emailContent","generateEmailRecommendations","riskLevel","indicators","recommendations","ind","messageContent","generateEnhancedRecommendations","patterns","rec","content","riskScore","pattern","matches","generateRecommendations","post","breach","indicator","count","category","Style","Animation","StatusBar","Root","googleClientId","ReactDOM"],"sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../node_modules/@capacitor/core/dist/index.js","../../src/lib/api.js","../../src/components/ui/mobile-card.jsx","../../src/components/ui/mobile-input.jsx","../../src/components/ui/button.jsx","../../node_modules/lucide-react/dist/esm/defaultAttributes.mjs","../../node_modules/lucide-react/dist/esm/createLucideIcon.mjs","../../node_modules/lucide-react/dist/esm/icons/alert-triangle.mjs","../../node_modules/lucide-react/dist/esm/icons/arrow-left.mjs","../../node_modules/lucide-react/dist/esm/icons/book-open.mjs","../../node_modules/lucide-react/dist/esm/icons/check-circle.mjs","../../node_modules/lucide-react/dist/esm/icons/eye.mjs","../../node_modules/lucide-react/dist/esm/icons/flag.mjs","../../node_modules/lucide-react/dist/esm/icons/help-circle.mjs","../../node_modules/lucide-react/dist/esm/icons/helping-hand.mjs","../../node_modules/lucide-react/dist/esm/icons/key.mjs","../../node_modules/lucide-react/dist/esm/icons/lock.mjs","../../node_modules/lucide-react/dist/esm/icons/mail.mjs","../../node_modules/lucide-react/dist/esm/icons/message-square.mjs","../../node_modules/lucide-react/dist/esm/icons/pen-line.mjs","../../node_modules/lucide-react/dist/esm/icons/plus.mjs","../../node_modules/lucide-react/dist/esm/icons/refresh-cw.mjs","../../node_modules/lucide-react/dist/esm/icons/save.mjs","../../node_modules/lucide-react/dist/esm/icons/search.mjs","../../node_modules/lucide-react/dist/esm/icons/shield.mjs","../../node_modules/lucide-react/dist/esm/icons/star.mjs","../../node_modules/lucide-react/dist/esm/icons/thumbs-down.mjs","../../node_modules/lucide-react/dist/esm/icons/thumbs-up.mjs","../../node_modules/lucide-react/dist/esm/icons/trash-2.mjs","../../node_modules/lucide-react/dist/esm/icons/trending-up.mjs","../../node_modules/lucide-react/dist/esm/icons/trophy.mjs","../../node_modules/lucide-react/dist/esm/icons/user.mjs","../../node_modules/lucide-react/dist/esm/icons/users.mjs","../../node_modules/lucide-react/dist/esm/icons/x.mjs","../../src/components/PasswordGenerator.jsx","../../src/hooks/useChatAssistant.js","../../src/components/ChatAssistant.jsx","../../src/components/ui/mobile-button.jsx","../../src/hooks/useAuth.js","../../src/lib/utils.js","../../src/utils/contentManager.js","../../src/components/MobilePullToRefresh.jsx","../../src/components/LearnHub.jsx","../../src/hooks/useCommunity.js","../../src/components/MobileModal.jsx","../../node_modules/@capacitor/browser/dist/esm/index.js","../../node_modules/@capacitor/app/dist/esm/index.js","../../node_modules/@capgo/capacitor-social-login/dist/esm/index.js","../../src/components/Login.jsx","../../src/components/CommunityHub.jsx","../../src/components/CommunityReporting.jsx","../../src/components/ui/textarea.jsx","../../src/utils/userManager.js","../../src/components/admin/CommunityReports.jsx","../../src/components/admin/AdminDashboard.jsx","../../src/components/ProfileSettings.jsx","../../src/components/Register.jsx","../../src/App.jsx","../../node_modules/@capacitor/status-bar/dist/esm/definitions.js","../../node_modules/@capacitor/status-bar/dist/esm/index.js","../../src/main.jsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","/*! Capacitor: https://capacitorjs.com/ - MIT License */\nvar ExceptionCode;\n(function (ExceptionCode) {\n    /**\n     * API is not implemented.\n     *\n     * This usually means the API can't be used because it is not implemented for\n     * the current platform.\n     */\n    ExceptionCode[\"Unimplemented\"] = \"UNIMPLEMENTED\";\n    /**\n     * API is not available.\n     *\n     * This means the API can't be used right now because:\n     *   - it is currently missing a prerequisite, such as network connectivity\n     *   - it requires a particular platform or browser version\n     */\n    ExceptionCode[\"Unavailable\"] = \"UNAVAILABLE\";\n})(ExceptionCode || (ExceptionCode = {}));\nclass CapacitorException extends Error {\n    constructor(message, code, data) {\n        super(message);\n        this.message = message;\n        this.code = code;\n        this.data = data;\n    }\n}\nconst getPlatformId = (win) => {\n    var _a, _b;\n    if (win === null || win === void 0 ? void 0 : win.androidBridge) {\n        return 'android';\n    }\n    else if ((_b = (_a = win === null || win === void 0 ? void 0 : win.webkit) === null || _a === void 0 ? void 0 : _a.messageHandlers) === null || _b === void 0 ? void 0 : _b.bridge) {\n        return 'ios';\n    }\n    else {\n        return 'web';\n    }\n};\n\nconst createCapacitor = (win) => {\n    const capCustomPlatform = win.CapacitorCustomPlatform || null;\n    const cap = win.Capacitor || {};\n    const Plugins = (cap.Plugins = cap.Plugins || {});\n    const getPlatform = () => {\n        return capCustomPlatform !== null ? capCustomPlatform.name : getPlatformId(win);\n    };\n    const isNativePlatform = () => getPlatform() !== 'web';\n    const isPluginAvailable = (pluginName) => {\n        const plugin = registeredPlugins.get(pluginName);\n        if (plugin === null || plugin === void 0 ? void 0 : plugin.platforms.has(getPlatform())) {\n            // JS implementation available for the current platform.\n            return true;\n        }\n        if (getPluginHeader(pluginName)) {\n            // Native implementation available.\n            return true;\n        }\n        return false;\n    };\n    const getPluginHeader = (pluginName) => { var _a; return (_a = cap.PluginHeaders) === null || _a === void 0 ? void 0 : _a.find((h) => h.name === pluginName); };\n    const handleError = (err) => win.console.error(err);\n    const registeredPlugins = new Map();\n    const registerPlugin = (pluginName, jsImplementations = {}) => {\n        const registeredPlugin = registeredPlugins.get(pluginName);\n        if (registeredPlugin) {\n            console.warn(`Capacitor plugin \"${pluginName}\" already registered. Cannot register plugins twice.`);\n            return registeredPlugin.proxy;\n        }\n        const platform = getPlatform();\n        const pluginHeader = getPluginHeader(pluginName);\n        let jsImplementation;\n        const loadPluginImplementation = async () => {\n            if (!jsImplementation && platform in jsImplementations) {\n                jsImplementation =\n                    typeof jsImplementations[platform] === 'function'\n                        ? (jsImplementation = await jsImplementations[platform]())\n                        : (jsImplementation = jsImplementations[platform]);\n            }\n            else if (capCustomPlatform !== null && !jsImplementation && 'web' in jsImplementations) {\n                jsImplementation =\n                    typeof jsImplementations['web'] === 'function'\n                        ? (jsImplementation = await jsImplementations['web']())\n                        : (jsImplementation = jsImplementations['web']);\n            }\n            return jsImplementation;\n        };\n        const createPluginMethod = (impl, prop) => {\n            var _a, _b;\n            if (pluginHeader) {\n                const methodHeader = pluginHeader === null || pluginHeader === void 0 ? void 0 : pluginHeader.methods.find((m) => prop === m.name);\n                if (methodHeader) {\n                    if (methodHeader.rtype === 'promise') {\n                        return (options) => cap.nativePromise(pluginName, prop.toString(), options);\n                    }\n                    else {\n                        return (options, callback) => cap.nativeCallback(pluginName, prop.toString(), options, callback);\n                    }\n                }\n                else if (impl) {\n                    return (_a = impl[prop]) === null || _a === void 0 ? void 0 : _a.bind(impl);\n                }\n            }\n            else if (impl) {\n                return (_b = impl[prop]) === null || _b === void 0 ? void 0 : _b.bind(impl);\n            }\n            else {\n                throw new CapacitorException(`\"${pluginName}\" plugin is not implemented on ${platform}`, ExceptionCode.Unimplemented);\n            }\n        };\n        const createPluginMethodWrapper = (prop) => {\n            let remove;\n            const wrapper = (...args) => {\n                const p = loadPluginImplementation().then((impl) => {\n                    const fn = createPluginMethod(impl, prop);\n                    if (fn) {\n                        const p = fn(...args);\n                        remove = p === null || p === void 0 ? void 0 : p.remove;\n                        return p;\n                    }\n                    else {\n                        throw new CapacitorException(`\"${pluginName}.${prop}()\" is not implemented on ${platform}`, ExceptionCode.Unimplemented);\n                    }\n                });\n                if (prop === 'addListener') {\n                    p.remove = async () => remove();\n                }\n                return p;\n            };\n            // Some flair ✨\n            wrapper.toString = () => `${prop.toString()}() { [capacitor code] }`;\n            Object.defineProperty(wrapper, 'name', {\n                value: prop,\n                writable: false,\n                configurable: false,\n            });\n            return wrapper;\n        };\n        const addListener = createPluginMethodWrapper('addListener');\n        const removeListener = createPluginMethodWrapper('removeListener');\n        const addListenerNative = (eventName, callback) => {\n            const call = addListener({ eventName }, callback);\n            const remove = async () => {\n                const callbackId = await call;\n                removeListener({\n                    eventName,\n                    callbackId,\n                }, callback);\n            };\n            const p = new Promise((resolve) => call.then(() => resolve({ remove })));\n            p.remove = async () => {\n                console.warn(`Using addListener() without 'await' is deprecated.`);\n                await remove();\n            };\n            return p;\n        };\n        const proxy = new Proxy({}, {\n            get(_, prop) {\n                switch (prop) {\n                    // https://github.com/facebook/react/issues/20030\n                    case '$$typeof':\n                        return undefined;\n                    case 'toJSON':\n                        return () => ({});\n                    case 'addListener':\n                        return pluginHeader ? addListenerNative : addListener;\n                    case 'removeListener':\n                        return removeListener;\n                    default:\n                        return createPluginMethodWrapper(prop);\n                }\n            },\n        });\n        Plugins[pluginName] = proxy;\n        registeredPlugins.set(pluginName, {\n            name: pluginName,\n            proxy,\n            platforms: new Set([...Object.keys(jsImplementations), ...(pluginHeader ? [platform] : [])]),\n        });\n        return proxy;\n    };\n    // Add in convertFileSrc for web, it will already be available in native context\n    if (!cap.convertFileSrc) {\n        cap.convertFileSrc = (filePath) => filePath;\n    }\n    cap.getPlatform = getPlatform;\n    cap.handleError = handleError;\n    cap.isNativePlatform = isNativePlatform;\n    cap.isPluginAvailable = isPluginAvailable;\n    cap.registerPlugin = registerPlugin;\n    cap.Exception = CapacitorException;\n    cap.DEBUG = !!cap.DEBUG;\n    cap.isLoggingEnabled = !!cap.isLoggingEnabled;\n    return cap;\n};\nconst initCapacitorGlobal = (win) => (win.Capacitor = createCapacitor(win));\n\nconst Capacitor = /*#__PURE__*/ initCapacitorGlobal(typeof globalThis !== 'undefined'\n    ? globalThis\n    : typeof self !== 'undefined'\n        ? self\n        : typeof window !== 'undefined'\n            ? window\n            : typeof global !== 'undefined'\n                ? global\n                : {});\nconst registerPlugin = Capacitor.registerPlugin;\n\n/**\n * Base class web plugins should extend.\n */\nclass WebPlugin {\n    constructor() {\n        this.listeners = {};\n        this.retainedEventArguments = {};\n        this.windowListeners = {};\n    }\n    addListener(eventName, listenerFunc) {\n        let firstListener = false;\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            this.listeners[eventName] = [];\n            firstListener = true;\n        }\n        this.listeners[eventName].push(listenerFunc);\n        // If we haven't added a window listener for this event and it requires one,\n        // go ahead and add it\n        const windowListener = this.windowListeners[eventName];\n        if (windowListener && !windowListener.registered) {\n            this.addWindowListener(windowListener);\n        }\n        if (firstListener) {\n            this.sendRetainedArgumentsForEvent(eventName);\n        }\n        const remove = async () => this.removeListener(eventName, listenerFunc);\n        const p = Promise.resolve({ remove });\n        return p;\n    }\n    async removeAllListeners() {\n        this.listeners = {};\n        for (const listener in this.windowListeners) {\n            this.removeWindowListener(this.windowListeners[listener]);\n        }\n        this.windowListeners = {};\n    }\n    notifyListeners(eventName, data, retainUntilConsumed) {\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            if (retainUntilConsumed) {\n                let args = this.retainedEventArguments[eventName];\n                if (!args) {\n                    args = [];\n                }\n                args.push(data);\n                this.retainedEventArguments[eventName] = args;\n            }\n            return;\n        }\n        listeners.forEach((listener) => listener(data));\n    }\n    hasListeners(eventName) {\n        var _a;\n        return !!((_a = this.listeners[eventName]) === null || _a === void 0 ? void 0 : _a.length);\n    }\n    registerWindowListener(windowEventName, pluginEventName) {\n        this.windowListeners[pluginEventName] = {\n            registered: false,\n            windowEventName,\n            pluginEventName,\n            handler: (event) => {\n                this.notifyListeners(pluginEventName, event);\n            },\n        };\n    }\n    unimplemented(msg = 'not implemented') {\n        return new Capacitor.Exception(msg, ExceptionCode.Unimplemented);\n    }\n    unavailable(msg = 'not available') {\n        return new Capacitor.Exception(msg, ExceptionCode.Unavailable);\n    }\n    async removeListener(eventName, listenerFunc) {\n        const listeners = this.listeners[eventName];\n        if (!listeners) {\n            return;\n        }\n        const index = listeners.indexOf(listenerFunc);\n        this.listeners[eventName].splice(index, 1);\n        // If there are no more listeners for this type of event,\n        // remove the window listener\n        if (!this.listeners[eventName].length) {\n            this.removeWindowListener(this.windowListeners[eventName]);\n        }\n    }\n    addWindowListener(handle) {\n        window.addEventListener(handle.windowEventName, handle.handler);\n        handle.registered = true;\n    }\n    removeWindowListener(handle) {\n        if (!handle) {\n            return;\n        }\n        window.removeEventListener(handle.windowEventName, handle.handler);\n        handle.registered = false;\n    }\n    sendRetainedArgumentsForEvent(eventName) {\n        const args = this.retainedEventArguments[eventName];\n        if (!args) {\n            return;\n        }\n        delete this.retainedEventArguments[eventName];\n        args.forEach((arg) => {\n            this.notifyListeners(eventName, arg);\n        });\n    }\n}\n\nconst WebView = /*#__PURE__*/ registerPlugin('WebView');\n/******** END WEB VIEW PLUGIN ********/\n/******** COOKIES PLUGIN ********/\n/**\n * Safely web encode a string value (inspired by js-cookie)\n * @param str The string value to encode\n */\nconst encode = (str) => encodeURIComponent(str)\n    .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n    .replace(/[()]/g, escape);\n/**\n * Safely web decode a string value (inspired by js-cookie)\n * @param str The string value to decode\n */\nconst decode = (str) => str.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent);\nclass CapacitorCookiesPluginWeb extends WebPlugin {\n    async getCookies() {\n        const cookies = document.cookie;\n        const cookieMap = {};\n        cookies.split(';').forEach((cookie) => {\n            if (cookie.length <= 0)\n                return;\n            // Replace first \"=\" with CAP_COOKIE to prevent splitting on additional \"=\"\n            let [key, value] = cookie.replace(/=/, 'CAP_COOKIE').split('CAP_COOKIE');\n            key = decode(key).trim();\n            value = decode(value).trim();\n            cookieMap[key] = value;\n        });\n        return cookieMap;\n    }\n    async setCookie(options) {\n        try {\n            // Safely Encoded Key/Value\n            const encodedKey = encode(options.key);\n            const encodedValue = encode(options.value);\n            // Clean & sanitize options\n            const expires = `; expires=${(options.expires || '').replace('expires=', '')}`; // Default is \"; expires=\"\n            const path = (options.path || '/').replace('path=', ''); // Default is \"path=/\"\n            const domain = options.url != null && options.url.length > 0 ? `domain=${options.url}` : '';\n            document.cookie = `${encodedKey}=${encodedValue || ''}${expires}; path=${path}; ${domain};`;\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async deleteCookie(options) {\n        try {\n            document.cookie = `${options.key}=; Max-Age=0`;\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async clearCookies() {\n        try {\n            const cookies = document.cookie.split(';') || [];\n            for (const cookie of cookies) {\n                document.cookie = cookie.replace(/^ +/, '').replace(/=.*/, `=;expires=${new Date().toUTCString()};path=/`);\n            }\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n    async clearAllCookies() {\n        try {\n            await this.clearCookies();\n        }\n        catch (error) {\n            return Promise.reject(error);\n        }\n    }\n}\nconst CapacitorCookies = registerPlugin('CapacitorCookies', {\n    web: () => new CapacitorCookiesPluginWeb(),\n});\n// UTILITY FUNCTIONS\n/**\n * Read in a Blob value and return it as a base64 string\n * @param blob The blob value to convert to a base64 string\n */\nconst readBlobAsBase64 = async (blob) => new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n        const base64String = reader.result;\n        // remove prefix \"data:application/pdf;base64,\"\n        resolve(base64String.indexOf(',') >= 0 ? base64String.split(',')[1] : base64String);\n    };\n    reader.onerror = (error) => reject(error);\n    reader.readAsDataURL(blob);\n});\n/**\n * Normalize an HttpHeaders map by lowercasing all of the values\n * @param headers The HttpHeaders object to normalize\n */\nconst normalizeHttpHeaders = (headers = {}) => {\n    const originalKeys = Object.keys(headers);\n    const loweredKeys = Object.keys(headers).map((k) => k.toLocaleLowerCase());\n    const normalized = loweredKeys.reduce((acc, key, index) => {\n        acc[key] = headers[originalKeys[index]];\n        return acc;\n    }, {});\n    return normalized;\n};\n/**\n * Builds a string of url parameters that\n * @param params A map of url parameters\n * @param shouldEncode true if you should encodeURIComponent() the values (true by default)\n */\nconst buildUrlParams = (params, shouldEncode = true) => {\n    if (!params)\n        return null;\n    const output = Object.entries(params).reduce((accumulator, entry) => {\n        const [key, value] = entry;\n        let encodedValue;\n        let item;\n        if (Array.isArray(value)) {\n            item = '';\n            value.forEach((str) => {\n                encodedValue = shouldEncode ? encodeURIComponent(str) : str;\n                item += `${key}=${encodedValue}&`;\n            });\n            // last character will always be \"&\" so slice it off\n            item.slice(0, -1);\n        }\n        else {\n            encodedValue = shouldEncode ? encodeURIComponent(value) : value;\n            item = `${key}=${encodedValue}`;\n        }\n        return `${accumulator}&${item}`;\n    }, '');\n    // Remove initial \"&\" from the reduce\n    return output.substr(1);\n};\n/**\n * Build the RequestInit object based on the options passed into the initial request\n * @param options The Http plugin options\n * @param extra Any extra RequestInit values\n */\nconst buildRequestInit = (options, extra = {}) => {\n    const output = Object.assign({ method: options.method || 'GET', headers: options.headers }, extra);\n    // Get the content-type\n    const headers = normalizeHttpHeaders(options.headers);\n    const type = headers['content-type'] || '';\n    // If body is already a string, then pass it through as-is.\n    if (typeof options.data === 'string') {\n        output.body = options.data;\n    }\n    // Build request initializers based off of content-type\n    else if (type.includes('application/x-www-form-urlencoded')) {\n        const params = new URLSearchParams();\n        for (const [key, value] of Object.entries(options.data || {})) {\n            params.set(key, value);\n        }\n        output.body = params.toString();\n    }\n    else if (type.includes('multipart/form-data') || options.data instanceof FormData) {\n        const form = new FormData();\n        if (options.data instanceof FormData) {\n            options.data.forEach((value, key) => {\n                form.append(key, value);\n            });\n        }\n        else {\n            for (const key of Object.keys(options.data)) {\n                form.append(key, options.data[key]);\n            }\n        }\n        output.body = form;\n        const headers = new Headers(output.headers);\n        headers.delete('content-type'); // content-type will be set by `window.fetch` to includy boundary\n        output.headers = headers;\n    }\n    else if (type.includes('application/json') || typeof options.data === 'object') {\n        output.body = JSON.stringify(options.data);\n    }\n    return output;\n};\n// WEB IMPLEMENTATION\nclass CapacitorHttpPluginWeb extends WebPlugin {\n    /**\n     * Perform an Http request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async request(options) {\n        const requestInit = buildRequestInit(options, options.webFetchExtra);\n        const urlParams = buildUrlParams(options.params, options.shouldEncodeUrlParams);\n        const url = urlParams ? `${options.url}?${urlParams}` : options.url;\n        const response = await fetch(url, requestInit);\n        const contentType = response.headers.get('content-type') || '';\n        // Default to 'text' responseType so no parsing happens\n        let { responseType = 'text' } = response.ok ? options : {};\n        // If the response content-type is json, force the response to be json\n        if (contentType.includes('application/json')) {\n            responseType = 'json';\n        }\n        let data;\n        let blob;\n        switch (responseType) {\n            case 'arraybuffer':\n            case 'blob':\n                blob = await response.blob();\n                data = await readBlobAsBase64(blob);\n                break;\n            case 'json':\n                data = await response.json();\n                break;\n            case 'document':\n            case 'text':\n            default:\n                data = await response.text();\n        }\n        // Convert fetch headers to Capacitor HttpHeaders\n        const headers = {};\n        response.headers.forEach((value, key) => {\n            headers[key] = value;\n        });\n        return {\n            data,\n            headers,\n            status: response.status,\n            url: response.url,\n        };\n    }\n    /**\n     * Perform an Http GET request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async get(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'GET' }));\n    }\n    /**\n     * Perform an Http POST request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async post(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'POST' }));\n    }\n    /**\n     * Perform an Http PUT request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async put(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'PUT' }));\n    }\n    /**\n     * Perform an Http PATCH request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async patch(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'PATCH' }));\n    }\n    /**\n     * Perform an Http DELETE request given a set of options\n     * @param options Options to build the HTTP request\n     */\n    async delete(options) {\n        return this.request(Object.assign(Object.assign({}, options), { method: 'DELETE' }));\n    }\n}\nconst CapacitorHttp = registerPlugin('CapacitorHttp', {\n    web: () => new CapacitorHttpPluginWeb(),\n});\n/******** END HTTP PLUGIN ********/\n\nexport { Capacitor, CapacitorCookies, CapacitorException, CapacitorHttp, ExceptionCode, WebPlugin, WebView, buildRequestInit, registerPlugin };\n//# sourceMappingURL=index.js.map\n","// Central API base for all fetch calls.\nimport { Capacitor, CapacitorHttp } from '@capacitor/core'\nexport const API = import.meta.env.VITE_API_BASE || import.meta.env.VITE_API_URL || \"https://api.remalehprotect.remaleh.com.au\";\n\n// Log the API base URL for debugging (remove in production)\nif (import.meta.env.DEV) {\n  console.log('🌐 API Configuration - API Base URL:', API);\n  console.log('🌐 API Configuration - Environment Variables:', {\n    VITE_API_BASE: import.meta.env.VITE_API_BASE,\n    VITE_API_URL: import.meta.env.VITE_API_URL,\n    NODE_ENV: import.meta.env.NODE_ENV,\n    MODE: import.meta.env.MODE\n  });\n} else {\n  console.log('🌐 API Configuration - Production API Base URL:', API);\n}\n\n// API endpoints for all features\nexport const API_ENDPOINTS = {\n  // Authentication\n  AUTH: {\n    REGISTER: '/api/auth/register',\n    LOGIN: '/api/auth/login',\n    PROFILE: '/api/auth/profile',\n    REFRESH: '/api/auth/refresh',\n    LOGOUT: '/api/auth/logout',\n    CHANGE_PASSWORD: '/api/auth/change-password',\n    VERIFY_EMAIL: '/api/auth/verify-email',\n    RESEND_VERIFICATION: '/api/auth/resend-verification',\n    REQUEST_PASSWORD_RESET: '/api/auth/request-password-reset'\n  },\n  \n  // Admin\n  ADMIN: {\n    USERS: '/api/admin/users',\n    CREATE_USER: '/api/admin/users',\n    USER_DETAILS: '/api/admin/users',\n    USER_UPDATE: '/api/admin/users',\n    USER_SUSPEND: '/api/admin/users',\n    USER_ACTIVATE: '/api/admin/users',\n    USER_DELETE: '/api/admin/users',\n    USER_RESET_PASSWORD: '/api/admin/users',\n    BULK_ACTION: '/api/admin/users/bulk-action',\n    BULK_RESET_PASSWORD: '/api/admin/users/bulk-reset-password',\n    DASHBOARD: '/api/admin/dashboard',\n    MAINTENANCE: '/api/admin/maintenance',\n    COMMUNITY_REPORTS: '/api/admin/community-reports',\n    COMMUNITY_REPORTS_VERIFY: '/api/admin/community-reports',\n    COMMUNITY_REPORTS_REJECT: '/api/admin/community-reports',\n    COMMUNITY_REPORTS_ESCALATE: '/api/admin/community-reports',\n    COMMUNITY_REPORTS_DELETE: '/api/admin/community-reports',\n    COMMUNITY_REPORTS_BULK_ACTION: '/api/admin/community-reports/bulk-action'\n  },\n  \n  // Threat Intelligence\n  THREAT_INTELLIGENCE: {\n    DASHBOARD: '/api/threat_intelligence/dashboard',\n    THREATS: '/api/threat_intelligence/threats',\n    ALERTS: '/api/threat_intelligence/alerts',\n    TRENDS: '/api/threat_intelligence/stats/trends'\n  },\n  \n  // Risk Profile\n  RISK_PROFILE: {\n    PROFILE: '/api/risk_profile/profile',\n    SCANS: '/api/risk_profile/scans',\n    LEARNING: '/api/risk_profile/learning/modules',\n    RECOMMENDATIONS: '/api/risk_profile/recommendations'\n  },\n  \n  // Learning Content\n  LEARNING: {\n    MODULES: '/api/learning/modules',\n    PROGRESS: '/api/learning/progress',\n    NEXT_LESSON: '/api/learning/next-lesson'\n  },\n  \n\n  \n  // Community\n  COMMUNITY: {\n    REPORTS: '/api/community/reports',\n    TRENDING: '/api/community/trending',\n    STATS: '/api/community/stats',\n    ALERTS: '/api/community/alerts',\n    LEADERBOARD: '/api/community/leaderboard',\n    MY_STATS: '/api/community/my-stats'\n  },\n  // Public\n  PUBLIC: {\n    BLOG_FEED: '/api/public/blog-feed'\n  },\n  \n  // Existing endpoints\n  SCAM: '/api/scam/comprehensive',\n  BREACH: '/api/breach/check',\n  LINK: '/api/link/analyze',\n  CHAT: '/api/chat/'\n};\n\n// Helper function to make authenticated API calls\nexport const apiCall = async (endpoint, options = {}) => {\n  const token = localStorage.getItem('authToken');\n  \n  console.log('🌐 API Call - Endpoint:', endpoint);\n  console.log('🌐 API Call - Token present:', !!token);\n  console.log('🌐 API Call - Token value:', token ? `${token.substring(0, 20)}...` : 'None');\n  \n  const defaultHeaders = {\n    'Content-Type': 'application/json',\n    ...(token && { 'Authorization': `Bearer ${token}` })\n  }\n  const defaultOptions = { headers: defaultHeaders, ...options }\n\n  console.log('🌐 API Call - Request headers:', defaultOptions.headers);\n  console.log('🌐 API Call - Full URL:', `${API}${endpoint}`);\n\n  try {\n    // Use native HTTP on mobile to bypass CORS preflight limitations\n    let response\n    if (Capacitor && Capacitor.getPlatform() !== 'web') {\n      const method = (defaultOptions.method || 'GET').toUpperCase()\n      const data = defaultOptions.body ? JSON.parse(defaultOptions.body) : undefined\n      const nativeResp = await CapacitorHttp.request({\n        url: `${API}${endpoint}`,\n        method,\n        headers: defaultHeaders,\n        data\n      })\n      // Normalize to Fetch-like Response shim\n      response = {\n        ok: nativeResp.status >= 200 && nativeResp.status < 300,\n        status: nativeResp.status,\n        headers: new Map(Object.entries(nativeResp.headers || {})),\n        json: async () => nativeResp.data,\n        text: async () => (typeof nativeResp.data === 'string' ? nativeResp.data : JSON.stringify(nativeResp.data))\n      }\n    } else {\n      response = await fetch(`${API}${endpoint}`, defaultOptions);\n    }\n    console.log('🌐 API Call - Response status:', response.status);\n    console.log('🌐 API Call - Response headers:', Object.fromEntries(response.headers.entries()));\n    \n    if (!response.ok) {\n      if (response.status === 401) {\n        console.log('🌐 API Call - 401 Unauthorized, attempting token refresh...');\n        // Token expired, try to refresh\n        const refreshToken = localStorage.getItem('refreshToken');\n        if (refreshToken) {\n          console.log('🌐 API Call - Refresh token found, attempting refresh...');\n          const refreshResponse = await fetch(`${API}${API_ENDPOINTS.AUTH.REFRESH}`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ refresh_token: refreshToken })\n          });\n          \n          if (refreshResponse.ok) {\n            const { access_token } = await refreshResponse.json();\n            console.log('🌐 API Call - Token refresh successful, retrying request...');\n            localStorage.setItem('authToken', access_token);\n            \n            // Retry original request with new token\n            defaultOptions.headers.Authorization = `Bearer ${access_token}`;\n            const retryResponse = await fetch(`${API}${endpoint}`, defaultOptions);\n            return retryResponse;\n          } else {\n            console.log('🌐 API Call - Token refresh failed, removing tokens');\n          }\n        }\n        // Redirect to login if refresh fails\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('refreshToken');\n        // Don't redirect - let the component handle authentication failures\n        // window.location.href = '/login';\n      }\n      // Convert to friendly message\n      let friendly = 'Something went wrong. Please try again.';\n      try {\n        const ej = await response.json();\n        const msg = ej && (ej.error || ej.message);\n        if (msg) friendly = msg;\n      } catch (_) {}\n      throw new Error(friendly);\n    }\n    \n    return response;\n  } catch (error) {\n    console.error('🌐 API Call - Request failed:', error);\n    throw error;\n  }\n};\n\n// Helper function for GET requests\nexport const apiGet = (endpoint) => apiCall(endpoint, { method: 'GET' });\n\n// Helper function for POST requests\nexport const apiPost = (endpoint, data) => apiCall(endpoint, {\n  method: 'POST',\n  body: JSON.stringify(data)\n});\n\n// Helper function for PUT requests\nexport const apiPut = (endpoint, data) => {\n  console.log('🔧 apiPut called with:', { endpoint, data })\n  console.log('🔧 HTTP method will be: PUT')\n  \n  return apiCall(endpoint, {\n    method: 'PUT',\n    body: JSON.stringify(data)\n  })\n};\n\n// Helper function for DELETE requests\nexport const apiDelete = (endpoint) => apiCall(endpoint, { method: 'DELETE' });\n\n// Create a unified API object for admin components\nexport const api = {\n  get: (endpoint) => apiGet(endpoint),\n  post: (endpoint, data) => apiPost(endpoint, data),\n  put: (endpoint, data) => apiPut(endpoint, data),\n  delete: (endpoint) => apiDelete(endpoint),\n  request: (options) => {\n    const { method = 'GET', url, data, ...rest } = options;\n    if (method === 'GET') {\n      return apiGet(url);\n    } else if (method === 'POST') {\n      return apiPost(url, data);\n    } else if (method === 'PUT') {\n      return apiPut(url, data);\n    } else if (method === 'DELETE') {\n      return apiDelete(url);\n    }\n    return apiCall(url, { method, body: data ? JSON.stringify(data) : undefined, ...rest });\n  }\n};\n","import React from 'react';\n\nexport function MobileCard({ \n  children, \n  className = '', \n  padding = 'p-4',\n  shadow = 'shadow-sm',\n  hover = false,\n  onClick,\n  interactive = false,\n  ...props \n}) {\n  const baseClasses = 'bg-white rounded-xl border border-gray-200'\n  const shadowClasses = shadow === 'shadow' ? 'shadow' : shadow === 'shadow-lg' ? 'shadow-lg' : 'shadow-sm'\n  const hoverClasses = hover ? 'hover:shadow-lg transition-all duration-200' : ''\n  const interactiveClasses = interactive ? 'active:scale-95 transition-transform duration-100' : ''\n  const classes = `${baseClasses} ${shadowClasses} ${hoverClasses} ${interactiveClasses} ${padding} ${className}`.trim()\n  \n  const Component = onClick ? 'button' : 'div'\n  \n  return (\n    <Component \n      className={classes}\n      onClick={onClick}\n      {...props}\n    >\n      {children}\n    </Component>\n  )\n}\n\nexport function MobileCardHeader({ children, className = '' }) {\n  return (\n    <div className={`mb-3 ${className}`}>\n      {children}\n    </div>\n  )\n}\n\nexport function MobileCardContent({ children, className = '' }) {\n  return (\n    <div className={className}>\n      {children}\n    </div>\n  )\n}\n\nexport function MobileCardFooter({ children, className = '' }) {\n  return (\n    <div className={`mt-3 pt-3 border-t border-gray-100 ${className}`}>\n      {children}\n    </div>\n  )\n}\n\n// Mobile-specific card variants\nexport function MobileActionCard({ \n  children, \n  icon, \n  title, \n  subtitle, \n  onClick, \n  className = '' \n}) {\n  return (\n    <MobileCard \n      onClick={onClick} \n      interactive={true}\n      className={`text-left ${className}`}\n    >\n      <div className=\"flex items-center space-x-3\">\n        {icon && (\n          <div className=\"flex-shrink-0\">\n            {icon}\n          </div>\n        )}\n        <div className=\"flex-1 min-w-0\">\n          <h3 className=\"text-sm font-medium text-gray-900 truncate\">{title}</h3>\n          {subtitle && (\n            <p className=\"text-xs text-gray-500 truncate\">{subtitle}</p>\n          )}\n        </div>\n        <div className=\"flex-shrink-0\">\n          <svg className=\"w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n          </svg>\n        </div>\n      </div>\n      {children}\n    </MobileCard>\n  )\n}\n\nexport function MobileStatsCard({ \n  title, \n  value, \n  subtitle, \n  icon, \n  trend, \n  trendDirection = 'up',\n  className = '' \n}) {\n  return (\n    <MobileCard className={`text-center ${className}`}>\n      <div className=\"flex flex-col items-center\">\n        {icon && (\n          <div className=\"mb-2 text-blue-600\">\n            {icon}\n          </div>\n        )}\n        <div className=\"text-2xl font-bold text-gray-900 mb-1\">{value}</div>\n        <div className=\"text-sm text-gray-600 mb-2\">{title}</div>\n        {subtitle && (\n          <div className=\"text-xs text-gray-500\">{subtitle}</div>\n        )}\n        {trend && (\n          <div className={`flex items-center text-xs ${\n            trendDirection === 'up' ? 'text-green-600' : 'text-red-600'\n          }`}>\n            <svg className={`w-3 h-3 mr-1 ${trendDirection === 'up' ? 'rotate-0' : 'rotate-180'}`} fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n            </svg>\n            {trend}\n          </div>\n        )}\n      </div>\n    </MobileCard>\n  )\n}\n","import React from 'react';\n\nexport function MobileInput({ \n  label,\n  error,\n  helperText,\n  fullWidth = false,\n  className = '',\n  ...props \n}) {\n  const inputClasses = `w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 ${\n    error ? 'border-red-300 focus:ring-red-500 focus:border-red-500' : ''\n  } ${fullWidth ? 'w-full' : ''} ${className}`\n\n  return (\n    <div className={`${fullWidth ? 'w-full' : ''}`}>\n      {label && (\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          {label}\n        </label>\n      )}\n      <input \n        className={inputClasses}\n        {...props}\n      />\n      {error && (\n        <p className=\"mt-1 text-sm text-red-600\">{error}</p>\n      )}\n      {helperText && !error && (\n        <p className=\"mt-1 text-sm text-gray-500\">{helperText}</p>\n      )}\n    </div>\n  )\n}\n\nexport function MobileTextarea({ \n  label,\n  error,\n  helperText,\n  fullWidth = false,\n  rows = 4,\n  className = '',\n  ...props \n}) {\n  const textareaClasses = `w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none ${\n    error ? 'border-red-300 focus:ring-red-500 focus:border-red-500' : ''\n  } ${fullWidth ? 'w-full' : ''} ${className}`\n\n  return (\n    <div className={`${fullWidth ? 'w-full' : ''}`}>\n      {label && (\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          {label}\n        </label>\n      )}\n      <textarea \n        className={textareaClasses}\n        rows={rows}\n        {...props}\n      />\n      {error && (\n        <p className=\"mt-1 text-sm text-red-600\">{error}</p>\n      )}\n      {helperText && !error && (\n        <p className=\"mt-1 text-sm text-gray-500\">{helperText}</p>\n      )}\n    </div>\n  )\n}\n\nexport function MobileSelect({ \n  label,\n  error,\n  helperText,\n  options = [],\n  fullWidth = false,\n  className = '',\n  ...props \n}) {\n  const selectClasses = `w-full px-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 appearance-none bg-white ${\n    error ? 'border-red-300 focus:ring-red-500 focus:border-red-500' : ''\n  } ${fullWidth ? 'w-full' : ''} ${className}`\n\n  return (\n    <div className={`${fullWidth ? 'w-full' : ''} relative`}>\n      {label && (\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n          {label}\n        </label>\n      )}\n      <select \n        className={selectClasses}\n        {...props}\n      >\n        {options.map((option) => (\n          <option key={option.value} value={option.value}>\n            {option.label}\n          </option>\n        ))}\n      </select>\n      \n      {/* Custom dropdown arrow */}\n      <div className=\"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none\">\n        <svg className=\"w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </div>\n      \n      {error && (\n        <p className=\"mt-1 text-sm text-red-600\">{error}</p>\n      )}\n      {helperText && !error && (\n        <p className=\"mt-1 text-sm text-gray-500\">{helperText}</p>\n      )}\n    </div>\n  )\n}\n\nexport function MobileSearchInput({ \n  placeholder = 'Search...',\n  onSearch,\n  className = '',\n  ...props \n}) {\n  const [query, setQuery] = React.useState('')\n\n  const handleSubmit = (e) => {\n    e.preventDefault()\n    if (onSearch && query.trim()) {\n      onSearch(query.trim())\n    }\n  }\n\n  return (\n    <form onSubmit={handleSubmit} className={`relative ${className}`}>\n      <div className=\"relative\">\n        <input\n          type=\"text\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n          placeholder={placeholder}\n          className=\"w-full pl-12 pr-4 py-3 text-base border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200\"\n          {...props}\n        />\n        <div className=\"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none\">\n          <svg className=\"w-5 h-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n          </svg>\n        </div>\n      </div>\n    </form>\n  )\n}\n","import React from 'react'\n\nexport function Button({ \n  variant = 'primary', \n  size = 'md',\n  children, \n  className = '',\n  disabled = false,\n  loading = false,\n  ...props \n}) {\n  const baseClasses = 'inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed'\n  \n  const variants = {\n    primary: 'bg-gradient-to-r from-[#21a1ce] to-[#1a80a3] text-white hover:shadow-lg focus:ring-[#21a1ce]',\n    secondary: 'bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500',\n    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-600',\n    success: 'bg-green-600 text-white hover:bg-green-700 focus:ring-green-600',\n    warning: 'bg-yellow-600 text-white hover:bg-yellow-700 focus:ring-yellow-600',\n    outline: 'border-2 border-[#21a1ce] text-[#21a1ce] hover:bg-[#21a1ce] hover:text-white focus:ring-[#21a1ce]'\n  }\n  \n  const sizes = {\n    sm: 'px-3 py-1.5 text-sm',\n    md: 'px-4 py-2 text-sm',\n    lg: 'px-6 py-3 text-base',\n    xl: 'px-8 py-4 text-lg'\n  }\n  \n  const classes = `${baseClasses} ${variants[variant]} ${sizes[size]} ${className}`.trim()\n  \n  return (\n    <button \n      className={classes}\n      disabled={disabled || loading}\n      {...props}\n    >\n      {loading && (\n        <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n        </svg>\n      )}\n      {children}\n    </button>\n  )\n} ","/**\n * lucide-react v0.0.1 - ISC\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.mjs';\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase();\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ color = \"currentColor\", size = 24, strokeWidth = 2, absoluteStrokeWidth, children, ...rest }, ref) => createElement(\n      \"svg\",\n      {\n        ref,\n        ...defaultAttributes,\n        width: size,\n        height: size,\n        stroke: color,\n        strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n        className: `lucide lucide-${toKebabCase(iconName)}`,\n        ...rest\n      },\n      [\n        ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n        ...(Array.isArray(children) ? children : [children]) || []\n      ]\n    )\n  );\n  Component.displayName = `${iconName}`;\n  return Component;\n};\nvar createLucideIcon$1 = createLucideIcon;\n\nexport { createLucideIcon$1 as default, toKebabCase };\n//# sourceMappingURL=createLucideIcon.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst AlertTriangle = createLucideIcon(\"AlertTriangle\", [\n  [\n    \"path\",\n    {\n      d: \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\",\n      key: \"c3ski4\"\n    }\n  ],\n  [\"path\", { d: \"M12 9v4\", key: \"juzpu7\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n]);\n\nexport { AlertTriangle as default };\n//# sourceMappingURL=alert-triangle.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst ArrowLeft = createLucideIcon(\"ArrowLeft\", [\n  [\"path\", { d: \"m12 19-7-7 7-7\", key: \"1l729n\" }],\n  [\"path\", { d: \"M19 12H5\", key: \"x3x0zl\" }]\n]);\n\nexport { ArrowLeft as default };\n//# sourceMappingURL=arrow-left.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst BookOpen = createLucideIcon(\"BookOpen\", [\n  [\"path\", { d: \"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z\", key: \"vv98re\" }],\n  [\"path\", { d: \"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z\", key: \"1cyq3y\" }]\n]);\n\nexport { BookOpen as default };\n//# sourceMappingURL=book-open.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst CheckCircle = createLucideIcon(\"CheckCircle\", [\n  [\"path\", { d: \"M22 11.08V12a10 10 0 1 1-5.93-9.14\", key: \"g774vq\" }],\n  [\"polyline\", { points: \"22 4 12 14.01 9 11.01\", key: \"6xbx8j\" }]\n]);\n\nexport { CheckCircle as default };\n//# sourceMappingURL=check-circle.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Eye = createLucideIcon(\"Eye\", [\n  [\n    \"path\",\n    { d: \"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z\", key: \"rwhkz3\" }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n]);\n\nexport { Eye as default };\n//# sourceMappingURL=eye.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Flag = createLucideIcon(\"Flag\", [\n  [\n    \"path\",\n    {\n      d: \"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z\",\n      key: \"i9b6wo\"\n    }\n  ],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"22\", y2: \"15\", key: \"1cm3nv\" }]\n]);\n\nexport { Flag as default };\n//# sourceMappingURL=flag.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst HelpCircle = createLucideIcon(\"HelpCircle\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\", key: \"1u773s\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n]);\n\nexport { HelpCircle as default };\n//# sourceMappingURL=help-circle.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst HelpingHand = createLucideIcon(\"HelpingHand\", [\n  [\n    \"path\",\n    {\n      d: \"m3 15 5.12-5.12A3 3 0 0 1 10.24 9H13a2 2 0 1 1 0 4h-2.5m4-.68 4.17-4.89a1.88 1.88 0 0 1 2.92 2.36l-4.2 5.94A3 3 0 0 1 14.96 17H9.83a2 2 0 0 0-1.42.59L7 19\",\n      key: \"nitrv7\"\n    }\n  ],\n  [\"path\", { d: \"m2 14 6 6\", key: \"g6j1uo\" }]\n]);\n\nexport { HelpingHand as default };\n//# sourceMappingURL=helping-hand.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Key = createLucideIcon(\"Key\", [\n  [\"circle\", { cx: \"7.5\", cy: \"15.5\", r: \"5.5\", key: \"yqb3hr\" }],\n  [\"path\", { d: \"m21 2-9.6 9.6\", key: \"1j0ho8\" }],\n  [\"path\", { d: \"m15.5 7.5 3 3L22 7l-3-3\", key: \"1rn1fs\" }]\n]);\n\nexport { Key as default };\n//# sourceMappingURL=key.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Lock = createLucideIcon(\"Lock\", [\n  [\n    \"rect\",\n    {\n      width: \"18\",\n      height: \"11\",\n      x: \"3\",\n      y: \"11\",\n      rx: \"2\",\n      ry: \"2\",\n      key: \"1w4ew1\"\n    }\n  ],\n  [\"path\", { d: \"M7 11V7a5 5 0 0 1 10 0v4\", key: \"fwvmzm\" }]\n]);\n\nexport { Lock as default };\n//# sourceMappingURL=lock.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Mail = createLucideIcon(\"Mail\", [\n  [\n    \"rect\",\n    { width: \"20\", height: \"16\", x: \"2\", y: \"4\", rx: \"2\", key: \"18n3k1\" }\n  ],\n  [\"path\", { d: \"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\", key: \"1ocrg3\" }]\n]);\n\nexport { Mail as default };\n//# sourceMappingURL=mail.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst MessageSquare = createLucideIcon(\"MessageSquare\", [\n  [\n    \"path\",\n    {\n      d: \"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\",\n      key: \"1lielz\"\n    }\n  ]\n]);\n\nexport { MessageSquare as default };\n//# sourceMappingURL=message-square.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst PenLine = createLucideIcon(\"PenLine\", [\n  [\"path\", { d: \"M12 20h9\", key: \"t2du7b\" }],\n  [\n    \"path\",\n    { d: \"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z\", key: \"ymcmye\" }\n  ]\n]);\n\nexport { PenLine as default };\n//# sourceMappingURL=pen-line.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Plus = createLucideIcon(\"Plus\", [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"M12 5v14\", key: \"s699le\" }]\n]);\n\nexport { Plus as default };\n//# sourceMappingURL=plus.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst RefreshCw = createLucideIcon(\"RefreshCw\", [\n  [\n    \"path\",\n    { d: \"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\", key: \"v9h5vc\" }\n  ],\n  [\"path\", { d: \"M21 3v5h-5\", key: \"1q7to0\" }],\n  [\n    \"path\",\n    { d: \"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\", key: \"3uifl3\" }\n  ],\n  [\"path\", { d: \"M8 16H3v5\", key: \"1cv678\" }]\n]);\n\nexport { RefreshCw as default };\n//# sourceMappingURL=refresh-cw.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Save = createLucideIcon(\"Save\", [\n  [\n    \"path\",\n    {\n      d: \"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z\",\n      key: \"1owoqh\"\n    }\n  ],\n  [\"polyline\", { points: \"17 21 17 13 7 13 7 21\", key: \"1md35c\" }],\n  [\"polyline\", { points: \"7 3 7 8 15 8\", key: \"8nz8an\" }]\n]);\n\nexport { Save as default };\n//# sourceMappingURL=save.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Search = createLucideIcon(\"Search\", [\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"8\", key: \"4ej97u\" }],\n  [\"path\", { d: \"m21 21-4.3-4.3\", key: \"1qie3q\" }]\n]);\n\nexport { Search as default };\n//# sourceMappingURL=search.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Shield = createLucideIcon(\"Shield\", [\n  [\"path\", { d: \"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\", key: \"3xmgem\" }]\n]);\n\nexport { Shield as default };\n//# sourceMappingURL=shield.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Star = createLucideIcon(\"Star\", [\n  [\n    \"polygon\",\n    {\n      points: \"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\",\n      key: \"8f66p6\"\n    }\n  ]\n]);\n\nexport { Star as default };\n//# sourceMappingURL=star.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst ThumbsDown = createLucideIcon(\"ThumbsDown\", [\n  [\"path\", { d: \"M17 14V2\", key: \"8ymqnk\" }],\n  [\n    \"path\",\n    {\n      d: \"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z\",\n      key: \"s6e0r\"\n    }\n  ]\n]);\n\nexport { ThumbsDown as default };\n//# sourceMappingURL=thumbs-down.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst ThumbsUp = createLucideIcon(\"ThumbsUp\", [\n  [\"path\", { d: \"M7 10v12\", key: \"1qc93n\" }],\n  [\n    \"path\",\n    {\n      d: \"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z\",\n      key: \"y3tblf\"\n    }\n  ]\n]);\n\nexport { ThumbsUp as default };\n//# sourceMappingURL=thumbs-up.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Trash2 = createLucideIcon(\"Trash2\", [\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\", key: \"4alrt4\" }],\n  [\"path\", { d: \"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\", key: \"v07s0e\" }],\n  [\"line\", { x1: \"10\", x2: \"10\", y1: \"11\", y2: \"17\", key: \"1uufr5\" }],\n  [\"line\", { x1: \"14\", x2: \"14\", y1: \"11\", y2: \"17\", key: \"xtxkd\" }]\n]);\n\nexport { Trash2 as default };\n//# sourceMappingURL=trash-2.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst TrendingUp = createLucideIcon(\"TrendingUp\", [\n  [\"polyline\", { points: \"22 7 13.5 15.5 8.5 10.5 2 17\", key: \"126l90\" }],\n  [\"polyline\", { points: \"16 7 22 7 22 13\", key: \"kwv8wd\" }]\n]);\n\nexport { TrendingUp as default };\n//# sourceMappingURL=trending-up.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Trophy = createLucideIcon(\"Trophy\", [\n  [\"path\", { d: \"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\", key: \"17hqa7\" }],\n  [\"path\", { d: \"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\", key: \"lmptdp\" }],\n  [\"path\", { d: \"M4 22h16\", key: \"57wxv0\" }],\n  [\n    \"path\",\n    {\n      d: \"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\",\n      key: \"1nw9bq\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\",\n      key: \"1np0yb\"\n    }\n  ],\n  [\"path\", { d: \"M18 2H6v7a6 6 0 0 0 12 0V2Z\", key: \"u46fv3\" }]\n]);\n\nexport { Trophy as default };\n//# sourceMappingURL=trophy.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst User = createLucideIcon(\"User\", [\n  [\"path\", { d: \"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\", key: \"975kel\" }],\n  [\"circle\", { cx: \"12\", cy: \"7\", r: \"4\", key: \"17ys0d\" }]\n]);\n\nexport { User as default };\n//# sourceMappingURL=user.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst Users = createLucideIcon(\"Users\", [\n  [\"path\", { d: \"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\", key: \"1yyitq\" }],\n  [\"circle\", { cx: \"9\", cy: \"7\", r: \"4\", key: \"nufk8\" }],\n  [\"path\", { d: \"M22 21v-2a4 4 0 0 0-3-3.87\", key: \"kshegd\" }],\n  [\"path\", { d: \"M16 3.13a4 4 0 0 1 0 7.75\", key: \"1da9ce\" }]\n]);\n\nexport { Users as default };\n//# sourceMappingURL=users.mjs.map\n","/**\n * lucide-react v0.0.1 - ISC\n */\n\nimport createLucideIcon from '../createLucideIcon.mjs';\n\nconst X = createLucideIcon(\"X\", [\n  [\"path\", { d: \"M18 6 6 18\", key: \"1bl5f8\" }],\n  [\"path\", { d: \"m6 6 12 12\", key: \"d8bk6v\" }]\n]);\n\nexport { X as default };\n//# sourceMappingURL=x.mjs.map\n","import React, { useMemo, useRef, useState } from \"react\";\nimport { MobileCard, MobileCardHeader, MobileCardContent } from './ui/mobile-card';\nimport { MobileInput } from './ui/mobile-input';\nimport { Button } from './ui/button';\nimport { Lock } from 'lucide-react';\n\n/* Crypto‑safe password generator. Uses Web Crypto API for randomness. */\nconst DEFAULT_LENGTH = 16;\nconst CHARSETS = {\n  lower: \"abcdefghjkmnpqrstuvwxyz\",\n  upper: \"ABCDEFGHJKMNPQRSTUVWXYZ\",\n  digits: \"23456789\",\n  symbols: \"!@#$%^&*()-_=+[]{};:,.?/|~\",\n  similar: \"ilIoO01\",\n};\n\nfunction getRandomValues(len) {\n  const arr = new Uint32Array(len);\n  crypto.getRandomValues(arr);\n  return arr;\n}\n\nfunction buildAlphabet(opts) {\n  let alphabet = \"\";\n  if (opts.lower) alphabet += CHARSETS.lower + (opts.similar ? \"il\" : \"\");\n  if (opts.upper) alphabet += CHARSETS.upper + (opts.similar ? \"IO\" : \"\");\n  if (opts.digits) alphabet += (opts.similar ? \"01\" : \"\") + CHARSETS.digits;\n  if (opts.symbols) alphabet += CHARSETS.symbols;\n  if (opts.ambiguous) alphabet += \"{}[]()/\\\\\\\\'\\\\\\\"`~,;:.<>\";\n  if (!opts.similar) {\n    alphabet = [...alphabet].filter((c) => !CHARSETS.similar.includes(c)).join(\"\");\n  }\n  return alphabet;\n}\n\nfunction generatePassword(length, opts) {\n  const alphabet = buildAlphabet(opts);\n  if (!alphabet.length) throw new Error(\"No character sets selected\");\n\n  const requiredPools = [];\n  if (opts.lower) requiredPools.push(CHARSETS.lower);\n  if (opts.upper) requiredPools.push(CHARSETS.upper);\n  if (opts.digits) requiredPools.push(opts.similar ? CHARSETS.digits + \"01\" : CHARSETS.digits);\n  if (opts.symbols) requiredPools.push(CHARSETS.symbols);\n  if (opts.ambiguous) requiredPools.push(\"{}[]()/\\\\\\\\'\\\\\\\"`~,;:.<>\");\n\n  const out = [];\n  requiredPools.forEach((pool) => {\n    const r = getRandomValues(1)[0] % pool.length;\n    out.push(pool[r]);\n  });\n\n  const remaining = Math.max(length - out.length, 0);\n  const rv = getRandomValues(remaining);\n  for (let i = 0; i < remaining; i++) {\n    const idx = rv[i] % alphabet.length;\n    out.push(alphabet[idx]);\n  }\n\n  for (let i = out.length - 1; i > 0; i--) {\n    const r = getRandomValues(1)[0] % (i + 1);\n    [out[i], out[r]] = [out[r], out[i]];\n  }\n  return out.join(\"\");\n}\n\nfunction estimateEntropy(length, opts) {\n  const alphabet = buildAlphabet(opts);\n  const N = Math.max(alphabet.length, 1);\n  return Math.round(length * Math.log2(N));\n}\n\nfunction StrengthBar({ bits }) {\n  let label = \"Weak\", pct = 25;\n  if (bits >= 80) { label = \"Very strong\"; pct = 100; }\n  else if (bits >= 60) { label = \"Strong\"; pct = 75; }\n  else if (bits >= 40) { label = \"Okay\"; pct = 50; }\n\n  return (\n    <div className=\"mt-2\">\n      <div className=\"w-full h-2 bg-gray-200 rounded\">\n        <div\n          className={`h-2 rounded ${pct >= 75 ? \"bg-green-500\" : pct >= 50 ? \"bg-yellow-500\" : \"bg-red-500\"}`}\n          style={{ width: `${pct}%` }}\n        />\n      </div>\n      <div className=\"text-xs text-gray-600 mt-1\">Strength: {label} ({bits} bits)</div>\n    </div>\n  );\n}\n\nexport default function PasswordGenerator({ onUse }) {\n  const [length, setLength] = useState(DEFAULT_LENGTH);\n  const [opts, setOpts] = useState({\n    lower: true,\n    upper: true,\n    digits: true,\n    symbols: true,\n    ambiguous: false,\n    similar: false,\n  });\n  const [value, setValue] = useState(\"\");\n  const [copied, setCopied] = useState(false);\n  const inputRef = useRef(null);\n\n  const entropy = useMemo(() => estimateEntropy(length, opts), [length, opts]);\n\n  function toggle(key) {\n    setOpts(prev => ({ ...prev, [key]: !prev[key] }));\n  }\n\n  function handleGenerate() {\n    try {\n      const password = generatePassword(length, opts);\n      setValue(password);\n      setCopied(false);\n    } catch (error) {\n      console.error(\"Failed to generate password:\", error);\n    }\n  }\n\n  async function handleCopy() {\n    if (!value) return;\n    try {\n      await navigator.clipboard.writeText(value);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (error) {\n      console.error(\"Failed to copy password:\", error);\n    }\n  }\n\n  function handleUse() {\n    if (onUse && value) {\n      onUse(value);\n    }\n  }\n\n  return (\n    <MobileCard className=\"mb-6\">\n      <MobileCardHeader>\n        <h3 className=\"text-lg font-semibold text-gray-900 flex items-center gap-2\">\n          <Lock className=\"w-5 h-5 text-blue-600\" />\n          Password Generator\n        </h3>\n        <p className=\"text-sm text-gray-600\">Generate secure, random passwords</p>\n      </MobileCardHeader>\n      \n      <MobileCardContent>\n        <div className=\"space-y-4\">\n          {/* Generated Password Display */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Generated Password\n            </label>\n            <div className=\"flex space-x-2\">\n              <MobileInput\n                ref={inputRef}\n                value={value}\n                readOnly\n                className=\"flex-1 font-mono text-sm\"\n                placeholder=\"Click 'Generate' to create a password\"\n              />\n              <Button\n                onClick={handleCopy}\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"px-3\"\n              >\n                {copied ? 'Copied!' : 'Copy'}\n              </Button>\n            </div>\n            {value && <StrengthBar bits={entropy} />}\n          </div>\n\n          {/* Length Control */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Password Length: {length}\n            </label>\n            <input\n              type=\"range\"\n              min=\"8\"\n              max=\"64\"\n              value={length}\n              onChange={(e) => setLength(parseInt(e.target.value))}\n              className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\"\n            />\n            <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\n              <span>8</span>\n              <span>16</span>\n              <span>32</span>\n              <span>64</span>\n            </div>\n          </div>\n\n          {/* Character Set Options */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Character Sets\n            </label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              {Object.entries(opts).map(([key, enabled]) => (\n                <label key={key} className=\"flex items-center space-x-2\">\n                  <input\n                    type=\"checkbox\"\n                    checked={enabled}\n                    onChange={() => toggle(key)}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 capitalize\">\n                    {key === 'lower' ? 'Lowercase' : \n                     key === 'upper' ? 'Uppercase' : \n                     key === 'digits' ? 'Numbers' : \n                     key === 'symbols' ? 'Symbols' : \n                     key === 'ambiguous' ? 'Ambiguous' : \n                     key === 'similar' ? 'Similar' : key}\n                  </span>\n                </label>\n              ))}\n            </div>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex space-x-2\">\n            <Button\n              onClick={handleGenerate}\n              className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white\"\n            >\n              Generate Password\n            </Button>\n            {value && onUse && (\n              <Button\n                onClick={handleUse}\n                variant=\"outline\"\n                className=\"flex-1\"\n              >\n                Use This Password\n              </Button>\n            )}\n          </div>\n\n          {/* Security Tips */}\n          <div className=\"bg-blue-50 p-3 rounded-lg border border-blue-200\">\n            <h4 className=\"text-sm font-medium text-blue-900 mb-1\">Security Tips</h4>\n            <ul className=\"text-xs text-blue-800 space-y-1\">\n              <li>• Use at least 16 characters for maximum security</li>\n              <li>• Include uppercase, lowercase, numbers, and symbols</li>\n              <li>• Avoid similar-looking characters (l, 1, I, O, 0)</li>\n              <li>• Store passwords in a secure password manager</li>\n            </ul>\n          </div>\n        </div>\n      </MobileCardContent>\n    </MobileCard>\n  );\n}\n","import { useState } from 'react'\nimport { Shield } from 'lucide-react'\nimport { API } from '../lib/api'\n\nconst CYBER_KB = {\n  passwords: {\n    keywords: ['password', 'passwords', 'strong password', 'secure password', 'passphrase', 'password manager'],\n    response: `**Password Protection**\\n\\n• Use at least 16 characters when possible\\n• Combine uppercase letters, lowercase letters, numbers, and symbols\\n• Avoid personal information (birthdays, names, etc.)\\n• Don't use common words or patterns\\n• Consider using passphrases (e.g., \"KangarooJumping2025!Sydney\")\\n• Use a different password for each account\\n• Consider using a password manager like LastPass, 1Password, or Bitwarden\\n• Enable multi-factor authentication (MFA) whenever possible`,\n    source: 'Expert Knowledge'\n  },\n}\n\nexport function useChatAssistant() {\n  const [chatMessages, setChatMessages] = useState([])\n  const [inputMessage, setInputMessage] = useState('')\n  const [isTyping, setIsTyping] = useState(false)\n  const [chatError, setChatError] = useState(false)\n\n  const formatChatMessage = (text) => {\n    if (!text) return ''\n    return text\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/^• /gm, '<br>• ')\n      .replace(/^\\* /gm, '<br>• ')\n      .replace(/^- /gm, '<br>• ')\n      .replace(/^### (.*$)/gm, '<h4 style=\"margin: 15px 0 8px 0; color: #374151; font-size: 16px;\">$1</h4>')\n      .replace(/^## (.*$)/gm, '<h3 style=\"margin: 15px 0 10px 0; color: #1f2937; font-size: 18px;\">$1</h3>')\n      .replace(/^# (.*$)/gm, '<h2 style=\"margin: 15px 0 10px 0; color: #111827; font-size: 20px;\">$1</h2>')\n      .replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"$2\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"color: #21a1ce; text-decoration: underline;\">$1</a>')\n      .replace(/\\n\\n/g, '<br><br>')\n      .replace(/\\n/g, '<br>')\n  }\n\n  const handleChatSubmit = async (e) => {\n    e.preventDefault()\n    if (!inputMessage.trim()) return\n\n    setChatError(false)\n\n    const userMessage = { text: inputMessage, sender: 'user' }\n    setChatMessages(prev => [...prev, userMessage])\n\n    const messageToProcess = inputMessage\n\n    setInputMessage('')\n    setIsTyping(true)\n\n    try {\n      let responseFound = false\n      let response = ''\n      let source = ''\n      const lowercaseInput = messageToProcess.toLowerCase()\n\n      for (const key in CYBER_KB) {\n        const { keywords, response: kbResponse, source: kbSource } = CYBER_KB[key]\n        for (const k of keywords) {\n          if (lowercaseInput.includes(k.toLowerCase())) {\n            response = kbResponse\n            source = kbSource\n            responseFound = true\n            break\n          }\n        }\n        if (responseFound) break\n      }\n\n      if (!responseFound) {\n        try {\n          const apiResponse = await fetch(`${API}/api/chat/`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ message: messageToProcess })\n          })\n          if (!apiResponse.ok) throw new Error(`API status ${apiResponse.status}`)\n          const data = await apiResponse.json()\n          if (data.success) {\n            response = data.response\n            source = data.source === 'expert_knowledge' ? 'Expert Knowledge' : 'AI Analysis'\n            responseFound = true\n          }\n        } catch (apiError) {\n          // fallthrough to default\n        }\n      }\n\n      if (!responseFound) {\n        response = \"I don't have specific information about that topic yet. For complex cybersecurity questions, I recommend consulting with a security professional.\"\n        source = 'AI Analysis'\n      }\n\n      setTimeout(() => {\n        const botMessage = { text: response, sender: 'assistant', source }\n        setChatMessages(prev => [...prev, botMessage])\n        setIsTyping(false)\n      }, 600)\n    } catch (err) {\n      setChatError(true)\n      const errorMessage = { text: 'Sorry, I encountered an error processing your request. Please try again.', sender: 'assistant', source: 'System' }\n      setChatMessages(prev => [...prev, errorMessage])\n      setIsTyping(false)\n    }\n  }\n\n  return {\n    chatMessages,\n    inputMessage,\n    isTyping,\n    chatError,\n    setInputMessage,\n    formatChatMessage,\n    handleChatSubmit,\n  }\n}\n","import React, { useState, useRef, useEffect } from 'react'\nimport { Send, Bot, User, MessageSquare, Shield } from 'lucide-react'\nimport { MobileCard, MobileCardContent } from './ui/mobile-card'\nimport { MobileInput } from './ui/mobile-input'\nimport { Button } from './ui/button'\nimport { useChatAssistant } from '../hooks/useChatAssistant'\n\nexport default function ChatAssistant({ setActiveTab }) {\n  const {\n    chatMessages,\n    inputMessage,\n    isTyping,\n    chatError,\n    setInputMessage,\n    formatChatMessage,\n    handleChatSubmit,\n  } = useChatAssistant()\n\n  const scrollRef = useRef(null)\n  useEffect(() => {\n    const el = scrollRef.current\n    if (el) {\n      try {\n        el.scrollTo({ top: el.scrollHeight, behavior: 'smooth' })\n      } catch (_) {\n        el.scrollTop = el.scrollHeight\n      }\n    }\n  }, [chatMessages, isTyping])\n\n  return (\n    <div className=\"p-2 md:p-4\">\n\n      <MobileCard className=\"mb-2\">\n        <MobileCardContent>\n          <div className=\"border border-gray-200 rounded-lg h-96 md:h-[32rem] flex flex-col\">\n            <div ref={scrollRef} className=\"flex-1 p-4 overflow-y-auto space-y-4\">\n              {chatMessages.length === 0 && (\n                <div className=\"text-center text-gray-500 mt-8\">\n                  <MessageSquare className=\"mx-auto mb-2 text-gray-300\" size={48} />\n                  <p className=\"text-sm md:text-base\">Ask me anything about cybersecurity!</p>\n                  <p className=\"text-xs md:text-sm mt-2 text-gray-400\">Try asking about passwords, phishing, or device security.</p>\n                </div>\n              )}\n\n              {chatMessages.map((message, index) => (\n                <div key={index} className={`flex ${message.sender === 'user' ? 'justify-end' : 'justify-start'}`}>\n                  <div className={`max-w-[80%] px-3 py-2 rounded-lg ${\n                    message.sender === 'user' ? 'bg-[#21a1ce] text-white' : 'bg-gray-100 text-gray-800'\n                  }`}>\n                    {message.sender === 'assistant' && (\n                      <div className=\"flex items-center mb-1\">\n                        <Shield className=\"w-4 h-4 mr-1 text-[#21a1ce]\" />\n                        <span className=\"text-xs text-[#21a1ce] font-medium\">\n                          {message.source || 'AI Assistant'}\n                        </span>\n                      </div>\n                    )}\n                    <div\n                      className=\"text-sm\"\n                      dangerouslySetInnerHTML={{\n                        __html: message.sender === 'assistant' ? formatChatMessage(message.text) : message.text,\n                      }}\n                    />\n                  </div>\n                </div>\n              ))}\n\n              {isTyping && (\n                <div className=\"flex justify-start\">\n                  <div className=\"bg-gray-100 text-gray-800 px-3 py-2 rounded-lg\">\n                    <div className=\"flex items-center\">\n                      <Shield className=\"w-4 h-4 mr-1 text-[#21a1ce]\" />\n                      <span className=\"text-xs text-[#21a1ce] font-medium mr-2\">AI Assistant</span>\n                      <div className=\"flex space-x-1\">\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n\n            <form onSubmit={handleChatSubmit} className=\"border-t border-gray-200 p-4\">\n              <div className=\"flex flex-col items-center space-y-3\">\n                <div className=\"flex w-full max-w-md space-x-2\">\n                  <MobileInput\n                    type=\"text\"\n                    value={inputMessage}\n                    onChange={(e) => setInputMessage(e.target.value)}\n                    placeholder=\"Type your cybersecurity question...\"\n                    disabled={isTyping}\n                    className=\"flex-1\"\n                  />\n                  <Button\n                    type=\"submit\"\n                    disabled={isTyping || !inputMessage.trim()}\n                    className=\"bg-[#21a1ce] hover:bg-[#1a80a3] text-white px-4 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    Send\n                  </Button>\n                </div>\n                {chatError && <p className=\"text-red-500 text-sm\">Connection error. Please check your internet and try again.</p>}\n              </div>\n            </form>\n          </div>\n        </MobileCardContent>\n      </MobileCard>\n    </div>\n  )\n}\n","import React from 'react';\n\nexport function MobileButton({ \n  children, \n  variant = 'primary', \n  size = 'md',\n  fullWidth = false,\n  disabled = false,\n  loading = false,\n  className = '',\n  ...props \n}) {\n  const baseClasses = 'inline-flex items-center justify-center font-medium rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100'\n  \n  const variantClasses = {\n    primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-sm',\n    secondary: 'bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500',\n    outline: 'border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500',\n    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm',\n    success: 'bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm',\n    ghost: 'bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500'\n  }\n  \n  const sizeClasses = {\n    sm: 'px-3 py-2 text-sm min-h-[44px]',\n    md: 'px-4 py-3 text-base min-h-[48px]',\n    lg: 'px-6 py-4 text-lg min-h-[56px]',\n    xl: 'px-8 py-5 text-xl min-h-[64px]'\n  }\n  \n  const widthClasses = fullWidth ? 'w-full' : ''\n  \n  const classes = `${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${widthClasses} ${className}`.trim()\n  \n  return (\n    <button \n      className={classes}\n      disabled={disabled || loading}\n      {...props}\n    >\n      {loading && (\n        <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n        </svg>\n      )}\n      {children}\n    </button>\n  )\n}\n\n// Mobile-specific button variants\nexport function MobileIconButton({ \n  children, \n  variant = 'ghost',\n  size = 'md',\n  className = '',\n  ...props \n}) {\n  const baseClasses = 'inline-flex items-center justify-center rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 active:scale-95'\n  \n  const variantClasses = {\n    primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-sm',\n    secondary: 'bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500',\n    outline: 'border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500',\n    ghost: 'bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500'\n  }\n  \n  const sizeClasses = {\n    sm: 'w-10 h-10',\n    md: 'w-12 h-12',\n    lg: 'w-14 h-14',\n    xl: 'w-16 h-16'\n  }\n  \n  const classes = `${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${className}`.trim()\n  \n  return (\n    <button \n      className={classes}\n      {...props}\n    >\n      {children}\n    </button>\n  )\n}\n\nexport function MobileFloatingButton({ \n  children, \n  variant = 'primary',\n  size = 'lg',\n  className = '',\n  ...props \n}) {\n  const baseClasses = 'fixed bottom-20 right-4 bg-blue-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 active:scale-95 z-40'\n  \n  const sizeClasses = {\n    sm: 'w-12 h-12',\n    md: 'w-14 h-14',\n    lg: 'w-16 h-16',\n    xl: 'w-20 h-20'\n  }\n  \n  const classes = `${baseClasses} ${sizeClasses[size]} ${className}`.trim()\n  \n  return (\n    <button \n      className={classes}\n      {...props}\n    >\n      {children}\n    </button>\n  )\n}\n","import { useState, useEffect, useCallback } from 'react';\nimport { API_ENDPOINTS, apiPost, apiGet, apiPut } from '../lib/api';\n\nexport const useAuth = () => {\n  const [user, setUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Refresh auth token function (defined early to avoid TDZ in callbacks below)\n  const refreshAuthToken = useCallback(async () => {\n    try {\n      const refreshToken = localStorage.getItem('refreshToken');\n      if (!refreshToken) {\n        return { success: false, error: 'No refresh token available' };\n      }\n\n      const response = await apiPost(API_ENDPOINTS.AUTH.REFRESH, {\n        refresh_token: refreshToken\n      });\n\n      if (response.ok) {\n        const responseData = await response.json();\n        const { access_token, refresh_token: newRefreshToken } = responseData;\n        localStorage.setItem('authToken', access_token);\n        if (newRefreshToken) {\n          localStorage.setItem('refreshToken', newRefreshToken);\n        }\n        return { success: true };\n      } else {\n        return { success: false, error: 'Token refresh failed' };\n      }\n    } catch (err) {\n      console.error('Token refresh error:', err);\n      return { success: false, error: 'Token refresh failed' };\n    }\n  }, []);\n\n  // Central auth check function (reusable and event-driven)\n  const checkAuth = useCallback(async () => {\n    const token = localStorage.getItem('authToken');\n    if (token) {\n      try {\n        const response = await apiGet(API_ENDPOINTS.AUTH.PROFILE);\n        if (response.ok) {\n          const userData = await response.json();\n          const newUser = userData.user || userData;\n          setUser(newUser);\n          setIsAuthenticated(true);\n        } else if (response.status === 401) {\n          const refreshResult = await refreshAuthToken();\n          if (!refreshResult.success) {\n            localStorage.removeItem('authToken');\n            localStorage.removeItem('refreshToken');\n            setUser(null);\n            setIsAuthenticated(false);\n          }\n        } else {\n          localStorage.removeItem('authToken');\n          localStorage.removeItem('refreshToken');\n          setUser(null);\n          setIsAuthenticated(false);\n        }\n      } catch (_err) {\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('refreshToken');\n        setUser(null);\n        setIsAuthenticated(false);\n      }\n    } else {\n      setUser(null);\n      setIsAuthenticated(false);\n    }\n    setIsLoading(false);\n  }, [refreshAuthToken]);\n\n  // On mount: check auth and subscribe to global auth change events\n  useEffect(() => {\n    checkAuth();\n    const handler = () => checkAuth();\n    window.addEventListener('remaleh-auth-changed', handler);\n    return () => window.removeEventListener('remaleh-auth-changed', handler);\n  }, [checkAuth]);\n\n  // Login function\n  const login = useCallback(async (email, password) => {\n    try {\n      setError(null);\n      setIsLoading(true);\n      \n      console.log('Attempting login to:', API_ENDPOINTS.AUTH.LOGIN);\n      \n      const response = await apiPost(API_ENDPOINTS.AUTH.LOGIN, {\n        email,\n        password\n      });\n      \n      if (response.ok) {\n        const responseData = await response.json();\n        console.log('Login response:', responseData);\n        \n        const { access_token, refresh_token, user: userData } = responseData;\n        \n        localStorage.setItem('authToken', access_token);\n        localStorage.setItem('refreshToken', refresh_token);\n        \n        // Ensure we have the user data with proper structure\n        const user = userData || responseData.user;\n        console.log('Setting user:', user);\n        console.log('User is_admin:', user?.is_admin);\n        console.log('User role:', user?.role);\n        \n        setUser(user);\n        setIsAuthenticated(true);\n        // Notify all hook instances (e.g., App) to refresh their state\n        window.dispatchEvent(new Event('remaleh-auth-changed'));\n        return { success: true };\n      } else {\n        let friendly = 'Login failed. Please check your email and password.';\n        try {\n          const errorData = await response.json();\n          const apiMsg = errorData.error || errorData.message || '';\n          // Map backend signals to friendlier copy\n          if (apiMsg.toLowerCase().includes('email not verified')) {\n            friendly = 'Please verify your email to sign in. Check your inbox for the code.';\n          } else if (apiMsg.toLowerCase().includes('invalid email or password')) {\n            friendly = 'Incorrect email or password. Please try again.';\n          } else if (apiMsg.toLowerCase().includes('deactivated')) {\n            friendly = 'Your account is deactivated. Contact support for assistance.';\n          }\n        } catch (_) {}\n        setError(friendly);\n        return { success: false, error: friendly };\n      }\n    } catch (err) {\n      console.error('Login error details:', err);\n      \n      // Provide more specific error messages\n      let errorMessage = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      if (err.name === 'TypeError' && err.message.includes('fetch')) {\n        errorMessage = 'Cannot connect to server. Please check your internet connection or server status.';\n      } else if (err.message) {\n        errorMessage = err.message;\n      }\n      \n      setError(errorMessage);\n      return { success: false, error: errorMessage };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Register function\n  const register = useCallback(async (userData) => {\n    try {\n      setError(null);\n      setIsLoading(true);\n      \n      const response = await apiPost(API_ENDPOINTS.AUTH.REGISTER, userData);\n      \n      if (response.ok) {\n        const resp = await response.json();\n        // If backend requires verification, it will not include tokens\n        if (resp.requires_verification) {\n          return { success: true, requires_verification: true, user: resp.user };\n        }\n        const { access_token, refresh_token, user: newUser } = resp;\n        localStorage.setItem('authToken', access_token);\n        localStorage.setItem('refreshToken', refresh_token);\n        setUser(newUser);\n        setIsAuthenticated(true);\n        window.dispatchEvent(new Event('remaleh-auth-changed'));\n        return { success: true };\n      } else {\n        let errorText = 'Registration failed';\n        try {\n          const errorData = await response.json();\n          errorText = errorData.error || errorData.message || errorText;\n        } catch (_) {}\n        setError(errorText);\n        return { success: false, error: errorText };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const verifyEmail = useCallback(async (email, code) => {\n    try {\n      setError(null);\n      setIsLoading(true);\n      const response = await apiPost(API_ENDPOINTS.AUTH.VERIFY_EMAIL, { email, code });\n      if (response.ok) {\n        const resp = await response.json();\n        const { access_token, refresh_token, user: verifiedUser } = resp;\n        localStorage.setItem('authToken', access_token);\n        localStorage.setItem('refreshToken', refresh_token);\n        setUser(verifiedUser);\n        setIsAuthenticated(true);\n        window.dispatchEvent(new Event('remaleh-auth-changed'));\n        return { success: true };\n      } else {\n        const errorData = await response.json();\n        setError(errorData.error || errorData.message || 'Verification failed');\n        return { success: false, error: errorData.error || errorData.message };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  const resendVerification = useCallback(async (email) => {\n    try {\n      setError(null);\n      const response = await apiPost(API_ENDPOINTS.AUTH.RESEND_VERIFICATION, { email });\n      if (response.ok) {\n        return { success: true };\n      } else {\n        const errorData = await response.json();\n        setError(errorData.error || errorData.message || 'Resend failed');\n        return { success: false, error: errorData.error || errorData.message };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    }\n  }, []);\n\n  const requestPasswordReset = useCallback(async (email) => {\n    try {\n      setError(null);\n      const response = await apiPost(API_ENDPOINTS.AUTH.REQUEST_PASSWORD_RESET, { email });\n      if (response.ok) {\n        const resp = await response.json();\n        return { success: true, message: resp.message || 'If this email exists, a temporary password has been sent.' };\n      } else {\n        let msg = 'Please wait before trying again.';\n        try {\n          const err = await response.json();\n          msg = err.error || err.message || msg;\n        } catch (_) {}\n        setError(msg);\n        return { success: false, error: msg };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    }\n  }, []);\n\n  // Logout function\n  const logout = useCallback(async () => {\n    try {\n      const token = localStorage.getItem('authToken');\n      if (token) {\n        await apiPost(API_ENDPOINTS.AUTH.LOGOUT);\n      }\n    } catch (err) {\n      console.error('Logout error:', err);\n    } finally {\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('refreshToken');\n      setUser(null);\n      setIsAuthenticated(false);\n      window.dispatchEvent(new Event('remaleh-auth-changed'));\n    }\n  }, []);\n\n  // Update profile function\n  const updateProfile = useCallback(async (profileData) => {\n    try {\n      setError(null);\n      setIsLoading(true);\n      // Backend expects first_name, last_name, bio. Map from UI fields.\n      const payload = {};\n      if (typeof profileData?.name === 'string') {\n        const trimmed = profileData.name.trim();\n        const parts = trimmed.split(/\\s+/);\n        payload.first_name = parts[0] || '';\n        payload.last_name = parts.length > 1 ? parts.slice(1).join(' ') : '';\n      }\n      if (typeof profileData?.first_name === 'string') payload.first_name = profileData.first_name;\n      if (typeof profileData?.last_name === 'string') payload.last_name = profileData.last_name;\n      if (typeof profileData?.bio === 'string') payload.bio = profileData.bio;\n\n      const response = await apiPut(API_ENDPOINTS.AUTH.PROFILE, payload);\n      \n      if (response.ok) {\n        const resp = await response.json();\n        const updatedUser = resp.user || resp;\n        setUser(updatedUser);\n        return { success: true, user: updatedUser };\n      } else {\n        const errorData = await response.json();\n        setError(errorData.message || 'Profile update failed');\n        return { success: false, error: errorData.message };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  \n\n  // Change password function\n  const changePassword = useCallback(async (currentPassword, newPassword) => {\n    try {\n      setError(null);\n      setIsLoading(true);\n      \n      const response = await apiPost(API_ENDPOINTS.AUTH.CHANGE_PASSWORD, {\n        current_password: currentPassword,\n        new_password: newPassword\n      });\n      \n      if (response.ok) {\n        return { success: true };\n      } else {\n        const errorData = await response.json();\n        setError(errorData.message || 'Password change failed');\n        return { success: false, error: errorData.message };\n      }\n    } catch (err) {\n      const msg = 'We couldn\\'t reach the server. Please check your connection and try again.';\n      setError(msg);\n      return { success: false, error: msg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Debug function to check user state\n  const debugUserState = useCallback(() => {\n    console.log('=== USER AUTH DEBUG ===');\n    console.log('User object:', user);\n    console.log('Is authenticated:', isAuthenticated);\n    console.log('Is loading:', isLoading);\n    console.log('User is_admin:', user?.is_admin);\n    console.log('User role:', user?.role);\n    console.log('User email:', user?.email);\n    console.log('Local storage token:', localStorage.getItem('authToken'));\n    console.log('========================');\n  }, [user, isAuthenticated, isLoading]);\n\n  return {\n    user,\n    isAuthenticated,\n    isLoading,\n    error,\n    login,\n    register,\n    verifyEmail,\n    resendVerification,\n    requestPasswordReset,\n    logout,\n    updateProfile,\n    changePassword,\n    refreshAuthToken,\n    clearError: () => setError(null),\n    debugUserState\n  };\n};\n","// Utility function for merging class names\nexport function cn(...classes) {\n  return classes.filter(Boolean).join(' ')\n}\n\nexport async function cloudinaryUnsignedUpload(file, { cloudName, uploadPreset, folder = 'app_uploads' } = {}) {\n  const name = cloudName || import.meta.env.VITE_CLOUDINARY_CLOUD_NAME\n  const preset = uploadPreset || import.meta.env.VITE_CLOUDINARY_UPLOAD_PRESET\n  if (!name || !preset) throw new Error('Cloudinary env not configured')\n\n  const form = new FormData()\n  form.append('file', file)\n  form.append('upload_preset', preset)\n  form.append('folder', folder)\n\n  const res = await fetch(`https://api.cloudinary.com/v1_1/${name}/auto/upload`, {\n    method: 'POST',\n    body: form\n  })\n  const text = await res.text()\n  let data = null\n  try { data = text ? JSON.parse(text) : null } catch {}\n  if (!res.ok) {\n    const message = (data && (data.error?.message || data.message)) || `Upload failed (HTTP ${res.status})`\n    throw new Error(message)\n  }\n  if (!data || !data.secure_url) throw new Error('Upload failed: no URL returned')\n  return { url: data.secure_url, public_id: data.public_id, resource_type: data.resource_type || 'image' }\n}\n","/**\n * Content Management Utility for Remaleh Protect Learning Hub\n * This makes it easy to update learning content without code changes\n */\n\nimport { API, apiPost, apiGet, apiPut, apiDelete } from '../lib/api'\nimport { cloudinaryUnsignedUpload } from '../lib/utils'\n\n// Backend API endpoints\nconst API_ENDPOINTS = {\n  MODULES: '/api/learning/modules',\n  MODULE: (id) => `/api/learning/modules/${id}`,\n  LESSONS: (moduleId) => `/api/learning/modules/${moduleId}/lessons`,\n  LESSON: (moduleId, lessonId) => `/api/learning/modules/${moduleId}/lessons/${lessonId}`,\n  PROGRESS: (moduleId) => `/api/learning/modules/${moduleId}/progress`,\n  PROGRESS_OVERVIEW: '/api/learning/progress/overview',\n  EXPORT: '/api/learning/content/export',\n  IMPORT: '/api/learning/content/import',\n  LEARNING_MEDIA: '/api/learning/media'\n}\n\n// Fallback to local storage if backend is unavailable\nconst FALLBACK_STORAGE_KEY = 'learning_content_fallback'\n\n// Get all learning modules from backend\nexport const getAllModules = async (forceRefresh = false) => {\n  try {\n    // Add cache-busting parameter if forceRefresh is true\n    const endpoint = forceRefresh ? `${API_ENDPOINTS.MODULES}?t=${Date.now()}` : API_ENDPOINTS.MODULES\n    console.log('🔄 getAllModules called with forceRefresh:', forceRefresh, 'endpoint:', endpoint)\n    \n    const response = await apiGet(endpoint)\n    if (response.ok) {\n      const data = await response.json()\n      console.log('🔄 getAllModules fresh data received:', data)\n      // Store in fallback storage\n      localStorage.setItem(FALLBACK_STORAGE_KEY, JSON.stringify(data))\n      return data.modules || []\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, using fallback data:', error)\n  }\n  \n  // Only use fallback if not forcing refresh\n  if (!forceRefresh) {\n    try {\n      const fallbackData = localStorage.getItem(FALLBACK_STORAGE_KEY)\n      if (fallbackData) {\n        console.log('🔄 getAllModules using fallback data')\n        return JSON.parse(fallbackData).modules || []\n      }\n    } catch (error) {\n      console.warn('Fallback data unavailable:', error)\n    }\n  }\n  \n  // Return empty array if no data available\n  return []\n}\n\n// Get specific module by ID\nexport const getModuleById = async (moduleId) => {\n  try {\n    const response = await apiGet(API_ENDPOINTS.MODULE(moduleId))\n    if (response.ok) {\n      const data = await response.json()\n      return data\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, using fallback data:', error)\n  }\n  \n  // Fallback to local storage\n  try {\n    const fallbackData = localStorage.getItem(FALLBACK_STORAGE_KEY)\n    if (fallbackData) {\n      const modules = JSON.parse(fallbackData).modules || []\n      return modules.find(m => m.id === moduleId)\n    }\n  } catch (error) {\n    console.warn('Fallback data unavailable:', error)\n  }\n  \n  return null\n}\n\n// Get specific lesson by ID\nexport const getLessonById = async (moduleId, lessonId) => {\n  try {\n    const module = await getModuleById(moduleId)\n    if (module && module.content && module.content.lessons) {\n      return module.content.lessons.find(l => l.id === lessonId)\n    }\n  } catch (error) {\n    console.warn('Error getting lesson:', error)\n  }\n  \n  return null\n}\n\n// Get module progress for current user\nexport const getModuleProgress = async (moduleId) => {\n  try {\n    const response = await apiGet(API_ENDPOINTS.PROGRESS(moduleId))\n    if (response.ok) {\n      const data = await response.json()\n      return data\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, using local progress:', error)\n  }\n  \n  // Fallback to local storage\n  try {\n    const localProgress = localStorage.getItem(`module_progress_${moduleId}`)\n    if (localProgress) {\n      return JSON.parse(localProgress)\n    }\n  } catch (error) {\n    console.warn('Local progress unavailable:', error)\n  }\n  \n  return {\n    module_id: moduleId,\n    completed: false,\n    score: 0,\n    started_at: null,\n    completed_at: null\n  }\n}\n\n// Get overall learning progress\nexport const getOverallProgress = async () => {\n  try {\n    const response = await apiGet(API_ENDPOINTS.PROGRESS_OVERVIEW)\n    if (response.ok) {\n      const data = await response.json()\n      return data\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, using local progress:', error)\n  }\n  \n  // Fallback to local calculation\n  try {\n    const modules = await getAllModules()\n    const completedModules = modules.filter(m => {\n      const progress = localStorage.getItem(`module_progress_${m.id}`)\n      return progress && JSON.parse(progress).completed\n    }).length\n    \n    return {\n      total_modules: modules.length,\n      completed_modules: completedModules,\n      completion_percentage: modules.length > 0 ? (completedModules / modules.length * 100) : 0,\n      total_score: 0,\n      average_score: 0\n    }\n  } catch (error) {\n    console.warn('Local progress calculation failed:', error)\n    return {\n      total_modules: 0,\n      completed_modules: 0,\n      completion_percentage: 0,\n      total_score: 0,\n      average_score: 0\n    }\n  }\n}\n\n// Get next recommended lesson\nexport const getNextRecommendedLesson = async () => {\n  try {\n    const modules = await getAllModules()\n    const overallProgress = await getOverallProgress()\n    \n    // Find first incomplete module\n    for (const module of modules) {\n      const progress = await getModuleProgress(module.id)\n      if (!progress.completed) {\n        return {\n          module_id: module.id,\n          module_title: module.title,\n          lesson_id: 1, // Start with first lesson\n          lesson_title: module.content?.lessons?.[0]?.title || 'Introduction'\n        }\n      }\n    }\n    \n    return null // All modules completed\n  } catch (error) {\n    console.warn('Error getting next recommended lesson:', error)\n    return null\n  }\n}\n\n// Compute next recommended lesson without extra API calls\nexport const computeNextRecommendedLesson = (modules, overallProgress) => {\n  try {\n    if (!Array.isArray(modules) || !overallProgress) return null\n    const completedSet = new Set(\n      (overallProgress.lesson_progress_records || [])\n        .filter((r) => r.completed)\n        .map((r) => `${r.module_id}_${r.lesson_id}`)\n    )\n\n    for (const module of modules) {\n      const lessons = module?.content?.lessons || []\n      for (const lesson of lessons) {\n        const key = `${module.id}_${lesson.id}`\n        if (!completedSet.has(key)) {\n          return {\n            module_id: module.id,\n            module_title: module.title,\n            lesson_id: lesson.id,\n            lesson_title: lesson.title\n          }\n        }\n      }\n    }\n    return null\n  } catch (error) {\n    console.warn('Error computing next recommended lesson:', error)\n    return null\n  }\n}\n\n// Get learning statistics\nexport const getLearningStats = async () => {\n  try {\n    const overallProgress = await getOverallProgress()\n    const modules = await getAllModules()\n    \n    return {\n      ...overallProgress,\n      total_lessons: modules.reduce((total, m) => {\n        return total + (m.content?.lessons?.length || 0)\n      }, 0),\n      estimated_total_time: modules.reduce((total, m) => {\n        return total + (m.estimated_time || 0)\n      }, 0)\n    }\n  } catch (error) {\n    console.warn('Error getting learning stats:', error)\n    return {\n      total_modules: 0,\n      completed_modules: 0,\n      completion_percentage: 0,\n      total_lessons: 0,\n      estimated_total_time: 0\n    }\n  }\n}\n\n// Search learning content\nexport const searchLearningContent = async (query) => {\n  try {\n    const modules = await getAllModules()\n    const results = []\n    \n    const searchTerm = query.toLowerCase()\n    \n    for (const module of modules) {\n      // Search in module title and description\n      if (module.title.toLowerCase().includes(searchTerm) ||\n          module.description.toLowerCase().includes(searchTerm)) {\n        results.push({\n          type: 'module',\n          id: module.id,\n          title: module.title,\n          description: module.description,\n          difficulty: module.difficulty\n        })\n      }\n      \n      // Search in lesson content\n      if (module.content && module.content.lessons) {\n        for (const lesson of module.content.lessons) {\n          if (lesson.title.toLowerCase().includes(searchTerm) ||\n              lesson.content.toLowerCase().includes(searchTerm)) {\n            results.push({\n              type: 'lesson',\n              module_id: module.id,\n              module_title: module.title,\n              id: lesson.id,\n              title: lesson.title,\n              content: lesson.content.substring(0, 100) + '...'\n            })\n          }\n        }\n      }\n    }\n    \n    return results\n  } catch (error) {\n    console.warn('Error searching content:', error)\n    return []\n  }\n}\n\n// Get content by difficulty level\nexport const getContentByDifficulty = async (difficulty) => {\n  try {\n    const modules = await getAllModules()\n    return modules.filter(m => m.difficulty === difficulty)\n  } catch (error) {\n    console.warn('Error getting content by difficulty:', error)\n    return []\n  }\n}\n\n// Get quick tips (first lesson from each module)\nexport const getQuickTips = async () => {\n  try {\n    const modules = await getAllModules()\n    const tips = []\n    \n    for (const module of modules) {\n      if (module.content && module.content.lessons && module.content.lessons.length > 0) {\n        const firstLesson = module.content.lessons[0]\n        tips.push({\n          module_id: module.id,\n          module_title: module.title,\n          lesson_id: firstLesson.id,\n          lesson_title: firstLesson.title,\n          content: firstLesson.content.substring(0, 150) + '...',\n          difficulty: module.difficulty,\n          estimated_time: module.estimated_time\n        })\n      }\n    }\n    \n    return tips\n  } catch (error) {\n    console.warn('Error getting quick tips:', error)\n    return []\n  }\n}\n\n// Get content update information\nexport const getContentUpdateInfo = async () => {\n  try {\n    const response = await apiGet(API_ENDPOINTS.EXPORT)\n    if (response.ok) {\n      const data = await response.json()\n      return data.metadata\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, using fallback data:', error)\n  }\n  \n  // Fallback to local storage\n  try {\n    const fallbackData = localStorage.getItem(FALLBACK_STORAGE_KEY)\n    if (fallbackData) {\n      const data = JSON.parse(fallbackData)\n      return data.metadata || {\n        version: '1.0',\n        last_updated: new Date().toISOString(),\n        total_modules: 0,\n        total_lessons: 0\n      }\n    }\n  } catch (error) {\n    console.warn('Fallback data unavailable:', error)\n  }\n  \n  return {\n    version: '1.0',\n    last_updated: new Date().toISOString(),\n    total_modules: 0,\n    total_lessons: 0\n  }\n}\n\n// Admin functions for content management\nexport const createModule = async (moduleData) => {\n  try {\n    const response = await apiPost(API_ENDPOINTS.MODULES, moduleData)\n    if (response.ok) {\n      const data = await response.json()\n      // Refresh local cache\n      await getAllModules()\n      return data\n    } else {\n      throw new Error('Failed to create module')\n    }\n  } catch (error) {\n    console.error('Error creating module:', error)\n    throw error\n  }\n}\n\nexport const updateModule = async (moduleId, moduleData) => {\n  try {\n    console.log('🔄 updateModule called with:', { moduleId, moduleData })\n    console.log('🌐 API endpoint:', API_ENDPOINTS.MODULE(moduleId))\n    \n    const response = await apiPut(API_ENDPOINTS.MODULE(moduleId), moduleData)\n    \n    console.log('🌐 Response status:', response.status)\n    console.log('🌐 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('✅ Module updated successfully:', data)\n      // Refresh local cache\n      await getAllModules()\n      return data\n    } else {\n      console.error('❌ Failed to update module, status:', response.status)\n      throw new Error('Failed to update module')\n    }\n  } catch (error) {\n    console.error('❌ Error in updateModule:', error)\n    throw error\n  }\n}\n\nexport const deleteModule = async (moduleId) => {\n  try {\n    const response = await apiDelete(API_ENDPOINTS.MODULE(moduleId))\n    if (response.ok) {\n      // Refresh local cache\n      await getAllModules()\n      return { message: 'Module deleted successfully' }\n    } else {\n      throw new Error('Failed to delete module')\n    }\n  } catch (error) {\n    console.error('Error deleting module:', error)\n    throw error\n  }\n}\n\nexport const addLesson = async (moduleId, lessonData) => {\n  try {\n    console.log('🔄 contentManager.addLesson called with:', { moduleId, lessonData })\n    console.log('🔄 API endpoint:', API_ENDPOINTS.LESSONS(moduleId))\n    \n    const response = await apiPost(API_ENDPOINTS.LESSONS(moduleId), lessonData)\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('🔄 Response data:', data)\n      // Refresh local cache\n      await getAllModules()\n      return data\n    } else {\n      console.log('❌ Response not ok, status:', response.status)\n      let msg = 'Failed to add lesson'\n      try {\n        const errorData = await response.json()\n        console.log('❌ Error response body:', errorData)\n        msg = errorData.error || errorData.message || msg\n      } catch (_) {}\n      throw new Error(msg)\n    }\n  } catch (error) {\n    console.error('❌ Error in addLesson:', error)\n    throw error\n  }\n}\n\nexport const uploadLessonMedia = async (file) => {\n  try {\n    // Prefer direct Cloudinary unsigned upload to avoid server size limits\n    const data = await cloudinaryUnsignedUpload(file, { folder: 'learning_content' })\n    return { url: data.url, public_id: data.public_id, resource_type: data.resource_type }\n  } catch (error) {\n    console.error('❌ Error uploading lesson media:', error)\n    throw error\n  }\n}\n\nexport const updateLesson = async (moduleId, lessonId, lessonData) => {\n  try {\n    const response = await apiPut(API_ENDPOINTS.LESSON(moduleId, lessonId), lessonData)\n    if (response.ok) {\n      const data = await response.json()\n      // Refresh local cache\n      await getAllModules()\n      return data\n    } else {\n      throw new Error('Failed to update lesson')\n    }\n  } catch (error) {\n    console.error('Error updating lesson:', error)\n    throw error\n  }\n}\n\nexport const deleteLesson = async (moduleId, lessonId) => {\n  try {\n    console.log('🔄 contentManager.deleteLesson called with:', { moduleId, lessonId })\n    console.log('🔄 API endpoint:', API_ENDPOINTS.LESSON(moduleId, lessonId))\n    \n    const response = await apiDelete(API_ENDPOINTS.LESSON(moduleId, lessonId))\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      console.log('✅ Lesson deleted successfully from API')\n      // Refresh local cache\n      await getAllModules()\n      return { message: 'Lesson deleted successfully' }\n    } else {\n      console.log('❌ API response not ok, status:', response.status)\n      const errorData = await response.json()\n      console.log('❌ Error response body:', errorData)\n      throw new Error(errorData.error || `HTTP error! status: ${response.status}`)\n    }\n  } catch (error) {\n    console.error('❌ Error in deleteLesson:', error)\n    throw error\n  }\n}\n\n// Update lesson progress (new function for lesson-level tracking)\nexport const updateLessonProgress = async (moduleId, lessonId, progressData) => {\n  try {\n    console.log('🔄 contentManager.updateLessonProgress called with:', { moduleId, lessonId, progressData })\n    const endpoint = `/api/learning/modules/${moduleId}/lessons/${lessonId}/progress`\n    console.log('🔄 API endpoint:', endpoint)\n    \n    const response = await apiPost(endpoint, progressData)\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('✅ Lesson progress updated successfully:', data)\n      return data\n    } else {\n      console.log('❌ API response not ok, status:', response.status)\n      const errorData = await response.json()\n      console.log('❌ Error response body:', errorData)\n      throw new Error(errorData.error || `HTTP error! status: ${response.status}`)\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, storing progress locally:', error)\n    // Store locally as fallback\n    const localProgress = {\n      module_id: moduleId,\n      lesson_id: lessonId,\n      completed: progressData.completed || false,\n      score: progressData.score || 0,\n      started_at: new Date().toISOString(),\n      completed_at: progressData.completed ? new Date().toISOString() : null\n    }\n    localStorage.setItem(`lesson_progress_${moduleId}_${lessonId}`, JSON.stringify(localProgress))\n    return { progress: localProgress }\n  }\n}\n\n// Update user progress (kept for backward compatibility)\nexport const updateProgress = async (moduleId, progressData) => {\n  try {\n    const response = await apiPost(API_ENDPOINTS.PROGRESS(moduleId), progressData)\n    if (response.ok) {\n      const data = await response.json()\n      // Also store locally as backup\n      localStorage.setItem(`module_progress_${moduleId}`, JSON.stringify(data.progress))\n      return data\n    } else {\n      throw new Error('Failed to update progress')\n    }\n  } catch (error) {\n    console.warn('Backend unavailable, storing progress locally:', error)\n    // Store locally as fallback\n    const localProgress = {\n      module_id: moduleId,\n      completed: progressData.completed || false,\n      score: progressData.score || 0,\n      started_at: new Date().toISOString(),\n      completed_at: progressData.completed ? new Date().toISOString() : null\n    }\n    localStorage.setItem(`module_progress_${moduleId}`, JSON.stringify(localProgress))\n    return { progress: localProgress }\n  }\n}\n\n// Export content (admin only)\nexport const exportContent = async () => {\n  try {\n    const response = await apiGet(API_ENDPOINTS.EXPORT)\n    if (response.ok) {\n      const data = await response.json()\n      return data\n    } else {\n      throw new Error('Failed to export content')\n    }\n  } catch (error) {\n    console.error('Error exporting content:', error)\n    throw error\n  }\n}\n\n// Import content (admin only)\nexport const importContent = async (contentData) => {\n  try {\n    const response = await apiPost(API_ENDPOINTS.IMPORT, contentData)\n    if (response.ok) {\n      const data = await response.json()\n      // Refresh local cache\n      await getAllModules()\n      return data\n    } else {\n      throw new Error('Failed to import content')\n    }\n  } catch (error) {\n    console.error('Error importing content:', error)\n    throw error\n  }\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport { RefreshCw } from 'lucide-react';\n\nexport default function MobilePullToRefresh({ \n  onRefresh, \n  children, \n  threshold = 80,\n  className = '' \n}) {\n  const [isPulling, setIsPulling] = useState(false);\n  const [pullDistance, setPullDistance] = useState(0);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const containerRef = useRef(null);\n  const startY = useRef(0);\n  const currentY = useRef(0);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleTouchStart = (e) => {\n      if (container.scrollTop === 0) {\n        startY.current = e.touches[0].clientY;\n        setIsPulling(true);\n      }\n    };\n\n    const handleTouchMove = (e) => {\n      if (!isPulling) return;\n      \n      currentY.current = e.touches[0].clientY;\n      const distance = Math.max(0, currentY.current - startY.current);\n      \n      if (distance > 0) {\n        setPullDistance(distance);\n        e.preventDefault();\n      }\n    };\n\n    const handleTouchEnd = async () => {\n      if (!isPulling) return;\n      \n      if (pullDistance >= threshold && onRefresh) {\n        setIsRefreshing(true);\n        try {\n          await onRefresh();\n        } catch (error) {\n          console.error('Pull to refresh failed:', error);\n        } finally {\n          setIsRefreshing(false);\n        }\n      }\n      \n      setIsPulling(false);\n      setPullDistance(0);\n    };\n\n    container.addEventListener('touchstart', handleTouchStart, { passive: false });\n    container.addEventListener('touchmove', handleTouchMove, { passive: false });\n    container.addEventListener('touchend', handleTouchEnd);\n\n    return () => {\n      container.removeEventListener('touchstart', handleTouchStart);\n      container.removeEventListener('touchmove', handleTouchMove);\n      container.removeEventListener('touchend', handleTouchEnd);\n    };\n  }, [isPulling, pullDistance, threshold, onRefresh]);\n\n  const pullProgress = Math.min(pullDistance / threshold, 1);\n  const shouldShowIndicator = isPulling && pullDistance > 20;\n\n  return (\n    <div className={`relative ${className}`}>\n      {/* Pull to refresh indicator */}\n      {shouldShowIndicator && (\n        <div \n          className=\"absolute top-0 left-0 right-0 z-10 flex items-center justify-center bg-blue-50 border-b border-blue-200 transition-all duration-200\"\n          style={{\n            height: `${Math.min(pullDistance, threshold)}px`,\n            opacity: pullProgress\n          }}\n        >\n          <div className=\"flex items-center space-x-2 text-blue-600\">\n            <RefreshCw \n              className={`w-5 h-5 transition-transform duration-200 ${\n                pullProgress >= 1 ? 'animate-spin' : ''\n              }`}\n              style={{\n                transform: `rotate(${pullProgress * 180}deg)`\n              }}\n            />\n            <span className=\"text-sm font-medium\">\n              {pullProgress >= 1 ? 'Release to refresh' : 'Pull to refresh'}\n            </span>\n          </div>\n        </div>\n      )}\n\n      {/* Refreshing indicator */}\n      {isRefreshing && (\n        <div className=\"absolute top-0 left-0 right-0 z-10 flex items-center justify-center bg-blue-50 border-b border-blue-200 h-16\">\n          <div className=\"flex items-center space-x-2 text-blue-600\">\n            <RefreshCw className=\"w-5 h-5 animate-spin\" />\n            <span className=\"text-sm font-medium\">Refreshing...</span>\n          </div>\n        </div>\n      )}\n\n      {/* Content container */}\n      <div \n        ref={containerRef}\n        className=\"h-full overflow-auto\"\n        style={{\n          transform: shouldShowIndicator ? `translateY(${Math.min(pullDistance, threshold)}px)` : 'translateY(0)',\n          transition: shouldShowIndicator ? 'none' : 'transform 0.3s ease-out'\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n\n// Hook for pull to refresh functionality\nexport function usePullToRefresh(onRefresh) {\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  const handleRefresh = async () => {\n    setIsRefreshing(true);\n    try {\n      await onRefresh();\n    } catch (error) {\n      console.error('Pull to refresh failed:', error);\n    } finally {\n      setIsRefreshing(false);\n    }\n  };\n\n  return { isRefreshing, handleRefresh };\n}\n","import React, { useState, useEffect } from 'react'\nimport { BookOpen, CheckCircle, Search, Shield, ArrowLeft, RefreshCw } from 'lucide-react'\nimport { MobileCard, MobileCardHeader, MobileCardContent } from './ui/mobile-card'\nimport { MobileButton } from './ui/mobile-button'\nimport { MobileInput } from './ui/mobile-input'\nimport { useAuth } from '../hooks/useAuth'\nimport { \n  getAllModules, \n  getOverallProgress,\n  computeNextRecommendedLesson\n} from '../utils/contentManager'\nimport MobilePullToRefresh from './MobilePullToRefresh'\n\nexport default function LearnHub({ setActiveTab }) {\n  const { isAuthenticated } = useAuth()\n  const [selectedModule, setSelectedModule] = useState(null)\n  const [selectedLesson, setSelectedLesson] = useState(null)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [difficultyFilter, setDifficultyFilter] = useState('all')\n  const [completedLessons, setCompletedLessons] = useState([])\n  const [showCompleted, setShowCompleted] = useState(false)\n  const [modules, setModules] = useState([])\n  const [overallProgress, setOverallProgress] = useState({ completed: 0, total: 0, progress: 0 })\n  const [nextLesson, setNextLesson] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(null)\n  \n  const getLessonTypeLabel = (lesson) => {\n    const rawType = (lesson?.type || '').toLowerCase()\n    if (rawType === 'quiz') return 'Quiz'\n    if (rawType === 'assessment') return 'Assessment'\n    const ct = (lesson?.contentType || '').toLowerCase()\n    switch (ct) {\n      case 'info':\n        return 'Information'\n      case 'tips':\n        return 'Tips'\n      case 'example':\n        return 'Example'\n      case 'list':\n        return 'List'\n      case 'warning':\n        return 'Warning'\n      case 'warning-signs':\n        return 'Warning Signs'\n      case 'steps':\n        return 'Steps'\n      case 'action-list':\n        return 'Actions'\n      case 'warning-list':\n        return 'Warning List'\n      case 'markdown':\n      case 'html':\n        return 'Information'\n      default:\n        return 'Information'\n    }\n  }\n\n  const formatDuration = (value) => {\n    try {\n      if (value === null || value === undefined) return '—'\n      if (typeof value === 'number') {\n        return `${Math.max(0, value)} min`\n      }\n      const str = String(value).trim()\n      const lower = str.toLowerCase()\n      // If it already includes a unit, return as-is\n      if (/[a-z]/.test(lower)) {\n        // Normalize common shorthand\n        if (/(^|\\s)(m|mins?)($|\\s)/.test(lower)) return str.replace(/\\bm\\b/i, 'min')\n        if (/(^|\\s)(s|secs?)($|\\s)/.test(lower)) return str.replace(/\\bs\\b/i, 'sec')\n        if (/(^|\\s)(h|hrs?)($|\\s)/.test(lower)) return str.replace(/\\bh\\b/i, 'hr')\n        return str\n      }\n      // If it's numeric text, append min\n      const num = parseInt(str, 10)\n      if (!isNaN(num)) return `${num} min`\n      return str\n    } catch {\n      return String(value)\n    }\n  }\n  \n  // Load data from backend APIs\n  useEffect(() => {\n    if (isAuthenticated) {\n      loadData()\n    } else {\n      // Set loading to false for non-authenticated users\n      setLoading(false)\n    }\n  }, [isAuthenticated])\n  \n  const loadData = async () => {\n    try {\n      setLoading(true)\n      setError(null)\n      \n      // Load modules and progress in parallel\n      const [modulesData, progressData] = await Promise.all([\n        getAllModules(),\n        getOverallProgress()\n      ])\n      \n      setModules(modulesData)\n      setOverallProgress(progressData)\n      setNextLesson(computeNextRecommendedLesson(modulesData, progressData))\n      \n      // Avoid extra per-module progress calls; compute view state locally from overallProgress\n      \n    } catch (err) {\n      setError('Failed to load learning content. Please try again.')\n    } finally {\n      setLoading(false)\n    }\n  }\n  \n  // Load completed lessons from backend lesson progress data\n  useEffect(() => {\n    if (overallProgress.lesson_progress_records && overallProgress.lesson_progress_records.length > 0) {\n      // Extract completed lesson IDs from lesson progress records\n      // IMPORTANT: We need to create unique identifiers that combine module_id and lesson_id\n      // because lesson IDs are not globally unique across modules\n      const backendCompletedKeys = overallProgress.lesson_progress_records\n        .filter(record => record.completed)\n        .map(record => `${record.module_id}_${record.lesson_id}`)\n      \n      // Optional: detect mismatches between backend and frontend (no UI/log output)\n      const backendCompletedSet = new Set(backendCompletedKeys)\n      const frontendCompletedSet = new Set(completedLessons)\n      const missingInFrontend = backendCompletedKeys.filter(key => !frontendCompletedSet.has(key))\n      const extraInFrontend = completedLessons.filter(key => !backendCompletedSet.has(key))\n      \n      // Only update if backend has more completed lessons than local state\n      // This prevents overwriting local progress with stale backend data\n      if (backendCompletedKeys.length > completedLessons.length) {\n        setCompletedLessons(backendCompletedKeys)\n      } else if (backendCompletedKeys.length === completedLessons.length) {\n        // Check if there are any new keys in backend that aren't in local state\n        const newKeys = backendCompletedKeys.filter(key => !completedLessons.includes(key))\n        if (newKeys.length > 0) {\n          const updatedKeys = [...new Set([...completedLessons, ...newKeys])]\n          setCompletedLessons(updatedKeys)\n        }\n      }\n    }\n  }, [overallProgress])\n  \n  // Mark lesson as complete and update backend progress\n  const markLessonComplete = async (moduleId, lessonId) => {\n    try {\n      // Find the module by provided moduleId (avoid cross-module ID collisions)\n      const module = modules.find(m => String(m.id) === String(moduleId))\n      if (!module) {\n        return\n      }\n\n      // If already completed, skip backend call\n      const lessonKeyPre = `${String(module.id)}_${String(lessonId)}`\n      if (completedLessons.includes(lessonKeyPre)) {\n        return\n      }\n\n      // Update backend lesson progress\n      const progressData = {\n        completed: true,\n        score: 100, // Full score for completing lesson\n        completed_at: new Date().toISOString()\n      }\n\n      // Import updateLessonProgress function for lesson-level tracking\n      const { updateLessonProgress } = await import('../utils/contentManager')\n      const result = await updateLessonProgress(module.id, lessonId, progressData)\n      // Normalize backend response and ensure completed flag is true\n      const backendKey = `${String(result?.progress?.module_id ?? module.id)}_${String(result?.progress?.lesson_id ?? lessonId)}`\n      const backendCompleted = Boolean(result?.progress?.completed ?? true)\n\n      // Update local state - prefer backend key if present\n      const lessonKey = backendCompleted ? backendKey : `${String(module.id)}_${String(lessonId)}`\n      setCompletedLessons(prev => {\n        const updated = [...new Set([...prev, lessonKey])]\n        return updated\n      })\n      \n      // Optimistically update overall progress locally for instant UI feedback\n      setOverallProgress(prev => {\n        const prevRecords = Array.isArray(prev?.lesson_progress_records) ? prev.lesson_progress_records : []\n        const updatedRecords = [...prevRecords]\n        const targetModuleId = result?.progress?.module_id || module.id\n        const targetLessonId = result?.progress?.lesson_id || lessonId\n        const existingIndex = updatedRecords.findIndex(r => r.module_id === targetModuleId && r.lesson_id === targetLessonId)\n        if (existingIndex >= 0) {\n          updatedRecords[existingIndex] = { ...updatedRecords[existingIndex], completed: true, score: 100 }\n        } else {\n          updatedRecords.push({ module_id: targetModuleId, lesson_id: targetLessonId, completed: true, score: 100 })\n        }\n        const completedCount = updatedRecords.filter(r => r.completed).length\n        const totalLessons = prev?.total_lessons || (modules.reduce((acc, m) => acc + (m.content?.lessons?.length || 0), 0))\n        const percentage = totalLessons > 0 ? (completedCount / totalLessons) * 100 : prev?.completion_percentage || 0\n        const next = {\n          ...prev,\n          lesson_progress_records: updatedRecords,\n          completed_lessons: completedCount,\n          completion_percentage: percentage\n        }\n        // Also optimistically compute next lesson locally\n        setNextLesson(computeNextRecommendedLesson(modules, next))\n        return next\n      })\n\n      // Lightweight refresh: only fetch overall progress and recompute next lesson\n      const refreshedProgress = await getOverallProgress()\n      // Merge backend progress with local optimistic completion to avoid UI regression\n      const localCompletedSet = new Set([...(completedLessons || []), lessonKey])\n      const mergedRecords = Array.isArray(refreshedProgress?.lesson_progress_records)\n        ? [...refreshedProgress.lesson_progress_records]\n        : []\n      for (const key of localCompletedSet) {\n        const [mIdStr, lIdStr] = key.split('_')\n        const mId = Number(mIdStr)\n        const lId = Number(lIdStr)\n        const idx = mergedRecords.findIndex(r => r.module_id === mId && r.lesson_id === lId)\n        if (idx >= 0) {\n          mergedRecords[idx] = { ...mergedRecords[idx], completed: true, score: 100 }\n        } else {\n          mergedRecords.push({ module_id: mId, lesson_id: lId, completed: true, score: 100 })\n        }\n      }\n      const mergedCompletedCount = mergedRecords.filter(r => r.completed).length\n      const totalLessonsMerged = refreshedProgress?.total_lessons || (modules.reduce((acc, m) => acc + (m.content?.lessons?.length || 0), 0))\n      const mergedPercentage = totalLessonsMerged > 0 ? (mergedCompletedCount / totalLessonsMerged) * 100 : (refreshedProgress?.completion_percentage || 0)\n      const mergedProgress = {\n        ...refreshedProgress,\n        lesson_progress_records: mergedRecords,\n        completed_lessons: mergedCompletedCount,\n        completion_percentage: mergedPercentage\n      }\n      setOverallProgress(mergedProgress)\n      setNextLesson(computeNextRecommendedLesson(modules, mergedProgress))\n    } catch (error) {\n      // Fallback to local storage if backend fails\n      const fallbackKey = `${selectedModule?.id || 'unknown'}_${lessonId}`\n      setCompletedLessons(prev => {\n        const updated = [...new Set([...prev, fallbackKey])]\n        return updated\n      })\n      try {\n        const tentative = [...new Set([...completedLessons, fallbackKey])]\n        localStorage.setItem('remaleh-completed-lessons', JSON.stringify(tentative))\n      } catch {}\n    }\n  }\n  \n  // Get filtered modules based on search and difficulty\n  const getFilteredModules = () => {\n    let filtered = modules\n    \n    if (difficultyFilter !== 'all') {\n      filtered = filtered.filter(module => (module.difficulty || '').toLowerCase() === difficultyFilter)\n    }\n    \n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase()\n      filtered = filtered.filter(module => \n        module.title.toLowerCase().includes(searchLower) ||\n        (module.description && module.description.toLowerCase().includes(searchLower))\n      )\n    }\n    \n    return filtered\n  }\n  \n  const filteredModules = getFilteredModules()\n\n  // Show authentication required message for non-authenticated users\n  if (!isAuthenticated) {\n    return (\n      <div className=\"space-y-6 p-4\">\n        <MobileCard>\n          <div className=\"text-center py-8\">\n            <BookOpen className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Authentication Required</h2>\n            <p className=\"text-gray-600 mb-6\">Please log in to access the Learning Hub and track your progress.</p>\n            <MobileButton \n              onClick={() => setActiveTab('login')}\n              className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n            >\n              Go to Login\n            </MobileButton>\n          </div>\n        </MobileCard>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex flex-col p-4 max-w-none mx-auto w-full overflow-x-hidden break-words min-h-screen\">\n      {/* Header centered like Community Hub */}\n      <div className=\"text-center mb-6\">\n        <div className=\"flex justify-center mb-3\">\n          <div className=\"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center\">\n            <BookOpen className=\"w-6 h-6 text-white\" />\n          </div>\n        </div>\n        <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Learning Hub</h1>\n        <p className=\"text-gray-600 text-sm\">Remaleh isn't just about learning it's about doing. Stuck or unsure? A Remaleh Guardian will guide you step-by-step until you're confident, capable, and ready to take action.</p>\n        <div className=\"mt-2\">\n          <button\n            onClick={loadData}\n            disabled={loading}\n            className=\"inline-flex items-center px-3 py-1.5 rounded-md border border-gray-200 hover:bg-gray-50 transition-all disabled:opacity-50 text-sm text-gray-700\"\n            title=\"Refresh content\"\n          >\n            <RefreshCw className={`w-4 h-4 text-gray-600 mr-2 ${loading ? 'animate-spin' : ''}`} />\n            Refresh\n          </button>\n        </div>\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n          <p className=\"text-red-800\">{error}</p>\n          <button \n            onClick={loadData}\n            className=\"mt-2 text-sm text-red-600 hover:text-red-800 underline\"\n          >\n            Try again\n          </button>\n        </div>\n      )}\n\n      {/* Progress Overview */}\n      <MobileCard className=\"mb-4\">\n        <MobileCardHeader>\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-lg font-semibold\">Your Progress</h3>\n            <div className=\"text-sm text-gray-600\">\n              {loading ? 'Loading...' : `${overallProgress.completed_modules || 0}/${overallProgress.total_modules || 0} modules`}\n            </div>\n          </div>\n        </MobileCardHeader>\n        <MobileCardContent>\n          <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\n            <div \n              className=\"bg-[#21a1ce] h-2 rounded-full transition-all duration-300\" \n              style={{ width: `${overallProgress.completion_percentage || 0}%` }}\n            ></div>\n          </div>\n          <div className=\"flex items-center justify-between text-sm text-gray-600\">\n            <span>{loading ? 'Loading...' : `${Math.round(overallProgress.completion_percentage || 0)}% Complete`}</span>\n            \n            {/* Debug Progress Bar Values */}\n            \n            {nextLesson && (\n              <span className=\"text-sm text-[#21a1ce] font-medium\">\n                Next: {nextLesson.lesson_title}\n              </span>\n            )}\n          </div>\n          \n        </MobileCardContent>\n      </MobileCard>\n\n      {/* Remaleh Guardian Support */}\n      <MobileCard className=\"mb-4\">\n        <MobileCardHeader>\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center\">\n                <Shield className=\"w-5 h-5 text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900\">Need Help Implementing?</h3>\n                <p className=\"text-sm text-gray-600\">Don't struggle alone - get expert guidance</p>\n              </div>\n            </div>\n            <a\n              href=\"https://www.remaleh.com.au/contact-us\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center justify-center bg-[#21a1ce] hover:bg-[#1a8bb8] text-white rounded-md px-3 py-1.5 text-sm font-medium whitespace-nowrap self-start sm:self-auto\"\n            >\n              Connect with a Remaleh Guardian\n            </a>\n          </div>\n        </MobileCardHeader>\n        <MobileCardContent>\n          <p className=\"text-gray-700 mb-4 text-sm\">\n            Learning is just the first step. When you're ready to implement cybersecurity measures, our Remaleh Guardians are here to guide you through every step of the process.\n          </p>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"w-2 h-2 bg-[#21a1ce] rounded-full mt-2\"></div>\n              <div className=\"text-sm text-gray-700\">\n                <span className=\"font-medium\">Personal Guidance:</span> One-on-one support for your specific situation\n              </div>\n            </div>\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"w-2 h-2 bg-[#21a1ce] rounded-full mt-2\"></div>\n              <div className=\"text-sm text-gray-700\">\n                <span className=\"font-medium\">Step-by-Step Implementation:</span> We'll walk you through each process\n              </div>\n            </div>\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"w-2 h-2 bg-[#21a1ce] rounded-full mt-2\"></div>\n              <div className=\"text-sm text-gray-700\">\n                <span className=\"font-medium\">Ongoing Support:</span> We're here until you feel confident and empowered\n              </div>\n            </div>\n          </div>\n          \n        </MobileCardContent>\n      </MobileCard>\n\n      {/* Search and Filters */}\n      <div className=\"space-y-3\">\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n          <MobileInput\n            type=\"text\"\n            placeholder=\"Search learning content...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n          />\n        </div>\n        \n        <div className=\"flex flex-wrap gap-2\">\n          <MobileButton\n            onClick={() => setDifficultyFilter('all')}\n            variant={difficultyFilter === 'all' ? 'primary' : 'secondary'}\n            className=\"text-sm px-3 py-2\"\n          >\n            All\n          </MobileButton>\n          <MobileButton\n            onClick={() => setDifficultyFilter('beginner')}\n            variant={difficultyFilter === 'beginner' ? 'primary' : 'secondary'}\n            className=\"text-sm px-3 py-2\"\n          >\n            Beginner\n          </MobileButton>\n          <MobileButton\n            onClick={() => setDifficultyFilter('intermediate')}\n            variant={difficultyFilter === 'intermediate' ? 'primary' : 'secondary'}\n            className=\"text-sm px-3 py-2\"\n          >\n            Intermediate\n          </MobileButton>\n          <MobileButton\n            onClick={() => setDifficultyFilter('advanced')}\n            variant={difficultyFilter === 'advanced' ? 'primary' : 'secondary'}\n            className=\"text-sm px-3 py-2\"\n          >\n            Advanced\n          </MobileButton>\n        </div>\n      </div>\n\n      {/* Main Content with Pull-to-Refresh */}\n      <MobilePullToRefresh onRefresh={loadData} className=\"flex-1 min-h-0\">\n      <div className=\"flex-1 min-h-0 overflow-y-auto\">\n      {!selectedModule ? (\n        /* Module Selection View */\n        <div className=\"space-y-4\">\n          {loading ? (\n            <div className=\"text-center py-8\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[#21a1ce] mx-auto\"></div>\n              <p className=\"text-gray-600 mt-2\">Loading learning modules...</p>\n            </div>\n          ) : filteredModules.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <BookOpen className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n              <p className=\"text-gray-600\">No learning modules found</p>\n              <p className=\"text-sm text-gray-500\">Check back later for new content</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n              {filteredModules.map(module => {\n              const lessonCount = module.content?.lessons?.length || 0\n              const completedLessonsInModule = module.content?.lessons?.filter(lesson => \n                completedLessons.includes(`${String(module.id)}_${String(lesson.id)}`)\n              ).length || 0\n              const progressPercent = lessonCount > 0 ? (completedLessonsInModule / lessonCount) * 100 : 0\n              \n              return (\n                <MobileCard \n                  key={module.id}\n                  className=\"cursor-pointer transition-colors hover:bg-gray-50 overflow-hidden\"\n                  padding=\"p-3\"\n                  onClick={() => setSelectedModule(module)}\n                >\n                  <MobileCardHeader className=\"mb-2\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex items-start space-x-3\">\n                        <div className=\"w-9 h-9 bg-[#21a1ce] rounded-lg flex items-center justify-center flex-shrink-0\">\n                          <BookOpen className=\"w-4 h-4 text-white\" />\n                        </div>\n                        <div className=\"min-w-0 break-words\">\n                          <h3 className=\"text-base font-semibold text-gray-900 truncate\">{module.title}</h3>\n                          <p className=\"text-xs text-gray-600 leading-5 max-h-[2.5rem] overflow-hidden break-words\">{module.description}</p>\n                          <div className=\"flex items-center space-x-3 text-[11px] text-gray-500 mt-1\">\n                            <span>{lessonCount} lessons</span>\n                            <span>{module.estimated_time} min</span>\n                            <span className=\"capitalize\">{module.difficulty}</span>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"text-right ml-2 flex-shrink-0\">\n                        <div className=\"text-xs font-medium text-[#21a1ce]\">{Math.round(progressPercent)}%</div>\n                        <div className=\"text-[11px] text-gray-500\">{completedLessonsInModule}/{lessonCount}</div>\n                      </div>\n                    </div>\n                  </MobileCardHeader>\n                  <MobileCardContent>\n                    <div className=\"w-full bg-gray-200 rounded-full h-1.5\">\n                      <div \n                        className=\"bg-[#21a1ce] h-1.5 rounded-full transition-all duration-300\" \n                        style={{ width: `${progressPercent}%` }}\n                      ></div>\n                    </div>\n                  </MobileCardContent>\n                </MobileCard>\n              )\n              })}\n            </div>\n          )}\n        </div>\n      ) : !selectedLesson ? (\n        /* Lesson Selection View */\n        <div>\n          <div className=\"flex items-center mb-4\">\n            <button \n              onClick={() => setSelectedModule(null)}\n              className=\"flex items-center text-[#21a1ce] hover:underline text-sm\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-1\" />\n              Back to modules\n            </button>\n          </div>\n          \n          <MobileCard>\n            <MobileCardHeader>\n              <div className=\"flex items-center space-x-3\">\n                <div className={`w-10 h-10 rounded-lg flex items-center justify-center text-white`} \n                     style={{ backgroundColor: selectedModule.color }}>\n                  <BookOpen className=\"w-5 h-5\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h2 className=\"text-xl font-bold text-gray-900\">{selectedModule.title}</h2>\n                  <p className=\"text-gray-600\">{selectedModule.description}</p>\n                  \n                  {/* Module Progress Bar */}\n                  <div className=\"mt-3\">\n                    <div className=\"flex items-center justify-between text-sm text-gray-600 mb-1\">\n                      <span>Progress</span>\n                      <span>{selectedModule.content?.lessons?.filter(lesson => \n                        completedLessons.includes(`${String(selectedModule.id)}_${String(lesson.id)}`)\n                      ).length || 0}/{selectedModule.content?.lessons?.length || 0} lessons</span>\n                    </div>\n                    <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                      <div \n                        className=\"bg-[#21a1ce] h-2 rounded-full transition-all duration-300\" \n                        style={{ \n                          width: `${selectedModule.content?.lessons?.length > 0 ? \n                            (selectedModule.content.lessons.filter(lesson => \n                              completedLessons.includes(`${String(selectedModule.id)}_${String(lesson.id)}`)\n                            ).length / selectedModule.content.lessons.length) * 100 : 0\n                          }%` \n                        }}\n                      ></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </MobileCardHeader>\n            \n            <MobileCardContent>\n              <div className=\"space-y-3\">\n                {selectedModule.content?.lessons?.map(lesson => {\n                  const lessonKey = `${String(selectedModule.id)}_${String(lesson.id)}`\n                  const isCompleted = completedLessons.includes(lessonKey)\n                  \n                  return (\n                    <div \n                      key={lesson.id} \n                      className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => setSelectedLesson(lesson)}\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        {isCompleted ? (\n                          <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                        ) : (\n                          <div className=\"w-5 h-5 border-2 border-gray-300 rounded-full\"></div>\n                        )}\n                        <div>\n                          <h4 className=\"font-medium\">{lesson.title}</h4>\n                          <p className=\"text-sm text-gray-600\">{formatDuration(lesson.duration)} • {getLessonTypeLabel(lesson)}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        {lesson.contentType === 'warning' && (\n                          <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\n                        )}\n                        {lesson.contentType === 'example' && (\n                          <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\n                        )}\n                        <ArrowLeft className=\"w-4 h-4 text-gray-400 transform rotate-180\" />\n                      </div>\n                      \n                    </div>\n                  )\n                })}\n              </div>\n            </MobileCardContent>\n          </MobileCard>\n        </div>\n      ) : (\n        /* Lesson Content View */\n        <div>\n          <div className=\"flex items-center justify-between mb-4\">\n            <button \n              onClick={() => setSelectedLesson(null)}\n              className=\"flex items-center text-[#21a1ce] hover:underline text-sm\"\n            >\n              <ArrowLeft className=\"w-4 h-4 mr-1\" />\n              Back to lessons\n            </button>\n            {!completedLessons.includes(`${String(selectedModule.id)}_${String(selectedLesson.id)}`) && (\n              <MobileButton \n                onClick={() => markLessonComplete(selectedModule.id, selectedLesson.id)}\n                variant=\"primary\"\n                size=\"sm\"\n              >\n                Mark Complete\n              </MobileButton>\n            )}\n          </div>\n          \n          <MobileCard>\n            <MobileCardHeader>\n              <h2 className=\"text-xl font-bold text-gray-900\">{selectedLesson.title}</h2>\n              <div className=\"flex items-center space-x-2 text-sm text-gray-600\">\n                <span>{formatDuration(selectedLesson.duration)}</span>\n                <span>•</span>\n                <span>{getLessonTypeLabel(selectedLesson)}</span>\n              </div>\n            </MobileCardHeader>\n            \n            <MobileCardContent>\n              <LessonContent lesson={selectedLesson} />\n            </MobileCardContent>\n          </MobileCard>\n        </div>\n      )}\n      </div>\n      </MobilePullToRefresh>\n    </div>\n  )\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction LessonContent({ lesson }) {\n  const sanitizeHtml = (html) => {\n    if (!html) return ''\n    // Remove script/style and on* attributes\n    let safe = html.replace(/<\\/(?:script|style)>/gi, '\\n')\n    safe = safe.replace(/<\\s*(script|style)[^>]*>[\\s\\S]*?<\\s*\\/\\s*\\1\\s*>/gi, '')\n    safe = safe.replace(/ on[a-z]+\\s*=\\s*\"[^\"]*\"/gi, '')\n    safe = safe.replace(/ on[a-z]+\\s*=\\s*'[^']*'/gi, '')\n    safe = safe.replace(/ on[a-z]+\\s*=\\s*[^\\s>]+/gi, '')\n    // Disable anchor tags (make non-clickable spans)\n    safe = safe.replace(/<\\s*a\\b[^>]*>/gi, '<span class=\"text-[#21a1ce] underline cursor-default\" data-role=\"educational-link\">')\n    safe = safe.replace(/<\\s*\\/\\s*a\\s*>/gi, '</span>')\n    return safe\n  }\n\n  const markdownToHtml = (md) => {\n    if (!md) return ''\n    let out = md\n    // Escape HTML first\n    out = out.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    // Headings\n    out = out.replace(/^### (.*)$/gm, '<h4 class=\"font-semibold text-gray-900 mb-2\">$1</h4>')\n             .replace(/^## (.*)$/gm, '<h3 class=\"font-semibold text-gray-900 mb-2\">$1</h3>')\n             .replace(/^# (.*)$/gm, '<h2 class=\"font-bold text-gray-900 mb-2\">$1</h2>')\n    // Bold\n    out = out.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    // Links [text](url)\n    out = out.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<span class=\"text-[#21a1ce] underline cursor-default\" data-role=\"educational-link\" data-url=\"$2\">$1</span>')\n    // Bullet lines starting with - or *\n    out = out.replace(/^(?:- |\\* )(.*)$/gm, '<li>$1</li>')\n    // Wrap consecutive <li> into <ul>\n    out = out.replace(/(<li>.*<\\/li>\\n?)+/g, (m) => `<ul class=\"list-disc list-inside space-y-1\">${m}\\n</ul>`) \n    // Line breaks\n    out = out.replace(/\\n\\n/g, '<br/><br/>').replace(/\\n/g, '<br/>')\n    return out\n  }\n  const getContentStyle = (style) => {\n    switch (style) {\n      case 'blue':\n        return 'bg-blue-50 border-blue-200'\n      case 'yellow':\n        return 'bg-yellow-50 border-yellow-200'\n      case 'red':\n        return 'bg-red-50 border-red-200'\n      case 'green':\n        return 'bg-green-50 border-green-200'\n      default:\n        return 'bg-gray-50 border-gray-200'\n    }\n  }\n\n  const renderContent = () => {\n    switch (lesson.contentType) {\n      case 'tips':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-gray-700 whitespace-pre-line break-words\">{lesson.content}</div>\n            <div className=\"space-y-3\">\n              {lesson.tips?.map((tip, index) => (\n                <div key={index} className=\"flex items-start\">\n                  <div className=\"p-1 rounded-full mr-3 mt-1 bg-green-100\">\n                    <div className=\"w-2 h-2 rounded-full bg-green-500\"></div>\n                  </div>\n                  <div>\n                    <p className=\"font-medium whitespace-pre-line\">{tip.title}</p>\n                    <p className=\"text-sm text-gray-600 whitespace-pre-line\">{tip.description}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )\n      \n      case 'warning-signs':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-gray-700 whitespace-pre-line break-words\">{lesson.content}</div>\n            <div className=\"space-y-3\">\n              {lesson.signs?.map((sign, index) => (\n                <div key={index} className=\"flex items-start\">\n                  <div className={`p-1 rounded-full mr-3 mt-1 ${sign.danger ? 'bg-red-100' : 'bg-green-100'}`}>\n                    <div className={`w-2 h-2 rounded-full ${sign.danger ? 'bg-red-500' : 'bg-green-500'}`}></div>\n                  </div>\n                  <div>\n                    <p className=\"font-medium whitespace-pre-line\">{sign.title}</p>\n                    <p className=\"text-sm text-gray-600 whitespace-pre-line\">{sign.description}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )\n      \n      case 'steps':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-gray-700 whitespace-pre-line break-words\">{lesson.content}</div>\n            <div className=\"space-y-2\">\n              {lesson.steps?.map((step, index) => (\n                <div key={index} className=\"flex items-start\">\n                  <div className=\"w-6 h-6 rounded-full bg-[#21a1ce] text-white text-sm font-bold flex items-center justify-center mr-3 mt-0.5\">\n                    {index + 1}\n                  </div>\n                  <p className=\"text-gray-700 whitespace-pre-line\">{step}</p>\n                </div>\n              ))}\n            </div>\n          </div>\n        )\n      \n      case 'list':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-gray-700 whitespace-pre-line\">{lesson.content}</div>\n            <ul className=\"space-y-2 ml-4\">\n              {lesson.items?.map((item, index) => (\n                <li key={index} className=\"text-gray-700 whitespace-pre-line\">• {item}</li>\n              ))}\n            </ul>\n          </div>\n        )\n      \n      case 'warning':\n      case 'warning-list':\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <h4 className=\"font-bold mb-2 text-red-800\">Important</h4>\n            <div className=\"text-red-700 mb-3 whitespace-pre-line break-words\">{lesson.content}</div>\n            {lesson.items && (\n              <ul className=\"space-y-1 text-red-700\">\n                {lesson.items.map((item, index) => (\n                  <li key={index} className=\"whitespace-pre-line\">• {item}</li>\n                ))}\n              </ul>\n            )}\n          </div>\n        )\n      \n      case 'action-list':\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <h4 className=\"font-bold mb-2 text-green-800\">Actions to Take</h4>\n            <div className=\"text-green-700 mb-3 whitespace-pre-line break-words\">{lesson.content}</div>\n            <ul className=\"space-y-1 text-green-700\">\n              {lesson.actions?.map((action, index) => (\n                <li key={index} className=\"whitespace-pre-line\">• {action}</li>\n              ))}\n            </ul>\n          </div>\n        )\n      \n      case 'example':\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <h4 className=\"font-bold mb-2\">Real-World Example</h4>\n            <div className=\"text-gray-700 whitespace-pre-line break-words\">{lesson.content}</div>\n          </div>\n        )\n      \n      case 'markdown':\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <div className=\"prose prose-sm max-w-none break-words\" dangerouslySetInnerHTML={{ __html: sanitizeHtml(markdownToHtml(lesson.content)) }} />\n          </div>\n        )\n\n      case 'html':\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <div className=\"prose prose-sm max-w-none break-words\" dangerouslySetInnerHTML={{ __html: sanitizeHtml(lesson.content) }} />\n          </div>\n        )\n\n      default:\n        return (\n          <div className={`p-4 rounded-lg border ${getContentStyle(lesson.contentStyle)} break-words`}>\n            <div className=\"text-gray-700 whitespace-pre-line break-words\">{lesson.content}</div>\n          </div>\n        )\n    }\n  }\n\n  return (\n    <div className=\"space-y-6 break-words\">\n      {renderContent()}\n      {Array.isArray(lesson.media) && lesson.media.length > 0 && (\n        <div className=\"space-y-3\">\n          {lesson.media.map((item, idx) => (\n            <div key={idx} className=\"space-y-2\">\n              {item.type === 'image' ? (\n                <img\n                  src={item.url}\n                  alt={item.caption || lesson.title}\n                  className=\"w-full max-h-72 object-cover rounded-lg border border-gray-200\"\n                  loading=\"lazy\"\n                />\n              ) : item.type === 'video' ? (\n                <video\n                  controls\n                  className=\"w-full max-h-80 rounded-lg border border-gray-200\"\n                >\n                  <source src={item.url} />\n                  Your browser does not support the video tag.\n                </video>\n              ) : null}\n              {item.caption && (\n                <div className=\"text-xs text-gray-500\">{item.caption}</div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n\n","import { useState, useEffect, useCallback } from 'react';\nimport { API, API_ENDPOINTS, apiGet, apiPost, apiPut, apiDelete } from '../lib/api';\nimport { cloudinaryUnsignedUpload } from '../lib/utils';\n\nexport const useCommunity = () => {\n  const [reports, setReports] = useState([]);\n  const [trendingThreats, setTrendingThreats] = useState([]);\n  const [communityStats, setCommunityStats] = useState(null);\n  const [alerts, setAlerts] = useState([]);\n  const [leaderboard, setLeaderboard] = useState([]);\n  const [latestReports, setLatestReports] = useState([]);\n  const [myStats, setMyStats] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [pagination, setPagination] = useState(null);\n  const [hasMore, setHasMore] = useState(true);\n\n  // Fetch community reports\n  const fetchReports = useCallback(async (filters = {}, append = false) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const queryParams = new URLSearchParams(filters).toString();\n      const endpoint = `${API_ENDPOINTS.COMMUNITY.REPORTS}${queryParams ? `?${queryParams}` : ''}`;\n      \n      const response = await apiGet(endpoint);\n      if (response.ok) {\n        const data = await response.json();\n        \n        if (append && data.reports) {\n          setReports(prev => [...prev, ...data.reports]);\n        } else {\n          setReports(data.reports || data);\n        }\n        \n        if (data.pagination) {\n          setPagination(data.pagination);\n          setHasMore(data.pagination.has_next);\n        }\n        \n        return data;\n      } else {\n        throw new Error('Failed to fetch community reports');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching reports:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch trending threats\n  const fetchTrendingThreats = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await apiGet(API_ENDPOINTS.COMMUNITY.TRENDING);\n      if (response.ok) {\n        const data = await response.json();\n        // Backend returns { trending_threats: [...] }\n        setTrendingThreats(data.trending_threats || data);\n        return data;\n      } else {\n        throw new Error('Failed to fetch trending threats');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching trending threats:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch latest reports: 10 most recent with status APPROVED or VERIFIED and urgency HIGH\n  const fetchLatestReports = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      // Fetch a larger page and filter client-side to meet multi-status and urgency criteria\n      const params = new URLSearchParams({ per_page: 50, sort: 'newest', include_all: 'true' }).toString();\n      const response = await apiGet(`${API_ENDPOINTS.COMMUNITY.REPORTS}?${params}`);\n      if (response.ok) {\n        const data = await response.json();\n        const all = data.reports || [];\n        const filtered = all.filter(r => (r.status === 'APPROVED' || r.status === 'VERIFIED') && r.verified === true && r.urgency === 'HIGH');\n        const topTen = filtered.slice(0, 10);\n        setLatestReports(topTen);\n        return { reports: topTen };\n      } else {\n        throw new Error('Failed to fetch latest reports');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching latest reports:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch a single report with full details (including all comments)\n  const fetchReportById = useCallback(async (reportId) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const response = await apiGet(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}`);\n      if (response.ok) {\n        const data = await response.json();\n        return { success: true, report: data };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch report');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // List comments with pagination\n  const fetchComments = useCallback(async (reportId, { page = 1, per_page = 20 } = {}) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const params = new URLSearchParams({ page, per_page }).toString();\n      const response = await apiGet(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/comments?${params}`);\n      if (response.ok) {\n        const data = await response.json();\n        return { success: true, ...data };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to fetch comments');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Delete a comment\n  const deleteComment = useCallback(async (commentId) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const response = await apiDelete(`/api/community/comments/${commentId}`);\n      if (response.ok) {\n        return { success: true };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to delete comment');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch community statistics\n  const fetchCommunityStats = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await apiGet(API_ENDPOINTS.COMMUNITY.STATS);\n      if (response.ok) {\n        const data = await response.json();\n        setCommunityStats(data);\n        return data;\n      } else {\n        throw new Error('Failed to fetch community statistics');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching community stats:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch community alerts\n  const fetchAlerts = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await apiGet(API_ENDPOINTS.COMMUNITY.ALERTS);\n      if (response.ok) {\n        const data = await response.json();\n        // Backend returns { alerts: [...], pagination: { ... } }\n        setAlerts(data.alerts || data);\n        return data;\n      } else {\n        throw new Error('Failed to fetch community alerts');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching alerts:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch leaderboard\n  const fetchLeaderboard = useCallback(async ({ period = '90d' } = {}) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const qs = new URLSearchParams({ period }).toString();\n      const response = await apiGet(`${API_ENDPOINTS.COMMUNITY.LEADERBOARD}?${qs}`);\n      if (response.ok) {\n        const data = await response.json();\n        setLeaderboard((data && data.leaderboard) ? data.leaderboard : (Array.isArray(data) ? data : []));\n        return data;\n      } else {\n        throw new Error('Failed to fetch leaderboard');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching leaderboard:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Fetch current user's reporting stats\n  const fetchMyStats = useCallback(async ({ period = '90d' } = {}) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const qs = new URLSearchParams({ period }).toString();\n      const response = await apiGet(`${API_ENDPOINTS.COMMUNITY.MY_STATS}?${qs}`);\n      if (response.ok) {\n        const data = await response.json();\n        setMyStats(data);\n        return data;\n      } else {\n        throw new Error('Failed to fetch my stats');\n      }\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching my stats:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Create new report\n  const createReport = useCallback(async (reportData) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // Map UI fields to backend expected payload\n      const payload = {\n        threat_type: reportData.threat_type,\n        description: reportData.description,\n        location: reportData.location,\n        urgency: reportData.urgency || 'MEDIUM'\n      };\n      const response = await apiPost(API_ENDPOINTS.COMMUNITY.REPORTS, payload);\n      if (response.ok) {\n        const { report } = await response.json();\n        setReports(prev => [report, ...prev]);\n        return { success: true, report };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to create report');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Upload media to a report (accepts File or remote URL)\n  const uploadReportMedia = useCallback(async (reportId, fileOrUrl) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      let response;\n      if (fileOrUrl instanceof File) {\n        // Direct-to-Cloudinary to avoid server size limits\n        const uploaded = await cloudinaryUnsignedUpload(fileOrUrl, { folder: 'community_reports' });\n        response = await apiPost(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/media`, {\n          media_url: uploaded.url,\n          media_type: uploaded.resource_type === 'video' ? 'video' : 'image'\n        });\n      } else {\n        response = await apiPost(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/media`, {\n          media_url: String(fileOrUrl),\n          media_type: 'image'\n        });\n      }\n\n      if (response.ok) {\n        const data = await response.json();\n        const media = data.media || data;\n        // Optionally update report media in local state\n        setReports(prev => prev.map(r => r.id === reportId ? { ...r, media: [...(r.media || []), media] } : r));\n        return { success: true, media };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.error || errorData.message || 'Failed to upload media');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, [setReports]);\n\n  // Delete report (owner or admin)\n  const deleteReport = useCallback(async (reportId) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      const response = await apiDelete(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}`);\n      if (response.ok) {\n        setReports(prev => prev.filter(r => r.id !== reportId));\n        return { success: true };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to delete report');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Vote on report\n  const voteOnReport = useCallback(async (reportId, voteType) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // voteType should be 'up' | 'down'\n      const response = await apiPost(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/vote`, {\n        vote_type: voteType\n      });\n      if (response.ok) {\n        const data = await response.json();\n        const updatedReport = data.report || data;\n        // Update the report in the list\n        setReports(prev => prev.map(r => \n          r.id === reportId ? { ...updatedReport } : r\n        ));\n        return { success: true, data: updatedReport };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to vote on report');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Verify report\n  const verifyReport = useCallback(async (reportId, verificationData) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await apiPost(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/verify`, verificationData);\n      if (response.ok) {\n        const data = await response.json();\n        const updatedReport = data.report || data;\n        // Update the report in the list\n        setReports(prev => prev.map(r => \n          r.id === reportId ? { ...updatedReport } : r\n        ));\n        return { success: true, data: updatedReport };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to verify report');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Add comment to report\n  const addComment = useCallback(async (reportId, commentData) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await apiPost(`${API_ENDPOINTS.COMMUNITY.REPORTS}/${reportId}/comment`, commentData);\n      if (response.ok) {\n        const result = await response.json();\n        const newComment = { id: result.comment_id, comment: commentData.comment };\n        // Update the report in the list (UI may render simple comments)\n        setReports(prev => prev.map(r => \n          r.id === reportId ? { ...r, comments: [...(r.comments || []), newComment] } : r\n        ));\n        return { success: true, comment: newComment };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to add comment');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Create alert\n  const createAlert = useCallback(async (alertData) => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      // Map UI fields to backend expected payload\n      const payload = {\n        message: alertData.message,\n        severity: (alertData.priority || 'medium').toUpperCase(),\n        threat_type: alertData.title\n      };\n      const response = await apiPost(API_ENDPOINTS.COMMUNITY.ALERTS, payload);\n      if (response.ok) {\n        const { alert } = await response.json();\n        setAlerts(prev => [alert, ...prev]);\n        return { success: true, alert };\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to create alert');\n      }\n    } catch (err) {\n      setError(err.message);\n      return { success: false, error: err.message };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  // Load all data\n  const loadAllData = useCallback(async ({ period = '90d' } = {}) => {\n    await Promise.all([\n      fetchReports({}, false), // Reset reports, don't append\n      fetchTrendingThreats(),\n      fetchLatestReports(),\n      fetchCommunityStats(),\n      fetchAlerts(),\n      fetchLeaderboard({ period }),\n      fetchMyStats({ period })\n    ]);\n  }, [fetchReports, fetchTrendingThreats, fetchLatestReports, fetchCommunityStats, fetchAlerts, fetchLeaderboard, fetchMyStats]);\n\n  // Clear error\n  const clearError = useCallback(() => setError(null), []);\n\n  return {\n    reports,\n    trendingThreats,\n    communityStats,\n    alerts,\n    leaderboard,\n    latestReports,\n    myStats,\n    isLoading,\n    error,\n    pagination,\n    hasMore,\n    fetchReports,\n    fetchTrendingThreats,\n    fetchLatestReports,\n    fetchComments,\n    deleteComment,\n    fetchReportById,\n    fetchCommunityStats,\n    fetchAlerts,\n    fetchLeaderboard,\n    fetchMyStats,\n    createReport,\n    voteOnReport,\n    verifyReport,\n    addComment,\n    createAlert,\n    uploadReportMedia,\n    deleteReport,\n    loadAllData,\n    clearError\n  };\n};\n","import React, { useEffect } from 'react';\nimport { X } from 'lucide-react';\nimport { Button } from './ui/button';\n\nexport default function MobileModal({ \n  isOpen, \n  onClose, \n  title, \n  children, \n  showCloseButton = true,\n  fullScreen = false,\n  hideOnDesktop = true\n}) {\n  // Close on escape key\n  useEffect(() => {\n    const handleEscape = (e) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n      // Prevent body scroll on mobile\n      document.body.style.overflow = 'hidden';\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n      document.body.style.overflow = 'unset';\n    };\n  }, [isOpen, onClose]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className={`fixed inset-0 z-50 ${hideOnDesktop ? 'md:hidden' : ''}`}>\n      {/* Backdrop */}\n      <div \n        className=\"absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm\"\n        onClick={onClose}\n      />\n      \n      {/* Modal Content */}\n      <div className={`absolute inset-0 bg-white ${\n        fullScreen ? 'rounded-none' : 'rounded-t-3xl'\n      } transform transition-transform duration-300 ease-out ${\n        isOpen ? 'translate-y-0' : 'translate-y-full'\n      }`}>\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n          <h2 className=\"text-lg font-semibold text-gray-900\">{title}</h2>\n          {showCloseButton && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onClose}\n              className=\"p-2 rounded-full hover:bg-gray-100\"\n            >\n              <X className=\"w-5 h-5 text-gray-600\" />\n            </Button>\n          )}\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-4\">\n          {children}\n        </div>\n\n        {/* Bottom safe area for devices with home indicators */}\n        <div className=\"h-4 bg-white\" />\n      </div>\n    </div>\n  );\n}\n","import { registerPlugin } from '@capacitor/core';\nconst Browser = registerPlugin('Browser', {\n    web: () => import('./web').then(m => new m.BrowserWeb()),\n});\nexport * from './definitions';\nexport { Browser };\n//# sourceMappingURL=index.js.map","import { registerPlugin } from '@capacitor/core';\nconst App = registerPlugin('App', {\n    web: () => import('./web').then(m => new m.AppWeb()),\n});\nexport * from './definitions';\nexport { App };\n//# sourceMappingURL=index.js.map","import { registerPlugin } from '@capacitor/core';\nconst SocialLogin = registerPlugin('SocialLogin', {\n    web: () => import('./web').then((m) => new m.SocialLoginWeb()),\n});\nexport * from './definitions';\nexport { SocialLogin };\n//# sourceMappingURL=index.js.map","import React, { useState, useEffect, useRef } from 'react';\nimport { Browser } from '@capacitor/browser';\nimport { App as CapApp } from '@capacitor/app';\nimport { Capacitor, registerPlugin, CapacitorHttp } from '@capacitor/core';\nimport { SocialLogin } from '@capgo/capacitor-social-login';\nconst AppleSignIn = registerPlugin('AppleSignInPlugin');\nimport { useAuth } from '../hooks/useAuth';\n\nconst Login = ({ onLoginSuccess, onSwitchToRegister }) => {\n  const [formData, setFormData] = useState({\n    email: '',\n    password: ''\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const { login, error, user, isAuthenticated, requestPasswordReset } = useAuth();\n  const [infoMsg, setInfoMsg] = useState('');\n  const [oauthLoading, setOauthLoading] = useState(false);\n\n  const deepLinkListenerRef = useRef(null)\n\n  const finalizeOAuthFromUrl = async (url) => {\n    try {\n      if (!url) return false\n      const googleReversed = 'com.googleusercontent.apps.453799187435-8omnd1nnnb92c3g2qos0qd43ch7c3h3r:/oauthredirect'\n      const isAppScheme = url.startsWith('remalehprotect://auth-callback')\n      const isGoogleScheme = url.startsWith(googleReversed)\n      if (!isAppScheme && !isGoogleScheme) return false\n      const qsIndex = url.indexOf('?')\n      const params = new URLSearchParams(qsIndex >= 0 ? url.slice(qsIndex) : '')\n      const provider = params.get('provider') || 'google'\n      const token = params.get('token') || params.get('access_token') || params.get('id_token')\n      const refreshToken = params.get('refresh_token') || ''\n      const code = params.get('code')\n      const state = params.get('state') || ''\n      const apiBase = import.meta.env.VITE_API_BASE || 'http://localhost:10000'\n\n      if (token) {\n        localStorage.setItem('authToken', token)\n        if (refreshToken) localStorage.setItem('refreshToken', refreshToken)\n        window.dispatchEvent(new Event('remaleh-auth-changed'))\n        return true\n      }\n\n      if (code) {\n        const resp = await fetch(`${apiBase}/api/auth/oauth/${provider}/exchange`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ code, redirect_uri: isGoogleScheme ? `${googleReversed}` : 'remalehprotect://auth-callback', state })\n        })\n        if (resp.ok) {\n          const data = await resp.json()\n          if (data.token) {\n            localStorage.setItem('authToken', data.token)\n            if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n            window.dispatchEvent(new Event('remaleh-auth-changed'))\n            return true\n          }\n        }\n      }\n      return false\n    } catch (err) {\n      console.error('OAuth finalize error:', err)\n      return false\n    }\n  }\n\n  // Watch for authentication changes and redirect accordingly\n  useEffect(() => {\n    if (isAuthenticated && user && onLoginSuccess) {\n      onLoginSuccess();\n    }\n  }, [isAuthenticated, user, onLoginSuccess]);\n\n  useEffect(() => {\n    if (Capacitor.getPlatform() === 'ios') {\n      deepLinkListenerRef.current = CapApp.addListener('appUrlOpen', async ({ url }) => {\n        const ok = await finalizeOAuthFromUrl(url)\n        if (ok) {\n          try { await Browser.close() } catch {}\n          window.location.reload()\n        }\n      })\n    }\n    return () => {\n      if (deepLinkListenerRef.current && deepLinkListenerRef.current.remove) deepLinkListenerRef.current.remove()\n    }\n  }, [])\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    // Basic validation\n    if (!formData.email.trim() || !formData.password.trim()) {\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      const result = await login(formData.email, formData.password);\n      \n      if (!result.success) {\n        // Error is already set in useAuth hook\n        console.error('Login failed:', result.error);\n      }\n    } catch (error) {\n      console.error('Login error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8\">\n      <div className=\"sm:mx-auto sm:w-full sm:max-w-md\">\n        <div className=\"flex justify-center\">\n          <img \n            src=\"/remaleh-logo.png\" \n            alt=\"Remaleh Protect\" \n            className=\"h-12 w-auto\"\n          />\n        </div>\n        <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n          Sign in to your account\n        </h2>\n        <p className=\"mt-2 text-center text-sm text-gray-600\">\n          Access your digital security dashboard\n        </p>\n      </div>\n\n      <div className=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n        <div className=\"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10\">\n          <form className=\"space-y-6\" onSubmit={handleSubmit}>\n            {error && (\n              <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n                <div className=\"flex\">\n                  <div className=\"flex-shrink-0\">\n                    <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                  <div className=\"ml-3\">\n                    <p className=\"text-sm text-red-800\">{error}</p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email address\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  autoComplete=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={handleChange}\n                  className=\"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n                  placeholder=\"Enter your email\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Password\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  autoComplete=\"current-password\"\n                  required\n                  value={formData.password}\n                  onChange={handleChange}\n                  className=\"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\n                  placeholder=\"Enter your password\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center\">\n                <input\n                  id=\"remember-me\"\n                  name=\"remember-me\"\n                  type=\"checkbox\"\n                  className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                />\n                <label htmlFor=\"remember-me\" className=\"ml-2 block text-sm text-gray-900\">\n                  Remember me\n                </label>\n              </div>\n\n              <div className=\"text-sm\">\n                <button\n                  type=\"button\"\n                  onClick={async () => {\n                    if (!formData.email.trim()) {\n                      setInfoMsg('Enter your email above, then click reset.');\n                      return;\n                    }\n                    const res = await requestPasswordReset(formData.email.trim());\n                    setInfoMsg(res.message || 'If this email exists, a temporary password has been sent.');\n                  }}\n                  className=\"font-medium text-blue-600 hover:text-blue-500\"\n                >\n                  Forgot your password?\n                </button>\n              </div>\n            </div>\n            {infoMsg && (\n              <div className=\"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800\">\n                {infoMsg}\n              </div>\n            )}\n\n            {/* OAuth Divider */}\n            <div className=\"relative my-4\">\n              <div className=\"absolute inset-0 flex items-center\" aria-hidden=\"true\">\n                <div className=\"w-full border-t border-gray-200\" />\n              </div>\n              <div className=\"relative flex justify-center text-sm\">\n                <span className=\"bg-white px-2 text-gray-500\">or</span>\n              </div>\n            </div>\n\n            {/* Google Sign-in */}\n            <div className=\"grid grid-cols-1 gap-2\">\n              <button\n                type=\"button\"\n                onClick={async () => {\n                  try {\n                    setOauthLoading(true)\n                    const apiBase = import.meta.env.VITE_API_BASE || 'http://localhost:10000'\n                    if (Capacitor.getPlatform() === 'ios') {\n                      try {\n                        // Prefer native SocialLogin plugin on iOS\n                        const res = await SocialLogin.login({ provider: 'google', options: { scopes: ['openid', 'email', 'profile'] } })\n                        const r = res?.result || res\n                        console.log('[OAuth][Google] plugin result keys:', Object.keys(r || {}))\n                        // Prefer server-side exchange via backend if code is present\n                        if (r && (r.serverAuthCode || r.authorizationCode)) {\n                          const code = r.serverAuthCode || r.authorizationCode\n                          const exchange = await fetch(`${apiBase}/api/auth/oauth/google/exchange`, {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ code, redirect_uri: 'com.googleusercontent.apps.453799187435-8omnd1nnnb92c3g2qos0qd43ch7c3h3r:/oauthredirect' })\n                          })\n                          if (exchange.ok) {\n                            const data = await exchange.json()\n                            if (data.token) {\n                              localStorage.setItem('authToken', data.token)\n                              if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                              window.dispatchEvent(new Event('remaleh-auth-changed'))\n                              window.location.reload()\n                              return\n                            }\n                          }\n                        }\n                        // Fallback to idToken flow if available\n                        // Try code -> id_token -> access_token\n                        const idTok = r?.idToken || r?.id_token || r?.authentication?.idToken\n                        if (idTok) {\n                          console.log('[OAuth][Google] Posting id_token to backend')\n                          const verify = await fetch(`${apiBase}/api/auth/oauth/google/idtoken`, {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ id_token: idTok })\n                          })\n                          if (verify.ok) {\n                            const data = await verify.json()\n                            if (data.token) {\n                              localStorage.setItem('authToken', data.token)\n                              if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                              window.dispatchEvent(new Event('remaleh-auth-changed'))\n                              window.location.reload()\n                              return\n                            }\n                          }\n                        }\n                        const accessTok = r?.accessToken?.token || r?.access_token\n                        if (accessTok) {\n                          console.log('[OAuth][Google] Sending access_token to backend...', { url: `${apiBase}/api/auth/oauth/google/access-token` })\n                          const verify = await fetch(`${apiBase}/api/auth/oauth/google/access-token`, {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({ access_token: accessTok })\n                          })\n                          console.log('[OAuth][Google] access-token response status:', verify.status)\n                          if (verify.ok) {\n                            const data = await verify.json()\n                            if (data.token) {\n                              localStorage.setItem('authToken', data.token)\n                              if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                              window.dispatchEvent(new Event('remaleh-auth-changed'))\n                              window.location.reload()\n                              return\n                            }\n                          } else {\n                            try {\n                              const errText = await verify.text()\n                              console.log('[OAuth][Google] access-token error body:', errText)\n                            } catch (_) {}\n                          }\n                        }\n                        setInfoMsg('Google sign-in could not complete.')\n                      } catch (err) {\n                        setInfoMsg('Google sign-in is not available right now.')\n                      }\n                    } else {\n                      // Existing web/deeplink flow\n                      const resp = await fetch(`${apiBase}/api/auth/oauth/google/start`)\n                      if (!resp.ok) throw new Error('google start failed')\n                      const data = await resp.json()\n                      if (!data.auth_url) throw new Error('no auth url')\n                      if (Capacitor.getPlatform() === 'ios') {\n                        const listener = await CapApp.addListener('appUrlOpen', async ({ url }) => {\n                          try {\n                            const ok = await finalizeOAuthFromUrl(url)\n                            await Browser.close()\n                            if (ok) window.location.reload()\n                          } catch {}\n                        })\n                        const url = data.auth_url + (data.auth_url.includes('?') ? '&' : '?') + 'deeplink=1'\n                        await Browser.open({ url, presentationStyle: 'popover' })\n                        setTimeout(() => listener.remove && listener.remove(), 120000)\n                      } else {\n                        window.location.href = data.auth_url\n                      }\n                    }\n                  } catch (e) {\n                    setInfoMsg('Google sign-in is not available right now.')\n                  } finally {\n                    setOauthLoading(false)\n                  }\n                }}\n                disabled={oauthLoading}\n                className=\"w-full flex items-center justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium bg-white hover:bg-gray-50 disabled:opacity-50\"\n              >\n                <img src=\"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg\" alt=\"Google\" className=\"w-4 h-4 mr-2\" />\n                Continue with Google\n              </button>\n              <button\n                type=\"button\"\n                onClick={async () => {\n                  try {\n                    setOauthLoading(true)\n                    const apiBase = import.meta.env.VITE_API_BASE || 'http://localhost:10000'\n                    if (Capacitor.getPlatform() === 'ios') {\n                      try {\n                        const res = await SocialLogin.login({ provider: 'apple', options: { scopes: ['email', 'name'] } })\n                        const ar = res?.result || res\n                        if (ar && (ar.authorizationCode || ar.identityToken || ar.accessToken?.token)) {\n                          // Prefer native authorizationCode exchange\n                          if (ar.authorizationCode) {\n                            const exchange = await CapacitorHttp.request({\n                              url: `${apiBase}/api/auth/oauth/apple/exchange`,\n                              method: 'POST',\n                              headers: { 'Content-Type': 'application/json' },\n                              data: { code: ar.authorizationCode, redirect_uri: 'https://api.remalehprotect.remaleh.com.au/api/auth/oauth/apple/callback' }\n                            })\n                            if (exchange.status >= 200 && exchange.status < 300) {\n                              const data = exchange.data\n                              if (data.token) {\n                                localStorage.setItem('authToken', data.token)\n                                if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                                window.dispatchEvent(new Event('remaleh-auth-changed'))\n                                return\n                              }\n                            }\n                          }\n                          // Fallback to identityToken verification endpoint if provided\n                          const possibleIdToken = ar.identityToken || ar.accessToken?.token\n                          if (possibleIdToken) {\n                            const verify = await CapacitorHttp.request({\n                              url: `${apiBase}/api/auth/oauth/apple/idtoken`,\n                              method: 'POST',\n                              headers: { 'Content-Type': 'application/json' },\n                              data: { id_token: possibleIdToken, nonce: ar.nonce || undefined }\n                            })\n                            if (verify.status >= 200 && verify.status < 300) {\n                              const data = verify.data\n                              if (data.token) {\n                                localStorage.setItem('authToken', data.token)\n                                if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                                window.dispatchEvent(new Event('remaleh-auth-changed'))\n                                return\n                              }\n                            }\n                          }\n                        }\n                        setInfoMsg('Apple sign-in could not complete.')\n                      } catch (err) {\n                        setInfoMsg('Apple sign-in is not available right now.')\n                      }\n                    } else if (Capacitor.getPlatform() === 'ios') {\n                      const res = await AppleSignIn.signIn()\n                      const body = {\n                        identity_token: res.identityToken,\n                        authorization_code: res.authorizationCode,\n                        nonce: res.nonce || undefined,\n                        email: res.email || undefined,\n                        name: res.fullName || undefined,\n                        apple_user: res.user || undefined\n                      }\n                      const exchange = await CapacitorHttp.request({\n                        url: `${apiBase}/api/auth/oauth/apple/native`,\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        data: body\n                      })\n                      if (exchange.status >= 200 && exchange.status < 300) {\n                        const data = exchange.data\n                        if (data.token) {\n                          localStorage.setItem('authToken', data.token)\n                          if (data.refresh_token) localStorage.setItem('refreshToken', data.refresh_token)\n                          window.dispatchEvent(new Event('remaleh-auth-changed'))\n                          return\n                        }\n                      }\n                      setInfoMsg('Apple sign-in could not complete.')\n                    } else {\n                      // Fallback to web flow\n                      const resp = await fetch(`${apiBase}/api/auth/oauth/apple/start`)\n                      if (resp.ok) {\n                        const data = await resp.json()\n                        if (data.auth_url) window.location.href = data.auth_url\n                      } else {\n                        setInfoMsg('Apple sign-in is not available right now.')\n                      }\n                    }\n                  } catch (e) {\n                    setInfoMsg('Apple sign-in is not available right now.')\n                  } finally {\n                    setOauthLoading(false)\n                  }\n                }}\n                disabled={oauthLoading}\n                className=\"w-full flex items-center justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium bg-white hover:bg-gray-50 disabled:opacity-50\"\n              >\n                <svg viewBox=\"0 0 24 24\" className=\"w-4 h-4 mr-2\" fill=\"currentColor\" aria-hidden=\"true\"><path d=\"M16.365 1.43c0 1.14-.495 2.294-1.293 3.184-.822.914-2.2 1.622-3.364 1.53-.146-1.12.51-2.314 1.315-3.19.823-.892 2.26-1.646 3.342-1.524zM20.66 17.03c-.836 1.93-1.85 3.84-3.338 3.865-1.464.03-1.934-.93-3.607-.93-1.673 0-2.19.9-3.565.96-1.43.06-2.513-2.08-3.36-4.01-1.832-4.038-1.01-9.19 1.288-11.71.85-.94 1.98-1.55 3.168-1.58 1.3-.03 2.52.89 3.603.89 1.085 0 2.4-1.1 4.05-.94.69.03 2.62.28 3.864 2.12-.1.06-2.31 1.35-2.2 4.02.1 3.23 2.84 4.3 2.94 4.35z\"/></svg>\n                Continue with Apple\n              </button>\n            </div>\n            {infoMsg && (\n              <div className=\"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md text-sm text-blue-800\">\n                {infoMsg}\n              </div>\n            )}\n\n            <div>\n              <button\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isLoading ? (\n                  <div className=\"flex items-center\">\n                    <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                    Signing in...\n                  </div>\n                ) : (\n                  'Sign in'\n                )}\n              </button>\n            </div>\n          </form>\n\n          <div className=\"mt-6\">\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <div className=\"w-full border-t border-gray-300\" />\n              </div>\n              <div className=\"relative flex justify-center text-sm\">\n                <span className=\"px-2 bg-white text-gray-500\">New to Remaleh Protect?</span>\n              </div>\n            </div>\n\n            <div className=\"mt-6\">\n              <button\n                onClick={() => {\n                  if (onSwitchToRegister) {\n                    onSwitchToRegister();\n                  }\n                }}\n                className=\"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              >\n                Create an account\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { Users, Flag, Trophy, TrendingUp, Plus, Star, CheckCircle, ThumbsUp, ThumbsDown, MessageSquare, Trash2, HelpingHand, Shield, Eye, HelpCircle } from 'lucide-react';\nimport { MobileCard } from './ui/mobile-card';\nimport { MobileButton } from './ui/mobile-button';\nimport { useAuth } from '../hooks/useAuth';\nimport { useCommunity } from '../hooks/useCommunity';\nimport { Button } from './ui/button';\nimport { MobileInput } from './ui/mobile-input';\nimport { MobileTextarea } from './ui/mobile-input';\nimport { MobileSelect, MobileSearchInput } from './ui/mobile-input';\nimport { API } from '../lib/api';\nimport MobileModal from './MobileModal';\nimport Login from './Login';\nimport MobilePullToRefresh from './MobilePullToRefresh';\n\nexport default function CommunityHub({ setActiveTab }) {\n  const [activeTab, setActiveTabLocal] = useState('reports');\n  const { reports, latestReports, fetchLatestReports, fetchReports, leaderboard, trendingThreats, myStats, loadAllData, isLoading, pagination, hasMore, createReport, uploadReportMedia, deleteReport, voteOnReport, addComment, fetchReportById, fetchComments, deleteComment, fetchLeaderboard, fetchMyStats } = useCommunity();\n  const { user, isAuthenticated } = useAuth();\n\n  const [showNewReport, setShowNewReport] = useState(false);\n  const [newReport, setNewReport] = useState({\n    description: '',\n    threat_type: 'SCAM',\n    urgency: 'MEDIUM',\n    location: ''\n  });\n  const [newReportFiles, setNewReportFiles] = useState([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [toast, setToast] = useState(null); // { type: 'success' | 'error', message: string }\n\n  // Lightbox for media\n  const [lightboxOpen, setLightboxOpen] = useState(false);\n  const [lightboxImages, setLightboxImages] = useState([]);\n  const [lightboxIndex, setLightboxIndex] = useState(0);\n\n  // Comments modal\n  const [commentsModalOpen, setCommentsModalOpen] = useState(false);\n  const [commentsReport, setCommentsReport] = useState(null);\n  const [commentsPage, setCommentsPage] = useState(1);\n  const [commentsHasMore, setCommentsHasMore] = useState(false);\n\n  // Inline comment inputs per report\n  const [commentTexts, setCommentTexts] = useState({}); // { [reportId]: text }\n\n  const [pointsPeriod, setPointsPeriod] = useState('90d'); // '90d' | 'all'\n  const [myStatusFilter, setMyStatusFilter] = useState('ALL'); // ALL | PENDING | APPROVED | VERIFIED | REJECTED\n\n  // Feed filters/search\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filterThreatType, setFilterThreatType] = useState('ALL');\n  const [filterUrgency, setFilterUrgency] = useState('ALL');\n  const [verifiedOnly, setVerifiedOnly] = useState(false);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      loadAllData({ period: pointsPeriod });\n    }\n  }, [isAuthenticated, loadAllData, pointsPeriod]);\n\n  // Ensure My Reports includes own reports regardless of approval/verification status\n  useEffect(() => {\n    if (!isAuthenticated) return;\n    if (activeTab === 'my_reports') {\n      // include_own=true causes backend to include user's reports of any status\n      fetchReports({ include_own: 'true' }, false);\n    }\n  }, [activeTab, isAuthenticated, fetchReports]);\n\n  \n\n  // Proper infinite scroll with pagination\n  useEffect(() => {\n    const handleScroll = () => {\n      if (activeTab !== 'feed') return;\n      const nearBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 200;\n      if (nearBottom && !isLoading && hasMore && pagination) {\n        const nextPage = pagination.next_num;\n        if (nextPage) {\n          fetchReports({ page: nextPage }, true); // Append to existing reports\n        }\n      }\n    };\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, [activeTab, isLoading, hasMore, pagination, fetchReports]);\n\n  const filteredFeedReports = useMemo(() => {\n    if (!reports || reports.length === 0) return [];\n    return reports.filter((r) => {\n      const matchesSearch = searchQuery\n        ? (r.description || '').toLowerCase().includes(searchQuery.toLowerCase()) ||\n          (r.location || '').toLowerCase().includes(searchQuery.toLowerCase()) ||\n          (r.threat_type || '').toLowerCase().includes(searchQuery.toLowerCase())\n        : true;\n      const matchesType = filterThreatType === 'ALL' ? true : (r.threat_type === filterThreatType);\n      const matchesUrgency = filterUrgency === 'ALL' ? true : (r.urgency === filterUrgency);\n      const matchesVerified = verifiedOnly ? !!r.verified : true;\n      return matchesSearch && matchesType && matchesUrgency && matchesVerified;\n    });\n  }, [reports, searchQuery, filterThreatType, filterUrgency, verifiedOnly]);\n\n  const resolveMediaUrl = (url) => {\n    if (!url) return '';\n    if (url.startsWith('http')) return url;\n    try {\n      // Use URL to safely join base and path, avoiding double slashes\n      return new URL(url, API).toString();\n    } catch (e) {\n      return `${API}${url}`;\n    }\n  };\n\n  const isImageMedia = (media) => {\n    if (!media || !media.media_type) return true; // default to image if unspecified\n    return media.media_type.toLowerCase().startsWith('image');\n  };\n\n  const isVideoMedia = (media) => {\n    if (!media || !media.media_type) return false;\n    return media.media_type.toLowerCase().startsWith('video');\n  };\n\n  const openLightbox = (mediaList, startIndex = 0) => {\n    const images = (mediaList || [])\n      .filter(isImageMedia)\n      .map(m => ({ id: m.id, src: resolveMediaUrl(m.media_url) }))\n      .filter(i => !!i.src);\n    if (images.length > 0) {\n      setLightboxImages(images);\n      setLightboxIndex(Math.max(0, Math.min(startIndex, images.length - 1)));\n      setLightboxOpen(true);\n    }\n  };\n\n  const handleViewAllComments = async (reportId) => {\n    setCommentsPage(1);\n    const res = await fetchComments(reportId, { page: 1, per_page: 20 });\n    if (res.success) {\n      setCommentsReport({ id: reportId, comments: res.comments || [] });\n      setCommentsHasMore((res.pagination?.page || 1) < (res.pagination?.pages || 1));\n      setCommentsModalOpen(true);\n    }\n  };\n\n  const handleLoadMoreComments = async () => {\n    if (!commentsReport) return;\n    const nextPage = commentsPage + 1;\n    const res = await fetchComments(commentsReport.id, { page: nextPage, per_page: 20 });\n    if (res.success) {\n      setCommentsReport(prev => ({ ...prev, comments: [...(prev.comments || []), ...(res.comments || [])] }));\n      setCommentsPage(nextPage);\n      setCommentsHasMore((res.pagination?.page || nextPage) < (res.pagination?.pages || nextPage));\n    }\n  };\n\n  const handleDeleteComment = async (commentId) => {\n    const res = await deleteComment(commentId);\n    if (res.success) {\n      setCommentsReport(prev => ({ ...prev, comments: (prev.comments || []).filter(c => c.id !== commentId) }));\n    }\n  };\n\n  const tabs = [\n    { id: 'reports', label: 'Report Scam', icon: Flag },\n    { id: 'feed', label: 'Community Reports', icon: Users },\n    { id: 'my_reports', label: 'My Reports', icon: CheckCircle },\n    { id: 'leaderboard', label: 'Leaderboard', icon: Trophy },\n    { id: 'latest', label: 'Latest Scams', icon: TrendingUp }\n  ];\n\n  const renderContent = () => {\n    switch (activeTab) {\n      case 'reports':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Report a Scam</h3>\n              <p className=\"text-sm text-gray-600\">Help protect others by reporting scams you encounter</p>\n            </div>\n            \n            <MobileCard className=\"bg-blue-50 border-blue-200\">\n              <div className=\"p-4\">\n                <div className=\"flex items-center space-x-3 mb-3\">\n                  <div className=\"p-2 bg-blue-100 rounded-lg\">\n                    <Flag className=\"w-5 h-5 text-blue-600\" />\n                  </div>\n                  <div>\n                    <h4 className=\"font-semibold text-gray-900\">Your Reporting Stats</h4>\n                    <p className=\"text-sm text-gray-600\">Keep reporting to climb the leaderboard!</p>\n                  </div>\n                </div>\n                <div className=\"flex justify-end mb-2\">\n                  <select\n                    value={pointsPeriod}\n                    onChange={(e) => {\n                      const v = e.target.value;\n                      setPointsPeriod(v);\n                      // Refresh stats + leaderboard for chosen period\n                      fetchMyStats({ period: v });\n                      fetchLeaderboard({ period: v });\n                    }}\n                    className=\"text-xs border border-gray-300 rounded px-2 py-1\"\n                  >\n                    <option value=\"90d\">Last 90 days</option>\n                    <option value=\"all\">All time</option>\n                  </select>\n                </div>\n                {\n                  // Determine tier styling\n                }\n                {(() => {\n                  const tierRaw = (myStats?.tier || '').toString();\n                  const t = tierRaw.toLowerCase();\n                  const hasTier = !!tierRaw;\n                  const gridCols = hasTier ? 'grid-cols-4' : 'grid-cols-3';\n                  let badgeBg = 'bg-gray-100 text-gray-700';\n                  let iconColor = 'text-gray-600';\n                  let iconEl = null;\n                  if (t.includes('helper')) {\n                    badgeBg = 'bg-blue-100 text-blue-700';\n                    iconColor = 'text-blue-600';\n                    iconEl = <HelpingHand className={`w-4 h-4 ${iconColor}`} />;\n                  } else if (t.includes('ally')) {\n                    badgeBg = 'bg-purple-100 text-purple-700';\n                    iconColor = 'text-purple-600';\n                    iconEl = <Shield className={`w-4 h-4 ${iconColor}`} />;\n                  } else if (t.includes('champion')) {\n                    badgeBg = 'bg-yellow-100 text-yellow-700';\n                    iconColor = 'text-yellow-600';\n                    iconEl = <Trophy className={`w-4 h-4 ${iconColor}`} />;\n                  } else if (t.includes('guardian')) {\n                    badgeBg = 'bg-emerald-100 text-emerald-700';\n                    iconColor = 'text-emerald-600';\n                    iconEl = (\n                      <span className=\"relative inline-block w-5 h-5\">\n                        <Shield className={`w-5 h-5 absolute inset-0 ${iconColor}`} />\n                        <Eye className=\"w-3 h-3 absolute bottom-0 right-0 text-emerald-700\" />\n                      </span>\n                    );\n                  }\n\n                  return (\n                    <div className={`grid ${gridCols} gap-4 text-center`}>\n                      <div>\n                        <div className=\"text-2xl font-bold text-blue-600\">{myStats?.report_count ?? 0}</div>\n                        <div className=\"text-xs text-gray-600\">Reports</div>\n                      </div>\n                      <div>\n                        <div className=\"text-2xl font-bold text-green-600\">{myStats?.points ?? 0}</div>\n                        <div className=\"text-xs text-gray-600\">Points</div>\n                      </div>\n                      <div>\n                        <div className=\"text-2xl font-bold text-orange-600\">{myStats?.rank ? `#${myStats.rank}` : '—'}</div>\n                        <div className=\"text-xs text-gray-600\">Rank</div>\n                      </div>\n                      {hasTier && (\n                        <div className=\"flex flex-col items-center justify-center\">\n                          <div className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full ${badgeBg}`}>\n                            {iconEl}\n                            <span className=\"text-xs font-medium\">{tierRaw}</span>\n                          </div>\n                          <div className=\"text-xs text-gray-600 mt-1\">Tier</div>\n                        </div>\n                      )}\n                    </div>\n                  );\n                })()}\n              </div>\n            </MobileCard>\n\n            <MobileButton\n              onClick={() => setShowNewReport(true)}\n              className=\"w-full bg-red-600 hover:bg-red-700 text-white py-3\"\n            >\n              <Plus className=\"w-5 h-5 mr-2\" />\n              Report New Scam\n            </MobileButton>\n          </div>\n        );\n\n      case 'feed':\n        return (\n          <div className=\"flex flex-col min-h-[70vh]\">\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-center flex-1\">\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Community Reports</h3>\n                  <p className=\"text-sm text-gray-600\">See a scam? Share it.</p>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <select\n                    onChange={(e) => fetchReports({ sort: e.target.value }, false)}\n                    className=\"text-xs border border-gray-300 rounded px-2 py-1\"\n                    defaultValue=\"newest\"\n                  >\n                    <option value=\"newest\">Newest</option>\n                    <option value=\"top\">Top</option>\n                    <option value=\"verified\">Verified first</option>\n                  </select>\n                  <Button onClick={() => fetchReports({}, false)} variant=\"outline\" size=\"sm\">Refresh</Button>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n                <MobileSearchInput\n                  placeholder=\"Search reports...\"\n                  onSearch={(q) => setSearchQuery(q)}\n                />\n                <div className=\"flex items-center gap-2\">\n                  <MobileSelect\n                    value={filterThreatType}\n                    onChange={(e) => setFilterThreatType(e.target.value)}\n                    options={[\n                      { value: 'ALL', label: 'All categories' },\n                      { value: 'PHISHING', label: 'Phishing' },\n                      { value: 'MALWARE', label: 'Malware' },\n                      { value: 'SCAM', label: 'Scam' },\n                      { value: 'SOCIAL_ENGINEERING', label: 'Social Eng.' },\n                      { value: 'OTHER', label: 'Other' }\n                    ]}\n                    className=\"flex-1\"\n                  />\n                  <MobileSelect\n                    value={filterUrgency}\n                    onChange={(e) => setFilterUrgency(e.target.value)}\n                    options={[\n                      { value: 'ALL', label: 'All severity' },\n                      { value: 'LOW', label: 'Caution' },\n                      { value: 'MEDIUM', label: 'Scam' },\n                      { value: 'HIGH', label: 'Ongoing Scam' }\n                    ]}\n                    className=\"flex-1\"\n                  />\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <label className=\"flex items-center gap-2 text-xs text-gray-700\">\n                    <input\n                      type=\"checkbox\"\n                      className=\"rounded\"\n                      checked={verifiedOnly}\n                      onChange={(e) => setVerifiedOnly(e.target.checked)}\n                    />\n                    Verified only\n                  </label>\n                  {(searchQuery || verifiedOnly || filterThreatType !== 'ALL' || filterUrgency !== 'ALL') && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => {\n                        setSearchQuery('');\n                        setFilterThreatType('ALL');\n                        setFilterUrgency('ALL');\n                        setVerifiedOnly(false);\n                      }}\n                    >\n                      Clear\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </div>\n            {/* Pull-to-refresh container around feed list */}\n            <div className=\"flex-1 min-h-0 overflow-y-auto\">\n              <MobilePullToRefresh\n                onRefresh={async () => {\n                  await fetchReports({}, false);\n                }}\n                className=\"h-full\"\n              >\n                {/* Pagination info */}\n                {pagination && (\n                  <div className=\"text-center text-xs text-gray-500 mb-2\">\n                    Showing {filteredFeedReports.length} of {pagination.total} reports\n                    {hasMore && <span className=\"ml-2\">• Scroll to load more</span>}\n                  </div>\n                )}\n                <div className=\"space-y-3\">\n                  {filteredFeedReports && filteredFeedReports.length > 0 ? (\n                    filteredFeedReports.map((report) => (\n                      <MobileCard key={report.id} className=\"border-gray-200\">\n                        <div className=\"p-4\">\n                          <div className=\"flex items-start justify-between\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-1\">\n                                <span className=\"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-700\">{report.threat_type}</span>\n                                <span className=\"text-xs text-gray-500\">{report.created_at ? new Date(report.created_at).toLocaleDateString() : ''}</span>\n                                {report.verified && <CheckCircle className=\"w-3.5 h-3.5 text-green-600\" />}\n                              </div>\n                              <div className=\"text-xs text-gray-500 mb-1 flex items-center gap-2\">\n                                <span>by {report.creator?.name || 'Anonymous'}</span>\n                                {(() => {\n                                  const tierRaw = (report.creator?.tier || '').toString();\n                                  if (!tierRaw) return null;\n                                  const t = tierRaw.toLowerCase();\n                                  let badgeBg = 'bg-gray-100 text-gray-700';\n                                  let iconColor = 'text-gray-600';\n                                  let iconEl = null;\n                                  if (t.includes('helper')) {\n                                    badgeBg = 'bg-blue-100 text-blue-700';\n                                    iconColor = 'text-blue-600';\n                                    iconEl = <HelpingHand className={`w-3.5 h-3.5 ${iconColor}`} />;\n                                  } else if (t.includes('ally')) {\n                                    badgeBg = 'bg-purple-100 text-purple-700';\n                                    iconColor = 'text-purple-600';\n                                    iconEl = <Shield className={`w-3.5 h-3.5 ${iconColor}`} />;\n                                  } else if (t.includes('champion')) {\n                                    badgeBg = 'bg-yellow-100 text-yellow-700';\n                                    iconColor = 'text-yellow-600';\n                                    iconEl = <Trophy className={`w-3.5 h-3.5 ${iconColor}`} />;\n                                  } else if (t.includes('guardian')) {\n                                    badgeBg = 'bg-emerald-100 text-emerald-700';\n                                    iconColor = 'text-emerald-600';\n                                    iconEl = (\n                                      <span className=\"relative inline-block w-4 h-4\">\n                                        <Shield className={`w-4 h-4 absolute inset-0 ${iconColor}`} />\n                                        <Eye className=\"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700\" />\n                                      </span>\n                                    );\n                                  }\n                                  return (\n                                    <span className={`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${badgeBg}`}>\n                                      {iconEl}\n                                      <span className=\"text-[10px] font-medium leading-none\">{tierRaw}</span>\n                                    </span>\n                                  );\n                                })()}\n                              </div>\n                              {report.creator?.bio && (\n                                <div className=\"text-xs text-gray-500 italic mb-1\">{report.creator.bio}</div>\n                              )}\n                              <p className=\"text-sm text-gray-800\">{report.description}</p>\n\n                              {report.media && report.media.length > 0 && (\n                                <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                  {(report.media.filter(m => isImageMedia(m) || isVideoMedia(m)).slice(0, 3)).map((m, idx, arr) => {\n                                    const isLastAndExtra = (idx === arr.length - 1) && (report.media.length > 3);\n                                    const extraCount = report.media.length - 3;\n                                    const src = resolveMediaUrl(m.media_url);\n                                    return (\n                                      <button\n                                        key={m.id || idx}\n                                        type=\"button\"\n                                        onClick={() => openLightbox(report.media, idx)}\n                                        className=\"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none\"\n                                      >\n                                        {src && (\n                                          isVideoMedia(m) ? (\n                                            <video src={src} className=\"w-full h-full object-cover\" muted playsInline />\n                                          ) : (\n                                            <img\n                                              src={src}\n                                              alt=\"report media\"\n                                              className=\"w-full h-full object-cover\"\n                                              loading=\"lazy\"\n                                              onError={(e) => {\n                                                const fallback = m.media_url || '';\n                                                if (fallback && e.currentTarget.src !== fallback) {\n                                                  e.currentTarget.src = fallback;\n                                                } else {\n                                                  e.currentTarget.style.display = 'none';\n                                                }\n                                              }}\n                                            />\n                                          )\n                                        )}\n                                        {isLastAndExtra && extraCount > 0 && (\n                                          <div className=\"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center\">\n                                            <span className=\"text-white text-sm font-semibold\">+{extraCount}</span>\n                                          </div>\n                                        )}\n                                      </button>\n                                    );\n                                  })}\n                                </div>\n                              )}\n\n                              <div className=\"mt-3 flex items-center justify-between\">\n                                <div className=\"flex items-center gap-2\">\n                                  <Button\n                                    onClick={() => voteOnReport(report.id, 'up')}\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className={report.user_vote === 'up' ? 'text-green-600' : ''}\n                                  >\n                                    <ThumbsUp className=\"w-4 h-4 mr-1\" /> {report.votes_up || 0}\n                                  </Button>\n                                  <Button\n                                    onClick={() => voteOnReport(report.id, 'down')}\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className={report.user_vote === 'down' ? 'text-red-600' : ''}\n                                  >\n                                    <ThumbsDown className=\"w-4 h-4 mr-1\" /> {report.votes_down || 0}\n                                  </Button>\n                                </div>\n                                <div className=\"text-xs text-gray-500 flex items-center gap-1\">\n                                  <MessageSquare className=\"w-3.5 h-3.5\" /> {report.comments?.length || 0}\n                                </div>\n                              </div>\n\n                              {report.comments && report.comments.length > 0 && (\n                                <div className=\"mt-2 space-y-1\">\n                                  {report.comments.slice(0, 2).map((c, i) => (\n                                    <div key={c.id || i} className=\"text-xs text-gray-700 bg-gray-50 p-2 rounded\">\n                                      <span className=\"font-medium\">{c.user_name || 'Anonymous'}:</span> {c.comment}\n                                    </div>\n                                  ))}\n                                  <div>\n                                    <Button variant=\"ghost\" size=\"sm\" onClick={() => handleViewAllComments(report.id)}>\n                                      View all comments\n                                    </Button>\n                                  </div>\n                                </div>\n                              )}\n\n                              <div className=\"mt-2 flex items-center gap-2\">\n                                <MobileInput\n                                  placeholder=\"Add a comment...\"\n                                  value={commentTexts[report.id] || ''}\n                                  onChange={(e) => setCommentTexts(prev => ({ ...prev, [report.id]: e.target.value }))}\n                                  className=\"flex-1\"\n                                />\n                                <Button\n                                  size=\"sm\"\n                                  disabled={!((commentTexts[report.id] || '').trim())}\n                                  onClick={async () => {\n                                    const text = (commentTexts[report.id] || '').trim();\n                                    if (!text) return;\n                                    await addComment(report.id, { comment: text });\n                                    setCommentTexts(prev => ({ ...prev, [report.id]: '' }));\n                                  }}\n                                >\n                                  Comment\n                                </Button>\n                              </div>\n                              {/* Allow owner to delete their report */}\n                              {report.user_id === user?.id && (\n                                <div className=\"mt-2 text-right\">\n                                  <Button\n                                    variant=\"outline\"\n                                    size=\"sm\"\n                                    onClick={async () => {\n                                      if (confirm('Delete this report? This cannot be undone.')) {\n                                        const res = await deleteReport(report.id);\n                                        if (!res.success) alert(res.error || 'Failed to delete');\n                                      }\n                                    }}\n                                  >\n                                    Delete report\n                                  </Button>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </MobileCard>\n                    ))\n                  ) : (\n                    <p className=\"text-gray-500 text-center py-6\">No reports to display yet.</p>\n                  )}\n\n                  {/* Loading indicator for pagination */}\n                  {isLoading && hasMore && (\n                    <div className=\"text-center py-4\">\n                      <div className=\"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n                      <p className=\"text-sm text-gray-500 mt-2\">Loading more reports...</p>\n                    </div>\n                  )}\n\n                  {/* Fallback Load More button */}\n                  {hasMore && !isLoading && (\n                    <div className=\"text-center py-3\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          if (pagination?.next_num) {\n                            fetchReports({ page: pagination.next_num }, true);\n                          }\n                        }}\n                      >\n                        Load more\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </MobilePullToRefresh>\n            </div>\n          </div>\n        );\n\n      case 'my_reports':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">My Reports</h3>\n              <p className=\"text-sm text-gray-600\">See the status of your submitted reports</p>\n            </div>\n\n            {/* Status breakdown */}\n            <div className=\"grid grid-cols-4 gap-2 text-center\">\n              <div className=\"p-2 bg-green-50 rounded\">\n                <div className=\"text-base font-semibold text-green-700\">{myStats?.approved_count ?? 0}</div>\n                <div className=\"text-xs text-green-700\">Approved</div>\n              </div>\n              <div className=\"p-2 bg-blue-50 rounded\">\n                <div className=\"text-base font-semibold text-blue-700\">{myStats?.verified_count ?? 0}</div>\n                <div className=\"text-xs text-blue-700\">Verified</div>\n              </div>\n              <div className=\"p-2 bg-yellow-50 rounded\">\n                <div className=\"text-base font-semibold text-yellow-700\">{myStats?.pending_count ?? 0}</div>\n                <div className=\"text-xs text-yellow-700\">Pending</div>\n              </div>\n              <div className=\"p-2 bg-red-50 rounded\">\n                <div className=\"text-base font-semibold text-red-700\">{myStats?.rejected_count ?? 0}</div>\n                <div className=\"text-xs text-red-700\">Rejected</div>\n              </div>\n            </div>\n\n            {/* Quick filters */}\n            <div className=\"flex flex-wrap gap-2\">\n              {[\n                { id: 'ALL', label: 'All' },\n                { id: 'PENDING', label: 'Pending' },\n                { id: 'APPROVED', label: 'Approved' },\n                { id: 'VERIFIED', label: 'Verified' },\n                { id: 'REJECTED', label: 'Rejected' }\n              ].map((opt) => (\n                <Button\n                  key={opt.id}\n                  size=\"sm\"\n                  variant={myStatusFilter === opt.id ? 'default' : 'outline'}\n                  onClick={() => setMyStatusFilter(opt.id)}\n                >\n                  {opt.label}\n                </Button>\n              ))}\n            </div>\n\n            <div className=\"space-y-3\">\n              {reports && reports.length > 0 ? (\n                reports\n                  .filter(r => r.user_id === user?.id)\n                  .filter(r => myStatusFilter === 'ALL' ? true : (r.status === myStatusFilter))\n                  .map((report) => (\n                  <MobileCard key={report.id} className=\"border-gray-200\">\n                    <div className=\"p-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1 pr-3\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <span className={`text-xs px-2 py-1 rounded-full ${\n                              report.status === 'APPROVED' || report.status === 'VERIFIED' ? 'bg-green-100 text-green-700' :\n                              report.status === 'REJECTED' ? 'bg-red-100 text-red-700' :\n                              'bg-yellow-100 text-yellow-700'\n                            }`}>\n                              {report.status}\n                            </span>\n                            {report.urgency === 'HIGH' && (\n                              <span className=\"text-xs px-2 py-1 rounded-full bg-red-100 text-red-700\">Ongoing Scam</span>\n                            )}\n                            {report.verified && (\n                              <span className=\"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700\">Verified</span>\n                            )}\n                          </div>\n                          <div className=\"text-xs text-gray-500 mb-1 flex items-center gap-2\">\n                            <span>by {report.creator?.name || 'You'}</span>\n                            {(() => {\n                              const tierRaw = (report.creator?.tier || user?.tier || '').toString();\n                              if (!tierRaw) return null;\n                              const t = tierRaw.toLowerCase();\n                              let badgeBg = 'bg-gray-100 text-gray-700';\n                              let iconColor = 'text-gray-600';\n                              let iconEl = null;\n                              if (t.includes('helper')) {\n                                badgeBg = 'bg-blue-100 text-blue-700';\n                                iconColor = 'text-blue-600';\n                                iconEl = <HelpingHand className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('ally')) {\n                                badgeBg = 'bg-purple-100 text-purple-700';\n                                iconColor = 'text-purple-600';\n                                iconEl = <Shield className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('champion')) {\n                                badgeBg = 'bg-yellow-100 text-yellow-700';\n                                iconColor = 'text-yellow-600';\n                                iconEl = <Trophy className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('guardian')) {\n                                badgeBg = 'bg-emerald-100 text-emerald-700';\n                                iconColor = 'text-emerald-600';\n                                iconEl = (\n                                  <span className=\"relative inline-block w-4 h-4\">\n                                    <Shield className={`w-4 h-4 absolute inset-0 ${iconColor}`} />\n                                    <Eye className=\"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700\" />\n                                  </span>\n                                );\n                              }\n                              return (\n                                <span className={`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${badgeBg}`}>\n                                  {iconEl}\n                                  <span className=\"text-[10px] font-medium leading-none\">{tierRaw}</span>\n                                </span>\n                              );\n                            })()}\n                            <span>• Submitted {new Date(report.created_at).toLocaleString()}</span>\n                          </div>\n                          <p className=\"text-sm text-gray-800\">{report.description}</p>\n\n                          {report.media && report.media.length > 0 && (\n                            <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                              {(report.media.filter(m => !m.media_type || m.media_type.startsWith('image')).slice(0, 3)).map((m, idx, arr) => {\n                                const isLastAndExtra = (idx === arr.length - 1) && (report.media.length > 3);\n                                const extraCount = report.media.length - 3;\n                                const src = m.media_url && (m.media_url.startsWith('http') ? m.media_url : `${API}${m.media_url}`);\n                                return (\n                                  <button\n                                    key={m.id || idx}\n                                    type=\"button\"\n                                    onClick={() => openLightbox(report.media, idx)}\n                                    className=\"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none\"\n                                  >\n                                    {src && (\n                                      <img src={src} alt=\"report media\" className=\"w-full h-full object-cover\" loading=\"lazy\" />\n                                    )}\n                                    {isLastAndExtra && extraCount > 0 && (\n                                      <div className=\"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center\">\n                                        <span className=\"text-white text-sm font-semibold\">+{extraCount}</span>\n                                      </div>\n                                    )}\n                                  </button>\n                                );\n                              })}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </MobileCard>\n                ))\n              ) : (\n                <p className=\"text-gray-500 text-center py-6\">No reports found</p>\n              )}\n            </div>\n          </div>\n        );\n\n      case 'leaderboard':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Top Reporters</h3>\n              <p className=\"text-sm text-gray-600\">Community heroes protecting others from scams</p>\n            </div>\n            <div className=\"flex justify-end\">\n              <select\n                value={pointsPeriod}\n                onChange={(e) => {\n                  const v = e.target.value;\n                  setPointsPeriod(v);\n                  fetchLeaderboard({ period: v });\n                }}\n                className=\"text-xs border border-gray-300 rounded px-2 py-1\"\n              >\n                <option value=\"90d\">Last 90 days</option>\n                <option value=\"all\">All time</option>\n              </select>\n            </div>\n            \n            <div className=\"space-y-2\">\n              {leaderboard.map((user, index) => (\n                <MobileCard key={user.id} className=\"border-gray-200\">\n                  <div className=\"p-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-3\">\n                        <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${\n                          index === 0 ? 'bg-yellow-100 text-yellow-800' :\n                          index === 1 ? 'bg-gray-100 text-gray-800' :\n                          index === 2 ? 'bg-orange-100 text-orange-800' :\n                          'bg-blue-100 text-blue-800'\n                        }`}>\n                          {index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : user.rank}\n                        </div>\n                        <div>\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"font-semibold text-gray-900\">{user.username || user.name}</span>\n                            {(() => {\n                              const tierRaw = (user.tier || '').toString();\n                              if (!tierRaw) return null;\n                              const t = tierRaw.toLowerCase();\n                              let badgeBg = 'bg-gray-100 text-gray-700';\n                              let iconColor = 'text-gray-600';\n                              let iconEl = null;\n                              if (t.includes('helper')) {\n                                badgeBg = 'bg-blue-100 text-blue-700';\n                                iconColor = 'text-blue-600';\n                                iconEl = <HelpingHand className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('ally')) {\n                                badgeBg = 'bg-purple-100 text-purple-700';\n                                iconColor = 'text-purple-600';\n                                iconEl = <Shield className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('champion')) {\n                                badgeBg = 'bg-yellow-100 text-yellow-700';\n                                iconColor = 'text-yellow-600';\n                                iconEl = <Trophy className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('guardian')) {\n                                badgeBg = 'bg-emerald-100 text-emerald-700';\n                                iconColor = 'text-emerald-600';\n                                iconEl = (\n                                  <span className=\"relative inline-block w-4 h-4\">\n                                    <Shield className={`w-4 h-4 absolute inset-0 ${iconColor}`} />\n                                    <Eye className=\"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700\" />\n                                  </span>\n                                );\n                              }\n                              return (\n                                <span className={`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${badgeBg}`}>\n                                  {iconEl}\n                                  <span className=\"text-[10px] font-medium leading-none\">{tierRaw}</span>\n                                </span>\n                              );\n                            })()}\n                          </div>\n                          <div className=\"text-xs text-gray-600\">{user.points ?? 0} pts</div>\n                        </div>\n                      </div>\n                      {index < 3 && (\n                        <Star className=\"w-5 h-5 text-yellow-500\" />\n                      )}\n                    </div>\n                  </div>\n                </MobileCard>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 'latest':\n        return (\n          <div className=\"space-y-4\">\n            <div className=\"text-center mb-4\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Latest Scams</h3>\n            </div>\n            \n            <div className=\"space-y-3\">\n              {latestReports && latestReports.length > 0 ? (\n                latestReports.map((report) => (\n                  <MobileCard key={report.id} className=\"border-gray-200\">\n                    <div className=\"p-4\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1 pr-3\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <span className={`text-xs px-2 py-1 rounded-full ${\n                              report.status === 'APPROVED' || report.status === 'VERIFIED' ? 'bg-green-100 text-green-700' :\n                              report.status === 'REJECTED' ? 'bg-red-100 text-red-700' :\n                              'bg-yellow-100 text-yellow-700'\n                            }`}>\n                              {report.status}\n                            </span>\n                            {report.verified && (\n                              <span className=\"text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-700\">Verified</span>\n                            )}\n                          </div>\n                          <div className=\"text-xs text-gray-500 mb-1 flex items-center gap-2\">\n                            <span>by {report.creator?.name || 'Anonymous'}</span>\n                            {(() => {\n                              const tierRaw = (report.creator?.tier || '').toString();\n                              if (!tierRaw) return null;\n                              const t = tierRaw.toLowerCase();\n                              let badgeBg = 'bg-gray-100 text-gray-700';\n                              let iconColor = 'text-gray-600';\n                              let iconEl = null;\n                              if (t.includes('helper')) {\n                                badgeBg = 'bg-blue-100 text-blue-700';\n                                iconColor = 'text-blue-600';\n                                iconEl = <HelpingHand className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('ally')) {\n                                badgeBg = 'bg-purple-100 text-purple-700';\n                                iconColor = 'text-purple-600';\n                                iconEl = <Shield className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('champion')) {\n                                badgeBg = 'bg-yellow-100 text-yellow-700';\n                                iconColor = 'text-yellow-600';\n                                iconEl = <Trophy className={`w-3.5 h-3.5 ${iconColor}`} />;\n                              } else if (t.includes('guardian')) {\n                                badgeBg = 'bg-emerald-100 text-emerald-700';\n                                iconColor = 'text-emerald-600';\n                                iconEl = (\n                                  <span className=\"relative inline-block w-4 h-4\">\n                                    <Shield className={`w-4 h-4 absolute inset-0 ${iconColor}`} />\n                                    <Eye className=\"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700\" />\n                                  </span>\n                                );\n                              }\n                              return (\n                                <span className={`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full ${badgeBg}`}>\n                                  {iconEl}\n                                  <span className=\"text-[10px] font-medium leading-none\">{tierRaw}</span>\n                                </span>\n                              );\n                            })()}\n                            <span>• {new Date(report.created_at).toLocaleString()}</span>\n                          </div>\n                          <p className=\"text-sm text-gray-800\">{report.description}</p>\n\n                          {report.media && report.media.length > 0 && (\n                            <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                              {(report.media.filter(m => !m.media_type || m.media_type.startsWith('image')).slice(0, 3)).map((m, idx, arr) => {\n                                const isLastAndExtra = (idx === arr.length - 1) && (report.media.length > 3);\n                                const extraCount = report.media.length - 3;\n                                const src = m.media_url && (m.media_url.startsWith('http') ? m.media_url : `${API}${m.media_url}`);\n                                return (\n                                  <button\n                                    key={m.id || idx}\n                                    type=\"button\"\n                                    onClick={() => openLightbox(report.media, idx)}\n                                    className=\"relative w-full h-24 bg-gray-100 rounded overflow-hidden focus:outline-none\"\n                                  >\n                                    {src && (\n                                      <img src={src} alt=\"report media\" className=\"w-full h-full object-cover\" loading=\"lazy\" />\n                                    )}\n                                    {isLastAndExtra && extraCount > 0 && (\n                                      <div className=\"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center\">\n                                        <span className=\"text-white text-sm font-semibold\">+{extraCount}</span>\n                                      </div>\n                                    )}\n                                  </button>\n                                );\n                              })}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </MobileCard>\n                ))\n              ) : (\n                <p className=\"text-gray-500 text-center py-6\">No recent reports.</p>\n              )}\n            </div>\n          </div>\n        );\n\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <div className=\"space-y-4 p-4 max-w-none mx-auto min-h-screen\">\n      {!isAuthenticated ? (\n        <div className=\"space-y-6\">\n          <MobileCard>\n            <div className=\"text-center py-8\">\n              <Users className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Authentication Required</h2>\n              <p className=\"text-gray-600 mb-6\">Please log in to access the Community Hub, report scams, and view the feed.</p>\n              <MobileButton \n                onClick={() => setActiveTab('login')}\n                className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n              >\n                Go to Login\n              </MobileButton>\n            </div>\n          </MobileCard>\n        </div>\n      ) : (\n        <>\n          {/* Header */}\n          <div className=\"text-center mb-6\">\n            <div className=\"flex justify-center mb-3\">\n              <div className=\"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center\">\n                <Users className=\"w-6 h-6 text-white\" />\n              </div>\n            </div>\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Community Hub</h1>\n            <p className=\"text-sm text-gray-600\">Spot it. Share it. Stay safe.</p>\n          </div>\n\n          {/* Navigation Tabs */}\n          <div className=\"flex space-x-1 bg-gray-100 p-1 rounded-lg\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon;\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTabLocal(tab.id)}\n                  className={`flex-1 flex items-center justify-center space-x-2 py-2 px-3 rounded-md text-sm font-medium transition-colors ${\n                    activeTab === tab.id\n                      ? 'bg-white text-blue-600 shadow-sm'\n                      : 'text-gray-600 hover:text-gray-800'\n                  }`}\n                >\n                  <Icon className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">{tab.label}</span>\n                </button>\n              );\n            })}\n          </div>\n\n          {/* Content */}\n          {renderContent()}\n\n          {/* Community Benefits - hide on feed to avoid obstructing the scrollable list */}\n          {activeTab !== 'feed' && (\n            <div className=\"mt-6\">\n              <MobileCard className=\"bg-orange-50 border-orange-200\">\n                <div className=\"p-4\">\n                  <h3 className=\"font-semibold text-gray-900 mb-2\">🤝 Community Benefits</h3>\n                  <ul className=\"text-sm text-gray-600 space-y-1\">\n                    <li>• Report scams to protect others</li>\n                    <li>• Earn points and climb the leaderboard</li>\n                    <li>• Stay updated on latest scams</li>\n                    <li>• Build a safer digital community</li>\n                  </ul>\n                </div>\n              </MobileCard>\n            </div>\n          )}\n\n          {/* New Report Modal */}\n          {showNewReport && (\n            <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n              <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl mx-4\">\n                <h2 className=\"text-xl font-semibold mb-4\">Report New Scam</h2>\n                {!isAuthenticated ? (\n                  <div className=\"text-center text-gray-600\">\n                    Please log in to submit a community report.\n                  </div>\n                ) : (\n                  <form\n                    onSubmit={async (e) => {\n                      e.preventDefault();\n                      try {\n                        setIsSubmitting(true);\n                        const result = await createReport(newReport);\n                        if (!result.success) {\n                          throw new Error(result.error || 'Failed to create report');\n                        }\n                        // Upload files\n                        for (const file of newReportFiles) {\n                          const up = await uploadReportMedia(result.report.id, file);\n                          if (!up.success) {\n                            throw new Error(up.error || 'Failed to upload media');\n                          }\n                        }\n                        setShowNewReport(false);\n                        setNewReport({ description: '', threat_type: 'SCAM', urgency: 'MEDIUM', location: '' });\n                        setNewReportFiles([]);\n                        setToast({ type: 'success', message: 'Report submitted successfully' });\n                        setTimeout(() => setToast(null), 3000);\n                        loadAllData();\n                      } catch (err) {\n                        setToast({ type: 'error', message: err.message || 'Submission failed' });\n                        setTimeout(() => setToast(null), 4000);\n                      } finally {\n                        setIsSubmitting(false);\n                      }\n                    }}\n                    className=\"space-y-4\"\n                  >\n                    <MobileTextarea\n                      placeholder=\"Detailed Description\"\n                      value={newReport.description}\n                      onChange={(e) => setNewReport({ ...newReport, description: e.target.value })}\n                      required\n                      rows={4}\n                    />\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm text-gray-700 mb-1\">Category</label>\n                        <select\n                          value={newReport.threat_type}\n                          onChange={(e) => setNewReport({ ...newReport, threat_type: e.target.value })}\n                          className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                        >\n                          <option value=\"PHISHING\">Phishing</option>\n                          <option value=\"MALWARE\">Malware</option>\n                          <option value=\"SCAM\">Scam</option>\n                          <option value=\"SOCIAL_ENGINEERING\">Social Engineering</option>\n                          <option value=\"OTHER\">Other</option>\n                        </select>\n                      </div>\n                      <div className=\"relative\">\n                        <label className=\"block text-sm text-gray-700 mb-1\">Severity</label>\n                        <select\n                        value={newReport.urgency}\n                        onChange={(e) => setNewReport({ ...newReport, urgency: e.target.value })}\n                        className=\"w-full border border-gray-300 rounded-md px-3 py-2\"\n                        aria-describedby=\"severity-help\"\n                      >\n                        <option value=\"LOW\">Caution</option>\n                        <option value=\"MEDIUM\">Scam</option>\n                        <option value=\"HIGH\">Ongoing Scam</option>\n                      </select>\n                        <button\n                          type=\"button\"\n                          aria-label=\"Severity help\"\n                          title=\"About severity levels\"\n                          className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700\"\n                          onClick={() => alert('Severity levels:\\n• Caution: suspicious or low-risk\\n• Scam: confirmed scam but not active\\n• Ongoing Scam: active scam happening now or immediate risk')}\n                        >\n                          <HelpCircle className=\"w-4 h-4\" />\n                        </button>\n                      </div>\n                    </div>\n                    <div>\n                      <label className=\"block text-sm text-gray-700 mb-1\">Attach Photos (optional)</label>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        multiple\n                        onChange={(e) => setNewReportFiles(Array.from(e.target.files || []))}\n                        className=\"block w-full text-sm text-gray-700\"\n                      />\n                      {newReportFiles.length > 0 && (\n                        <div className=\"mt-2 text-xs text-gray-600\">{newReportFiles.length} file(s) selected</div>\n                      )}\n                    </div>\n                    <MobileInput\n                      placeholder=\"Location/URL\"\n                      value={newReport.location}\n                      onChange={(e) => setNewReport({ ...newReport, location: e.target.value })}\n                    />\n                    <div className=\"flex space-x-3\">\n                      <Button type=\"submit\" className=\"flex-1\" disabled={isSubmitting}>\n                        {isSubmitting ? 'Submitting...' : 'Submit Report'}\n                      </Button>\n                      <Button\n                        type=\"button\"\n                        variant=\"outline\"\n                        onClick={() => setShowNewReport(false)}\n                        className=\"flex-1\"\n                      >\n                        Cancel\n                      </Button>\n                    </div>\n                  </form>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Toast Notification */}\n          {toast && (\n            <div className={`fixed bottom-6 left-1/2 -translate-x-1/2 px-4 py-3 rounded-lg shadow-md text-sm z-50 ${\n              toast.type === 'success' ? 'bg-green-600 text-white' : 'bg-red-600 text-white'\n            }`}>\n              {toast.message}\n            </div>\n          )}\n\n          {/* Lightbox Modal */}\n          <MobileModal isOpen={lightboxOpen} onClose={() => setLightboxOpen(false)} title=\"Preview\" fullScreen hideOnDesktop={false}>\n            {lightboxImages.length > 0 && (\n              <div className=\"flex flex-col items-center\">\n                <div className=\"w-full h-[60vh] bg-black flex items-center justify-center mb-3\">\n                  <img\n                    src={lightboxImages[lightboxIndex].src}\n                    alt=\"preview\"\n                    className=\"max-h-full max-w-full object-contain\"\n                  />\n                </div>\n                <div className=\"flex items-center justify-between w-full\">\n                  <Button onClick={() => setLightboxIndex(i => Math.max(0, i - 1))} disabled={lightboxIndex === 0} variant=\"outline\" size=\"sm\">Prev</Button>\n                  <div className=\"text-sm text-gray-600\">{lightboxIndex + 1} / {lightboxImages.length}</div>\n                  <Button onClick={() => setLightboxIndex(i => Math.min(lightboxImages.length - 1, i + 1))} disabled={lightboxIndex >= lightboxImages.length - 1} variant=\"outline\" size=\"sm\">Next</Button>\n                </div>\n              </div>\n            )}\n          </MobileModal>\n\n          {/* Full Comments Modal */}\n          <MobileModal isOpen={commentsModalOpen} onClose={() => setCommentsModalOpen(false)} title=\"All Comments\" hideOnDesktop={false}>\n            {commentsReport ? (\n              <div className=\"space-y-3\">\n                {commentsReport.comments && commentsReport.comments.length > 0 ? (\n                  commentsReport.comments.map((c) => (\n                    <div key={c.id} className=\"p-2 bg-gray-50 rounded border border-gray-200 flex items-start justify-between\">\n                      <div>\n                        <div className=\"text-sm text-gray-800\"><span className=\"font-medium\">{c.user_name || 'Anonymous'}:</span> {c.comment}</div>\n                        <div className=\"text-xs text-gray-500 mt-1\">{c.created_at ? new Date(c.created_at).toLocaleString() : ''}</div>\n                      </div>\n                      {(user?.id === c.user_id || user?.is_admin) && (\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => handleDeleteComment(c.id)} title=\"Delete comment\">\n                          <Trash2 className=\"w-4 h-4 text-red-600\" />\n                        </Button>\n                      )}\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"text-sm text-gray-500\">No comments yet.</div>\n                )}\n\n                {commentsHasMore && (\n                  <div className=\"pt-2\">\n                    <Button onClick={handleLoadMoreComments} variant=\"outline\" size=\"sm\">Load more</Button>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"text-sm text-gray-500\">Loading...</div>\n            )}\n          </MobileModal>\n        </>\n      )}\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { MobileCard, MobileCardHeader, MobileCardContent } from './ui/mobile-card';\nimport { Badge } from './ui/badge';\nimport { Button } from './ui/button';\nimport { MobileTextarea } from './ui/mobile-input';\nimport { MobileInput } from './ui/mobile-input';\nimport { \n  AlertTriangle, \n  TrendingUp, \n  Users, \n  MessageSquare, \n  ThumbsUp, \n  ThumbsDown,\n  CheckCircle,\n  Star,\n  Lock,\n  ArrowLeft,\n  Trash2\n} from 'lucide-react';\nimport { useCommunity } from '../hooks/useCommunity';\nimport { useAuth } from '../hooks/useAuth';\nimport { API } from '../lib/api';\nimport MobileModal from './MobileModal';\nimport MobilePullToRefresh from './MobilePullToRefresh';\nimport { MobileSelect, MobileSearchInput } from './ui/mobile-input';\n\nexport default function CommunityReporting({ setActiveTab }) {\n  const { isAuthenticated, user } = useAuth();\n  const {\n    reports,\n    trendingThreats,\n    communityStats,\n    alerts,\n    isLoading,\n    error,\n    loadAllData,\n    createReport,\n    voteOnReport,\n    verifyReport,\n    addComment,\n    createAlert,\n    uploadReportMedia,\n    fetchReportById,\n    fetchComments,\n    deleteComment,\n    clearError\n  } = useCommunity();\n\n  const [showNewReport, setShowNewReport] = useState(false);\n  const [showNewAlert, setShowNewAlert] = useState(false);\n  const [newReport, setNewReport] = useState({ description: '', threat_type: 'SCAM', urgency: 'MEDIUM', location: '' });\n  const [newAlert, setNewAlert] = useState({ title: '', message: '', priority: 'medium' });\n  const [commentText, setCommentText] = useState('');\n  const [newReportFiles, setNewReportFiles] = useState([]);\n  // Filters/search for the recent reports list\n  const [searchQuery, setSearchQuery] = useState('');\n  const [filterThreatType, setFilterThreatType] = useState('ALL');\n  const [filterUrgency, setFilterUrgency] = useState('ALL');\n  const [verifiedOnly, setVerifiedOnly] = useState(false);\n\n  // Lightbox\n  const [lightboxOpen, setLightboxOpen] = useState(false);\n  const [lightboxImages, setLightboxImages] = useState([]);\n  const [lightboxIndex, setLightboxIndex] = useState(0);\n\n  // Full comments modal\n  const [commentsModalOpen, setCommentsModalOpen] = useState(false);\n  const [commentsReport, setCommentsReport] = useState(null);\n  const [commentsPage, setCommentsPage] = useState(1);\n  const [commentsHasMore, setCommentsHasMore] = useState(false);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      loadAllData();\n      const shouldOpen = (\n        (typeof localStorage !== 'undefined' && localStorage.getItem('openNewReport') === '1') ||\n        (typeof sessionStorage !== 'undefined' && sessionStorage.getItem('openNewReport') === '1') ||\n        (typeof window !== 'undefined' && window.__openNewReport === true)\n      );\n      if (shouldOpen) {\n        setShowNewReport(true);\n        try { localStorage.removeItem('openNewReport'); } catch (e) {}\n        try { sessionStorage.removeItem('openNewReport'); } catch (e) {}\n        try { delete window.__openNewReport; } catch (e) {}\n      }\n    }\n  }, [loadAllData, isAuthenticated]);\n  \n  const filteredReports = (reports || []).filter((r) => {\n    const matchesSearch = searchQuery\n      ? (r.description || '').toLowerCase().includes(searchQuery.toLowerCase()) ||\n        (r.location || '').toLowerCase().includes(searchQuery.toLowerCase()) ||\n        (r.threat_type || '').toLowerCase().includes(searchQuery.toLowerCase())\n      : true;\n    const matchesType = filterThreatType === 'ALL' ? true : (r.threat_type === filterThreatType);\n    const matchesUrgency = filterUrgency === 'ALL' ? true : (r.urgency === filterUrgency);\n    const matchesVerified = verifiedOnly ? !!r.verified : true;\n    return matchesSearch && matchesType && matchesUrgency && matchesVerified;\n  });\n\n  const handleSubmitReport = async (e) => {\n    e.preventDefault();\n    const result = await createReport(newReport);\n    if (result.success) {\n      // Upload any selected files\n      for (const file of newReportFiles) {\n        await uploadReportMedia(result.report.id, file);\n      }\n      setShowNewReport(false);\n      setNewReport({\n        description: '',\n        threat_type: 'SCAM',\n        urgency: 'MEDIUM',\n        location: ''\n      });\n      setNewReportFiles([]);\n    }\n  };\n\n  const handleSubmitAlert = async (e) => {\n    e.preventDefault();\n    const result = await createAlert(newAlert);\n    if (result.success) {\n      setShowNewAlert(false);\n      setNewAlert({\n        title: '',\n        message: '',\n        priority: 'medium'\n      });\n    }\n  };\n\n  const handleVote = async (reportId, voteType) => {\n    await voteOnReport(reportId, voteType);\n  };\n\n  const handleVerify = async (reportId) => {\n    await verifyReport(reportId, { verified: true });\n  };\n\n  const handleAddComment = async (reportId) => {\n    if (commentText.trim()) {\n      await addComment(reportId, { comment: commentText });\n      setCommentText('');\n    }\n  };\n\n  const handleViewAllComments = async (reportId) => {\n    setCommentsPage(1);\n    const res = await fetchComments(reportId, { page: 1, per_page: 20 });\n    if (res.success) {\n      setCommentsReport({ id: reportId, comments: res.comments || [] });\n      setCommentsHasMore((res.pagination?.page || 1) < (res.pagination?.pages || 1));\n      setCommentsModalOpen(true);\n    }\n  };\n\n  const handleLoadMoreComments = async () => {\n    if (!commentsReport) return;\n    const nextPage = commentsPage + 1;\n    const res = await fetchComments(commentsReport.id, { page: nextPage, per_page: 20 });\n    if (res.success) {\n      setCommentsReport(prev => ({ ...prev, comments: [...(prev.comments || []), ...(res.comments || [])] }));\n      setCommentsPage(nextPage);\n      setCommentsHasMore((res.pagination?.page || nextPage) < (res.pagination?.pages || nextPage));\n    }\n  };\n\n  const handleDeleteComment = async (commentId) => {\n    const res = await deleteComment(commentId);\n    if (res.success) {\n      setCommentsReport(prev => ({ ...prev, comments: (prev.comments || []).filter(c => c.id !== commentId) }));\n    }\n  };\n\n  const openLightbox = (mediaList, startIndex = 0) => {\n    const images = (mediaList || [])\n      .filter(m => !m.media_type || m.media_type === 'image')\n      .map(m => ({ id: m.id, src: m.media_url && (m.media_url.startsWith('http') ? m.media_url : `${API}${m.media_url}`) }))\n      .filter(i => !!i.src);\n    if (images.length > 0) {\n      setLightboxImages(images);\n      setLightboxIndex(Math.max(0, Math.min(startIndex, images.length - 1)));\n      setLightboxOpen(true);\n    }\n  };\n\n  // Show login prompt if not authenticated\n  if (!isAuthenticated) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"text-center\">\n          <Lock className=\"w-8 h-8 mx-auto mb-2 text-gray-400\" />\n          <p className=\"text-gray-600 mb-2\">Login required to access Community</p>\n          <p className=\"text-gray-500 text-sm\">Please log in to view and contribute to community reports</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-64\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading community data...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    // Check if it's an authentication error\n    const isAuthError = error.includes('Token is missing') || error.includes('401') || error.includes('Unauthorized')\n    \n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6\">\n        <div className=\"flex items-center\">\n          <AlertTriangle className=\"h-5 w-5 text-red-400 mr-2\" />\n          <span className=\"text-red-800\">\n            {isAuthError ? 'Authentication Required' : error}\n          </span>\n        </div>\n        <p className=\"text-red-700 text-sm mt-2\">\n          {isAuthError \n            ? 'Please log in to access community features. Your session may have expired.'\n            : ''\n          }\n        </p>\n        <div className=\"flex gap-2 mt-3\">\n          {isAuthError ? (\n            <Button \n              onClick={() => window.location.reload()} \n              variant=\"outline\" \n              size=\"sm\"\n            >\n              Go to Login\n            </Button>\n          ) : (\n            <Button onClick={clearError} variant=\"outline\" size=\"sm\">\n              Dismiss\n            </Button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 p-4 max-w-3xl mx-auto\">\n      {/* Header with Back Button */}\n      <div className=\"flex items-center mb-6\">\n        <button\n          onClick={() => setActiveTab('community')}\n          className=\"p-2 mr-3 text-gray-600 hover:text-gray-800 transition-colors\"\n        >\n          <ArrowLeft className=\"w-5 h-5\" />\n        </button>\n        <div className=\"flex-1 text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Community Reports</h1>\n          <p className=\"text-gray-600 text-sm\">Report and track security threats</p>\n        </div>\n      </div>\n\n      {/* Community Stats */}\n      {communityStats && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <MobileCard className=\"p-4\">\n            <MobileCardHeader className=\"flex items-center\">\n              <Users className=\"h-8 w-8 text-blue-600 mr-3\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Total Reports</p>\n                <p className=\"text-2xl font-bold text-gray-900\">{communityStats.total_reports || 0}</p>\n              </div>\n            </MobileCardHeader>\n          </MobileCard>\n          <MobileCard className=\"p-4\">\n            <MobileCardHeader className=\"flex items-center\">\n              <AlertTriangle className=\"h-8 w-8 text-red-600 mr-3\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Verified</p>\n                <p className=\"text-2xl font-bold text-gray-900\">{(communityStats.status_breakdown && communityStats.status_breakdown.VERIFIED) || 0}</p>\n              </div>\n            </MobileCardHeader>\n          </MobileCard>\n          <MobileCard className=\"p-4\">\n            <MobileCardHeader className=\"flex items-center\">\n              <CheckCircle className=\"h-8 w-8 text-green-600 mr-3\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Pending</p>\n                <p className=\"text-2xl font-bold text-gray-900\">{(communityStats.status_breakdown && communityStats.status_breakdown.PENDING) || 0}</p>\n              </div>\n            </MobileCardHeader>\n          </MobileCard>\n          <MobileCard className=\"p-4\">\n            <MobileCardHeader className=\"flex items-center\">\n              <Users className=\"h-8 w-8 text-purple-600 mr-3\" />\n              <div>\n                <p className=\"text-sm text-gray-600\">Top Reporter</p>\n                <p className=\"text-2xl font-bold text-gray-900\">{(communityStats.top_contributors && communityStats.top_contributors[0]?.name) || '—'}</p>\n              </div>\n            </MobileCardHeader>\n          </MobileCard>\n        </div>\n      )}\n\n      {/* Trending Threats */}\n      <MobileCard className=\"p-6\">\n        <MobileCardHeader className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Trending Threats</h2>\n          <TrendingUp className=\"h-5 w-5 text-orange-500\" />\n        </MobileCardHeader>\n        <MobileCardContent>\n          <div className=\"space-y-3\">\n            {trendingThreats && trendingThreats.length > 0 ? (\n              trendingThreats.map((threat, idx) => (\n                <div key={idx} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                  <div className=\"flex items-center space-x-3\">\n                    <Star className=\"h-4 w-4 text-yellow-500\" />\n                    <div>\n                      <p className=\"font-medium text-gray-900\">{threat.threat_type}</p>\n                      <p className=\"text-sm text-gray-600\">Reports: {threat.report_count} • Trend: {threat.trend} • Urgency score: {threat.urgency_score}</p>\n                    </div>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <p className=\"text-gray-500 text-center py-4\">No trending threats at the moment</p>\n            )}\n          </div>\n        </MobileCardContent>\n      </MobileCard>\n\n      {/* Recent Reports */}\n      <MobileCard className=\"p-6\">\n        <MobileCardHeader className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Recent Reports</h2>\n          <div className=\"flex items-center gap-2\">\n            <Button onClick={() => setShowNewReport(true)} size=\"sm\">\n              Report New Scam\n            </Button>\n            <Button onClick={loadAllData} variant=\"outline\" size=\"sm\">\n              Refresh\n            </Button>\n          </div>\n        </MobileCardHeader>\n        <MobileCardContent>\n          <div className=\"space-y-3\">\n            {/* Filters */}\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-2\">\n              <MobileSearchInput placeholder=\"Search reports...\" onSearch={(q) => setSearchQuery(q)} />\n              <div className=\"flex items-center gap-2\">\n                <MobileSelect\n                  value={filterThreatType}\n                  onChange={(e) => setFilterThreatType(e.target.value)}\n                  options={[\n                    { value: 'ALL', label: 'All categories' },\n                    { value: 'PHISHING', label: 'Phishing' },\n                    { value: 'MALWARE', label: 'Malware' },\n                    { value: 'SCAM', label: 'Scam' },\n                    { value: 'SOCIAL_ENGINEERING', label: 'Social Eng.' },\n                    { value: 'OTHER', label: 'Other' }\n                  ]}\n                  className=\"flex-1\"\n                />\n                <MobileSelect\n                  value={filterUrgency}\n                  onChange={(e) => setFilterUrgency(e.target.value)}\n                  options={[\n                    { value: 'ALL', label: 'All severity' },\n                    { value: 'LOW', label: 'Caution' },\n                    { value: 'MEDIUM', label: 'Scam' },\n                    { value: 'HIGH', label: 'Ongoing Scam' }\n                  ]}\n                  className=\"flex-1\"\n                />\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <label className=\"flex items-center gap-2 text-xs text-gray-700\">\n                  <input type=\"checkbox\" className=\"rounded\" checked={verifiedOnly} onChange={(e) => setVerifiedOnly(e.target.checked)} />\n                  Verified only\n                </label>\n                {(searchQuery || verifiedOnly || filterThreatType !== 'ALL' || filterUrgency !== 'ALL') && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setSearchQuery('');\n                      setFilterThreatType('ALL');\n                      setFilterUrgency('ALL');\n                      setVerifiedOnly(false);\n                    }}\n                  >\n                    Clear\n                  </Button>\n                )}\n              </div>\n            </div>\n\n            {/* Scrollable + pull-to-refresh list */}\n            <div className=\"text-center text-xs text-gray-500 mb-1\">\n              Showing {filteredReports.length}{Array.isArray(reports) ? ' of ' + reports.length : ''} reports\n            </div>\n            <MobilePullToRefresh onRefresh={loadAllData} className=\"h-[60vh] sm:h-[65vh] md:h-[70vh]\">\n              <div className=\"space-y-4\">\n                {filteredReports && filteredReports.length > 0 ? (\n                  filteredReports.map((report) => (\n                    <div key={report.id} className=\"border border-gray-200 rounded-lg p-4\">\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div>\n                          <h3 className=\"font-medium text-gray-900\">{report.threat_type}</h3>\n                          <p className=\"text-sm text-gray-600 mb-2\">{report.description}</p>\n                          {report.media && report.media.length > 0 && (\n                            <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                              {(report.media.filter(m => !m.media_type || m.media_type === 'image').slice(0, 3)).map((m, idx, arr) => {\n                                const isLastAndExtra = (idx === arr.length - 1) && (report.media.length > 3);\n                                const extraCount = report.media.length - 3;\n                                const src = m.media_url && (m.media_url.startsWith('http') ? m.media_url : `${API}${m.media_url}`);\n                                return (\n                                  <button\n                                    key={m.id || idx}\n                                    type=\"button\"\n                                    onClick={() => openLightbox(report.media, idx)}\n                                    className=\"relative w-full h-20 bg-gray-100 rounded overflow-hidden focus:outline-none\"\n                                  >\n                                    {src && (\n                                      <img\n                                        src={src}\n                                        alt=\"report media\"\n                                        className=\"w-full h-full object-cover\"\n                                        loading=\"lazy\"\n                                      />\n                                    )}\n                                    {isLastAndExtra && extraCount > 0 && (\n                                      <div className=\"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center\">\n                                        <span className=\"text-white text-sm font-semibold\">+{extraCount}</span>\n                                      </div>\n                                    )}\n                                  </button>\n                                );\n                              })}\n                            </div>\n                          )}\n                          <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n                            <span>Urgency: {report.urgency}</span>\n                            <span>Location: {report.location || 'N/A'}</span>\n                            <span>Reported: {report.created_at ? new Date(report.created_at).toLocaleDateString() : 'N/A'}</span>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          {report.verified && (\n                            <CheckCircle className=\"h-4 w-4 text-green-500\" />\n                          )}\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-4\">\n                          <div className=\"flex items-center space-x-2\">\n                            <Button\n                              onClick={() => handleVote(report.id, 'up')}\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              className={report.user_vote === 'up' ? 'text-green-600' : ''}\n                            >\n                              <ThumbsUp className=\"h-4 w-4 mr-1\" />\n                              {report.votes_up || 0}\n                            </Button>\n                            <Button\n                              onClick={() => handleVote(report.id, 'down')}\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              className={report.user_vote === 'down' ? 'text-red-600' : ''}\n                            >\n                              <ThumbsDown className=\"h-4 w-4 mr-1\" />\n                              {report.votes_down || 0}\n                            </Button>\n                          </div>\n                          {/* Show verify button only for admins */}\n                          {user?.is_admin && !report.verified && (\n                            <Button\n                              onClick={() => handleVerify(report.id)}\n                              variant=\"outline\"\n                              size=\"sm\"\n                            >\n                              <CheckCircle className=\"h-4 w-4 mr-1\" />\n                              Verify\n                            </Button>\n                          )}\n                        </div>\n                        <div className=\"text-sm text-gray-500\">\n                          {report.creator?.name || 'Anonymous'}\n                        </div>\n                      </div>\n\n                      {/* Comments */}\n                      {report.comments && report.comments.length > 0 && (\n                        <div className=\"mt-3 pt-3 border-t border-gray-200\">\n                          <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Comments</h4>\n                          <div className=\"space-y-2\">\n                            {report.comments.map((comment, index) => (\n                              <div key={index} className=\"text-sm text-gray-600 bg-gray-50 p-2 rounded\">\n                                <span className=\"font-medium\">{comment.user_name || 'Anonymous'}:</span> {comment.comment}\n                              </div>\n                            ))}\n                          </div>\n                          <div className=\"mt-2\">\n                            <Button variant=\"ghost\" size=\"sm\" onClick={() => handleViewAllComments(report.id)}>\n                              View all comments\n                            </Button>\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Add Comment */}\n                      <div className=\"mt-3 pt-3 border-t border-gray-200\">\n                        <div className=\"flex space-x-2\">\n                          <MobileInput\n                            placeholder=\"Add a comment...\"\n                            value={commentText}\n                            onChange={(e) => setCommentText(e.target.value)}\n                            className=\"flex-1\"\n                          />\n                          <Button\n                            onClick={() => handleAddComment(report.id)}\n                            size=\"sm\"\n                            disabled={!commentText.trim()}\n                          >\n                            Comment\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-gray-500 text-center py-8\">No reports yet. Be the first to report a threat!</p>\n                )}\n              </div>\n            </MobilePullToRefresh>\n          </div>\n        </MobileCardContent>\n      </MobileCard>\n\n      {/* Community Alerts */}\n      <MobileCard className=\"p-6\">\n        <MobileCardHeader className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">Community Alerts</h2>\n        </MobileCardHeader>\n        <MobileCardContent>\n          <div className=\"space-y-3\">\n            {alerts && alerts.length > 0 ? (\n              alerts.map((alert) => (\n                <div key={alert.id} className=\"flex items-start space-x-3 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                  <MessageSquare className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                  <div className=\"flex-1\">\n                    <h4 className=\"font-medium text-blue-900\">{alert.threat_type || 'Community Alert'}</h4>\n                    <p className=\"text-sm text-blue-800\">{alert.message}</p>\n                    <div className=\"flex items-center space-x-4 mt-2 text-xs text-blue-600\">\n                      <span>Severity: {alert.severity}</span>\n                      <span>{alert.created_at ? new Date(alert.created_at).toLocaleDateString() : ''}</span>\n                    </div>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <p className=\"text-gray-500 text-center py-4\">No active alerts</p>\n            )}\n          </div>\n        </MobileCardContent>\n      </MobileCard>\n\n      {/* New Report Modal */}\n      {showNewReport && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl mx-4\">\n            <h2 className=\"text-xl font-semibold mb-4\">Report New Threat</h2>\n            <form onSubmit={handleSubmitReport} className=\"space-y-4\">\n              <MobileTextarea\n                placeholder=\"Detailed Description\"\n                value={newReport.description}\n                onChange={(e) => setNewReport({...newReport, description: e.target.value})}\n                required\n                rows={4}\n              />\n              <div className=\"grid grid-cols-2 gap-4\">\n                <select\n                  value={newReport.threat_type}\n                  onChange={(e) => setNewReport({...newReport, threat_type: e.target.value})}\n                  className=\"border border-gray-300 rounded-md px-3 py-2\"\n                >\n                  <option value=\"PHISHING\">Phishing</option>\n                  <option value=\"MALWARE\">Malware</option>\n                  <option value=\"SCAM\">Scam</option>\n                  <option value=\"SOCIAL_ENGINEERING\">Social Engineering</option>\n                  <option value=\"OTHER\">Other</option>\n                </select>\n                <select\n                  value={newReport.urgency}\n                  onChange={(e) => setNewReport({...newReport, urgency: e.target.value})}\n                  className=\"border border-gray-300 rounded-md px-3 py-2\"\n                >\n                  <option value=\"LOW\">Low</option>\n                  <option value=\"MEDIUM\">Medium</option>\n                  <option value=\"HIGH\">High</option>\n                </select>\n              </div>\n              <div>\n                <label className=\"block text-sm text-gray-700 mb-1\">Attach Photos (optional)</label>\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  multiple\n                  onChange={(e) => setNewReportFiles(Array.from(e.target.files || []))}\n                  className=\"block w-full text-sm text-gray-700\"\n                />\n                {newReportFiles.length > 0 && (\n                  <div className=\"mt-2 text-xs text-gray-600\">{newReportFiles.length} file(s) selected</div>\n                )}\n              </div>\n              <MobileInput\n                placeholder=\"Location/URL\"\n                value={newReport.location}\n                onChange={(e) => setNewReport({...newReport, location: e.target.value})}\n              />\n              <div className=\"flex space-x-3\">\n                <Button type=\"submit\" className=\"flex-1\">\n                  Submit Report\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setShowNewReport(false)}\n                  className=\"flex-1\"\n                >\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {/* New Alert Modal */}\n      {showNewAlert && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-lg mx-4\">\n            <h2 className=\"text-xl font-semibold mb-4\">Create Community Alert</h2>\n            <form onSubmit={handleSubmitAlert} className=\"space-y-4\">\n              <MobileInput\n                placeholder=\"Alert Title\"\n                value={newAlert.title}\n                onChange={(e) => setNewAlert({...newAlert, title: e.target.value})}\n                required\n              />\n              <MobileTextarea\n                placeholder=\"Alert Message\"\n                value={newAlert.message}\n                onChange={(e) => setNewAlert({...newAlert, message: e.target.value})}\n                required\n                rows={4}\n              />\n              <select\n                value={newAlert.priority}\n                onChange={(e) => setNewAlert({...newAlert, priority: e.target.value})}\n                className=\"border border-gray-300 rounded-md px-3 py-2 w-full\"\n              >\n                <option value=\"low\">Low Priority</option>\n                <option value=\"medium\">Medium Priority</option>\n                <option value=\"high\">High Priority</option>\n                <option value=\"urgent\">Urgent</option>\n              </select>\n              <div className=\"flex space-x-3\">\n                <Button type=\"submit\" className=\"flex-1\">\n                  Create Alert\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setShowNewAlert(false)}\n                  className=\"flex-1\"\n                >\n                  Cancel\n                </Button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {/* Full Comments Modal */}\n      <MobileModal isOpen={commentsModalOpen} onClose={() => setCommentsModalOpen(false)} title=\"All Comments\">\n        {commentsReport ? (\n          <div className=\"space-y-3\">\n            {commentsReport.comments && commentsReport.comments.length > 0 ? (\n              commentsReport.comments.map((c) => (\n                <div key={c.id} className=\"p-2 bg-gray-50 rounded border border-gray-200 flex items-start justify-between\">\n                  <div>\n                    <div className=\"text-sm text-gray-800\"><span className=\"font-medium\">{c.user_name || 'Anonymous'}:</span> {c.comment}</div>\n                    <div className=\"text-xs text-gray-500 mt-1\">{c.created_at ? new Date(c.created_at).toLocaleString() : ''}</div>\n                  </div>\n                  {(user?.id === c.user_id || user?.is_admin) && (\n                    <Button variant=\"ghost\" size=\"sm\" onClick={() => handleDeleteComment(c.id)} title=\"Delete comment\">\n                      <Trash2 className=\"w-4 h-4 text-red-600\" />\n                    </Button>\n                  )}\n                </div>\n              ))\n            ) : (\n              <div className=\"text-sm text-gray-500\">No comments yet.</div>\n            )}\n\n            {commentsHasMore && (\n              <div className=\"pt-2\">\n                <Button onClick={handleLoadMoreComments} variant=\"outline\" size=\"sm\">Load more</Button>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div className=\"text-sm text-gray-500\">Loading...</div>\n        )}\n      </MobileModal>\n\n      {/* Lightbox Modal */}\n      <MobileModal isOpen={lightboxOpen} onClose={() => setLightboxOpen(false)} title=\"Preview\" fullScreen>\n        {lightboxImages.length > 0 && (\n          <div className=\"flex flex-col items-center\">\n            <div className=\"w-full h-[60vh] bg-black flex items-center justify-center mb-3\">\n              <img\n                src={lightboxImages[lightboxIndex].src}\n                alt=\"preview\"\n                className=\"max-h-full max-w-full object-contain\"\n              />\n            </div>\n            <div className=\"flex items-center justify-between w-full\">\n              <Button\n                onClick={() => setLightboxIndex(i => Math.max(0, i - 1))}\n                disabled={lightboxIndex === 0}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                Prev\n              </Button>\n              <div className=\"text-sm text-gray-600\">{lightboxIndex + 1} / {lightboxImages.length}</div>\n              <Button\n                onClick={() => setLightboxIndex(i => Math.min(lightboxImages.length - 1, i + 1))}\n                disabled={lightboxIndex >= lightboxImages.length - 1}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                Next\n              </Button>\n            </div>\n          </div>\n        )}\n      </MobileModal>\n    </div>\n  );\n}\n","import React from 'react'\n\nconst Textarea = React.forwardRef(({ className = '', ...props }, ref) => {\n  const baseClasses = 'flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50'\n  \n  const classes = `${baseClasses} ${className}`\n\n  return (\n    <textarea\n      className={classes}\n      ref={ref}\n      {...props}\n    />\n  )\n})\n\nTextarea.displayName = 'Textarea'\n\nexport { Textarea }\n","/**\n * User Management Utility for Remaleh Protect Admin Dashboard\n * Handles all user-related API calls and operations\n */\n\nimport { apiGet, apiPost, apiPut, apiDelete } from '../lib/api'\n\n// Backend API endpoints for user management\nconst USER_ENDPOINTS = {\n  USERS: '/api/admin/users',\n  USER: (id) => `/api/admin/users/${id}`,\n  UPDATE_STATUS: (id) => `/api/admin/users/${id}/status`,\n  UPDATE_ROLE: (id) => `/api/admin/users/${id}/role`,\n  DELETE_USER: (id) => `/api/admin/users/${id}`,\n  HARD_DELETE_USER: (id) => `/api/admin/users/${id}/hard-delete`,\n  DELETED_USERS: '/api/admin/users/deleted',\n}\n\n// Get all users with optional filtering\nexport const getAllUsers = async (filters = {}) => {\n  try {\n    const queryParams = new URLSearchParams()\n    \n    if (filters.page) queryParams.append('page', filters.page)\n    if (filters.per_page) queryParams.append('per_page', filters.per_page)\n    if (filters.status) queryParams.append('status', filters.status)\n    if (filters.role) queryParams.append('role', filters.role)\n    \n    const url = `${USER_ENDPOINTS.USERS}?${queryParams.toString()}`\n    const response = await apiGet(url)\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        users: data.users || [],\n        pagination: data.pagination || {},\n        success: true\n      }\n    } else {\n      throw new Error('Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error fetching users:', error)\n    return {\n      users: [],\n      pagination: {},\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Get deleted users\nexport const getDeletedUsers = async () => {\n  try {\n    const response = await apiGet(USER_ENDPOINTS.DELETED_USERS)\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        users: data.users || [],\n        success: true\n      }\n    } else {\n      throw new Error('Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error fetching deleted users:', error)\n    return {\n      users: [],\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Get specific user by ID\nexport const getUserById = async (userId) => {\n  try {\n    const response = await apiGet(USER_ENDPOINTS.USER(userId))\n    \n    if (response.ok) {\n      const userData = await response.json()\n      return {\n        user: userData,\n        success: true\n      }\n    } else {\n      throw new Error('Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error fetching user:', error)\n    return {\n      user: null,\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Update user status\nexport const updateUserStatus = async (userId, newStatus) => {\n  try {\n    console.log('🔄 userManager.updateUserStatus called with:', { userId, newStatus })\n    console.log('🔄 API endpoint:', USER_ENDPOINTS.UPDATE_STATUS(userId))\n    \n    const response = await apiPut(USER_ENDPOINTS.UPDATE_STATUS(userId), {\n      status: newStatus\n    })\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('🔄 Response data:', data)\n      return {\n        success: true,\n        message: data.message || 'User status updated successfully',\n        user: data.user\n      }\n    } else {\n      console.log('❌ Response not ok, status:', response.status)\n      const errorData = await response.json()\n      console.log('❌ Error response body:', errorData)\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('❌ Error in updateUserStatus:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Update user role\nexport const updateUserRole = async (userId, newRole) => {\n  try {\n    console.log('🔄 userManager.updateUserRole called with:', { userId, newRole })\n    console.log('🔄 API endpoint:', USER_ENDPOINTS.UPDATE_ROLE(userId))\n    \n    const response = await apiPut(USER_ENDPOINTS.UPDATE_ROLE(userId), {\n      role: newRole\n    })\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('🔄 Response data:', data)\n      return {\n        success: true,\n        message: data.message || 'User role updated successfully',\n        user: data.user\n      }\n    } else {\n      console.log('❌ Response not ok, status:', response.status)\n      const errorData = await response.json()\n      console.log('❌ Error response body:', errorData)\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('❌ Error in updateUserRole:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Update user information (first name, last name, email)\nexport const updateUserInfo = async (userId, userData) => {\n  try {\n    const response = await apiPut(USER_ENDPOINTS.USER(userId), userData)\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        success: true,\n        message: data.message || 'User information updated successfully',\n        user: data.user\n      }\n    } else {\n      const errorData = await response.json()\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error updating user information:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Update user password\nexport const updateUserPassword = async (userId, newPassword) => {\n  try {\n    const response = await apiPut(`${USER_ENDPOINTS.USER(userId)}/password`, {\n      password: newPassword\n    })\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        success: true,\n        message: data.message || 'User password updated successfully'\n      }\n    } else {\n      const errorData = await response.json()\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error updating user password:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Delete user (soft delete)\nexport const deleteUser = async (userId) => {\n  try {\n    const response = await apiDelete(USER_ENDPOINTS.DELETE_USER(userId))\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        success: true,\n        message: data.message || 'User deleted successfully'\n      }\n    } else {\n      const errorData = await response.json()\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error deleting user:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Permanently delete a user (hard delete)\nexport const hardDeleteUser = async (userId) => {\n  try {\n    const response = await apiDelete(USER_ENDPOINTS.HARD_DELETE_USER(userId))\n    if (response.ok) {\n      const data = await response.json()\n      return {\n        success: true,\n        message: data.message || 'User permanently deleted'\n      }\n    } else {\n      const errorData = await response.json()\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error hard-deleting user:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Create new user (if endpoint exists)\nexport const createUser = async (userData) => {\n  try {\n    const response = await apiPost(USER_ENDPOINTS.USERS, userData)\n    \n    if (response.ok) {\n      const data = await response.json()\n      return {\n        success: true,\n        message: data.message || 'User created successfully',\n        user: data.user\n      }\n    } else {\n      const errorData = await response.json()\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error creating user:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Get user statistics\nexport const getUserStats = async () => {\n  try {\n    const response = await apiGet(USER_ENDPOINTS.USERS)\n    \n    if (response.ok) {\n      const data = await response.json()\n      const users = data.users || []\n      \n      const stats = {\n        total: users.length,\n        active: users.filter(u => u.status === 'ACTIVE').length,\n        suspended: users.filter(u => u.status === 'SUSPENDED').length,\n        banned: users.filter(u => u.status === 'BANNED').length,\n        admins: users.filter(u => u.is_admin || u.role === 'ADMIN').length,\n        moderators: users.filter(u => u.role === 'MODERATOR').length,\n        regular: users.filter(u => u.role === 'USER').length\n      }\n      \n      return {\n        stats,\n        success: true\n      }\n    } else {\n      throw new Error('Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('Error fetching user stats:', error)\n    return {\n      stats: {\n        total: 0,\n        active: 0,\n        suspended: 0,\n        banned: 0,\n        admins: 0,\n        moderators: 0,\n        regular: 0\n      },\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Restore deleted user\nexport const restoreUser = async (userId) => {\n  try {\n    console.log('🔄 userManager.restoreUser called with:', { userId })\n    console.log('🔄 API endpoint:', USER_ENDPOINTS.USER(userId) + '/restore')\n    \n    const response = await apiPut(`${USER_ENDPOINTS.USER(userId)}/restore`, {})\n    console.log('🔄 API response received:', response)\n    console.log('🔄 Response status:', response.status)\n    console.log('🔄 Response ok:', response.ok)\n    \n    if (response.ok) {\n      const data = await response.json()\n      console.log('🔄 Response data:', data)\n      return {\n        success: true,\n        message: data.message || 'User restored successfully',\n        user: data.user\n      }\n    } else {\n      console.log('❌ Response not ok, status:', response.status)\n      const errorData = await response.json()\n      console.log('❌ Error response body:', errorData)\n      throw new Error(errorData.error || errorData.message || 'Request failed. Please try again.')\n    }\n  } catch (error) {\n    console.error('❌ Error in restoreUser:', error)\n    return {\n      success: false,\n      error: error.message\n    }\n  }\n}\n\n// Search users\nexport const searchUsers = async (searchTerm, filters = {}) => {\n  try {\n    // For now, we'll filter on the frontend since the backend doesn't have search\n    // In the future, this could be enhanced with backend search\n    const allUsers = await getAllUsers(filters)\n    \n    if (!allUsers.success) {\n      return allUsers\n    }\n    \n    const searchLower = searchTerm.toLowerCase()\n    const filteredUsers = allUsers.users.filter(user => \n      user.email?.toLowerCase().includes(searchLower) ||\n      user.first_name?.toLowerCase().includes(searchLower) ||\n      user.last_name?.toLowerCase().includes(searchLower) ||\n      user.role?.toLowerCase().includes(searchLower)\n    )\n    \n    return {\n      users: filteredUsers,\n      pagination: allUsers.pagination,\n      success: true\n    }\n  } catch (error) {\n    console.error('Error searching users:', error)\n    return {\n      users: [],\n      pagination: {},\n      success: false,\n      error: error.message\n    }\n  }\n}\n","import React, { useState, useEffect } from 'react';\nimport { HelpingHand, Shield, Trophy, Eye } from 'lucide-react';\nimport { api } from '../../lib/api';\nimport MobileModal from '../MobileModal';\nimport { API } from '../../lib/api';\n\nconst CommunityReports = ({ initialFilters }) => {\n  const [reports, setReports] = useState([]);\n  const [pagination, setPagination] = useState({});\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [toast, setToast] = useState(null); // { type: 'success'|'error'|'info', message }\n  const [bulkErrors, setBulkErrors] = useState([]); // [{ id, error }]\n  const [selectedReports, setSelectedReports] = useState([]);\n  const [showReportModal, setShowReportModal] = useState(false);\n  const [selectedReport, setSelectedReport] = useState(null);\n  const [showBulkModal, setShowBulkModal] = useState(false);\n  const [bulkAction, setBulkAction] = useState('');\n\n  // Filters\n  const [filters, setFilters] = useState({\n    page: 1,\n    per_page: 20,\n    status: '',\n    urgency: '',\n    threat_type: '',\n    verified: ''\n  });\n\n  // Apply initial filters on mount\n  useEffect(() => {\n    if (initialFilters && Object.keys(initialFilters).length > 0) {\n      setFilters(prev => ({ ...prev, ...initialFilters, page: 1 }));\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    fetchReports();\n  }, [filters]);\n\n  const fetchReports = async () => {\n    try {\n      setIsLoading(true);\n      const params = new URLSearchParams();\n      Object.entries(filters).forEach(([key, value]) => {\n        if (value) params.append(key, value);\n      });\n\n      const response = await api.get(`/api/admin/reports?${params}`);\n      const data = await response.json();\n      setReports(data.reports || []);\n      setPagination(data.pagination || {});\n      setError(null);\n    } catch (err) {\n      setError('Failed to load community reports');\n      console.error('Reports error:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleReportAction = async (reportId, action) => {\n    try {\n      let response;\n      if (action === 'verify') {\n        // Use community verify endpoint to set verified=true and status=VERIFIED\n        response = await api.request({\n          method: 'POST',\n          url: `/api/community/reports/${reportId}/verify`\n        });\n      } else {\n        const actionMap = {\n          reject: 'REJECTED',\n          escalate: 'FLAGGED',\n          approve: 'APPROVED'\n        };\n        const mapped = actionMap[action] || actionMap['approve'];\n        response = await api.request({\n          method: 'PUT',\n          url: `/api/admin/reports/${reportId}/moderate`,\n          data: { action: mapped }\n        });\n      }\n      if (!response.ok) {\n        const errData = await response.json().catch(() => ({}));\n        throw new Error(errData.error || `Failed to ${action} report`);\n      }\n\n      // Refresh reports list\n      fetchReports();\n      setSelectedReports([]);\n    } catch (err) {\n      console.error('Report action error:', err);\n      alert(`Failed to ${action} report: ${err.response?.data?.error || err.message}`);\n    }\n  };\n\n  const handleBulkAction = async () => {\n    if (!bulkAction || selectedReports.length === 0) return;\n\n    setBulkErrors([]);\n    try {\n      if (bulkAction === 'delete') {\n        if (!window.confirm(`Delete ${selectedReports.length} report(s)? This cannot be undone.`)) return;\n      }\n\n      let results;\n      if (bulkAction === 'delete') {\n        // Sequential delete with existence pre-check and fallback to community endpoint\n        results = [];\n        for (const id of selectedReports) {\n          try {\n            // Pre-check existence via community GET (admin is authorized)\n            let exists = true;\n            try {\n              const head = await api.request({ method: 'GET', url: `/api/community/reports/${id}` });\n              exists = head.ok;\n            } catch (_) {\n              exists = false; // treat failure as missing\n            }\n            if (!exists) {\n              results.push({ status: 'fulfilled', value: { id } });\n              continue;\n            }\n\n            // Attempt admin delete first\n            let response = await api.request({ method: 'DELETE', url: `/api/admin/reports/${id}` });\n            if (!response.ok) {\n              // Fallback to community delete (admin allowed)\n              await response.json().catch(() => ({}));\n              response = await api.request({ method: 'DELETE', url: `/api/community/reports/${id}` });\n            }\n            if (!response.ok) {\n              const errData = await response.json().catch(() => ({}));\n              // If 404 from either endpoint, treat as success (already gone)\n              if (response.status === 404) {\n                results.push({ status: 'fulfilled', value: { id } });\n              } else {\n                throw new Error(errData.error || errData.details || `Failed to delete report ${id}`);\n              }\n            }\n            results.push({ status: 'fulfilled', value: { id } });\n          } catch (e) {\n            results.push({ status: 'rejected', reason: e });\n          }\n        }\n      } else {\n        results = await Promise.allSettled(selectedReports.map(async (id) => {\n          if (bulkAction === 'verify') {\n            const response = await api.request({ method: 'POST', url: `/api/community/reports/${id}/verify` });\n            if (!response.ok) {\n              const errData = await response.json().catch(() => ({}));\n              throw new Error(errData.error || `Failed to verify report ${id}`);\n            }\n            return { id };\n          }\n          const actionMap = { reject: 'REJECTED', approve: 'APPROVED' };\n          const mapped = actionMap[bulkAction] || actionMap['approve'];\n          const response = await api.request({ method: 'PUT', url: `/api/admin/reports/${id}/moderate`, data: { action: mapped } });\n          if (!response.ok) {\n            const errData = await response.json().catch(() => ({}));\n            throw new Error(errData.error || `Failed to ${bulkAction} report ${id}`);\n          }\n          return { id };\n        }));\n      }\n\n      const failed = results\n        .map((r, idx) => ({ r, id: selectedReports[idx] }))\n        .filter(x => x.r.status === 'rejected')\n        .map(x => ({ id: x.id, error: x.r.reason?.message || 'Unknown error' }));\n      const succeeded = results.filter(r => r.status === 'fulfilled').length;\n\n      // Refresh list\n      fetchReports();\n      setSelectedReports([]);\n      setShowBulkModal(false);\n      setBulkAction('');\n\n      if (failed.length > 0) {\n        setBulkErrors(failed);\n        setToast({ type: 'error', message: `Bulk ${bulkAction}: ${succeeded} succeeded, ${failed.length} failed` });\n      } else {\n        setToast({ type: 'success', message: `Bulk ${bulkAction}: ${succeeded} succeeded` });\n      }\n      setTimeout(() => setToast(null), 3500);\n    } catch (err) {\n      console.error('Bulk action error:', err);\n      setToast({ type: 'error', message: err.response?.data?.error || err.message || 'Bulk action failed' });\n      setTimeout(() => setToast(null), 4500);\n    }\n  };\n\n  const handleReportSelect = (reportId) => {\n    setSelectedReports(prev => \n      prev.includes(reportId) \n        ? prev.filter(id => id !== reportId)\n        : [...prev, reportId]\n    );\n  };\n\n  const handleSelectAll = () => {\n    if (selectedReports.length === reports.length) {\n      setSelectedReports([]);\n    } else {\n      setSelectedReports(reports.map(report => report.id));\n    }\n  };\n\n  const updateFilters = (newFilters) => {\n    setFilters(prev => ({ ...prev, ...newFilters, page: 1 }));\n  };\n\n  const ReportRow = ({ report }) => (\n    <div className=\"bg-white border rounded-lg p-4 mb-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-3\">\n          <input\n            type=\"checkbox\"\n            checked={selectedReports.includes(report.id)}\n            onChange={() => handleReportSelect(report.id)}\n            className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n          />\n          <div className=\"flex-1\">\n            <div className=\"flex items-center space-x-2 mb-2\">\n              <span className={`px-2 py-1 text-xs rounded-full ${\n                report.urgency === 'HIGH' ? 'bg-red-100 text-red-800' :\n                report.urgency === 'MEDIUM' ? 'bg-yellow-100 text-yellow-800' :\n                'bg-green-100 text-green-800'\n              }`}>\n                {report.urgency === 'HIGH' ? 'Ongoing Scam' : report.urgency === 'MEDIUM' ? 'Scam' : 'Caution'}\n              </span>\n              {report.status !== 'VERIFIED' && (\n                <span className={`px-2 py-1 text-xs rounded-full ${\n                  report.status === 'PENDING' ? 'bg-yellow-100 text-yellow-800' :\n                  report.status === 'REJECTED' ? 'bg-red-100 text-red-800' :\n                  report.status === 'ESCALATED' ? 'bg-orange-100 text-orange-800' :\n                  'bg-gray-100 text-gray-800'\n                }`}>\n                  {report.status}\n                </span>\n              )}\n              {(report.verified || report.status === 'VERIFIED') && (\n                <span className=\"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800\">\n                  ✓ Verified\n                </span>\n              )}\n            </div>\n            <h4 className=\"font-medium text-gray-900\">{report.threat_type}</h4>\n            <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{report.description}</p>\n            <div className=\"flex items-center space-x-4 mt-2 text-xs text-gray-500\">\n              <span>Location: {report.location || 'N/A'}</span>\n              <span>Votes: +{report.votes_up} / -{report.votes_down}</span>\n              <span>Created: {new Date(report.created_at).toLocaleDateString()}</span>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-2\">\n          <button\n            onClick={() => {\n              setSelectedReport(report);\n              setShowReportModal(true);\n            }}\n            className=\"text-blue-600 hover:text-blue-800 text-sm font-medium\"\n          >\n            View\n          </button>\n          <div className=\"relative\">\n            <select\n              onChange={(e) => handleReportAction(report.id, e.target.value)}\n              className=\"text-sm border rounded px-2 py-1\"\n              defaultValue=\"\"\n            >\n              <option value=\"\" disabled>Actions</option>\n              {report.status === 'PENDING' && (\n                <>\n                  <option value=\"approve\">Approve</option>\n                  <option value=\"verify\">Verify</option>\n                  <option value=\"reject\">Reject</option>\n                  <option value=\"escalate\">Flag</option>\n                </>\n              )}\n              {report.status === 'APPROVED' && (\n                <>\n                  <option value=\"verify\">Verify</option>\n                </>\n              )}\n            </select>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  const ReportDetailModal = () => {\n    const reporterObj = selectedReport && selectedReport.reporter && typeof selectedReport.reporter === 'object' ? selectedReport.reporter : null;\n    const reporterName = selectedReport ? (\n      (selectedReport.creator && (selectedReport.creator.username || selectedReport.creator.name)) ||\n      selectedReport.creator_name ||\n      selectedReport.user_name ||\n      (reporterObj && (reporterObj.username || reporterObj.email || reporterObj.name)) ||\n      (selectedReport.user && (selectedReport.user.username || selectedReport.user.name)) ||\n      selectedReport.user_email ||\n      selectedReport.email ||\n      (typeof selectedReport.reporter === 'string' ? selectedReport.reporter : '') ||\n      'Anonymous'\n    ) : '';\n    const reporterTier = selectedReport ? (\n      (selectedReport.creator && selectedReport.creator.tier) ||\n      selectedReport.creator_tier ||\n      (selectedReport.user && selectedReport.user.tier) ||\n      (reporterObj && reporterObj.tier) ||\n      selectedReport.tier ||\n      ''\n    ) : '';\n    return (\n      <MobileModal\n        isOpen={showReportModal}\n        onClose={() => setShowReportModal(false)}\n        title=\"Report Details\"\n        hideOnDesktop={false}\n        fullScreen\n      >\n        {selectedReport && (\n        <div className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Threat Type</label>\n              <p className=\"text-gray-900\">{selectedReport.threat_type}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Reporter</label>\n              <div className=\"flex items-center gap-2 text-gray-900\">\n                <span>{reporterName}</span>\n                {reporterTier && (() => {\n                  const t = String(reporterTier).toLowerCase();\n                  let badgeBg = 'bg-gray-100 text-gray-700';\n                  let iconColor = 'text-gray-600';\n                  let iconEl = null;\n                  if (t.includes('helper')) {\n                    badgeBg = 'bg-blue-100 text-blue-700';\n                    iconColor = 'text-blue-600';\n                    iconEl = <HelpingHand className={`w-3.5 h-3.5 ${iconColor}`} />;\n                  } else if (t.includes('ally')) {\n                    badgeBg = 'bg-purple-100 text-purple-700';\n                    iconColor = 'text-purple-600';\n                    iconEl = <Shield className={`w-3.5 h-3.5 ${iconColor}`} />;\n                  } else if (t.includes('champion')) {\n                    badgeBg = 'bg-yellow-100 text-yellow-700';\n                    iconColor = 'text-yellow-600';\n                    iconEl = <Trophy className={`w-3.5 h-3.5 ${iconColor}`} />;\n                  } else if (t.includes('guardian')) {\n                    badgeBg = 'bg-emerald-100 text-emerald-700';\n                    iconColor = 'text-emerald-600';\n                    iconEl = (\n                      <span className=\"relative inline-block w-4 h-4\">\n                        <Shield className={`w-4 h-4 absolute inset-0 ${iconColor}`} />\n                        <Eye className=\"w-2.5 h-2.5 absolute bottom-0 right-0 text-emerald-700\" />\n                      </span>\n                    );\n                  }\n                  return (\n                    <span className={`inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-xs ${badgeBg}`}>\n                      {iconEl}\n                      <span className=\"leading-none\">{reporterTier}</span>\n                    </span>\n                  );\n                })()}\n              </div>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Urgency</label>\n              <p className=\"text-gray-900\">{selectedReport.urgency}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Status</label>\n              <p className=\"text-gray-900\">{selectedReport.status}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Verified</label>\n              <p className=\"text-gray-900\">{selectedReport.verified ? 'Yes' : 'No'}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Location</label>\n              <p className=\"text-gray-900\">{selectedReport.location || 'N/A'}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Created</label>\n              <p className=\"text-gray-900\">\n                {new Date(selectedReport.created_at).toLocaleString()}\n              </p>\n            </div>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700\">Description</label>\n            <p className=\"text-gray-900\">{selectedReport.description}</p>\n          </div>\n\n          {selectedReport.media && selectedReport.media.length > 0 && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Attachments</label>\n              <div className=\"grid grid-cols-3 gap-2\">\n                {selectedReport.media.map((m, idx) => {\n                  const url = m.media_url?.startsWith('http') ? m.media_url : `${API}${m.media_url}`;\n                  return (\n                    <a\n                      key={m.id || idx}\n                      href={url}\n                      target=\"_blank\"\n                      rel=\"noreferrer\"\n                      className=\"block w-full h-24 bg-gray-100 rounded overflow-hidden\"\n                    >\n                      <img\n                        src={url}\n                        alt=\"attachment\"\n                        className=\"w-full h-full object-cover\"\n                        onError={(e) => { e.currentTarget.style.display = 'none'; }}\n                      />\n                    </a>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n          \n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Up Votes</label>\n              <p className=\"text-gray-900\">{selectedReport.votes_up}</p>\n            </div>\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700\">Down Votes</label>\n              <p className=\"text-gray-900\">{selectedReport.votes_down}</p>\n            </div>\n          </div>\n          \n          <div className=\"pt-4 border-t\">\n            <h4 className=\"font-medium text-gray-900 mb-2\">Quick Actions</h4>\n            <div className=\"flex space-x-2\">\n              {selectedReport.status === 'PENDING' && (\n                <>\n                  <button\n                    onClick={() => {\n                      handleReportAction(selectedReport.id, 'approve');\n                      setShowReportModal(false);\n                    }}\n                    className=\"bg-green-600 text-white px-3 py-2 rounded text-sm hover:bg-green-700\"\n                  >\n                    Approve\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleReportAction(selectedReport.id, 'verify');\n                      setShowReportModal(false);\n                    }}\n                    className=\"bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700\"\n                  >\n                    Verify\n                  </button>\n                  <button\n                    onClick={() => {\n                      handleReportAction(selectedReport.id, 'reject');\n                      setShowReportModal(false);\n                    }}\n                    className=\"bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700\"\n                  >\n                    Reject\n                  </button>\n                </>\n              )}\n              {selectedReport.status === 'APPROVED' && (\n                <button\n                  onClick={() => {\n                    handleReportAction(selectedReport.id, 'verify');\n                    setShowReportModal(false);\n                  }}\n                  className=\"bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700\"\n                >\n                  Verify\n                </button>\n              )}\n              <button\n                onClick={async () => {\n                  if (!confirm('Delete this report?')) return;\n                  try {\n                    let response = await api.request({ method: 'DELETE', url: `/api/admin/reports/${selectedReport.id}` });\n                    if (!response.ok) {\n                      await response.json().catch(() => ({}));\n                      response = await api.request({ method: 'DELETE', url: `/api/community/reports/${selectedReport.id}` });\n                    }\n                    if (!response.ok && response.status !== 404) {\n                      // Last resort: set status to REJECTED then try admin delete again\n                      await api.request({ method: 'PUT', url: `/api/admin/reports/${selectedReport.id}/moderate`, data: { action: 'REJECTED' } }).catch(() => ({}));\n                      response = await api.request({ method: 'DELETE', url: `/api/admin/reports/${selectedReport.id}` });\n                    }\n                    if (!response.ok && response.status !== 404) throw new Error('Delete failed');\n                    setShowReportModal(false);\n                    fetchReports();\n                  } catch (e) {\n                    alert('Failed to delete report: ' + (e.message || 'Unknown error'));\n                  }\n                }}\n                className=\"bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700\"\n              >\n                Delete\n              </button>\n            </div>\n          </div>\n        </div>\n        )}\n      </MobileModal>\n    );\n  };\n\n  const BulkActionModal = () => (\n    <MobileModal\n      isOpen={showBulkModal}\n      onClose={() => setShowBulkModal(false)}\n      title=\"Bulk Actions\"\n      hideOnDesktop={false}\n      fullScreen\n    >\n      <div className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Action for {selectedReports.length} selected reports\n          </label>\n          <select\n            value={bulkAction}\n            onChange={(e) => setBulkAction(e.target.value)}\n            className=\"w-full border rounded-lg px-3 py-2\"\n          >\n            <option value=\"\">Select action...</option>\n            <option value=\"approve\">Approve</option>\n            <option value=\"verify\">Verify</option>\n            <option value=\"reject\">Reject</option>\n            <option value=\"delete\">Delete</option>\n          </select>\n        </div>\n        \n        <div className=\"pt-4 border-t\">\n          <div className=\"flex space-x-2\">\n            <button\n              onClick={handleBulkAction}\n              disabled={!bulkAction}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400\"\n            >\n              Apply Action\n            </button>\n            <button\n              onClick={() => setShowBulkModal(false)}\n              className=\"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700\"\n            >\n              Cancel\n            </button>\n          </div>\n        </div>\n      </div>\n    </MobileModal>\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Community Reports</h1>\n            <p className=\"text-gray-600\">Manage and moderate community threat reports</p>\n          </div>\n          <div className=\"mt-4 sm:mt-0 flex space-x-2\">\n            {selectedReports.length > 0 && (\n              <button\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setShowBulkModal(true);\n                }}\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\n              >\n                Bulk Actions ({selectedReports.length})\n              </button>\n            )}\n            <button\n              onClick={fetchReports}\n              className=\"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700\"\n            >\n              Refresh\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Filters</h3>\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Status</label>\n            <select\n              value={filters.status}\n              onChange={(e) => updateFilters({ status: e.target.value })}\n              className=\"w-full border rounded-lg px-3 py-2\"\n            >\n              <option value=\"\">All Statuses</option>\n              <option value=\"PENDING\">Pending</option>\n              <option value=\"VERIFIED\">Verified</option>\n              <option value=\"REJECTED\">Rejected</option>\n              <option value=\"ESCALATED\">Escalated</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Severity</label>\n            <select\n              value={filters.urgency}\n              onChange={(e) => updateFilters({ urgency: e.target.value })}\n              className=\"w-full border rounded-lg px-3 py-2\"\n            >\n              <option value=\"\">All Severity</option>\n              <option value=\"HIGH\">Ongoing Scam</option>\n              <option value=\"MEDIUM\">Scam</option>\n              <option value=\"LOW\">Caution</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Category</label>\n            <select\n              value={filters.threat_type}\n              onChange={(e) => updateFilters({ threat_type: e.target.value })}\n              className=\"w-full border rounded-lg px-3 py-2\"\n            >\n              <option value=\"\">All Categories</option>\n              <option value=\"PHISHING\">Phishing</option>\n              <option value=\"MALWARE\">Malware</option>\n              <option value=\"SCAM\">Scam</option>\n              <option value=\"SOCIAL_ENGINEERING\">Social Engineering</option>\n              <option value=\"OTHER\">Other</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Verified</label>\n            <select\n              value={filters.verified}\n              onChange={(e) => updateFilters({ verified: e.target.value })}\n              className=\"w-full border rounded-lg px-3 py-2\"\n            >\n              <option value=\"\">All</option>\n              <option value=\"true\">Verified Only</option>\n              <option value=\"false\">Unverified Only</option>\n            </select>\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">Per Page</label>\n            <select\n              value={filters.per_page}\n              onChange={(e) => updateFilters({ per_page: parseInt(e.target.value) })}\n              className=\"w-full border rounded-lg px-3 py-2\"\n            >\n              <option value={10}>10</option>\n              <option value={20}>20</option>\n              <option value={50}>50</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* Reports List */}\n      <div className=\"bg-white rounded-lg shadow\">\n        <div className=\"p-6 border-b\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">\n              Reports ({pagination.total || 0})\n            </h3>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"checkbox\"\n                checked={selectedReports.length === reports.length && reports.length > 0}\n                onChange={handleSelectAll}\n                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n              />\n              <span className=\"text-sm text-gray-600\">Select All</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"p-6\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            </div>\n          ) : error ? (\n            <div className=\"text-center py-12\">\n              <div className=\"text-red-500 mb-4\">⚠️ {error}</div>\n              <button\n                onClick={fetchReports}\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\n              >\n                Retry\n              </button>\n            </div>\n          ) : reports.length === 0 ? (\n            <div className=\"text-center py-12 text-gray-500\">\n              No reports found matching your criteria\n            </div>\n          ) : (\n            <div>\n              {reports.map(report => (\n                <ReportRow key={report.id} report={report} />\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Pagination */}\n      {pagination.pages > 1 && (\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"text-sm text-gray-700\">\n              Showing {((pagination.page - 1) * pagination.per_page) + 1} to{' '}\n              {Math.min(pagination.page * pagination.per_page, pagination.total)} of{' '}\n              {pagination.total} results\n            </div>\n            <div className=\"flex space-x-2\">\n              <button\n                onClick={() => updateFilters({ page: pagination.page - 1 })}\n                disabled={pagination.page <= 1}\n                className=\"px-3 py-2 border rounded-lg disabled:bg-gray-100 disabled:text-gray-400\"\n              >\n                Previous\n              </button>\n              <span className=\"px-3 py-2 text-gray-700\">\n                Page {pagination.page} of {pagination.pages}\n              </span>\n              <button\n                onClick={() => updateFilters({ page: pagination.page + 1 })}\n                disabled={pagination.page >= pagination.pages}\n                className=\"px-3 py-2 border rounded-lg disabled:bg-gray-100 disabled:text-gray-400\"\n              >\n                Next\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Modals */}\n      <ReportDetailModal />\n      <BulkActionModal />\n\n      {/* Toast */}\n      {toast && (\n        <div className={`fixed bottom-6 left-1/2 -translate-x-1/2 px-4 py-3 rounded-lg shadow-md text-sm z-50 ${\n          toast.type === 'success' ? 'bg-green-600 text-white' : toast.type === 'error' ? 'bg-red-600 text-white' : 'bg-gray-800 text-white'\n        }`}>\n          {toast.message}\n        </div>\n      )}\n\n      {/* Bulk error details */}\n      {bulkErrors.length > 0 && (\n        <div className=\"bg-red-50 border border-red-200 text-red-800 p-4 rounded\">\n          <div className=\"font-medium mb-2\">Some items failed:</div>\n          <ul className=\"list-disc pl-5 space-y-1 text-sm\">\n            {bulkErrors.map(e => (\n              <li key={e.id}>#{e.id}: {e.error}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CommunityReports;\n","import React, { useState } from 'react'\nimport { useAuth } from '../../hooks/useAuth'\nimport { \n  BookOpen, \n  Users, \n  MessageSquare, \n  Settings, \n  Shield,\n  Plus,\n  Edit3,\n  Trash2,\n  Eye,\n  BarChart3,\n  RefreshCw\n} from 'lucide-react'\nimport { MobileCard } from '../ui/mobile-card'\nimport { MobileButton } from '../ui/mobile-button'\nimport { MobileInput } from '../ui/mobile-input'\nimport { Textarea } from '../ui/textarea'\nimport { createModule, getAllModules, updateModule, deleteModule, addLesson, updateLesson, deleteLesson, uploadLessonMedia } from '../../utils/contentManager'\nimport { getAllUsers, updateUserStatus, updateUserRole, deleteUser, hardDeleteUser, getUserStats, createUser, updateUserInfo, updateUserPassword, restoreUser, getDeletedUsers } from '../../utils/userManager'\nimport CommunityReports from './CommunityReports'\nimport { apiGet } from '../../lib/api'\n\nexport default function AdminDashboard({ setActiveTab }) {\n  const { user, isAuthenticated, isLoading: authLoading } = useAuth()\n  const [activeSection, setActiveSection] = useState('overview')\n  const [showAddModule, setShowAddModule] = useState(false)\n  const [showAddUser, setShowAddUser] = useState(false)\n  const [editingModule, setEditingModule] = useState(null)\n  const [editingUser, setEditingUser] = useState(null)\n  const [actionLoading, setActionLoading] = useState(false)\n  const [loadingUsers, setLoadingUsers] = useState(false)\n  \n  // Form state for new module\n  const [newModuleData, setNewModuleData] = useState({\n    title: '',\n    description: '',\n    difficulty: 'BEGINNER',\n    estimated_time: 10\n  })\n  \n  // Form state for new user\n  const [newUserData, setNewUserData] = useState({\n    first_name: '',\n    last_name: '',\n    email: '',\n    role: 'USER',\n    password: ''\n  })\n  \n  // Real data state\n  const [modules, setModules] = useState([])\n  const [users, setUsers] = useState([])\n  const [deletedUsers, setDeletedUsers] = useState([])\n  const [userStats, setUserStats] = useState({\n    total: 0,\n    active: 0,\n    suspended: 0,\n    banned: 0,\n    admins: 0,\n    moderators: 0,\n    regular: 0\n  })\n  \n  // Error state\n  const [error, setError] = useState(null)\n  const [dbConnectionStatus, setDbConnectionStatus] = useState('checking')\n  const [selectedDeletedUserIds, setSelectedDeletedUserIds] = useState([])\n  const isDeletedUserSelected = (id) => selectedDeletedUserIds.includes(id)\n  const toggleDeletedUserSelected = (id) => setSelectedDeletedUserIds(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id])\n  const selectAllDeletedUsersOnPage = () => {\n    const pageIds = deletedUsers.map(u => u.id)\n    const allSelected = pageIds.every(id => selectedDeletedUserIds.includes(id))\n    setSelectedDeletedUserIds(allSelected ? selectedDeletedUserIds.filter(id => !pageIds.includes(id)) : Array.from(new Set([...selectedDeletedUserIds, ...pageIds])))\n  }\n  const clearDeletedSelection = () => setSelectedDeletedUserIds([])\n  const [selectedUserIds, setSelectedUserIds] = useState([])\n  const [bulkActionType, setBulkActionType] = useState('')\n  const [bulkActionValue, setBulkActionValue] = useState('')\n  const isUserSelected = (id) => selectedUserIds.includes(id)\n  const toggleUserSelected = (id) => {\n    setSelectedUserIds(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id])\n  }\n  const selectAllUsersOnPage = () => {\n    const pageIds = users.map(u => u.id)\n    const allSelected = pageIds.every(id => selectedUserIds.includes(id))\n    setSelectedUserIds(allSelected ? selectedUserIds.filter(id => !pageIds.includes(id)) : Array.from(new Set([...selectedUserIds, ...pageIds])))\n  }\n  const clearBulkSelection = () => {\n    setSelectedUserIds([])\n    setBulkActionType('')\n    setBulkActionValue('')\n  }\n  const handleBulkApply = async () => {\n    if (selectedUserIds.length === 0) {\n      alert('Select at least one user')\n      return\n    }\n    if (!bulkActionType) {\n      alert('Choose a bulk action')\n      return\n    }\n    if ((bulkActionType === 'status' || bulkActionType === 'role') && !bulkActionValue) {\n      alert('Choose a value for the selected action')\n      return\n    }\n    if (bulkActionType === 'delete' && !confirm(`Delete ${selectedUserIds.length} user(s)?`)) {\n      return\n    }\n    setActionLoading(true)\n    const results = { success: 0, failed: 0, errors: [] }\n    for (const userId of selectedUserIds) {\n      try {\n        if (bulkActionType === 'status') {\n          const res = await updateUserStatus(userId, bulkActionValue)\n          if (!res.success) throw new Error(res.error || 'Failed')\n        } else if (bulkActionType === 'role') {\n          const res = await updateUserRole(userId, bulkActionValue)\n          if (!res.success) throw new Error(res.error || 'Failed')\n        } else if (bulkActionType === 'delete') {\n          const res = await deleteUser(userId)\n          if (!res.success) throw new Error(res.error || 'Failed')\n        }\n        results.success += 1\n      } catch (e) {\n        results.failed += 1\n        results.errors.push(`#${userId}: ${e.message || 'Error'}`)\n      }\n    }\n    await loadUsers()\n    await loadDeletedUsers()\n    setActionLoading(false)\n    clearBulkSelection()\n    const summary = `Bulk ${bulkActionType}: ${results.success} succeeded, ${results.failed} failed${results.errors.length ? `\\n${results.errors.join('\\n')}` : ''}`\n    alert(summary)\n  }\n  \n  // Admin stats (includes reports totals)\n  const [adminStats, setAdminStats] = useState(null)\n  \n  // Lesson management state\n  const [selectedModuleForLessons, setSelectedModuleForLessons] = useState(null)\n  const [newLessonData, setNewLessonData] = useState({\n    title: '',\n    type: 'info',\n    content: '',\n    contentType: 'info',\n    contentStyle: 'default',\n    duration: 5,\n    media: []\n  })\n  const [editingLesson, setEditingLesson] = useState(null)\n  \n  // Lesson operation loading states\n  const [lessonActionLoading, setLessonActionLoading] = useState(false)\n  const [lessonSuccessMessage, setLessonSuccessMessage] = useState('')\n  \n  // Force re-render mechanism\n  const [forceUpdate, setForceUpdate] = useState(0)\n  \n  // Auto-hide success messages\n  React.useEffect(() => {\n    if (lessonSuccessMessage) {\n      const timer = setTimeout(() => {\n        setLessonSuccessMessage('')\n      }, 3000) // Hide after 3 seconds\n      \n      return () => clearTimeout(timer)\n    }\n  }, [lessonSuccessMessage])\n  \n  // Debug: Monitor selectedModuleForLessons state changes\n  React.useEffect(() => {\n    console.log('🔄 selectedModuleForLessons state changed:', selectedModuleForLessons)\n    if (selectedModuleForLessons) {\n      console.log('🔄 New selectedModuleForLessons lessons:', selectedModuleForLessons.content?.lessons)\n      console.log('🔄 New selectedModuleForLessons lesson count:', selectedModuleForLessons.content?.lessons?.length || 0)\n    }\n  }, [selectedModuleForLessons])\n  \n  // Load modules from backend\n  const loadModules = async () => {\n    try {\n      setError(null)\n      const modulesData = await getAllModules()\n      setModules(modulesData)\n    } catch (error) {\n      console.error('Failed to load modules:', error)\n      setError(`Failed to load modules: ${error.message}`)\n      // Check if it's a connection issue\n      if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\n        setDbConnectionStatus('disconnected')\n      }\n    }\n  }\n  \n  // Load users from backend\n  const loadUsers = async () => {\n    try {\n      setLoadingUsers(true)\n      setError(null)\n      console.log('🔄 loadUsers called')\n      \n      const usersData = await getAllUsers()\n      console.log('🔄 getAllUsers result:', usersData)\n      \n      if (usersData.success) {\n        console.log('✅ Setting users state with:', usersData.users)\n        setUsers(usersData.users)\n      } else {\n        console.error('❌ Failed to load users:', usersData.error)\n        setError(`Failed to load users: ${usersData.error}`)\n      }\n    } catch (error) {\n      console.error('❌ Error in loadUsers:', error)\n      setError(`Failed to load users: ${error.message}`)\n      // Check if it's a connection issue\n      if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\n        setDbConnectionStatus('disconnected')\n      }\n    } finally {\n      setLoadingUsers(false)\n    }\n  }\n\n  // Load deleted users from backend\n  const loadDeletedUsers = async () => {\n    try {\n      console.log('🔄 loadDeletedUsers called')\n      \n      const deletedUsersData = await getDeletedUsers()\n      console.log('🔄 getDeletedUsers result:', deletedUsersData)\n      \n      if (deletedUsersData.success) {\n        console.log('✅ Setting deletedUsers state with:', deletedUsersData.users)\n        setDeletedUsers(deletedUsersData.users)\n      } else {\n        console.error('❌ Failed to load deleted users:', deletedUsersData.error)\n      }\n    } catch (error) {\n      console.error('❌ Error in loadDeletedUsers:', error)\n    }\n  }\n  \n  // Load user statistics\n  const loadUserStats = async () => {\n    try {\n      setError(null)\n      const statsData = await getUserStats()\n      if (statsData.success) {\n        setUserStats(statsData.stats)\n      } else {\n        console.error('Failed to load user stats:', statsData.error)\n        setError(`Failed to load user stats: ${statsData.error}`)\n      }\n    } catch (error) {\n      console.error('Failed to load user stats:', error)\n      setError(`Failed to load user stats: ${error.message}`)\n      // Check if it's a connection issue\n      if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {\n        setDbConnectionStatus('disconnected')\n      }\n    }\n  }\n  \n  // Handle module creation\n  const handleCreateModule = async () => {\n    if (!newModuleData.title.trim() || !newModuleData.description.trim()) {\n      alert('Please fill in all required fields')\n      return\n    }\n    \n    try {\n      setActionLoading(true)\n      \n      // Prepare module data with content structure\n      const moduleData = {\n        ...newModuleData,\n        content: {\n          lessons: []\n        }\n      }\n      \n      await createModule(moduleData)\n      \n      // Reset form and close modal\n      setNewModuleData({\n        title: '',\n        description: '',\n        difficulty: 'BEGINNER',\n        estimated_time: 10\n      })\n      setShowAddModule(false)\n      \n      // Reload modules\n      await loadModules()\n      \n      alert('Module created successfully!')\n    } catch (error) {\n      console.error('Failed to create module:', error)\n      alert(`Failed to create module: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  // Handle module deletion\n  const handleDeleteModule = async (moduleId) => {\n    if (!confirm('Are you sure you want to delete this module? This will also delete all lessons within it. This action cannot be undone.')) {\n      return\n    }\n    \n    try {\n      setActionLoading(true)\n      \n      await deleteModule(moduleId)\n      \n      alert('Module deleted successfully!')\n      \n      // Reload modules\n      await loadModules()\n      \n    } catch (error) {\n      console.error('Failed to delete module:', error)\n      alert(`Failed to delete module: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n  \n  // Handle user status update\n  const handleUpdateUserStatus = async (userId, newStatus) => {\n    try {\n      setActionLoading(true)\n      console.log('🔄 Updating user status:', { userId, newStatus })\n      \n      const result = await updateUserStatus(userId, newStatus)\n      console.log('🔄 updateUserStatus result:', result)\n      \n      if (result.success) {\n        console.log('✅ User status updated successfully')\n        alert('User status updated successfully!')\n        await loadUsers() // Reload users\n        await loadUserStats() // Reload stats\n      } else {\n        console.log('❌ User status update failed:', result.error)\n        alert(`Failed to update user status: ${result.error}`)\n      }\n    } catch (error) {\n      console.error('❌ Error updating user status:', error)\n      alert(`Failed to update user status: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n  \n  // Handle user role update\n  const handleUpdateUserRole = async (userId, newRole) => {\n    try {\n      setActionLoading(true)\n      console.log('🔄 Updating user role:', { userId, newRole })\n      \n      const result = await updateUserRole(userId, newRole)\n      console.log('🔄 updateUserRole result:', result)\n      \n      if (result.success) {\n        console.log('✅ User role updated successfully')\n        alert('User role updated successfully!')\n        await loadUsers() // Reload users\n        await loadUserStats() // Reload stats\n      } else {\n        console.log('❌ User role update failed:', result.error)\n        alert(`Failed to update user role: ${result.error}`)\n      }\n    } catch (error) {\n      console.error('❌ Error updating user role:', error)\n      alert(`Failed to update user role: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n  \n  // Handle user deletion\n  const handleDeleteUser = async (userId) => {\n    if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {\n      return\n    }\n    \n    try {\n      setActionLoading(true)\n      const result = await deleteUser(userId)\n      \n      if (result.success) {\n        alert('User deleted successfully!')\n        await loadUsers() // Reload users\n        await loadDeletedUsers() // Reload deleted users\n        await loadUserStats() // Reload stats\n      } else {\n        alert(`Failed to delete user: ${result.error}`)\n      }\n    } catch (error) {\n      console.error('Failed to delete user:', error)\n      alert(`Failed to delete user: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  // Handle user restoration\n  const handleRestoreUser = async (userId) => {\n    if (!confirm('Are you sure you want to restore this user? They will be able to access the system again.')) {\n      return\n    }\n    \n    try {\n      setActionLoading(true)\n      const result = await restoreUser(userId)\n      \n      if (result.success) {\n        alert('User restored successfully!')\n        await loadUsers() // Reload users\n        await loadDeletedUsers() // Reload deleted users\n        await loadUserStats() // Reload stats\n      } else {\n        alert(`Failed to restore user: ${result.error}`)\n      }\n    } catch (error) {\n      console.error('Failed to restore user:', error)\n      alert(`Failed to restore user: ${error.message}`)\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  const handleBulkRestoreDeleted = async () => {\n    if (selectedDeletedUserIds.length === 0) { alert('Select at least one user to restore'); return }\n    try {\n      setActionLoading(true)\n      const results = { success: 0, failed: 0, errors: [] }\n      for (const id of selectedDeletedUserIds) {\n        try {\n          const r = await restoreUser(id)\n          if (!r.success) throw new Error(r.error || 'Failed')\n          results.success++\n        } catch (e) {\n          results.failed++\n          results.errors.push(`#${id}: ${e.message || 'Error'}`)\n        }\n      }\n      await loadUsers(); await loadDeletedUsers()\n      alert(`Bulk restore: ${results.success} succeeded, ${results.failed} failed${results.errors.length ? `\\n${results.errors.join('\\n')}` : ''}`)\n    } finally {\n      setActionLoading(false)\n      setSelectedDeletedUserIds([])\n    }\n  }\n  \n  // Handle user creation\n  const handleCreateUser = async () => {\n    if (!newUserData.first_name.trim() || !newUserData.last_name.trim() || !newUserData.email.trim() || !newUserData.password.trim()) {\n      alert('Please fill in all required fields')\n      return\n    }\n    \n    try {\n      setActionLoading(true)\n      setError(null)\n      \n      const result = await createUser(newUserData)\n      \n      if (result.success) {\n        alert('User created successfully!')\n        \n        // Reset form and close modal\n        setNewUserData({\n          first_name: '',\n          last_name: '',\n          email: '',\n          role: 'USER',\n          password: ''\n        })\n        setShowAddUser(false)\n        \n        // Reload users and stats\n        await loadUsers()\n        await loadUserStats()\n      } else {\n        setError(result.error || 'Failed to create user')\n      }\n    } catch (error) {\n      console.error('Failed to create user:', error)\n      setError(error.message || 'Failed to create user')\n    } finally {\n      setActionLoading(false)\n    }\n  }\n  \n  // Handle user update\n  const handleUpdateUser = async (userId) => {\n    try {\n      setActionLoading(true)\n      setError(null)\n      \n      // Find the user being edited\n      const userToUpdate = editingUser\n      \n      // Update user information\n      const updatePromises = []\n      \n      // Update basic user info if changed\n      const basicInfoChanged = \n        userToUpdate.first_name !== users.find(u => u.id === userId)?.first_name ||\n        userToUpdate.last_name !== users.find(u => u.id === userId)?.last_name ||\n        userToUpdate.email !== users.find(u => u.id === userId)?.email\n      \n      if (basicInfoChanged) {\n        const basicInfo = {\n          first_name: userToUpdate.first_name,\n          last_name: userToUpdate.last_name,\n          email: userToUpdate.email\n        }\n        updatePromises.push(updateUserInfo(userId, basicInfo))\n      }\n      \n      // Update role if changed\n      if (userToUpdate.role && userToUpdate.role !== users.find(u => u.id === userId)?.role) {\n        updatePromises.push(updateUserRole(userId, userToUpdate.role))\n      }\n      \n      // Update status if changed\n      if (userToUpdate.status && userToUpdate.status !== users.find(u => u.id === userId)?.status) {\n        updatePromises.push(updateUserStatus(userId, userToUpdate.status))\n      }\n      \n      // Update password if changed\n      if (userToUpdate.newPassword) {\n        updatePromises.push(updateUserPassword(userId, userToUpdate.newPassword))\n      }\n      \n      // Execute all updates\n      if (updatePromises.length > 0) {\n        const results = await Promise.all(updatePromises)\n        const hasErrors = results.some(result => !result.success)\n        \n        if (hasErrors) {\n          const errors = results.filter(r => !r.success).map(r => r.error).join(', ')\n          setError(`Failed to update user: ${errors}`)\n          return\n        }\n      }\n      \n      alert('User updated successfully!')\n      \n      // Close modal and reload data\n      setEditingUser(null)\n      await loadUsers()\n      await loadUserStats()\n      \n    } catch (error) {\n      console.error('Failed to update user:', error)\n      setError(error.message || 'Failed to update user')\n    } finally {\n      setActionLoading(false)\n    }\n  }\n  \n  // Handle module update\n  const handleUpdateModule = async (moduleId) => {\n    try {\n      console.log('🔄 handleUpdateModule called with moduleId:', moduleId)\n      console.log('🔄 editingModule state:', editingModule)\n      \n      setActionLoading(true)\n      setError(null)\n      \n      // Find the module being edited\n      const moduleToUpdate = editingModule\n      console.log('🔄 moduleToUpdate:', moduleToUpdate)\n      \n      // Prepare module data\n      const moduleData = {\n        title: moduleToUpdate.title,\n        description: moduleToUpdate.description,\n        difficulty: moduleToUpdate.difficulty,\n        estimated_time: moduleToUpdate.estimated_time\n      }\n      console.log('🔄 moduleData to send:', moduleData)\n      \n      // Update module using contentManager\n      console.log('🔄 Calling updateModule from contentManager...')\n      await updateModule(moduleId, moduleData)\n      \n      alert('Module updated successfully!')\n      \n      // Close modal and reload data\n      setEditingModule(null)\n      await loadModules()\n      \n    } catch (error) {\n      console.error('❌ Failed to update module:', error)\n      setError(error.message || 'Failed to update module')\n    } finally {\n      setActionLoading(false)\n    }\n  }\n\n  // Lesson management functions\n  const handleAddLesson = async (moduleId) => {\n    try {\n      setLessonActionLoading(true)\n      setLessonSuccessMessage('')\n      console.log('🔄 Adding lesson with data:', { moduleId, newLessonData })\n      \n      const response = await addLesson(moduleId, newLessonData)\n      console.log('🔄 addLesson response:', response)\n      \n      if (response && response.message) {\n        console.log('✅ Lesson added successfully, response:', response)\n        setNewLessonData({\n          title: '',\n          type: 'info',\n          content: '',\n          contentType: 'info',\n          contentStyle: 'default',\n          duration: 5,\n          media: []\n        })\n        \n        // Refresh both the modules list and the selected module data\n        await loadModules()\n        console.log('🔄 After loadModules, modules state:', modules)\n        \n        // Refresh the modules data\n        const updatedModules = await getAllModules(true) // Force refresh to get latest data\n        console.log('🔄 getAllModules result:', updatedModules)\n        console.log('🔄 All modules content:', updatedModules.map(m => ({ id: m.id, title: m.title, content: m.content, lessons: m.content?.lessons })))\n        \n        // Find the updated module\n        const updatedModule = updatedModules.find(m => m.id === moduleId)\n        console.log('🔄 Found updated module:', updatedModule)\n        console.log('🔄 Module content:', updatedModule?.content)\n        console.log('🔄 Module lessons:', updatedModule?.content?.lessons)\n        console.log('🔄 Lesson count:', updatedModule?.content?.lessons?.length || 0)\n        \n        // Also check the current selectedModuleForLessons state\n        console.log('🔄 Current selectedModuleForLessons state:', selectedModuleForLessons)\n        console.log('🔄 Current selectedModuleForLessons lessons:', selectedModuleForLessons?.content?.lessons)\n        console.log('🔄 Current selectedModuleForLessons lesson count:', selectedModuleForLessons?.content?.lessons?.length || 0)\n        \n        if (updatedModule) {\n          console.log('🔄 Setting selectedModuleForLessons to:', updatedModule)\n          console.log('🔄 Current lesson count before update:', selectedModuleForLessons?.content?.lessons?.length || 0)\n          console.log('🔄 New lesson count after update:', updatedModule?.content?.lessons?.length || 0)\n          \n          setSelectedModuleForLessons(updatedModule)\n          \n          // Also update the modules state to ensure consistency\n          setModules(updatedModules)\n          \n          // Force a re-render to ensure UI updates\n          setForceUpdate(prev => prev + 1)\n          \n          // Debug: Check state after setting\n          setTimeout(() => {\n            console.log('🔄 After state update - selectedModuleForLessons:', selectedModuleForLessons)\n            console.log('🔄 After state update - modules state:', modules)\n            console.log('🔄 After state update - forceUpdate value:', forceUpdate)\n          }, 100)\n        } else {\n          console.log('❌ Could not find updated module with ID:', moduleId)\n        }\n        \n        setLessonSuccessMessage('Lesson added successfully!')\n      } else {\n        console.log('❌ Lesson add failed, response:', response)\n        setError(response?.error || 'Failed to add lesson')\n      }\n    } catch (error) {\n      console.error('❌ Error adding lesson:', error)\n      setError('Failed to add lesson')\n    } finally {\n      setLessonActionLoading(false)\n    }\n  }\n\n  const handleUpdateLesson = async (moduleId, lessonId, lessonData) => {\n    try {\n      setLessonActionLoading(true)\n      setLessonSuccessMessage('')\n      const response = await updateLesson(moduleId, lessonId, lessonData)\n      \n      if (response && response.message) {\n        setEditingLesson(null)\n        \n        // Refresh both the modules list and the selected module data\n        await loadModules()\n        \n        // Update the selected module with fresh data\n        const updatedModules = await getAllModules(true) // Force refresh to get latest data\n        const updatedModule = updatedModules.find(m => m.id === moduleId)\n        if (updatedModule) {\n          setSelectedModuleForLessons(updatedModule)\n          \n          // Also update the modules state to ensure consistency\n          setModules(updatedModules)\n          \n          // Force a re-render to ensure UI updates\n          setForceUpdate(prev => prev + 1)\n        }\n        \n        setLessonSuccessMessage('Lesson updated successfully!')\n      } else {\n        setError(response?.error || 'Failed to update lesson')\n      }\n    } catch (error) {\n      console.error('Error updating lesson:', error)\n      setError('Failed to update lesson')\n    } finally {\n      setLessonActionLoading(false)\n    }\n  }\n\n  const handleDeleteLesson = async (moduleId, lessonId) => {\n    if (!window.confirm('Are you sure you want to delete this lesson?')) {\n      return\n    }\n    \n    try {\n      setLessonActionLoading(true)\n      setLessonSuccessMessage('')\n      console.log('🔄 handleDeleteLesson called with:', { moduleId, lessonId })\n      \n      const response = await deleteLesson(moduleId, lessonId)\n      console.log('🔄 deleteLesson response:', response)\n      \n      if (response && response.message) {\n        console.log('✅ Lesson deleted successfully, refreshing data...')\n        \n        // Refresh both the modules list and the selected module data\n        await loadModules()\n        \n        // Update the selected module with fresh data\n        const updatedModules = await getAllModules(true) // Force refresh to get latest data\n        const updatedModule = updatedModules.find(m => m.id === moduleId)\n        if (updatedModule) {\n          console.log('🔄 Found updated module:', updatedModule)\n          console.log('🔄 Module content:', updatedModule.content)\n          console.log('🔄 Module lessons:', updatedModule.content?.lessons)\n          console.log('🔄 Lesson count:', updatedModule.content?.lessons?.length || 0)\n          setSelectedModuleForLessons(updatedModule)\n          \n          // Also update the modules state to ensure consistency\n          setModules(updatedModules)\n          \n          // Force a re-render to ensure UI updates\n          setForceUpdate(prev => prev + 1)\n        }\n        \n        setLessonSuccessMessage('Lesson deleted successfully!')\n      } else {\n        console.log('❌ Failed to delete lesson:', response?.error)\n        setError(response?.error || 'Failed to delete lesson')\n      }\n    } catch (error) {\n      console.error('❌ Error deleting lesson:', error)\n      setError('Failed to delete lesson')\n    } finally {\n      setLessonActionLoading(false)\n    }\n  }\n  \n  // Check database connectivity\n  const checkDatabaseConnection = async () => {\n    try {\n      setDbConnectionStatus('checking')\n      const apiBase = import.meta.env.VITE_API_BASE || 'http://localhost:10000'\n      const response = await fetch(`${apiBase}/api/health`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        // Add timeout for the request\n        signal: AbortSignal.timeout(10000) // 10 second timeout\n      })\n      \n      if (response.ok) {\n        const data = await response.json()\n        console.log('Health check response:', data)\n        setDbConnectionStatus(data.database === 'healthy' ? 'connected' : 'disconnected')\n        \n        if (data.database !== 'healthy') {\n          setError(`Database status: ${data.database}`)\n        } else {\n          setError(null)\n        }\n      } else {\n        console.error('Health check failed with status:', response.status)\n        setDbConnectionStatus('disconnected')\n        setError(`Backend health check failed: ${response.status}`)\n      }\n    } catch (error) {\n      console.error('Database connection check failed:', error)\n      setDbConnectionStatus('disconnected')\n      \n      if (error.name === 'AbortError') {\n        setError('Backend connection timeout - service may be unavailable')\n      } else if (error.message.includes('Failed to fetch')) {\n        setError('Cannot connect to backend - check if service is running')\n      } else {\n        setError(`Connection error: ${error.message}`)\n      }\n    }\n  }\n  \n  // Load data on component mount\n  React.useEffect(() => {\n    loadModules()\n    loadUsers()\n    loadDeletedUsers()\n    loadUserStats()\n    checkDatabaseConnection() // Check DB connection on mount\n    // Load admin dashboard stats (includes reports totals)\n    ;(async () => {\n      try {\n        const res = await apiGet('/api/admin/stats')\n        if (res.ok) {\n          const data = await res.json()\n          setAdminStats(data)\n        }\n      } catch (e) {\n        // ignore\n      }\n    })()\n  }, [])\n  \n  // Authentication check\n  if (authLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#21a1ce] mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Checking authentication...</p>\n        </div>\n      </div>\n    )\n  }\n  \n  if (!isAuthenticated) {\n    return (\n      <div className=\"space-y-6 p-4\">\n        <div className=\"bg-gradient-to-r from-[#21a1ce] to-[#1a8bb8] rounded-2xl p-6 text-white shadow-lg\">\n          <div className=\"text-center\">\n            <Shield className=\"w-16 h-16 mx-auto mb-4\" />\n            <h1 className=\"text-3xl font-bold mb-2\">Authentication Required</h1>\n            <p className=\"text-white text-lg\">Please log in to access the Admin Dashboard.</p>\n          </div>\n        </div>\n        <MobileCard>\n          <div className=\"text-center py-8\">\n            <Shield className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Access Denied</h2>\n            <p className=\"text-gray-600 mb-6\">You must be logged in to access the admin panel.</p>\n            <MobileButton\n              onClick={() => setActiveTab('login')}\n              className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n            >\n              Go to Login\n            </MobileButton>\n          </div>\n        </MobileCard>\n      </div>\n    )\n  }\n  \n  if (!user?.is_admin && user?.role !== 'ADMIN' && user?.role !== 'MODERATOR') {\n    return (\n      <div className=\"space-y-6 p-4\">\n        <div className=\"bg-gradient-to-r from-red-500 to-red-600 rounded-2xl p-6 text-white shadow-lg\">\n          <div className=\"text-center\">\n            <Shield className=\"w-16 h-16 mx-auto mb-4\" />\n            <h1 className=\"text-3xl font-bold mb-2\">Access Denied</h1>\n            <p className=\"text-white text-lg\">You don't have permission to access the Admin Dashboard.</p>\n          </div>\n        </div>\n        <MobileCard>\n          <div className=\"text-center py-8\">\n            <Shield className=\"w-16 h-16 text-red-400 mx-auto mb-4\" />\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Insufficient Privileges</h2>\n            <p className=\"text-gray-600 mb-6\">Only administrators can access this panel.</p>\n            <MobileButton\n              onClick={() => setActiveTab('home')}\n              className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n            >\n              Return to Home\n            </MobileButton>\n          </div>\n        </MobileCard>\n      </div>\n    )\n  }\n\n  const renderOverview = () => (\n    <div className=\"space-y-6\">\n      {/* Database status moved into System Overview → System Status card */}\n\n      <MobileCard>\n        <div className=\"p-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">System Overview</h2>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <MobileCard>\n              <div className=\"text-center p-4\">\n                <BookOpen className=\"w-8 h-8 text-blue-500 mx-auto mb-2\" />\n                <h3 className=\"text-lg font-semibold text-gray-900\">{modules.length}</h3>\n                <p className=\"text-sm text-gray-600\">Learning Modules</p>\n              </div>\n            </MobileCard>\n            <MobileCard>\n              <div className=\"text-center p-4\">\n                <Users className=\"w-8 h-8 text-green-500 mx-auto mb-2\" />\n                <h3 className=\"text-lg font-semibold text-gray-900\">{userStats.total}</h3>\n                <p className=\"text-sm text-gray-600\">Total Users</p>\n                <div className=\"mt-2 grid grid-cols-2 gap-x-3 gap-y-1 text-xs text-gray-600\">\n                  <span>Active: <span className=\"font-medium\">{userStats.active ?? 0}</span></span>\n                  <span>Admins: <span className=\"font-medium\">{userStats.admins ?? 0}</span></span>\n                  <span>Moderators: <span className=\"font-medium\">{userStats.moderators ?? 0}</span></span>\n                  <span>Deleted: <span className=\"font-medium\">{deletedUsers?.length ?? 0}</span></span>\n                  <span>Suspended: <span className=\"font-medium\">{userStats.suspended ?? 0}</span></span>\n                  <span>Banned: <span className=\"font-medium\">{userStats.banned ?? 0}</span></span>\n                </div>\n              </div>\n            </MobileCard>\n            <MobileCard>\n              <div className=\"text-center p-4\">\n                <MessageSquare className=\"w-8 h-8 text-orange-500 mx-auto mb-2\" />\n                <h3 className=\"text-lg font-semibold text-gray-900\">{adminStats?.reports?.total ?? 0}</h3>\n                <p className=\"text-sm text-gray-600\">Community Reports</p>\n                {adminStats?.reports && (\n                  <div className=\"mt-2 grid grid-cols-3 gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded-full bg-yellow-50 text-yellow-700 text-center\">\n                      Pending: <span className=\"font-medium\">{adminStats.reports.pending ?? 0}</span>\n                    </span>\n                    <span className=\"px-2 py-1 rounded-full bg-green-50 text-green-700 text-center\">\n                      Approved: <span className=\"font-medium\">{adminStats.reports.approved ?? 0}</span>\n                    </span>\n                    <span className=\"px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-center\">\n                      Verified: <span className=\"font-medium\">{adminStats.reports.verified ?? 0}</span>\n                    </span>\n                  </div>\n                )}\n                <div className=\"mt-3 flex items-center justify-center gap-2\">\n                  <MobileButton\n                    onClick={() => setActiveSection('reports')}\n                    className=\"bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 text-xs\"\n                  >\n                    Go to Reports\n                  </MobileButton>\n                  {adminStats?.reports?.pending > 0 && (\n                    <MobileButton\n                      onClick={() => {\n                        setActiveSection('reports');\n                        window.__ADMIN_REPORTS_INITIAL_FILTERS__ = { status: 'PENDING' };\n                      }}\n                      className=\"bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 text-xs\"\n                    >\n                      Review Pending\n                    </MobileButton>\n                  )}\n                </div>\n              </div>\n            </MobileCard>\n            <MobileCard>\n              <div className=\"text-center p-4\">\n                <Shield className=\"w-8 h-8 text-purple-500 mx-auto mb-2\" />\n                <h3 className=\"text-lg font-semibold text-gray-900\">Active</h3>\n                <p className=\"text-sm text-gray-600\">System Status</p>\n                <div className=\"mt-3 space-y-1\">\n                  <div className=\"flex items-center justify-center gap-2 text-xs\">\n                    <span className=\"text-gray-500\">Backend:</span>\n                    <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full ${\n                      dbConnectionStatus === 'connected' ? 'bg-green-100 text-green-700' :\n                      dbConnectionStatus === 'disconnected' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700'\n                    }`}>\n                      <span className={`w-2 h-2 rounded-full ${\n                        dbConnectionStatus === 'connected' ? 'bg-green-500' :\n                        dbConnectionStatus === 'disconnected' ? 'bg-red-500' : 'bg-yellow-500'\n                      }`}></span>\n                      {dbConnectionStatus === 'connected' ? 'Connected' : dbConnectionStatus === 'disconnected' ? 'Disconnected' : 'Checking...'}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-center gap-2 text-xs\">\n                    <span className=\"text-gray-500\">Database:</span>\n                    <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full ${\n                      dbConnectionStatus === 'connected' ? 'bg-green-100 text-green-700' :\n                      dbConnectionStatus === 'disconnected' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700'\n                    }`}>\n                      <span className={`w-2 h-2 rounded-full ${\n                        dbConnectionStatus === 'connected' ? 'bg-green-500' :\n                        dbConnectionStatus === 'disconnected' ? 'bg-red-500' : 'bg-yellow-500'\n                      }`}></span>\n                      {dbConnectionStatus === 'connected' ? 'Connected' : dbConnectionStatus === 'disconnected' ? 'Disconnected' : 'Checking...'}\n                    </span>\n                  </div>\n                  <button\n                    onClick={checkDatabaseConnection}\n                    className=\"block mx-auto mt-1 text-[11px] text-blue-600 hover:text-blue-800 underline\"\n                  >\n                    Check connection\n                  </button>\n                </div>\n              </div>\n            </MobileCard>\n          </div>\n          \n          \n        </div>\n      </MobileCard>\n    </div>\n  )\n\n  const renderContentManagement = () => (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">Learning Content Management</h2>\n        <MobileButton\n          onClick={() => setShowAddModule(true)}\n          className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Add Module\n        </MobileButton>\n      </div>\n\n      <div className=\"space-y-4\">\n        {modules.length === 0 ? (\n          <MobileCard>\n            <div className=\"text-center py-8\">\n              <BookOpen className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">No Modules Yet</h3>\n              <p className=\"text-gray-600 mb-4\">Create your first learning module to get started.</p>\n              <MobileButton\n                onClick={() => setShowAddModule(true)}\n                className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n              >\n                <Plus className=\"w-4 h-4 mr-2\" />\n                Create First Module\n              </MobileButton>\n            </div>\n          </MobileCard>\n        ) : (\n          modules.map((module) => (\n            <MobileCard key={module.id}>\n              <div className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className=\"font-semibold text-gray-900\">{module.title}</h3>\n                  <div className=\"flex space-x-2\">\n                    <button\n                      onClick={() => setSelectedModuleForLessons(module)}\n                      className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors\"\n                      title=\"Manage Lessons\"\n                    >\n                      <BookOpen className=\"w-4 h-4\" />\n                    </button>\n                    <button\n                      onClick={() => setEditingModule(module)}\n                      className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                      title=\"Edit Module\"\n                    >\n                      <Edit3 className=\"w-4 h-4\" />\n                    </button>\n                    <button\n                      onClick={() => handleDeleteModule(module.id)}\n                      disabled={actionLoading}\n                      className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50\"\n                      title=\"Delete Module\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n                <p className=\"text-gray-600 text-sm mb-2\">{module.description}</p>\n                <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n                  <span>{module.content?.lessons?.length || 0} lessons</span>\n                  <span className=\"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800\">\n                    {module.difficulty}\n                  </span>\n                  <span className=\"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800\">\n                    {module.estimated_time} min\n                  </span>\n                </div>\n              </div>\n            </MobileCard>\n          ))\n        )}\n      </div>\n    </div>\n  )\n\n  const renderUserManagement = () => (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">User Management</h2>\n        <div className=\"flex space-x-2\">\n          <MobileButton\n            onClick={loadUsers}\n            disabled={actionLoading}\n            className=\"bg-gray-600 hover:bg-gray-700 text-white\"\n          >\n            <RefreshCw className={`w-4 h-4 mr-2 ${actionLoading ? 'animate-spin' : ''}`} />\n            Refresh\n          </MobileButton>\n          <MobileButton\n            onClick={() => setShowAddUser(true)}\n            className=\"bg-green-600 hover:bg-green-700 text-white\"\n          >\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Add User\n          </MobileButton>\n        </div>\n      </div>\n\n      {loadingUsers ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#21a1ce] mx-auto mb-4\"></div>\n            <p className=\"text-gray-600\">Loading users...</p>\n          </div>\n        </div>\n      ) : users.length === 0 ? (\n        <MobileCard>\n          <div className=\"text-center py-8\">\n            <Users className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">No Users Found</h3>\n            <p className=\"text-gray-600 mb-4\">There are no users in the system yet.</p>\n          </div>\n        </MobileCard>\n      ) : (\n        <div className=\"space-y-4\">\n          <div className=\"bg-white border rounded-lg p-3 flex flex-wrap items-center gap-2\">\n            <button onClick={selectAllUsersOnPage} className=\"px-2 py-1 text-sm border rounded\">\n              {users.every(u => selectedUserIds.includes(u.id)) && users.length > 0 ? 'Unselect All' : 'Select All'}\n            </button>\n            <span className=\"text-sm text-gray-600\">Selected: {selectedUserIds.length}</span>\n            <select value={bulkActionType} onChange={(e) => { setBulkActionType(e.target.value); setBulkActionValue('') }} className=\"text-sm border rounded px-2 py-1\">\n              <option value=\"\">Bulk action...</option>\n              <option value=\"status\">Set Status</option>\n              <option value=\"role\">Set Role</option>\n              <option value=\"delete\">Delete</option>\n            </select>\n            {bulkActionType === 'status' && (\n              <select value={bulkActionValue} onChange={(e) => setBulkActionValue(e.target.value)} className=\"text-sm border rounded px-2 py-1\">\n                <option value=\"\">Choose status</option>\n                <option value=\"ACTIVE\">Active</option>\n                <option value=\"SUSPENDED\">Suspended</option>\n                <option value=\"BANNED\">Banned</option>\n              </select>\n            )}\n            {bulkActionType === 'role' && (\n              <select value={bulkActionValue} onChange={(e) => setBulkActionValue(e.target.value)} className=\"text-sm border rounded px-2 py-1\">\n                <option value=\"\">Choose role</option>\n                <option value=\"USER\">User</option>\n                <option value=\"MODERATOR\">Moderator</option>\n                <option value=\"ADMIN\">Admin</option>\n              </select>\n            )}\n            <MobileButton onClick={handleBulkApply} disabled={actionLoading || selectedUserIds.length === 0 || !bulkActionType || ((bulkActionType === 'status' || bulkActionType === 'role') && !bulkActionValue)} className=\"px-3 py-1\">\n              Apply\n            </MobileButton>\n            {selectedUserIds.length > 0 && (\n              <button onClick={clearBulkSelection} className=\"text-sm text-gray-600 hover:underline ml-auto\">Clear</button>\n            )}\n          </div>\n          {users.map((user) => (\n            <MobileCard key={user.id}>\n              <div className=\"p-4\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div className=\"flex items-start gap-3\">\n                    <input type=\"checkbox\" checked={isUserSelected(user.id)} onChange={() => toggleUserSelected(user.id)} className=\"mt-1 h-4 w-4\" />\n                    <div>\n                      <h3 className=\"font-semibold text-gray-900\">\n                        {user.first_name && user.last_name \n                          ? `${user.first_name} ${user.last_name}` \n                          : user.email?.split('@')[0] || 'Unknown User'\n                        }\n                      </h3>\n                      <p className=\"text-sm text-gray-600\">{user.email}</p>\n                      {user.created_at && (\n                        <p className=\"text-xs text-gray-500\">\n                          Joined: {new Date(user.created_at).toLocaleDateString()}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex space-x-2\">\n                    <button\n                      onClick={() => setEditingUser(user)}\n                      className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                      title=\"Edit User\"\n                    >\n                      <Edit3 className=\"w-4 h-4\" />\n                    </button>\n                    <button\n                      onClick={() => handleDeleteUser(user.id)}\n                      disabled={actionLoading}\n                      className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50\"\n                      title=\"Delete User\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center space-x-4 text-sm mb-3\">\n                  <span className={`px-2 py-1 rounded-full text-xs ${\n                    user.is_admin || user.role === 'ADMIN' \n                      ? 'bg-purple-100 text-purple-800' \n                      : user.role === 'MODERATOR'\n                      ? 'bg-orange-100 text-orange-800'\n                      : 'bg-blue-100 text-blue-800'\n                  }`}>\n                    {user.role || 'USER'}\n                  </span>\n                  <span className={`px-2 py-1 rounded-full text-xs ${\n                    user.status === 'ACTIVE' \n                      ? 'bg-green-100 text-green-800' \n                      : user.status === 'SUSPENDED'\n                      ? 'bg-yellow-100 text-yellow-800'\n                      : user.status === 'BANNED'\n                      ? 'bg-red-100 text-red-800'\n                      : 'bg-gray-100 text-gray-800'\n                  }`}>\n                    {user.status || 'UNKNOWN'}\n                  </span>\n                </div>\n                \n                {/* Quick Actions */}\n                <div className=\"flex flex-wrap gap-2\">\n                  {/* Status Update */}\n                  <select\n                    value={user.status || 'ACTIVE'}\n                    onChange={(e) => handleUpdateUserStatus(user.id, e.target.value)}\n                    disabled={actionLoading}\n                    className=\"px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 disabled:opacity-50\"\n                  >\n                    <option value=\"ACTIVE\">Active</option>\n                    <option value=\"SUSPENDED\">Suspended</option>\n                    <option value=\"BANNED\">Banned</option>\n                  </select>\n                  \n                  {/* Role Update */}\n                  <select\n                    value={user.role || 'USER'}\n                    onChange={(e) => handleUpdateUserRole(user.id, e.target.value)}\n                    disabled={actionLoading}\n                    className=\"px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-1 focus:ring-blue-500 disabled:opacity-50\"\n                  >\n                    <option value=\"USER\">User</option>\n                    <option value=\"MODERATOR\">Moderator</option>\n                    <option value=\"ADMIN\">Admin</option>\n                  </select>\n\n                  {/* Email Verified Toggle */}\n                  <label className=\"flex items-center space-x-2 text-xs\">\n                    <input\n                      type=\"checkbox\"\n                      checked={!!user.email_verified}\n                      onChange={async (e) => {\n                        try {\n                          setActionLoading(true)\n                          await updateUserInfo(user.id, { email_verified: e.target.checked })\n                          await loadUsers()\n                        } catch (err) {\n                          alert('Failed to update verification flag: ' + (err.message || 'Unknown error'))\n                        } finally {\n                          setActionLoading(false)\n                        }\n                      }}\n                      className=\"h-4 w-4\"\n                    />\n                    <span>Email verified</span>\n                  </label>\n                </div>\n              </div>\n            </MobileCard>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n\n  const renderDeletedUsers = () => (\n    <div className=\"space-y-6\">\n      <h2 className=\"text-xl font-semibold text-gray-900\">Deleted Users</h2>\n      <div className=\"space-y-4\">\n        {/* Bulk restore toolbar */}\n        <div className=\"bg-white border rounded-lg p-3 flex flex-wrap items-center gap-2\">\n          <button onClick={selectAllDeletedUsersOnPage} className=\"px-2 py-1 text-sm border rounded\">\n            {deletedUsers.every(u => selectedDeletedUserIds.includes(u.id)) && deletedUsers.length > 0 ? 'Unselect All' : 'Select All'}\n          </button>\n          <span className=\"text-sm text-gray-600\">Selected: {selectedDeletedUserIds.length}</span>\n          <MobileButton onClick={handleBulkRestoreDeleted} disabled={actionLoading || selectedDeletedUserIds.length === 0} className=\"px-3 py-1\">\n            Restore Selected\n          </MobileButton>\n          <MobileButton onClick={async () => {\n            if (selectedDeletedUserIds.length === 0) { alert('Select at least one user'); return }\n            if (!confirm(`Permanently delete ${selectedDeletedUserIds.length} user(s)? This cannot be undone.`)) return\n            try {\n              setActionLoading(true)\n              const results = { success: 0, failed: 0, errors: [] }\n              for (const id of selectedDeletedUserIds) {\n                try {\n                  const r = await hardDeleteUser(id)\n                  if (!r.success) throw new Error(r.error || 'Failed')\n                  results.success++\n                } catch (e) {\n                  results.failed++\n                  results.errors.push(`#${id}: ${e.message || 'Error'}`)\n                }\n              }\n              await loadUsers(); await loadDeletedUsers()\n              alert(`Bulk permanent delete: ${results.success} succeeded, ${results.failed} failed${results.errors.length ? `\\n${results.errors.join('\\n')}` : ''}`)\n            } finally {\n              setActionLoading(false)\n              setSelectedDeletedUserIds([])\n            }\n          }} disabled={actionLoading || selectedDeletedUserIds.length === 0} className=\"px-3 py-1 bg-red-600 hover:bg-red-700 text-white\">\n            Permanently Delete\n          </MobileButton>\n          {selectedDeletedUserIds.length > 0 && (\n            <button onClick={clearDeletedSelection} className=\"text-sm text-gray-600 hover:underline ml-auto\">Clear</button>\n          )}\n        </div>\n        {deletedUsers.map((user) => (\n          <MobileCard key={user.id}>\n            <div className=\"p-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-start gap-3\">\n                  <input\n                    type=\"checkbox\"\n                    checked={isDeletedUserSelected(user.id)}\n                    onChange={() => toggleDeletedUserSelected(user.id)}\n                    className=\"mt-1 h-4 w-4\"\n                  />\n                  <div>\n                  <h4 className=\"font-medium text-gray-900\">\n                    {user.first_name && user.last_name \n                      ? `${user.first_name} ${user.last_name}`\n                      : user.email?.split('@')[0] || 'Unknown User'\n                    }\n                  </h4>\n                  <p className=\"text-sm text-gray-600\">{user.email}</p>\n                  {user.created_at && (\n                    <p className=\"text-xs text-gray-500\">\n                      Joined: {new Date(user.created_at).toLocaleDateString()}\n                    </p>\n                  )}\n                  </div>\n                </div>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => handleRestoreUser(user.id)}\n                    disabled={actionLoading}\n                    className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50\"\n                    title=\"Restore User\"\n                  >\n                    <RefreshCw className=\"w-4 h-4\" />\n                  </button>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-4 text-sm\">\n                <span className=\"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800\">\n                  {user.role || 'USER'}\n                </span>\n                <span className=\"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800\">\n                  DELETED\n                </span>\n              </div>\n            </div>\n          </MobileCard>\n        ))}\n        \n        {deletedUsers.length === 0 && (\n          <div className=\"text-center py-8 text-gray-500\">\n            <p>No deleted users</p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n\n  const renderCommunityReports = () => (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-xl font-semibold text-gray-900\">Community Reports</h2>\n        <MobileButton\n          onClick={() => {/* Refresh reports */}}\n          className=\"bg-orange-600 hover:bg-orange-700 text-white\"\n        >\n          <BarChart3 className=\"w-4 h-4 mr-2\" />\n          Refresh\n        </MobileButton>\n      </div>\n\n      <div className=\"space-y-4\">\n        {reports.map((report) => (\n          <MobileCard key={report.id}>\n            <div className=\"p-4\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <h3 className=\"font-semibold text-gray-900 capitalize\">{report.type} Report</h3>\n                <span className={`px-2 py-1 rounded-full text-xs ${\n                  report.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :\n                  report.status === 'investigating' ? 'bg-blue-100 text-blue-800' :\n                  'bg-green-100 text-green-800'\n                }`}>\n                  {report.status}\n                </span>\n              </div>\n              <p className=\"text-gray-600 text-sm mb-2\">{report.description}</p>\n              <div className=\"flex items-center justify-between text-sm text-gray-500\">\n                <span>Reported by: {report.reporter}</span>\n                <button className=\"text-[#21a1ce] hover:underline\">View Details</button>\n              </div>\n            </div>\n          </MobileCard>\n        ))}\n      </div>\n    </div>\n  )\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{((user?.role || '').toUpperCase() === 'MODERATOR' && !user?.is_admin) ? 'Moderator Dashboard' : 'Admin Dashboard'}</h1>\n          <p className=\"text-gray-600\">Welcome back, {user?.name || (((user?.role || '').toUpperCase() === 'MODERATOR') ? 'Moderator' : 'Admin')}</p>\n          <div className=\"flex items-center space-x-2 mt-1\">\n            <span className=\"text-sm text-gray-500\">Backend:</span>\n            <div className={`flex items-center space-x-1 ${\n              dbConnectionStatus === 'connected' ? 'text-green-600' : \n              dbConnectionStatus === 'disconnected' ? 'text-red-600' : 'text-yellow-600'\n            }`}>\n              <div className={`w-2 h-2 rounded-full ${\n                dbConnectionStatus === 'connected' ? 'bg-green-500' : \n                dbConnectionStatus === 'disconnected' ? 'bg-red-500' : 'bg-yellow-500'\n              }`}></div>\n              <span className=\"text-xs font-medium capitalize\">\n                {dbConnectionStatus === 'connected' ? 'Connected' : \n                 dbConnectionStatus === 'disconnected' ? 'Disconnected' : 'Checking...'}\n              </span>\n            </div>\n          </div>\n        </div>\n        <button\n          onClick={() => setActiveTab('home')}\n          className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n        >\n          <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </button>\n      </div>\n\n      {/* Navigation Tabs */}\n      <div className=\"flex space-x-1 bg-gray-100 p-1 rounded-xl\">\n        {(user?.is_admin || user?.role === 'ADMIN') && (\n          <button\n            onClick={() => setActiveSection('overview')}\n            className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${\n              activeSection === 'overview'\n                ? 'bg-white text-[#21a1ce] shadow-sm'\n                : 'text-gray-600 hover:text-gray-900'\n            }`}\n          >\n            Overview\n          </button>\n        )}\n        <button\n          onClick={() => setActiveSection('content')}\n          className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${\n            activeSection === 'content'\n              ? 'bg-white text-[#21a1ce] shadow-sm'\n              : 'text-gray-600 hover:text-gray-900'\n          }`}\n        >\n          Content\n        </button>\n        {(user?.is_admin || user?.role === 'ADMIN') && (\n        <button\n          onClick={() => setActiveSection('users')}\n          className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${\n            activeSection === 'users'\n              ? 'bg-white text-[#21a1ce] shadow-sm'\n              : 'text-gray-600 hover:text-gray-900'\n          }`}\n        >\n          Users\n        </button>\n        )}\n        <button\n          onClick={() => setActiveSection('reports')}\n          className={`flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors ${\n            activeSection === 'reports'\n              ? 'bg-white text-[#21a1ce] shadow-sm'\n              : 'text-gray-600 hover:text-gray-900'\n          }`}\n        >\n          Reports\n        </button>\n      </div>\n\n      {/* Content Sections */}\n      {(user?.is_admin || user?.role === 'ADMIN') && activeSection === 'overview' && renderOverview()}\n      {activeSection === 'content' && renderContentManagement()}\n      {(user?.is_admin || user?.role === 'ADMIN') && activeSection === 'users' && (\n        <>\n          {renderUserManagement()}\n          {renderDeletedUsers()}\n        </>\n      )}\n      {activeSection === 'reports' && (\n        window.__ADMIN_REPORTS_INITIAL_FILTERS__ ? (\n          (() => {\n            const filters = window.__ADMIN_REPORTS_INITIAL_FILTERS__\n            delete window.__ADMIN_REPORTS_INITIAL_FILTERS__\n            return <CommunityReports initialFilters={filters} />\n          })()\n        ) : (\n          <CommunityReports />\n        )\n      )}\n\n      {/* Add Module Modal */}\n      {showAddModule && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Add New Module</h2>\n                <button \n                  onClick={() => setShowAddModule(false)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Module Title *</label>\n                  <MobileInput\n                    type=\"text\"\n                    value={newModuleData.title}\n                    onChange={(e) => setNewModuleData(prev => ({ ...prev, title: e.target.value }))}\n                    placeholder=\"Enter module title\"\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Description *</label>\n                  <Textarea\n                    value={newModuleData.description}\n                    onChange={(e) => setNewModuleData(prev => ({ ...prev, description: e.target.value }))}\n                    placeholder=\"Enter module description\"\n                    className=\"w-full\"\n                    rows={3}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Difficulty</label>\n                  <select\n                    value={newModuleData.difficulty}\n                    onChange={(e) => setNewModuleData(prev => ({ ...prev, difficulty: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"BEGINNER\">Beginner</option>\n                    <option value=\"INTERMEDIATE\">Intermediate</option>\n                    <option value=\"ADVANCED\">Advanced</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Estimated Time (minutes)</label>\n                  <MobileInput\n                    type=\"number\"\n                    value={newModuleData.estimated_time}\n                    onChange={(e) => setNewModuleData(prev => ({ ...prev, estimated_time: parseInt(e.target.value) || 10 }))}\n                    placeholder=\"10\"\n                    min=\"1\"\n                    max=\"120\"\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div className=\"flex space-x-3\">\n                  <MobileButton\n                    onClick={() => setShowAddModule(false)}\n                    className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white\"\n                  >\n                    Cancel\n                  </MobileButton>\n                  <MobileButton\n                    onClick={handleCreateModule}\n                    disabled={actionLoading}\n                    className=\"flex-1 bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n                  >\n                    {actionLoading ? 'Creating...' : 'Create Module'}\n                  </MobileButton>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Add User Modal */}\n      {showAddUser && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Add New User</h2>\n                <button \n                  onClick={() => setShowAddUser(false)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Full Name</label>\n                  <MobileInput\n                    type=\"text\"\n                    placeholder=\"Enter full name\"\n                    value={newUserData.first_name}\n                    onChange={(e) => setNewUserData(prev => ({ ...prev, first_name: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Email</label>\n                  <MobileInput\n                    type=\"email\"\n                    placeholder=\"Enter email address\"\n                    value={newUserData.email}\n                    onChange={(e) => setNewUserData(prev => ({ ...prev, email: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Role</label>\n                  <select \n                    value={newUserData.role}\n                    onChange={(e) => setNewUserData(prev => ({ ...prev, role: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"USER\">User</option>\n                    <option value=\"MODERATOR\">Moderator</option>\n                    <option value=\"ADMIN\">Admin</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Password</label>\n                  <MobileInput\n                    type=\"password\"\n                    placeholder=\"Enter password\"\n                    value={newUserData.password}\n                    onChange={(e) => setNewUserData(prev => ({ ...prev, password: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div className=\"flex space-x-3\">\n                  <MobileButton\n                    onClick={() => setShowAddUser(false)}\n                    className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white\"\n                  >\n                    Cancel\n                  </MobileButton>\n                  <MobileButton\n                    onClick={handleCreateUser}\n                    disabled={actionLoading}\n                    className=\"flex-1 bg-green-600 hover:bg-green-700 text-white\"\n                  >\n                    {actionLoading ? 'Creating...' : 'Create User'}\n                  </MobileButton>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit User Modal */}\n      {editingUser && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Edit User</h2>\n                <button \n                  onClick={() => setEditingUser(null)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">First Name</label>\n                  <MobileInput\n                    type=\"text\"\n                    placeholder=\"Enter first name\"\n                    value={editingUser.first_name || ''}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, first_name: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Last Name</label>\n                  <MobileInput\n                    type=\"text\"\n                    placeholder=\"Enter last name\"\n                    value={editingUser.last_name || ''}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, last_name: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Email</label>\n                  <MobileInput\n                    type=\"email\"\n                    placeholder=\"Enter email address\"\n                    value={editingUser.email || ''}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, email: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Role</label>\n                  <select \n                    value={editingUser.role || 'USER'}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, role: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"USER\">User</option>\n                    <option value=\"MODERATOR\">Moderator</option>\n                    <option value=\"ADMIN\">Admin</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Status</label>\n                  <select \n                    value={editingUser.status || 'ACTIVE'}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, status: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"ACTIVE\">Active</option>\n                    <option value=\"SUSPENDED\">Suspended</option>\n                    <option value=\"BANNED\">Banned</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">New Password (leave blank to keep current)</label>\n                  <MobileInput\n                    type=\"password\"\n                    placeholder=\"Enter new password\"\n                    value={editingUser.newPassword || ''}\n                    onChange={(e) => setEditingUser(prev => ({ ...prev, newPassword: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div className=\"flex space-x-3\">\n                  <MobileButton\n                    onClick={() => setEditingUser(null)}\n                    className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white\"\n                  >\n                    Cancel\n                  </MobileButton>\n                  <MobileButton\n                    onClick={() => handleUpdateUser(editingUser.id)}\n                    disabled={actionLoading}\n                    className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white\"\n                  >\n                    {actionLoading ? 'Updating...' : 'Update User'}\n                  </MobileButton>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Module Modal */}\n      {editingModule && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Edit Module</h2>\n                <button \n                  onClick={() => setEditingModule(null)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Title</label>\n                  <MobileInput\n                    type=\"text\"\n                    placeholder=\"Enter module title\"\n                    value={editingModule.title || ''}\n                    onChange={(e) => setEditingModule(prev => ({ ...prev, title: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Description</label>\n                  <Textarea\n                    placeholder=\"Enter module description\"\n                    value={editingModule.description || ''}\n                    onChange={(e) => setEditingModule(prev => ({ ...prev, description: e.target.value }))}\n                    className=\"w-full\"\n                    rows={3}\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Difficulty</label>\n                  <select\n                    value={editingModule.difficulty || 'BEGINNER'}\n                    onChange={(e) => setEditingModule(prev => ({ ...prev, difficulty: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"BEGINNER\">Beginner</option>\n                    <option value=\"INTERMEDIATE\">Intermediate</option>\n                    <option value=\"ADVANCED\">Advanced</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Estimated Time (minutes)</label>\n                  <MobileInput\n                    type=\"number\"\n                    placeholder=\"10\"\n                    value={editingModule.estimated_time || 10}\n                    onChange={(e) => setEditingModule(prev => ({ ...prev, estimated_time: parseInt(e.target.value) || 10 }))}\n                    min=\"1\"\n                    max=\"120\"\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div className=\"flex space-x-3\">\n                  <MobileButton\n                    onClick={() => setEditingModule(null)}\n                    className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white\"\n                  >\n                    Cancel\n                  </MobileButton>\n                  <MobileButton\n                    onClick={() => handleUpdateModule(editingModule.id)}\n                    disabled={actionLoading}\n                    className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white\"\n                  >\n                    {actionLoading ? 'Updating...' : 'Update Module'}\n                  </MobileButton>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Lesson Management Modal */}\n      {selectedModuleForLessons && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">\n                  Manage Lessons: {selectedModuleForLessons.title}\n                </h2>\n                <div className=\"text-sm text-gray-500\">\n                  Last updated: {new Date().toLocaleTimeString()} (Render: {forceUpdate})\n                </div>\n                <button \n                  onClick={() => setSelectedModuleForLessons(null)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n\n              {/* Add New Lesson Form */}\n              <div className=\"bg-gray-50 rounded-lg p-4 mb-6\">\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Add New Lesson</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Title</label>\n                    <MobileInput\n                      type=\"text\"\n                      placeholder=\"Enter lesson title\"\n                      value={newLessonData.title}\n                      onChange={(e) => setNewLessonData(prev => ({ ...prev, title: e.target.value }))}\n                      className=\"w-full\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Type</label>\n                    <select\n                      value={newLessonData.type}\n                      onChange={(e) => setNewLessonData(prev => ({ ...prev, type: e.target.value }))}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                    >\n                      <option value=\"info\">Information</option>\n                      <option value=\"quiz\">Quiz</option>\n                      <option value=\"video\">Video</option>\n                      <option value=\"interactive\">Interactive</option>\n                    </select>\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Content Type</label>\n                    <select\n                      value={newLessonData.contentType}\n                      onChange={(e) => setNewLessonData(prev => ({ ...prev, contentType: e.target.value }))}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                    >\n                      <option value=\"info\">Plain Text</option>\n                      <option value=\"tips\">Tips (title + description list)</option>\n                      <option value=\"warning-signs\">Warning Signs</option>\n                      <option value=\"steps\">Steps (numbered)</option>\n                      <option value=\"list\">Bullet List</option>\n                      <option value=\"warning\">Warning Box</option>\n                      <option value=\"warning-list\">Warning Box + List</option>\n                      <option value=\"action-list\">Actions To Take</option>\n                      <option value=\"example\">Real-world Example</option>\n                      <option value=\"markdown\">Markdown</option>\n                      <option value=\"html\">HTML (sanitized)</option>\n                    </select>\n                    <p className=\"text-xs text-gray-500 mt-1\">This controls how the lesson renders in the Learn Hub.</p>\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Duration (minutes)</label>\n                    <MobileInput\n                      type=\"number\"\n                      placeholder=\"5\"\n                      value={newLessonData.duration}\n                      onChange={(e) => setNewLessonData(prev => ({ ...prev, duration: parseInt(e.target.value) || 5 }))}\n                      min=\"1\"\n                      max=\"60\"\n                      className=\"w-full\"\n                    />\n                  </div>\n                  \n                  <div className=\"md:col-span-2\">\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Content</label>\n                    <Textarea\n                      placeholder=\"Enter lesson content\"\n                      value={newLessonData.content}\n                      onChange={(e) => setNewLessonData(prev => ({ ...prev, content: e.target.value }))}\n                      className=\"w-full\"\n                      rows={4}\n                    />\n                  </div>\n\n                  {/* Media attachments */}\n                  <div className=\"md:col-span-2\">\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Media (optional)</label>\n                    <div className=\"space-y-3\">\n                      {(newLessonData.media || []).map((item, idx) => (\n                        <div key={idx} className=\"grid grid-cols-1 md:grid-cols-4 gap-2 items-center\">\n                          <select\n                            value={item.type || 'image'}\n                            onChange={(e) => setNewLessonData(prev => {\n                              const media = [...(prev.media || [])]\n                              media[idx] = { ...media[idx], type: e.target.value }\n                              return { ...prev, media }\n                            })}\n                            className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                          >\n                            <option value=\"image\">Image</option>\n                            <option value=\"video\">Video</option>\n                          </select>\n                          <input\n                            type=\"url\"\n                            placeholder=\"https://cdn.example.com/path/to/media\"\n                            value={item.url || ''}\n                            onChange={(e) => setNewLessonData(prev => {\n                              const media = [...(prev.media || [])]\n                              media[idx] = { ...media[idx], url: e.target.value }\n                              return { ...prev, media }\n                            })}\n                            className=\"md:col-span-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                          />\n                          <input\n                            type=\"text\"\n                            placeholder=\"Caption (optional)\"\n                            value={item.caption || ''}\n                            onChange={(e) => setNewLessonData(prev => {\n                              const media = [...(prev.media || [])]\n                              media[idx] = { ...media[idx], caption: e.target.value }\n                              return { ...prev, media }\n                            })}\n                            className=\"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => setNewLessonData(prev => ({\n                              ...prev,\n                              media: (prev.media || []).filter((_, i) => i !== idx)\n                            }))}\n                            className=\"text-red-600 text-sm hover:underline\"\n                          >\n                            Remove\n                          </button>\n                        </div>\n                      ))}\n                      <button\n                        type=\"button\"\n                        onClick={() => setNewLessonData(prev => ({\n                          ...prev,\n                          media: [...(prev.media || []), { type: 'image', url: '', caption: '' }]\n                        }))}\n                        className=\"text-[#21a1ce] text-sm hover:underline\"\n                      >\n                        + Add media\n                      </button>\n                      <div className=\"flex items-center gap-3\">\n                        <input\n                          type=\"file\"\n                          accept=\"image/*,video/*\"\n                          onChange={async (e) => {\n                            const file = e.target.files?.[0]\n                            if (!file) return\n                            try {\n                              setLessonActionLoading(true)\n                              const res = await uploadLessonMedia(file)\n                              const url = res.url\n                              const type = res.resource_type || 'image'\n                              setNewLessonData(prev => ({\n                                ...prev,\n                                media: [...(prev.media || []), { type, url, caption: '' }]\n                              }))\n                            } catch (err) {\n                              alert('Upload failed: ' + (err.message || 'Unknown error'))\n                            } finally {\n                              setLessonActionLoading(false)\n                              e.target.value = ''\n                            }\n                          }}\n                          className=\"text-sm\"\n                        />\n                        <span className=\"text-xs text-gray-500\">Upload to Cloudinary and auto-add to list</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                \n                <div className=\"mt-4\">\n                  <MobileButton\n                    onClick={() => handleAddLesson(selectedModuleForLessons.id)}\n                    disabled={lessonActionLoading}\n                    className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n                  >\n                    {lessonActionLoading ? 'Adding...' : 'Add Lesson'}\n                  </MobileButton>\n                  {lessonSuccessMessage && (\n                    <div className=\"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg\">\n                      <div className=\"flex items-center\">\n                        <svg className=\"w-5 h-5 text-green-600 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                        </svg>\n                        <span className=\"text-sm text-green-800 font-medium\">{lessonSuccessMessage}</span>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Existing Lessons List */}\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Existing Lessons</h3>\n                {lessonActionLoading && (\n                  <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                    <div className=\"flex items-center\">\n                      <RefreshCw className=\"w-4 h-4 text-blue-600 mr-2 animate-spin\" />\n                      <span className=\"text-sm text-blue-800\">Updating lessons...</span>\n                    </div>\n                  </div>\n                )}\n                {selectedModuleForLessons.content?.lessons?.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {selectedModuleForLessons.content.lessons.map((lesson) => (\n                      <div key={lesson.id} className=\"border border-gray-200 rounded-lg p-4\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <h4 className=\"font-medium text-gray-900\">{lesson.title}</h4>\n                          <div className=\"flex space-x-2\">\n                            <button\n                              onClick={() => setEditingLesson(lesson)}\n                              className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n                              title=\"Edit Lesson\"\n                            >\n                              <Edit3 className=\"w-4 h-4\" />\n                            </button>\n                            <button\n                              onClick={() => handleDeleteLesson(selectedModuleForLessons.id, lesson.id)}\n                              disabled={lessonActionLoading}\n                              className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50\"\n                              title=\"Delete Lesson\"\n                            >\n                              <Trash2 className=\"w-4 h-4\" />\n                            </button>\n                          </div>\n                        </div>\n                        <div className=\"text-sm text-gray-600 mb-2\">\n                          <span className=\"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 mr-2\">\n                            {lesson.type}\n                          </span>\n                          <span className=\"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800 mr-2\">\n                            {lesson.duration} min\n                          </span>\n                          <span className=\"px-2 py-1 rounded-full text-xs bg-purple-100 text-purple-800\">\n                            {lesson.contentType}\n                          </span>\n                        </div>\n                        <p className=\"text-gray-700 text-sm line-clamp-2\">{lesson.content}</p>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    <BookOpen className=\"w-16 h-16 text-gray-300 mx-auto mb-4\" />\n                    <p>No lessons yet. Add your first lesson above!</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Edit Lesson Modal */}\n      {editingLesson && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Edit Lesson</h2>\n                <button \n                  onClick={() => setEditingLesson(null)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Title</label>\n                  <MobileInput\n                    type=\"text\"\n                    placeholder=\"Enter lesson title\"\n                    value={editingLesson.title || ''}\n                    onChange={(e) => setEditingLesson(prev => ({ ...prev, title: e.target.value }))}\n                    className=\"w-full\"\n                  />\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Type</label>\n                    <select\n                      value={editingLesson.type || 'info'}\n                      onChange={(e) => setEditingLesson(prev => ({ ...prev, type: e.target.value }))}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                    >\n                      <option value=\"info\">Information</option>\n                      <option value=\"quiz\">Quiz</option>\n                      <option value=\"video\">Video</option>\n                      <option value=\"interactive\">Interactive</option>\n                    </select>\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">Duration (minutes)</label>\n                    <MobileInput\n                      type=\"number\"\n                      placeholder=\"5\"\n                      value={editingLesson.duration || 5}\n                      onChange={(e) => setEditingLesson(prev => ({ ...prev, duration: parseInt(e.target.value) || 5 }))}\n                      min=\"1\"\n                      max=\"60\"\n                      className=\"w-full\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Content Type</label>\n                  <select\n                    value={editingLesson.contentType || 'info'}\n                    onChange={(e) => setEditingLesson(prev => ({ ...prev, contentType: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent\"\n                  >\n                    <option value=\"info\">Plain Text</option>\n                    <option value=\"tips\">Tips (title + description list)</option>\n                    <option value=\"warning-signs\">Warning Signs</option>\n                    <option value=\"steps\">Steps (numbered)</option>\n                    <option value=\"list\">Bullet List</option>\n                    <option value=\"warning\">Warning Box</option>\n                    <option value=\"warning-list\">Warning Box + List</option>\n                    <option value=\"action-list\">Actions To Take</option>\n                    <option value=\"example\">Real-world Example</option>\n                    <option value=\"markdown\">Markdown</option>\n                    <option value=\"html\">HTML (sanitized)</option>\n                  </select>\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">Content</label>\n                  <Textarea\n                    placeholder=\"Enter lesson content\"\n                    value={editingLesson.content || ''}\n                    onChange={(e) => setEditingLesson(prev => ({ ...prev, content: e.target.value }))}\n                    className=\"w-full\"\n                    rows={6}\n                  />\n                </div>\n                \n                <div className=\"flex space-x-3\">\n                  <MobileButton\n                    onClick={() => setEditingLesson(null)}\n                    className=\"flex-1 bg-gray-600 hover:bg-gray-700 text-white\"\n                  >\n                    Cancel\n                  </MobileButton>\n                  <MobileButton\n                    onClick={() => handleUpdateLesson(selectedModuleForLessons.id, editingLesson.id, editingLesson)}\n                    disabled={lessonActionLoading}\n                    className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white\"\n                  >\n                    {lessonActionLoading ? 'Updating...' : 'Update Lesson'}\n                  </MobileButton>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useState } from 'react'\nimport { useAuth } from '../hooks/useAuth'\nimport { User, Mail, Shield, ArrowLeft, Save, Key } from 'lucide-react'\nimport { MobileCard } from './ui/mobile-card'\nimport { MobileButton } from './ui/mobile-button'\nimport { MobileInput } from './ui/mobile-input'\nimport { Textarea } from './ui/textarea'\n\nexport default function ProfileSettings({ setActiveTab }) {\n  const { user, updateProfile, changePassword } = useAuth()\n  const [isEditing, setIsEditing] = useState(false)\n  const [isChangingPassword, setIsChangingPassword] = useState(false)\n  const [loading, setLoading] = useState(false)\n  \n  // Form state\n  const [formData, setFormData] = useState({\n    name: user?.name || `${user?.first_name || ''} ${user?.last_name || ''}`.trim(),\n    email: user?.email || '',\n    bio: user?.bio || ''\n  })\n  \n  const [passwordData, setPasswordData] = useState({\n    currentPassword: '',\n    newPassword: '',\n    confirmPassword: ''\n  })\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }))\n  }\n\n  const handlePasswordChange = (e) => {\n    const { name, value } = e.target\n    setPasswordData(prev => ({\n      ...prev,\n      [name]: value\n    }))\n  }\n\n  const handleSaveProfile = async () => {\n    setLoading(true)\n    try {\n      await updateProfile(formData)\n      setIsEditing(false)\n    } catch (error) {\n      console.error('Failed to update profile:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleChangePassword = async () => {\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\n      alert('New passwords do not match')\n      return\n    }\n    \n    setLoading(true)\n    try {\n      await changePassword(passwordData.currentPassword, passwordData.newPassword)\n      setIsChangingPassword(false)\n      setPasswordData({ currentPassword: '', newPassword: '', confirmPassword: '' })\n    } catch (error) {\n      console.error('Failed to change password:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  if (!user) {\n    return (\n      <div className=\"space-y-6\">\n        <MobileCard>\n          <div className=\"text-center py-8\">\n            <User className=\"w-16 h-16 text-gray-400 mx-auto mb-4\" />\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Profile Not Found</h2>\n            <p className=\"text-gray-600 mb-6\">Please log in to access your profile.</p>\n            <MobileButton \n              onClick={() => setActiveTab('login')}\n              className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n            >\n              Go to Login\n            </MobileButton>\n          </div>\n        </MobileCard>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {(() => {\n        // compute display name once for use below\n        const dn = `${user?.first_name || ''} ${user?.last_name || ''}`.trim() || user?.name || ''\n        return null\n      })()}\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-3\">\n          <button\n            onClick={() => setActiveTab('home')}\n            className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </button>\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Profile Settings</h1>\n            <p className=\"text-gray-600\">Manage your account information</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Profile Information */}\n      <MobileCard>\n        <div className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900\">Profile Information</h2>\n            <MobileButton\n              onClick={() => setIsEditing(!isEditing)}\n              variant={isEditing ? 'secondary' : 'primary'}\n              className=\"bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n            >\n              {isEditing ? 'Cancel' : 'Edit Profile'}\n            </MobileButton>\n          </div>\n\n          {isEditing ? (\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Full Name</label>\n                <MobileInput\n                  type=\"text\"\n                  name=\"name\"\n                  value={formData.name}\n                  onChange={handleInputChange}\n                  placeholder=\"Enter your full name\"\n                  className=\"w-full\"\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Email</label>\n                <MobileInput\n                  type=\"email\"\n                  name=\"email\"\n                  value={formData.email}\n                  disabled\n                  className=\"w-full bg-gray-50 cursor-not-allowed\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">Email changes are not supported from here.</p>\n              </div>\n\n              {/* Bio remains editable */}\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Bio</label>\n                <Textarea\n                  name=\"bio\"\n                  value={formData.bio}\n                  onChange={handleInputChange}\n                  placeholder=\"Tell us about yourself\"\n                  rows={3}\n                  className=\"w-full\"\n                />\n              </div>\n              \n              <MobileButton\n                onClick={handleSaveProfile}\n                disabled={loading}\n                loading={loading}\n                className=\"w-full bg-[#21a1ce] hover:bg-[#1a8bb8] text-white\"\n              >\n                <Save className=\"w-4 h-4 mr-2\" />\n                Save Changes\n              </MobileButton>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center space-x-3\">\n                <User className=\"w-5 h-5 text-gray-400\" />\n                <div>\n                  <p className=\"text-sm text-gray-500\">Name</p>\n                  <p className=\"font-medium text-gray-900\">{(`${user?.first_name || ''} ${user?.last_name || ''}`.trim() || user?.name || 'Not set')}</p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center space-x-3\">\n                <Mail className=\"w-5 h-5 text-gray-400\" />\n                <div>\n                  <p className=\"text-sm text-gray-500\">Email</p>\n                  <p className=\"font-medium text-gray-900\">{user.email}</p>\n                </div>\n              </div>\n              \n              {user.bio && (\n                <div className=\"flex items-start space-x-3\">\n                  <User className=\"w-5 h-5 text-gray-400 mt-1\" />\n                  <div>\n                    <p className=\"text-sm text-gray-500\">Bio</p>\n                    <p className=\"font-medium text-gray-900\">{user.bio}</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </MobileCard>\n\n      {/* Security Settings */}\n      <MobileCard>\n        <div className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-lg font-semibold text-gray-900\">Security</h2>\n            <MobileButton\n              onClick={() => setIsChangingPassword(!isChangingPassword)}\n              variant={isChangingPassword ? 'secondary' : 'primary'}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              {isChangingPassword ? 'Cancel' : 'Change Password'}\n            </MobileButton>\n          </div>\n\n          {isChangingPassword ? (\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Current Password</label>\n                <MobileInput\n                  type=\"password\"\n                  name=\"currentPassword\"\n                  value={passwordData.currentPassword}\n                  onChange={handlePasswordChange}\n                  placeholder=\"Enter current password\"\n                  className=\"w-full\"\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">New Password</label>\n                <MobileInput\n                  type=\"password\"\n                  name=\"newPassword\"\n                  value={passwordData.newPassword}\n                  onChange={handlePasswordChange}\n                  placeholder=\"Enter new password\"\n                  className=\"w-full\"\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">Confirm New Password</label>\n                <MobileInput\n                  type=\"password\"\n                  name=\"confirmPassword\"\n                  value={passwordData.confirmPassword}\n                  onChange={handlePasswordChange}\n                  placeholder=\"Confirm new password\"\n                  className=\"w-full\"\n                />\n              </div>\n              \n              <MobileButton\n                onClick={handleChangePassword}\n                disabled={loading}\n                loading={loading}\n                className=\"w-full bg-green-600 hover:bg-green-700 text-white\"\n              >\n                <Key className=\"w-4 h-4 mr-2\" />\n                Update Password\n              </MobileButton>\n            </div>\n          ) : (\n            <div className=\"flex items-center space-x-3\">\n              <Shield className=\"w-5 h-5 text-gray-400\" />\n              <div>\n                <p className=\"text-sm text-gray-500\">Password</p>\n                <p className=\"font-medium text-gray-900\">••••••••</p>\n              </div>\n            </div>\n          )}\n        </div>\n      </MobileCard>\n\n      {/* Account Status */}\n      <MobileCard>\n        <div className=\"p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 mb-4\">Account Status</h2>\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Account Type</span>\n              <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                user.is_admin || user.role === 'ADMIN' \n                  ? 'bg-purple-100 text-purple-800' \n                  : 'bg-blue-100 text-blue-800'\n              }`}>\n                {user.is_admin || user.role === 'ADMIN' ? 'Admin' : 'User'}\n              </span>\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Status</span>\n              <span className=\"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                Active\n              </span>\n            </div>\n            \n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Member Since</span>\n              <span className=\"text-sm font-medium text-gray-900\">\n                {user.created_at ? new Date(user.created_at).toLocaleDateString() : 'Unknown'}\n              </span>\n            </div>\n          </div>\n        </div>\n      </MobileCard>\n    </div>\n  )\n}\n","import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../hooks/useAuth';\n\nconst Register = ({ onRegisterSuccess, onSwitchToLogin }) => {\n  const [formData, setFormData] = useState({\n    first_name: '',\n    last_name: '',\n    email: '',\n    password: '',\n    confirm_password: ''\n  });\n  const [formErrors, setFormErrors] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const { register, verifyEmail, resendVerification, error, user, isAuthenticated } = useAuth();\n  const [needsVerification, setNeedsVerification] = useState(false);\n  const [verificationCode, setVerificationCode] = useState('');\n  const [verifyMsg, setVerifyMsg] = useState('');\n\n  // Watch for authentication changes and redirect accordingly\n  useEffect(() => {\n    if (isAuthenticated && user && onRegisterSuccess) {\n      onRegisterSuccess();\n    }\n  }, [isAuthenticated, user, onRegisterSuccess]);\n\n  const validateForm = () => {\n    const errors = {};\n    \n    if (!formData.first_name.trim()) {\n      errors.first_name = 'First name is required';\n    }\n    \n    if (!formData.last_name.trim()) {\n      errors.last_name = 'Last name is required';\n    }\n    \n    if (!formData.email.trim()) {\n      errors.email = 'Email is required';\n    } else if (!/\\S+@\\S+\\.\\S+/.test(formData.email)) {\n      errors.email = 'Email is invalid';\n    }\n    \n    if (!formData.password) {\n      errors.password = 'Password is required';\n    } else if (formData.password.length < 8) {\n      errors.password = 'Password must be at least 8 characters';\n    }\n    \n    if (formData.password !== formData.confirm_password) {\n      errors.confirm_password = 'Passwords do not match';\n    }\n    \n    setFormErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsLoading(true);\n    \n    try {\n      const userData = {\n        first_name: formData.first_name.trim(),\n        last_name: formData.last_name.trim(),\n        email: formData.email.trim().toLowerCase(),\n        password: formData.password\n      };\n      \n      const result = await register(userData);\n      \n      if (!result.success) {\n        // Error is already set in useAuth hook\n        console.error('Registration failed:', result.error);\n        if (result.error && result.error.toLowerCase().includes('email')) {\n          setFormErrors((prev) => ({ ...prev, email: result.error }));\n        }\n      } else if (result.requires_verification) {\n        setNeedsVerification(true);\n        setVerifyMsg('We sent a 6-digit code to your email. Enter it below to verify your account.');\n      }\n    } catch (error) {\n      console.error('Registration error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n    \n    // Clear error when user starts typing\n    if (formErrors[e.target.name]) {\n      setFormErrors({\n        ...formErrors,\n        [e.target.name]: ''\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8\">\n      <div className=\"sm:mx-auto sm:w-full sm:max-w-md\">\n        <div className=\"flex justify-center\">\n          <img \n            src=\"/remaleh-logo.png\" \n            alt=\"Remaleh Protect\" \n            className=\"h-12 w-auto\"\n          />\n        </div>\n        <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n          Create your account\n        </h2>\n        <p className=\"mt-2 text-center text-sm text-gray-600\">\n          Join Remaleh Protect for enhanced digital security\n        </p>\n      </div>\n\n      <div className=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n        <div className=\"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10\">\n          {!needsVerification && (\n          <form className=\"space-y-6\" onSubmit={handleSubmit}>\n            {error && (\n              <div className=\"bg-red-50 border border-red-200 rounded-md p-4\">\n                <div className=\"flex\">\n                  <div className=\"flex-shrink-0\">\n                    <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n                    </svg>\n                  </div>\n                  <div className=\"ml-3\">\n                    <p className=\"text-sm text-red-800\">{error}</p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2\">\n              <div>\n                <label htmlFor=\"first_name\" className=\"block text-sm font-medium text-gray-700\">\n                  First name\n                </label>\n                <div className=\"mt-1\">\n                  <input\n                    id=\"first_name\"\n                    name=\"first_name\"\n                    type=\"text\"\n                    autoComplete=\"given-name\"\n                    required\n                    value={formData.first_name}\n                    onChange={handleChange}\n                    className={`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${\n                      formErrors.first_name ? 'border-red-300' : 'border-gray-300'\n                    }`}\n                    placeholder=\"Enter your first name\"\n                  />\n                </div>\n                {formErrors.first_name && (\n                  <p className=\"mt-1 text-sm text-red-600\">{formErrors.first_name}</p>\n                )}\n              </div>\n\n              <div>\n                <label htmlFor=\"last_name\" className=\"block text-sm font-medium text-gray-700\">\n                  Last name\n                </label>\n                <div className=\"mt-1\">\n                  <input\n                    id=\"last_name\"\n                    name=\"last_name\"\n                    type=\"text\"\n                    autoComplete=\"family-name\"\n                    required\n                    value={formData.last_name}\n                    onChange={handleChange}\n                    className={`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${\n                      formErrors.last_name ? 'border-red-300' : 'border-gray-300'\n                    }`}\n                    placeholder=\"Enter your last name\"\n                  />\n                </div>\n                {formErrors.last_name && (\n                  <p className=\"mt-1 text-sm text-red-600\">{formErrors.last_name}</p>\n                )}\n              </div>\n            </div>\n\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email address\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  autoComplete=\"email\"\n                  required\n                  value={formData.email}\n                  onChange={handleChange}\n                  className={`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${\n                    formErrors.email ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"Enter your email address\"\n                />\n              </div>\n              {formErrors.email && (\n                <p className=\"mt-1 text-sm text-red-600\">{formErrors.email}</p>\n              )}\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Password\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  autoComplete=\"new-password\"\n                  required\n                  value={formData.password}\n                  onChange={handleChange}\n                  className={`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${\n                    formErrors.password ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"Create a strong password\"\n                />\n              </div>\n              {formErrors.password && (\n                <p className=\"mt-1 text-sm text-red-600\">{formErrors.password}</p>\n              )}\n              <p className=\"mt-1 text-xs text-gray-500\">\n                Must be at least 8 characters long\n              </p>\n            </div>\n\n            <div>\n              <label htmlFor=\"confirm_password\" className=\"block text-sm font-medium text-gray-700\">\n                Confirm password\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"confirm_password\"\n                  name=\"confirm_password\"\n                  type=\"password\"\n                  autoComplete=\"new-password\"\n                  required\n                  value={formData.confirm_password}\n                  onChange={handleChange}\n                  className={`appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${\n                    formErrors.confirm_password ? 'border-red-300' : 'border-gray-300'\n                  }`}\n                  placeholder=\"Confirm your password\"\n                />\n              </div>\n              {formErrors.confirm_password && (\n                <p className=\"mt-1 text-sm text-red-600\">{formErrors.confirm_password}</p>\n              )}\n            </div>\n\n            <div>\n              <button\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isLoading ? (\n                  <div className=\"flex items-center\">\n                    <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                    </svg>\n                    Creating account...\n                  </div>\n                ) : (\n                  'Create account'\n                )}\n              </button>\n            </div>\n          </form>\n          )}\n\n          {needsVerification && (\n            <div className=\"space-y-4\">\n              {verifyMsg && (\n                <div className=\"p-3 bg-blue-50 border border-blue-200 rounded\">\n                  <p className=\"text-sm text-blue-800\">{verifyMsg}</p>\n                </div>\n              )}\n              {error && (\n                <div className=\"bg-red-50 border border-red-200 rounded-md p-3\">\n                  <p className=\"text-sm text-red-800\">{error}</p>\n                </div>\n              )}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">Verification code</label>\n                <input\n                  type=\"text\"\n                  inputMode=\"numeric\"\n                  pattern=\"[0-9]*\"\n                  maxLength={6}\n                  value={verificationCode}\n                  onChange={(e) => setVerificationCode(e.target.value.replace(/\\D/g, ''))}\n                  className=\"mt-1 appearance-none block w-full px-3 py-2 border rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm border-gray-300\"\n                  placeholder=\"Enter 6-digit code\"\n                />\n              </div>\n              <button\n                onClick={async () => {\n                  if (!formData.email || verificationCode.length !== 6) return;\n                  const res = await verifyEmail(formData.email.trim().toLowerCase(), verificationCode);\n                  if (res.success && onRegisterSuccess) onRegisterSuccess();\n                }}\n                className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none\"\n              >\n                Verify and continue\n              </button>\n              <button\n                type=\"button\"\n                onClick={async () => {\n                  if (!formData.email) return;\n                  await resendVerification(formData.email.trim().toLowerCase());\n                  setVerifyMsg('A new code has been sent to your email.');\n                }}\n                className=\"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\"\n              >\n                Resend code\n              </button>\n            </div>\n          )}\n\n          <div className=\"mt-6\">\n            <div className=\"relative\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <div className=\"w-full border-t border-gray-300\" />\n              </div>\n              <div className=\"relative flex justify-center text-sm\">\n                <span className=\"px-2 bg-white text-gray-500\">Already have an account?</span>\n              </div>\n            </div>\n\n            <div className=\"mt-6\">\n              <button\n                onClick={() => {\n                  if (onSwitchToLogin) {\n                    onSwitchToLogin();\n                  } else if (onRegisterSuccess) {\n                    onRegisterSuccess();\n                  }\n                }}\n                className=\"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n              >\n                Sign in instead\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Register;\n","import React, { useState, useEffect, useRef } from 'react'\nimport './App.css'\nimport { apiPost, apiGet, API_ENDPOINTS, API } from './lib/api'\nimport PasswordGenerator from './components/PasswordGenerator'\nimport ChatAssistant from './components/ChatAssistant'\nimport LearnHub from './components/LearnHub'\nimport CommunityHub from './components/CommunityHub'\nimport CommunityReporting from './components/CommunityReporting'\nimport AdminDashboard from './components/admin/AdminDashboard'\nimport ProfileSettings from './components/ProfileSettings'\nimport Login from './components/Login'\nimport Register from './components/Register'\nimport { useAuth } from './hooks/useAuth'\nimport MobilePullToRefresh from './components/MobilePullToRefresh'\nimport { User } from 'lucide-react'\n\nfunction App() {\n  const [activeTab, setActiveTab] = useState('home')\n  const [greeting, setGreeting] = useState('')\n  const [blogItems, setBlogItems] = useState([])\n  \n  // Breach checker state\n  const [breachEmail, setBreachEmail] = useState('')\n  const [breachResult, setBreachResult] = useState(null)\n  const [isChecking, setIsChecking] = useState(false)\n  const [breachError, setBreachError] = useState('')\n  \n  // Password generator modal state\n  const [showPasswordGenerator, setShowPasswordGenerator] = useState(false)\n  \n  // Profile dropdown state\n  const [showProfileDropdown, setShowProfileDropdown] = useState(false)\n  \n  // Get authentication state\n  const { user, isAuthenticated, logout } = useAuth()\n  const [forwardingAddress, setForwardingAddress] = useState('')\n  const [copiedForward, setCopiedForward] = useState(false)\n  const [recentScans, setRecentScans] = useState([])\n\n  // Global logout function\n  const handleGlobalLogout = async () => {\n    try {\n      // Clear local storage\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('refreshToken');\n      \n      // Reset to home tab\n      setActiveTab('home');\n      \n      // Reload the page to clear all state\n      window.location.reload();\n    } catch (error) {\n      console.error('Global logout error:', error);\n      // Force reload even if there's an error\n      window.location.reload();\n    }\n  };\n\n  // Make logout function globally available\n  useEffect(() => {\n    window.logoutUser = handleGlobalLogout;\n    \n    // Cleanup on unmount\n    return () => {\n      delete window.logoutUser;\n    };\n  }, []);\n\n  // Capture OAuth redirect tokens\n  useEffect(() => {\n    try {\n      const params = new URLSearchParams(window.location.search)\n      const oauth = params.get('oauth')\n      const access = params.get('access_token')\n      const refresh = params.get('refresh_token')\n      if (oauth && access && refresh) {\n        localStorage.setItem('authToken', access)\n        localStorage.setItem('refreshToken', refresh)\n        window.history.replaceState({}, document.title, window.location.pathname)\n        window.dispatchEvent(new Event('remaleh-auth-changed'))\n        setActiveTab('home')\n      }\n    } catch (_) {}\n  }, [])\n\n  // Dynamic greeting based on time of day\n  useEffect(() => {\n    const getGreeting = () => {\n      const hour = new Date().getHours()\n      if (hour < 12) return 'Good morning!'\n      if (hour < 17) return 'Good afternoon!'\n      return 'Good evening!'\n    }\n    setGreeting(getGreeting())\n  }, [])\n\n  // Fetch user-specific email forwarding address for scam analysis (when logged in)\n  useEffect(() => {\n    const fetchForwarding = async () => {\n      try {\n        if (!isAuthenticated) return\n        const res = await apiGet('/api/enhanced-scam/forwarding-address')\n        if (res.ok) {\n          const data = await res.json()\n          setForwardingAddress(data.forwarding_address || '')\n        }\n      } catch (_) {\n        // ignore\n      }\n    }\n    fetchForwarding()\n  }, [isAuthenticated])\n\n  // Load recent forwarded scans\n  useEffect(() => {\n    const loadScans = async () => {\n      try {\n        if (!isAuthenticated) return\n        const res = await apiGet('/api/enhanced-scam/recent-scans?limit=10')\n        if (res.ok) {\n          const data = await res.json()\n          setRecentScans(Array.isArray(data.items) ? data.items : [])\n        }\n      } catch (_) {}\n    }\n    loadScans()\n    const id = setInterval(loadScans, 15000)\n    return () => clearInterval(id)\n  }, [isAuthenticated])\n  \n  // Load blog headlines\n  useEffect(() => {\n    const loadBlog = async () => {\n      try {\n        // 1) Try backend first\n        const res = await fetch(`${API}${API_ENDPOINTS.PUBLIC.BLOG_FEED}?limit=8`)\n        if (res.ok) {\n          const data = await res.json()\n          if (Array.isArray(data.items) && data.items.length > 0) {\n            setBlogItems(data.items)\n            return\n          }\n        }\n        // 2) Fallback: fetch RSS directly via a public CORS passthrough\n        const feedUrl = 'https://www.remaleh.com.au/blog/blog-feed.xml'\n        const proxies = [\n          (u) => `${API}/api/public/rss-proxy?url=${encodeURIComponent(u)}`,\n          (u) => `https://api.allorigins.win/raw?url=${encodeURIComponent(u)}`,\n          (u) => `https://r.jina.ai/http://www.remaleh.com.au/blog/blog-feed.xml`,\n        ]\n        let xmlText = ''\n        for (const make of proxies) {\n          try {\n            const r = await fetch(make(feedUrl), { cache: 'no-store' })\n            if (r.ok) {\n              xmlText = await r.text()\n              if (xmlText && xmlText.length > 100) break\n            }\n          } catch (_) {}\n        }\n        if (!xmlText) return\n        // Parse XML client-side\n        const parser = new DOMParser()\n        const doc = parser.parseFromString(xmlText, 'text/xml')\n        const rssChannel = doc.querySelector('rss > channel')\n        let entries = []\n        if (rssChannel) {\n          entries = Array.from(rssChannel.querySelectorAll('item'))\n        } else {\n          entries = Array.from(doc.querySelectorAll('entry'))\n        }\n        const pick = (el, sel) => {\n          const n = el.querySelector(sel)\n          return n && n.textContent ? n.textContent.trim() : ''\n        }\n        const items = entries.slice(0, 8).map((el) => {\n          const title = pick(el, 'title')\n          let link = ''\n          const linkEl = el.querySelector('link')\n          if (linkEl) {\n            link = linkEl.getAttribute('href') || linkEl.textContent || ''\n          }\n          const pubDate = pick(el, 'pubDate') || pick(el, 'updated') || pick(el, 'published')\n          const desc = pick(el, 'description') || pick(el, 'content\\\\:encoded') || pick(el, 'summary') || pick(el, 'content')\n          const excerpt = desc ? desc.replace(/<[^>]+>/g, '').slice(0, 240) : ''\n          // Try to find an image\n          let img = ''\n          const imgInHtml = (desc || '').match(/<img[^>]+src=[\"']([^\"']+)[\"']/i)\n          if (imgInHtml) img = imgInHtml[1]\n          return { title, link, pubDate, excerpt, image: img }\n        })\n        setBlogItems(items)\n      } catch (e) {\n        // ignore if offline\n      }\n    }\n    loadBlog()\n  }, [])\n  \n  const formatDate = (dateStr) => {\n    try {\n      if (!dateStr) return ''\n      const d = new Date(dateStr)\n      if (isNaN(d)) return ''\n      return d.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' })\n    } catch (e) {\n      return ''\n    }\n  }\n  \n  // Get user initials for profile icon\n  const getUserInitials = () => {\n    if (user?.name) {\n      const names = user.name.split(' ')\n      if (names.length >= 2) {\n        return `${names[0][0]}${names[names.length - 1][0]}`.toUpperCase()\n      }\n      return names[0][0].toUpperCase()\n    }\n    if (user?.email) {\n      return user.email[0].toUpperCase()\n    }\n    return 'U' // Default user icon\n  }\n  \n  // Handle profile icon click\n  const handleProfileClick = () => {\n    setShowProfileDropdown(!showProfileDropdown)\n  }\n  \n  // Handle logout\n  const handleLogout = () => {\n    logout()\n    setShowProfileDropdown(false)\n    setActiveTab('home')\n  }\n  \n  // Close dropdown when clicking outside or pressing escape\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (showProfileDropdown && !event.target.closest('.profile-dropdown')) {\n        setShowProfileDropdown(false)\n      }\n    }\n    \n    const handleEscapeKey = (event) => {\n      if (event.key === 'Escape' && showProfileDropdown) {\n        setShowProfileDropdown(false)\n      }\n    }\n    \n    document.addEventListener('mousedown', handleClickOutside)\n    document.addEventListener('keydown', handleEscapeKey)\n    \n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n      document.removeEventListener('keydown', handleEscapeKey)\n    }\n  }, [showProfileDropdown])\n\n  const tabs = [\n    { \n      id: 'home', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\" />\n        </svg>\n      )\n    },\n    { \n      id: 'breach', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n        </svg>\n      )\n    },\n    { \n      id: 'scam', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n        </svg>\n      )\n    },\n    { \n      id: 'learn', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\n        </svg>\n      ),\n      label: 'Learning Hub'\n    },\n    { \n      id: 'community', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n        </svg>\n      )\n    },\n    { \n      id: 'chat', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n        </svg>\n      )\n    },\n    { \n      id: 'admin', \n      icon: (\n        <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756 2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a0 3 3 0 11-6 0 3 3 0 016 0z\" />\n        </svg>\n      ),\n      label: 'Admin'\n    }\n  ]\n\n  // Breach checking function\n  const handleBreachCheck = async () => {\n    if (!breachEmail || !breachEmail.includes('@')) {\n      setBreachError('Please enter a valid email address')\n      return\n    }\n    \n    setIsChecking(true)\n    setBreachError('')\n    setBreachResult(null)\n    \n    try {\n      const response = await apiPost(API_ENDPOINTS.BREACH, { email: breachEmail })\n      const data = await response.json()\n      \n      if (response.ok) {\n        setBreachResult(data)\n      } else {\n        setBreachError(data.error || 'Failed to check for breaches')\n      }\n    } catch (error) {\n      console.error('Breach check error:', error)\n      setBreachError('We couldn\\'t reach the breach service. Please check your connection and try again.')\n    } finally {\n      setIsChecking(false)\n    }\n  }\n\n  // Handle password generation modal\n  const handlePasswordUse = (password) => {\n    // You could store the generated password or show it in the breach results\n    console.log('Generated password:', password)\n    setShowPasswordGenerator(false)\n  }\n\n  // Scam analysis state\n  const [scamInput, setScamInput] = useState('')\n  const [scamType, setScamType] = useState('message')\n  const [scamResult, setScamResult] = useState(null)\n  const [isAnalyzing, setIsAnalyzing] = useState(false)\n  const [scamError, setScamError] = useState('')\n\n  // Scam analysis function\n  const handleScamAnalysis = async () => {\n    if (!scamInput.trim()) {\n      setScamError('Please enter content to analyze')\n      return\n    }\n    \n    setIsAnalyzing(true)\n    setScamError('')\n    setScamResult(null)\n    \n    try {\n      let analysis\n      let detectedContentType = scamType\n      let contentTypeNote = ''\n      \n      // Intelligent content detection and routing\n      if (scamType === 'link') {\n        // Check if user actually pasted a URL or a message\n        const urlPattern = /^https?:\\/\\/[^\\s]+$/i\n        const containsUrls = /https?:\\/\\/[^\\s]+/gi.test(scamInput)\n        \n        if (urlPattern.test(scamInput.trim())) {\n          // Single URL - use link analysis\n          analysis = await analyzeLink(scamInput)\n          contentTypeNote = 'Analyzed as single URL'\n        } else if (containsUrls) {\n          // Message containing URLs - use enhanced scam analysis for better detection\n          analysis = await analyzeMessage(scamInput)\n          detectedContentType = 'message'\n          contentTypeNote = 'Detected message with URLs - used Enhanced Scam Detection Engine'\n        } else {\n          // No URLs found - use enhanced scam analysis\n          analysis = await analyzeMessage(scamInput)\n          detectedContentType = 'message'\n          contentTypeNote = 'No URLs detected - analyzed with Enhanced Scam Detection Engine'\n        }\n      } else if (scamType === 'email') {\n        // Check if content looks like an email\n        const emailPattern = /^[^\\s]+@[^\\s]+\\.[^\\s]+/i\n        const containsEmailHeaders = /^(from|to|subject|date):/im.test(scamInput)\n        \n        if (emailPattern.test(scamInput.split('\\n')[0]) || containsEmailHeaders) {\n          // Looks like email - use enhanced scam API\n          analysis = await analyzeEmail(scamInput)\n          contentTypeNote = 'Analyzed as email content'\n        } else {\n          // Doesn't look like email - use enhanced scam analysis\n          analysis = await analyzeMessage(scamInput)\n          detectedContentType = 'message'\n          contentTypeNote = 'Content doesn\\'t appear to be email - used Enhanced Scam Detection Engine'\n        }\n      } else {\n        // General message analysis - use enhanced scam detection\n        analysis = await analyzeMessage(scamInput)\n        contentTypeNote = 'Analyzed with Enhanced Scam Detection Engine'\n      }\n      \n      // Add content type detection note to results\n      if (contentTypeNote) {\n        analysis.contentTypeNote = contentTypeNote\n        analysis.detectedContentType = detectedContentType\n      }\n      \n      setScamResult(analysis)\n    } catch (error) {\n      console.error('Scam analysis error:', error)\n      if (error.message.includes('Failed to fetch')) {\n        setScamError('Unable to connect to security APIs. Please check your internet connection and try again.')\n      } else if (error.message.includes('HTTP error')) {\n        setScamError('Security service temporarily unavailable. Please try again later.')\n      } else {\n        setScamError('Analysis failed. Please try again.')\n      }\n    } finally {\n      setIsAnalyzing(false)\n    }\n  }\n\n  // Link analysis using link_analysis.py\n  const analyzeLink = async (url) => {\n    try {\n      const response = await fetch(`${API}/api/link/analyze-url`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ url: url })\n      })\n      \n      if (!response.ok) {\n        throw new Error('Service temporarily unavailable')\n      }\n      \n      const data = await response.json()\n      \n      if (!data.success) {\n        throw new Error(data.error || 'Link analysis failed')\n      }\n      \n      const result = data.result\n      \n      // Transform link analysis response to match our format\n      return {\n        riskLevel: result.risk_level?.toLowerCase() || 'medium',\n        riskScore: result.risk_score || 50,\n        indicators: result.indicators || [],\n        recommendations: result.recommendations || [\n          'Be cautious of this link',\n          'Verify the destination before clicking',\n          'Check for HTTPS and legitimate domain'\n        ],\n        analysis: url.substring(0, 100) + (url.length > 100 ? '...' : ''),\n        linkDetails: result\n      }\n    } catch (error) {\n      console.error('Link analysis error:', error)\n      // Fallback to local analysis\n      return analyzeScamContent(url, 'link')\n    }\n  }\n\n  // Email analysis using enhanced_scam.py\n  const analyzeEmail = async (emailContent) => {\n    try {\n      const response = await fetch(`${API}/api/enhanced-scam/analyze`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ text: emailContent })\n      })\n      \n      if (!response.ok) {\n        throw new Error('Service temporarily unavailable')\n      }\n      \n      const data = await response.json()\n      \n      if (!data.success) {\n        throw new Error(data.error || 'Email analysis failed')\n      }\n      \n      const result = data.result\n      \n      // Transform enhanced scam response to match our format\n      return {\n        riskLevel: result.risk_level?.toLowerCase() || 'medium',\n        riskScore: Math.round(result.risk_score * 100) || 50,\n        indicators: result.indicators || [],\n        recommendations: generateEmailRecommendations(result.risk_level, result.indicators),\n        analysis: emailContent.substring(0, 100) + (emailContent.length > 100 ? '...' : ''),\n        emailDetails: result\n      }\n    } catch (error) {\n      console.error('Email analysis error:', error)\n      // Fallback to local analysis\n      return analyzeScamContent(emailContent, 'email')\n    }\n  }\n\n  // Generate email-specific recommendations\n  const generateEmailRecommendations = (riskLevel, indicators) => {\n    const recommendations = []\n    \n    if (riskLevel === 'SCAM') {\n      recommendations.push('Do not respond to this email')\n      recommendations.push('Delete immediately and contact Remaleh Guardians')\n      recommendations.push('Do not click any links or attachments')\n      recommendations.push('If you clicked any links, reach out to Remaleh Guardians via chat immediately')\n    } else if (riskLevel === 'SUSPICIOUS') {\n      recommendations.push('Exercise extreme caution with this email')\n      recommendations.push('Verify sender authenticity before responding')\n      recommendations.push('Do not share personal information')\n      recommendations.push('Contact Remaleh Guardians if you need assistance')\n    } else {\n      recommendations.push('Review this email carefully')\n      recommendations.push('Check sender authenticity')\n      recommendations.push('Avoid clicking suspicious links')\n    }\n    \n    // Add specific recommendations based on indicators\n    if (indicators.some(ind => ind.includes('financial'))) {\n      recommendations.push('Never send money or financial information via email')\n      recommendations.push('Contact Remaleh Guardians if you have financial concerns')\n    }\n    if (indicators.some(ind => ind.includes('urgency'))) {\n      recommendations.push('Be cautious of urgent requests - legitimate organizations rarely pressure you')\n    }\n    \n    return recommendations\n  }\n\n  // Message analysis using enhanced_scam.py for better detection\n  const analyzeMessage = async (messageContent) => {\n    try {\n      const response = await fetch(`${API}/api/enhanced-scam/analyze`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ \n          text: messageContent\n        })\n      })\n      \n      if (!response.ok) {\n        throw new Error('Service temporarily unavailable')\n      }\n      \n      const data = await response.json()\n      \n      if (!data.success) {\n        throw new Error(data.error || 'Enhanced scam analysis failed')\n      }\n      \n      const result = data.result\n      \n      // Transform enhanced scam response to match our format\n      return {\n        riskLevel: result.risk_level?.toLowerCase() || 'medium',\n        riskScore: Math.round(result.risk_score * 100) || 50,\n        indicators: result.indicators || [],\n        recommendations: generateEnhancedRecommendations(result.risk_level, result.indicators, result.patterns),\n        analysis: messageContent.substring(0, 100) + (messageContent.length > 100 ? '...' : ''),\n        messageDetails: result\n      }\n    } catch (error) {\n      console.error('Enhanced message analysis error:', error)\n      // Fallback to local analysis\n      return analyzeScamContent(messageContent, 'message')\n    }\n  }\n\n  // Generate enhanced recommendations based on enhanced scam detection\n  const generateEnhancedRecommendations = (riskLevel, indicators, patterns) => {\n    const recommendations = []\n    \n    if (riskLevel === 'SCAM') {\n      recommendations.push('Do not respond to this message')\n      recommendations.push('Delete immediately and contact Remaleh Guardians')\n      recommendations.push('Do not click any links or attachments')\n      recommendations.push('If you clicked any links, reach out to Remaleh Guardians via chat immediately')\n    } else if (riskLevel === 'SUSPICIOUS') {\n      recommendations.push('Exercise extreme caution with this message')\n      recommendations.push('Verify authenticity before responding')\n      recommendations.push('Do not share personal information')\n      recommendations.push('Contact Remaleh Guardians if you need assistance')\n    } else if (riskLevel === 'SAFE') {\n      recommendations.push('Content appears safe - no obvious threats detected')\n      recommendations.push('Continue to exercise normal caution')\n      recommendations.push('If you have concerns, contact Remaleh Guardians via chat')\n    } else {\n      recommendations.push('Review this message carefully')\n      recommendations.push('Check sender authenticity')\n      recommendations.push('Avoid clicking suspicious links')\n    }\n    \n    // Add specific recommendations based on patterns\n    if (patterns && patterns.includes('suspicious_domain')) {\n      recommendations.push('Contains suspicious domain (.buzz, .tk, etc.) - high risk')\n    }\n    if (patterns && patterns.includes('url')) {\n      recommendations.push('Contains URLs - verify before clicking')\n    }\n    if (patterns && patterns.includes('phone_number')) {\n      recommendations.push('Contains phone numbers - do not call unknown numbers')\n    }\n    \n    // Add Remaleh Guardians contact info only once\n    if (!recommendations.some(rec => rec.includes('Remaleh Guardians'))) {\n      recommendations.push('Contact Remaleh Guardians via chat for immediate assistance')\n    }\n    \n    // Remove any duplicate recommendations\n    const uniqueRecommendations = [...new Set(recommendations)]\n    \n    return uniqueRecommendations\n  }\n\n  // Generate recommendations from detected threats\n  const generateRecommendationsFromThreats = (threats) => {\n    const recommendations = []\n    \n    threats.forEach(threat => {\n      if (threat.includes('Urgency')) {\n        recommendations.push('Be cautious of urgent requests - legitimate organizations rarely pressure you')\n      }\n      if (threat.includes('Financial')) {\n        recommendations.push('Never send money to unknown sources or for urgent requests')\n      }\n      if (threat.includes('Personal')) {\n        recommendations.push('Never share passwords, SSN, or other sensitive information via message')\n      }\n      if (threat.includes('Suspicious')) {\n        recommendations.push('Avoid clicking suspicious links or responding to unknown contacts')\n      }\n    })\n    \n    if (recommendations.length === 0) {\n      recommendations.push('Review the content carefully before taking any action')\n    }\n    \n    // Add Remaleh Guardians contact info only once\n    if (!recommendations.some(rec => rec.includes('Remaleh Guardians'))) {\n      recommendations.push('Contact Remaleh Guardians via chat for immediate assistance')\n    }\n    \n    // Remove any duplicate recommendations\n    const uniqueRecommendations = [...new Set(recommendations)]\n    \n    return uniqueRecommendations\n  }\n\n  // Scam content analysis logic\n  const analyzeScamContent = (content, type) => {\n    const indicators = {\n      urgency: /(urgent|immediate|now|quick|fast|hurry|deadline|limited time|expires|last chance)/gi,\n      money: /(\\$[\\d,]+|money|payment|bank|account|credit card|paypal|bitcoin|crypto|investment|profit|return)/gi,\n      personal: /(password|login|verify|confirm|update|social security|ssn|birthday|address|phone)/gi,\n      threats: /(suspended|blocked|locked|deleted|expired|legal action|police|fbi|irs|tax)/gi,\n      suspicious: /(click here|verify now|login|password|bank|urgent|free|winner|prize|lottery)/gi\n    }\n    \n    const results = {}\n    let riskScore = 0\n    \n    Object.entries(indicators).forEach(([key, pattern]) => {\n      const matches = content.match(pattern)\n      if (matches) {\n        results[key] = matches.length\n        riskScore += matches.length * 2\n      }\n    })\n    \n    // Additional analysis based on type\n    if (type === 'link') {\n      if (content.includes('bit.ly') || content.includes('tinyurl')) riskScore += 5\n      if (content.includes('http://') && !content.includes('https://')) riskScore += 3\n    }\n    \n    if (type === 'email') {\n      if (content.includes('@') && !content.includes('@gmail.com') && !content.includes('@yahoo.com')) riskScore += 2\n    }\n    \n    const riskLevel = riskScore < 10 ? 'safe' : riskScore < 20 ? 'suspicious' : 'scam'\n    \n    return {\n      riskLevel,\n      riskScore,\n      indicators: results,\n      recommendations: generateRecommendations(riskLevel, results, type),\n      analysis: content.substring(0, 100) + (content.length > 100 ? '...' : '')\n    }\n  }\n\n  const generateRecommendations = (riskLevel, indicators, type) => {\n    const recommendations = []\n    \n    if (riskLevel === 'scam') {\n      recommendations.push('Do not click any links or provide personal information')\n      recommendations.push('Contact Remaleh Guardians immediately')\n      recommendations.push('Delete the message immediately')\n      recommendations.push('If you clicked any links, reach out to Remaleh Guardians via chat')\n    }\n    \n    if (indicators.urgency) {\n      recommendations.push('Be cautious of urgent requests - legitimate organizations rarely pressure you')\n    }\n    \n    if (indicators.money) {\n      recommendations.push('Never send money to unknown sources or for urgent requests')\n    }\n    \n    if (indicators.personal) {\n      recommendations.push('Never share passwords, SSN, or other sensitive information via message')\n    }\n    \n    if (type === 'link') {\n      recommendations.push('Hover over links to verify the actual destination')\n      recommendations.push('Use link scanning tools before clicking')\n    }\n    \n    // Add Remaleh Guardians contact info only once\n    if (!recommendations.some(rec => rec.includes('Remaleh Guardians'))) {\n      recommendations.push('Contact Remaleh Guardians via chat for immediate assistance')\n    }\n    \n    // Remove any duplicate recommendations\n    const uniqueRecommendations = [...new Set(recommendations)]\n    \n    return uniqueRecommendations\n  }\n\n\n\n  const renderContent = () => {\n    switch (activeTab) {\n      case 'home':\n        return (\n          <MobilePullToRefresh onRefresh={async () => { try { await loadBlogFeed?.(); await loadRecentScans?.(); } catch {} }} className=\"\">\n          <div className=\"space-y-6\">\n            {/* Welcome Message */}\n            <div className=\"text-center\">\n              <h1 className=\"text-3xl font-bold text-black mb-2\">{greeting}</h1>\n              <p className=\"text-gray-600\">Welcome to Remaleh Protect</p>\n            </div>\n            \n\n            {/* For You Today Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              \n              {/* Horizontal Carousel Container */}\n              <div className=\"relative\">\n                <div className=\"flex gap-4 overflow-x-auto pb-4 scrollbar-hide\">\n                  {(blogItems.length > 0 ? blogItems : []).map((post, idx) => (\n                    <a\n                      key={`${post.link || idx}`}\n                      href={post.link || 'https://www.remaleh.com.au/blog'}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"flex-shrink-0 w-80 bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200\"\n                    >\n                      {post.image && (\n                        <img\n                          src={post.image}\n                          alt={post.title || 'Blog image'}\n                          className=\"w-full h-40 object-cover\"\n                          onError={(e) => { e.currentTarget.style.display = 'none' }}\n                        />\n                      )}\n                      <div className=\"p-4\">\n                        <h3 className=\"font-semibold text-gray-900 mb-1 line-clamp-2\">{post.title}</h3>\n                        {post.excerpt && (\n                          <p className=\"text-gray-600 text-sm mb-3 line-clamp-3\">{post.excerpt}</p>\n                        )}\n                        <div className=\"flex items-center text-xs text-gray-500\">\n                          <span>{formatDate(post.pubDate)}</span>\n                        </div>\n                        \n                      </div>\n                    </a>\n                  ))}\n                  {blogItems.length === 0 && (\n                    <a\n                      href=\"https://www.remaleh.com.au/blog\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"flex-shrink-0 w-80 bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200\"\n                    >\n                      <div className=\"p-4\">\n                        <div className=\"flex items-start justify-between h-full\">\n                          <div className=\"flex-1\">\n                            <h3 className=\"font-semibold text-gray-800 mb-2\">Visit the Remaleh Blog</h3>\n                            <span className=\"text-gray-500 text-xs\">Latest insights and security tips</span>\n                          </div>\n                          <div className=\"text-blue-400 ml-3\">\n                            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M10.293 3.293a1 1 0 011.414 0L17 8.586a1 1 0 010 1.414l-5.293 5.293a1 1 0 01-1.414-1.414L13.586 10H4a1 1 0 110-2h9.586l-3.293-3.293a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                            </svg>\n                          </div>\n                        </div>\n                      </div>\n                    </a>\n                  )}\n                </div>\n                \n                {/* Scroll Indicator */}\n                <div className=\"flex justify-center mt-4 space-x-2\">\n                  {[1, 2, 3, 4, 5].map((_, index) => (\n                    <div \n                      key={index}\n                      className=\"w-2 h-2 rounded-full bg-gray-300\"\n                    />\n                  ))}\n                </div>\n              </div>\n              \n            </div>\n\n            {/* Quick Action Icons */}\n            <div className=\"grid grid-cols-1 gap-4\">\n              <div onClick={() => setActiveTab('breach')} className=\"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4\">\n                    <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-black mb-1\">Breach Check</h3>\n                    <p className=\"text-gray-600 text-sm\">Check if your email has been compromised in data breaches</p>\n                  </div>\n                  <div className=\"text-gray-400\">\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n\n              <div onClick={() => setActiveTab('scam')} className=\"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4\">\n                    <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-black mb-1\">Scam Analysis</h3>\n                    <p className=\"text-gray-600 text-sm\">Analyze suspicious messages and links for potential scams</p>\n                  </div>\n                  <div className=\"text-gray-400\">\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n\n              <div onClick={() => setActiveTab('learn')} className=\"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4\">\n                    <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-black mb-1\">Learning Hub</h3>\n                    <p className=\"text-gray-600 text-sm\">Learn how to stay safe online, the easy way.</p>\n                  </div>\n                  <div className=\"text-gray-400\">\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n\n              <div onClick={() => setActiveTab('community')} className=\"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4\">\n                    <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-black mb-1\">Community</h3>\n                    <p className=\"text-gray-600 text-sm\">Report scams. Protect your community.</p>\n                  </div>\n                  <div className=\"text-gray-400\">\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n\n              <div onClick={() => setActiveTab('chat')} className=\"bg-white rounded-2xl p-5 shadow-sm border border-gray-100 hover:shadow-md transition-shadow cursor-pointer\">\n                <div className=\"flex items-center\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] rounded-xl flex items-center justify-center mr-4\">\n                    <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                    </svg>\n                  </div>\n                  <div className=\"flex-1\">\n                    <h3 className=\"text-lg font-semibold text-black mb-1\">Chat</h3>\n                    <p className=\"text-gray-600 text-sm\">Chat with our Cyber Assistant and a Remaleh Guardian's just a message away</p>\n                  </div>\n                  <div className=\"text-gray-400\">\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                    </svg>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          </MobilePullToRefresh>\n        )\n      case 'breach':\n        return (\n          <div className=\"space-y-6\">\n            {/* Header Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <div className=\"text-center\">\n                <div className=\"flex justify-center mb-3\">\n                  <div className=\"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                    </svg>\n                  </div>\n                </div>\n                <h1 className=\"text-2xl font-bold text-black mb-2\">Breach Checker</h1>\n                <p className=\"text-gray-600 text-sm\">Check if your email has been compromised</p>\n              </div>\n            </div>\n\n            {/* Email Input Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">Check Your Email</h2>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Email Address\n                  </label>\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                      <svg className=\"h-5 w-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207\" />\n                      </svg>\n                    </div>\n                    <input\n                      type=\"email\"\n                      id=\"email\"\n                      value={breachEmail}\n                      onChange={(e) => setBreachEmail(e.target.value)}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter' && !isChecking && breachEmail && breachEmail.includes('@')) {\n                          handleBreachCheck()\n                        }\n                      }}\n                      placeholder=\"Enter your email address\"\n                      className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent transition-all duration-200\"\n                      disabled={isChecking}\n                    />\n                  </div>\n                </div>\n                \n                {/* Error Display */}\n                {breachError && (\n                  <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n                    <div className=\"flex items-center\">\n                      <svg className=\"w-5 h-5 text-red-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                      </svg>\n                      <span className=\"text-red-800 text-sm\">{breachError}</span>\n                    </div>\n                  </div>\n                )}\n                \n                <button \n                  onClick={handleBreachCheck}\n                  disabled={isChecking || !breachEmail}\n                  className=\"w-full bg-[#21a1ce] text-white py-3 px-6 rounded-xl font-medium hover:bg-[#1a8bb8] transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {isChecking ? (\n                    <>\n                      <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                      </svg>\n                      Checking...\n                    </>\n                  ) : (\n                    <>\n                      <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                      </svg>\n                      Check for Breaches\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Results Display */}\n            {breachResult && (\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n                <div className=\"flex items-center mb-4\">\n                  {breachResult.breached ? (\n                    <div className=\"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center mr-4\">\n                      <svg className=\"w-6 h-6 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                      </svg>\n                    </div>\n                  ) : (\n                    <div className=\"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mr-4\">\n                      <svg className=\"w-6 h-6 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    </div>\n                  )}\n                  <div className=\"flex-1\">\n                    <h2 className=\"text-xl font-bold text-black\">\n                      {breachResult.breached ? 'Breaches Found' : 'No Breaches Detected'}\n                    </h2>\n                    <p className=\"text-gray-600\">\n                      {breachResult.breached ? `${breachResult.breach_count} breach(es) found` : 'Your email is secure'}\n                    </p>\n                    <p className=\"text-sm text-gray-500 mt-1\">\n                      Checked: {breachEmail}\n                    </p>\n                  </div>\n                </div>\n\n                <div className=\"mb-4\">\n                  <p className={`text-lg ${breachResult.breached ? 'text-red-700' : 'text-green-700'}`}>\n                    {breachResult.message}\n                  </p>\n                </div>\n\n                {breachResult.breached && breachResult.breaches && breachResult.breaches.length > 0 && (\n                  <div className=\"space-y-3\">\n                    <h3 className=\"font-semibold text-gray-800\">Affected Services:</h3>\n                    {breachResult.breaches.map((breach, index) => (\n                      <div key={index} className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <h4 className=\"font-medium text-red-800 mb-1\">{breach.name}</h4>\n                            <p className=\"text-red-700 text-sm mb-2\">{breach.domain}</p>\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <span className=\"text-red-600 text-xs\">Breached: {breach.date}</span>\n                              <span className=\"text-red-600 text-xs\">•</span>\n                              <span className=\"text-red-600 text-xs\">{breach.data.join(', ')}</span>\n                            </div>\n                          </div>\n                          <div className=\"text-red-400 ml-3\">\n                            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                            </svg>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {breachResult.demo_mode && (\n                  <div className=\"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                    <div className=\"flex items-center\">\n                      <svg className=\"w-5 h-5 text-blue-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                      <span className=\"text-blue-800 text-sm\">Demo mode - Results are simulated for testing purposes</span>\n                    </div>\n                  </div>\n                )}\n\n                {/* Security Recommendations */}\n                <div className=\"mt-6 pt-4 border-t border-gray-200\">\n                  <h3 className=\"text-lg font-semibold text-black mb-4\">Security Recommendations</h3>\n                  \n                  <div className=\"space-y-4\">\n                    {/* MFA Recommendation */}\n                    <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n                      <div className=\"flex items-start\">\n                        <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-blue-800 mb-1\">Enable Multi-Factor Authentication (MFA)</h4>\n                          <p className=\"text-blue-700 text-sm mb-3\">Add an extra layer of security to your accounts with MFA apps like Google Authenticator, Authy, or Microsoft Authenticator.</p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            <span className=\"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full\">Google Authenticator</span>\n                            <span className=\"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full\">Authy</span>\n                            <span className=\"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full\">Microsoft Authenticator</span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Password Security */}\n                    <div className=\"p-4 bg-green-50 border border-green-200 rounded-lg\">\n                      <div className=\"flex items-start\">\n                        <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                          </svg>\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-green-800 mb-1\">Use Strong, Unique Passwords</h4>\n                          <p className=\"text-green-700 text-sm mb-3\">Generate secure passwords for each account to prevent credential stuffing attacks.</p>\n                          <button \n                            onClick={() => setShowPasswordGenerator(true)}\n                            className=\"inline-flex items-center px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-colors\"\n                          >\n                            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                            </svg>\n                            Generate Secure Password\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Regular Monitoring */}\n                    <div className=\"p-4 bg-purple-50 border border-purple-200 rounded-lg\">\n                      <div className=\"flex items-start\">\n                        <div className=\"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n                          </svg>\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-purple-800 mb-1\">Monitor Your Accounts Regularly</h4>\n                          <p className=\"text-purple-700 text-sm mb-3\">Use Remaleh Protect regularly to check for new breaches and stay updated on security threats.</p>\n                          <div className=\"flex items-center text-purple-600 text-sm\">\n                            <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                            </svg>\n                            Check back monthly for new breaches\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Password Manager */}\n                    <div className=\"p-4 bg-orange-50 border border-orange-200 rounded-lg\">\n                      <div className=\"flex items-start\">\n                        <div className=\"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center mr-3 flex-shrink-0\">\n                          <svg className=\"w-5 h-5 text-orange-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\" />\n                          </svg>\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-orange-800 mb-1\">Use a Password Manager</h4>\n                          <p className=\"text-orange-700 text-sm mb-3\">Store and manage your passwords securely with trusted password managers.</p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            <span className=\"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full\">Bitwarden</span>\n                            <span className=\"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full\">1Password</span>\n                            <span className=\"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full\">LastPass</span>\n                            <span className=\"px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full\">Dashlane</span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"mt-6 pt-4 border-t border-gray-200\">\n                  <button \n                    onClick={() => {\n                      setBreachEmail('')\n                      setBreachResult(null)\n                      setBreachError('')\n                    }}\n                    className=\"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl font-medium hover:bg-gray-200 transition-all duration-200\"\n                  >\n                    Check Another Email\n                  </button>\n                </div>\n              </div>\n            )}\n\n            {/* How It Works Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">How It Works</h2>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">1</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">Enter Email</h3>\n                  <p className=\"text-gray-600 text-sm\">Provide your email address securely</p>\n                </div>\n                \n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">2</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">Scan Database</h3>\n                  <p className=\"text-gray-600 text-sm\">We check against known breaches</p>\n                </div>\n                \n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">3</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">Get Results</h3>\n                  <p className=\"text-gray-600 text-sm\">Instant results and recommendations</p>\n                </div>\n              </div>\n              \n            </div>\n\n            {/* Security Features */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">Security Features</h2>\n              \n              <div className=\"space-y-3\">\n                <div className=\"flex items-center p-3 bg-green-50 rounded-lg border border-green-200\">\n                  <svg className=\"w-5 h-5 text-green-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                  </svg>\n                  <span className=\"text-green-800 text-sm\">Your data is never stored or shared</span>\n                </div>\n                \n                <div className=\"flex items-center p-3 bg-blue-50 rounded-lg border border-blue-200\">\n                  <svg className=\"w-5 h-5 text-blue-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                  </svg>\n                  <span className=\"text-blue-800 text-sm\">Real-time breach database updates</span>\n                </div>\n                \n                <div className=\"flex items-center p-3 bg-purple-50 rounded-lg border border-purple-200\">\n                  <svg className=\"w-5 h-5 text-purple-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n                  </svg>\n                  <span className=\"text-purple-800 text-sm\">Instant results and notifications</span>\n                </div>\n              </div>\n              \n            </div>\n          </div>\n        )\n      case 'scam':\n        return (\n          <div className=\"space-y-6\">\n            {/* Header Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <div className=\"text-center\">\n                <div className=\"flex justify-center mb-3\">\n                  <div className=\"w-10 h-10 bg-[#21a1ce] rounded-lg flex items-center justify-center\">\n                    <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                    </svg>\n                  </div>\n                </div>\n                <h1 className=\"text-2xl font-bold text-black mb-2\">Scam Analysis</h1>\n                <p className=\"text-gray-600 text-sm\">Analyze suspicious content for potential scams</p>\n              </div>\n              \n              {/* API Status Indicator */}\n              <div className=\"flex items-center justify-center space-x-2 text-sm mt-2\">\n                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                <span className=\"text-gray-600\">Connected to Remaleh Protect Security Engine</span>\n                <button \n                  onClick={async () => {\n                    try {\n                      const response = await fetch(`${API}/api/security/status`)\n                      if (response.ok) {\n                        const data = await response.json()\n                        console.log('Security Engine Status:', data)\n                        alert(`Security Engine Status: ${data.status}\\nVersion: ${data.version}\\nServices: ${Object.keys(data.available_services).length} available`)\n                      }\n                    } catch (error) {\n                      console.error('Status check failed:', error)\n                      alert('Unable to check Security Engine status')\n                    }\n                  }}\n                  className=\"ml-2 text-xs text-[#21a1ce] hover:text-[#1a8bb8] underline cursor-pointer\"\n                >\n                  Check Status\n                </button>\n              </div>\n\n              {/* Email forwarding UI moved into the Email tab below */}\n            </div>\n\n            {/* Input Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">Analyze Content</h2>\n              \n              <div className=\"space-y-4\">\n                {/* Content Type Selection */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Content Type\n                  </label>\n                  <div className=\"grid grid-cols-3 gap-3\">\n                    {[\n                      { id: 'message', label: 'Message', icon: '💬' },\n                      { id: 'link', label: 'Link', icon: '🔗' },\n                      { id: 'email', label: 'Email', icon: '📧' }\n                    ].map((type) => (\n                      <button\n                        key={type.id}\n                        onClick={() => setScamType(type.id)}\n                        className={`p-3 rounded-xl border-2 transition-all duration-200 ${\n                          scamType === type.id\n                            ? 'border-[#21a1ce] bg-[#21a1ce] bg-opacity-10'\n                            : 'border-gray-200 hover:border-gray-300'\n                        }`}\n                      >\n                        <div className=\"text-center\">\n                          <div className=\"text-2xl mb-1\">{type.icon}</div>\n                          <div className=\"text-sm font-medium text-gray-700\">{type.label}</div>\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Content Input or Email Forwarding */}\n                {scamType === 'email' ? (\n                  <div className=\"space-y-3\">\n                    {isAuthenticated ? (\n                      <div className=\"p-3 bg-gray-50 border border-gray-200 rounded-lg\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"text-sm text-gray-700\">\n                            <span className=\"font-medium\">Forward emails for analysis:</span>\n                            <div className=\"mt-1 select-all break-all\">{forwardingAddress || 'Generating...'}</div>\n                          </div>\n                          <button\n                            onClick={() => {\n                              if (!forwardingAddress) return\n                              navigator.clipboard.writeText(forwardingAddress).then(() => {\n                                setCopiedForward(true)\n                                setTimeout(() => setCopiedForward(false), 1500)\n                              })\n                            }}\n                            className=\"ml-3 text-xs bg-[#21a1ce] text-white px-3 py-2 rounded-lg hover:bg-[#1a8bb8]\"\n                          >\n                            {copiedForward ? 'Copied' : 'Copy'}\n                          </button>\n                        </div>\n                        <p className=\"text-xs text-gray-500 mt-2\">Forward suspicious emails (including attachments) to this address. We'll analyze them and show results below.</p>\n                      </div>\n                    ) : (\n                      <p className=\"text-sm text-gray-600\">Sign in to get your personal forwarding address.</p>\n                    )}\n                  </div>\n                ) : (\n                  <div>\n                    <label htmlFor=\"scamInput\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n                      {scamType === 'message' ? 'Message Content' : 'URL or Link'}\n                    </label>\n                    <div className=\"relative\">\n                      {scamType === 'link' ? (\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <svg className=\"h-5 w-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1\" />\n                          </svg>\n                        </div>\n                      ) : (\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                          <svg className=\"h-5 w-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                          </svg>\n                        </div>\n                      )}\n                      <textarea\n                        id=\"scamInput\"\n                        value={scamInput}\n                        onChange={(e) => setScamInput(e.target.value)}\n                        placeholder={scamType === 'message' ? 'Paste the suspicious message here...' : 'Enter the URL or link to analyze...'}\n                        rows={4}\n                        className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#21a1ce] focus:border-transparent transition-all duration-200 resize-none\"\n                        disabled={isAnalyzing}\n                      />\n                    </div>\n                  </div>\n                )}\n\n                {/* Error Display */}\n                {scamError && (\n                  <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg\">\n                    <div className=\"flex items-center\">\n                      <svg className=\"w-5 h-5 text-red-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                      </svg>\n                      <span className=\"text-red-800 text-sm\">{scamError}</span>\n                    </div>\n                  </div>\n                )}\n\n                {/* Analyze Button (hidden for Email flow) */}\n                {scamType !== 'email' && (\n                  <button \n                    onClick={handleScamAnalysis}\n                    disabled={isAnalyzing || !scamInput.trim()}\n                    className=\"w-full bg-[#21a1ce] text-white py-3 px-6 rounded-xl font-medium hover:bg-[#1a8bb8] transition-all duration-200 shadow-sm hover:shadow-md flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {isAnalyzing ? (\n                      <>\n                        <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                        </svg>\n                        Analyzing with {scamType === 'link' ? 'Link Analysis Engine' : 'Comprehensive Scam Analysis Engine'}...\n                      </>\n                    ) : (\n                      <>\n                        <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                        </svg>\n                        Analyze for Scams\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n              <div className=\"mt-3 text-center\">\n                <p className=\"text-xs text-gray-500\">Sometimes our scanners miss the mark, so double check to stay safe.</p>\n              </div>\n            </div>\n\n            {/* Results Display */}\n            {scamResult && (\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n                <div className=\"flex items-center mb-4\">\n                  <div className={`w-12 h-12 rounded-xl flex items-center justify-center mr-4 ${\n                    scamResult.riskLevel === 'scam' ? 'bg-red-100' :\n                    scamResult.riskLevel === 'suspicious' ? 'bg-yellow-100' :\n                    scamResult.riskLevel === 'safe' ? 'bg-green-100' :\n                    'bg-green-100'\n                  }`}>\n                    <svg className={`w-6 h-6 ${\n                      scamResult.riskLevel === 'scam' ? 'text-red-600' :\n                      scamResult.riskLevel === 'suspicious' ? 'text-yellow-600' :\n                      scamResult.riskLevel === 'safe' ? 'text-green-600' :\n                      'text-green-600'\n                    }`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                    </svg>\n                  </div>\n                  <div>\n                    <h2 className=\"text-xl font-bold text-black\">\n                      Risk Level: {scamResult.riskLevel === 'safe' ? 'Safe ✅' : \n                                  scamResult.riskLevel === 'scam' ? 'Scam 🚨' :\n                                  scamResult.riskLevel === 'suspicious' ? 'Suspicious ⚠️' :\n                                  scamResult.riskLevel.charAt(0).toUpperCase() + scamResult.riskLevel.slice(1)}\n                      {scamResult.riskLevel === 'scam' ? ' - IMMEDIATE ACTION REQUIRED' : ''}\n                      {scamResult.riskLevel === 'safe' ? ' - No threats detected' : ''}\n                      {scamResult.riskLevel === 'suspicious' ? ' - Exercise caution' : ''}\n                    </h2>\n                    <p className=\"text-gray-600\">\n                      Risk Score: {scamResult.riskScore}/100\n                      {scamResult.riskScore >= 70 ? ' - IMMEDIATE ACTION REQUIRED' : ''}\n                      {scamResult.riskLevel === 'safe' ? ' - Content appears safe' : ''}\n                      {scamResult.riskLevel === 'suspicious' ? ' - Review carefully' : ''}\n                    </p>\n                    <p className=\"text-xs text-gray-500 mt-1\">\n                      Analyzed with {scamType === 'link' ? 'Link Analysis Engine' : scamType === 'email' ? 'Enhanced Scam Detection Engine' : 'Comprehensive Scam Analysis Engine'}\n                    </p>\n                    {scamResult.contentTypeNote && (\n                      <div className=\"mt-2 p-2 bg-blue-50 rounded-lg border border-blue-200\">\n                        <div className=\"flex items-center\">\n                          <svg className=\"w-4 h-4 text-blue-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                          <span className=\"text-blue-800 text-xs\">\n                            <strong>Content Detection:</strong> {scamResult.contentTypeNote}\n                          </span>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* Scam Warning */}\n                {(scamResult.riskLevel === 'scam' || scamResult.riskScore >= 70) && (\n                  <div className=\"mb-4 p-4 bg-red-50 border-2 border-red-300 rounded-xl\">\n                    <div className=\"flex items-center mb-3\">\n                      <svg className=\"w-6 h-6 text-red-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                      </svg>\n                      <h3 className=\"text-lg font-bold text-red-800\">🚨 SCAM DETECTED</h3>\n                    </div>\n                    <div className=\"space-y-2 text-red-700\">\n                      <p className=\"font-medium\">This content shows multiple signs of being a scam:</p>\n                      <ul className=\"list-disc list-inside space-y-1 text-sm\">\n                        {scamResult.riskLevel === 'scam' && <li>Scam risk level - immediate action required</li>}\n                        {scamResult.riskScore >= 70 && <li>Very high risk score ({scamResult.riskScore}/100)</li>}\n                        {scamResult.indicators && scamResult.indicators.length > 0 && <li>Multiple suspicious indicators detected</li>}\n                        <li>Do NOT click any links or respond to this message</li>\n                        <li>Contact Remaleh Guardians via chat immediately</li>\n                      </ul>\n                    </div>\n                  </div>\n                )}\n\n                {/* Suspicious Content Warning */}\n                {scamResult.riskLevel === 'suspicious' && (\n                  <div className=\"mb-4 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-xl\">\n                    <div className=\"flex items-center mb-3\">\n                      <svg className=\"w-6 h-6 text-yellow-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                      </svg>\n                      <h3 className=\"text-lg font-bold text-yellow-800\">⚠️ SUSPICIOUS CONTENT DETECTED</h3>\n                    </div>\n                    <div className=\"space-y-2 text-yellow-700\">\n                      <p className=\"font-medium\">This content shows some concerning signs:</p>\n                      <ul className=\"list-disc list-inside space-y-1 text-sm\">\n                        <li>Exercise caution with this content</li>\n                        <li>Verify authenticity before responding</li>\n                        <li>Do not share personal information</li>\n                        <li>Contact Remaleh Guardians via chat if you need assistance</li>\n                      </ul>\n                    </div>\n                  </div>\n                )}\n\n                {/* Safe Content Message */}\n                {scamResult.riskLevel === 'safe' && (\n                  <div className=\"mb-4 p-4 bg-green-50 border-2 border-green-300 rounded-xl\">\n                    <div className=\"flex items-center mb-3\">\n                      <svg className=\"w-6 h-6 text-green-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                      <h3 className=\"text-lg font-bold text-green-800\">✅ CONTENT APPEARS SAFE</h3>\n                    </div>\n                    <div className=\"space-y-2 text-green-700\">\n                      <p className=\"font-medium\">This content shows no obvious signs of being a scam:</p>\n                      <ul className=\"list-disc list-inside space-y-1 text-sm\">\n                        <li>Low risk score ({scamResult.riskScore}/100)</li>\n                        <li>No suspicious patterns detected</li>\n                        <li>Continue to exercise normal caution</li>\n                        <li>If you have concerns, contact Remaleh Guardians via chat</li>\n                      </ul>\n                    </div>\n                  </div>\n                )}\n\n                {/* Risk Indicators - Handle both object and array formats */}\n                {scamResult.indicators && (\n                  <div className=\"mb-4\">\n                    <h3 className=\"font-semibold text-gray-800 mb-2\">Detected Indicators:</h3>\n                    \n                    {/* Object format indicators (with counts) */}\n                    {Object.keys(scamResult.indicators).length > 0 && !Array.isArray(scamResult.indicators) && (\n                      <div className=\"grid grid-cols-2 gap-2\">\n                        {Object.entries(scamResult.indicators).map(([indicator, count]) => (\n                          <div key={indicator} className=\"p-2 bg-gray-50 rounded-lg border border-gray-200\">\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-700 capitalize\">\n                                {indicator.replace(/([A-Z])/g, ' $1').trim()}\n                              </span>\n                              <span className=\"text-xs bg-[#21a1ce] text-white px-2 py-1 rounded-full\">\n                                {count}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                    \n                    {/* Array format indicators (link analysis, enhanced scam) */}\n                    {Array.isArray(scamResult.indicators) && scamResult.indicators.length > 0 && (\n                      <div className=\"space-y-2\">\n                        {scamResult.indicators.map((indicator, index) => (\n                          <div key={index} className=\"p-3 bg-yellow-50 rounded-lg border border-yellow-200\">\n                            <div className=\"flex items-center\">\n                              <svg className=\"w-4 h-4 text-yellow-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                              </svg>\n                              <span className=\"text-yellow-800 text-sm\">{indicator}</span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                    \n                    {/* No indicators case */}\n                    {(!scamResult.indicators || \n                      (Array.isArray(scamResult.indicators) && scamResult.indicators.length === 0) ||\n                      (!Array.isArray(scamResult.indicators) && Object.keys(scamResult.indicators).length === 0)) && (\n                      <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\n                        <div className=\"flex items-center\">\n                          <svg className=\"w-4 h-4 text-green-600 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                          <span className=\"text-green-800 text-sm\">No suspicious indicators detected</span>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* Threats Detected section removed - now handled in consolidated indicators above */}\n\n                {/* Link Analysis Details */}\n                {scamResult.linkDetails && (\n                  <div className=\"mb-4\">\n                    <h3 className=\"font-semibold text-gray-800 mb-2\">Link Analysis Details:</h3>\n                    <div className=\"space-y-2\">\n                      {scamResult.linkDetails.indicators && scamResult.linkDetails.indicators.map((indicator, index) => (\n                        <div key={index} className=\"p-2 bg-yellow-50 rounded-lg border border-yellow-200\">\n                          <span className=\"text-yellow-800 text-sm\">{indicator}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Email Analysis Details */}\n                {scamResult.emailDetails && (\n                  <div className=\"mb-4\">\n                    <h3 className=\"font-semibold text-gray-800 mb-2\">Email Analysis Details:</h3>\n                    <div className=\"space-y-2\">\n                      {scamResult.emailDetails.scam_categories && scamResult.emailDetails.scam_categories.map((category, index) => (\n                        <div key={index} className=\"p-2 bg-purple-50 rounded-lg border border-purple-200\">\n                          <span className=\"text-purple-800 text-sm\">{category}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                {/* Recommendations */}\n                <div className=\"mb-4\">\n                  <h3 className=\"font-semibold text-gray-800 mb-2\">Security Recommendations:</h3>\n                  <div className=\"space-y-2\">\n                    {scamResult.recommendations.map((rec, index) => (\n                      <div key={index} className=\"flex items-start p-3 bg-blue-50 rounded-lg border border-blue-200\">\n                        <svg className=\"w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        <span className=\"text-blue-800 text-sm\">{rec}</span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Reset Button */}\n                <div className=\"pt-4 border-t border-gray-200\">\n                  <button \n                    onClick={() => {\n                      setScamInput('')\n                      setScamResult(null)\n                      setScamError('')\n                    }}\n                    className=\"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-xl font-medium hover:bg-gray-200 transition-all duration-200\"\n                  >\n                    Analyze Another Item\n                  </button>\n                </div>\n              </div>\n            )}\n            {/* Recent forwarded email scans (only show for Email content type) */}\n            {isAuthenticated && scamType === 'email' && (\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n                <h3 className=\"text-lg font-semibold text-black mb-3\">Recently forwarded emails</h3>\n                {recentScans.length === 0 ? (\n                  <p className=\"text-sm text-gray-500\">No forwarded emails analyzed yet.</p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {recentScans.map(item => (\n                      <div key={item.id} className=\"flex items-center justify-between p-3 border border-gray-200 rounded-lg\">\n                        <div className=\"mr-3 flex-1 min-w-0\">\n                          <div className=\"text-sm font-medium text-gray-800 truncate\">{item.subject || 'Email'}</div>\n                          <div className=\"text-xs text-gray-500 flex items-center gap-2\">\n                            <span>{item.scanned_at?.replace('T',' ').slice(0,16)}</span>\n                            {typeof item.attachments === 'number' && (\n                              <span>• {item.attachments} attachment{item.attachments === 1 ? '' : 's'}</span>\n                            )}\n                          </div>\n                          {item.preview && (\n                            <div className=\"text-xs text-gray-600 mt-1 line-clamp-2\">{item.preview}</div>\n                          )}\n                          {Array.isArray(item.indicators) && item.indicators.length > 0 && (\n                            <div className=\"mt-1 flex flex-wrap gap-1\">\n                              {item.indicators.map((ind, i) => (\n                                <span key={i} className=\"text-[10px] px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700\">{ind}</span>\n                              ))}\n                            </div>\n                          )}\n                          {Array.isArray(item.recommendations) && item.recommendations.length > 0 && (\n                            <ul className=\"mt-2 list-disc list-inside text-[11px] text-gray-600 space-y-0.5\">\n                              {item.recommendations.map((r, i) => (\n                                <li key={i}>{r}</li>\n                              ))}\n                            </ul>\n                          )}\n                        </div>\n                        <span className={`text-xs px-2 py-1 rounded-full ${item.risk_level === 'SCAM' ? 'bg-red-100 text-red-700' : item.risk_level === 'SUSPICIOUS' ? 'bg-yellow-100 text-yellow-700' : 'bg-green-100 text-green-700'}`}>\n                          {item.risk_level} {typeof item.risk_score === 'number' ? `(${item.risk_score})` : ''}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* How It Works Section */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">How Scam Analysis Works</h2>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">1</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">Input Content</h3>\n                  <p className=\"text-gray-600 text-sm\">Paste suspicious messages, links, or forward email</p>\n                </div>\n                \n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">2</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">AI Analysis</h3>\n                  <p className=\"text-gray-600 text-sm\">Advanced pattern recognition scans for threats</p>\n                </div>\n                \n                <div className=\"text-center p-4\">\n                  <div className=\"w-12 h-12 bg-[#21a1ce] bg-opacity-10 rounded-xl flex items-center justify-center mx-auto mb-3\">\n                    <span className=\"text-[#21a1ce] font-bold text-lg\">3</span>\n                  </div>\n                  <h3 className=\"font-medium text-gray-800 mb-2\">Get Results</h3>\n                  <p className=\"text-gray-600 text-sm\">Risk assessment and security recommendations</p>\n                </div>\n              </div>\n            </div>\n\n            {/* Security Features */}\n            <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n              <h2 className=\"text-lg font-semibold text-black mb-4\">Detection Capabilities</h2>\n              \n              <div className=\"space-y-3\">\n                <div className=\"flex items-center p-3 bg-red-50 rounded-lg border border-red-200\">\n                  <svg className=\"w-5 h-5 text-red-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\n                  </svg>\n                  <span className=\"text-red-800 text-sm\">Phishing attempts and social engineering</span>\n                </div>\n                \n                <div className=\"flex items-center p-3 bg-yellow-50 rounded-lg border border-yellow-200\">\n                  <svg className=\"w-5 h-5 text-yellow-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n                  </svg>\n                  <span className=\"text-yellow-800 text-sm\">Suspicious links and URLs</span>\n                </div>\n                \n                <div className=\"flex items-center p-3 bg-purple-50 rounded-lg border border-purple-200\">\n                  <svg className=\"w-5 h-5 text-purple-600 mr-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n                  </svg>\n                  <span className=\"text-yellow-800 text-sm\">Financial fraud and money scams</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n      case 'chat':\n        return (\n          <div className=\"space-y-4\">\n            {/* Chat Header */}\n            <div className=\"bg-white rounded-2xl p-4 shadow-sm border border-gray-100\">\n              <div className=\"text-center\">\n                <div className=\"w-10 h-10 bg-[#21a1ce] bg-opacity-10 rounded-full flex items-center justify-center mx-auto mb-2\">\n                  <svg className=\"w-5 h-5 text-[#21a1ce]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\n                  </svg>\n                </div>\n                <p className=\"text-gray-600 text-sm mb-2\">Your AI cybersecurity assistant for instant help and guidance</p>\n                <div className=\"bg-[#21a1ce] bg-opacity-10 px-3 py-2 rounded-lg border border-[#21a1ce] border-opacity-20 inline-block\">\n                  <p className=\"text-[#21a1ce] text-xs font-medium\">\n                    💡 <strong>Need human help?</strong> Send \"connect me with a Remaleh Guardian\"\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Chat Interface */}\n            <div className=\"bg-white rounded-2xl shadow-sm border border-gray-100\">\n              <ChatAssistant setActiveTab={setActiveTab} />\n            </div>\n          </div>\n        )\n      case 'learn':\n        return <LearnHub setActiveTab={setActiveTab} />\n      case 'admin':\n        return <AdminDashboard setActiveTab={setActiveTab} />\n      case 'login':\n        return <Login onLoginSuccess={() => setActiveTab('home')} onSwitchToRegister={() => setActiveTab('register')} />\n      case 'register':\n        return <Register onRegisterSuccess={() => setActiveTab('home')} onSwitchToLogin={() => setActiveTab('login')} />\n      case 'profile':\n        return <ProfileSettings setActiveTab={setActiveTab} />\n      case 'community':\n        return <CommunityHub setActiveTab={setActiveTab} />\n      case 'community_reports':\n        return <CommunityReporting setActiveTab={setActiveTab} />\n      default:\n        return (\n          <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100\">\n            <h1 className=\"text-2xl font-bold text-black mb-4\">Welcome to Remaleh Protect</h1>\n            <p className=\"text-gray-700\">Your digital security companion</p>\n          </div>\n        )\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"safe-top-bar\" />\n      {/* Header with Profile Icon */}\n      <header className=\"bg-[#21a1ce] px-6 py-4\" style={{ position: 'sticky', top: 0, zIndex: 30 }}>\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1 text-center\">\n            <img \n              src=\"/Remaleh-logo-full-2.jpg\" \n              alt=\"Remaleh\" \n              className=\"h-8 w-auto mx-auto\"\n            />\n          </div>\n          \n          {/* Profile Icon - Clickable */}\n          <div className=\"relative\">\n            <button\n              onClick={handleProfileClick}\n              className=\"w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer\"\n            >\n              {isAuthenticated ? (\n                <span className=\"text-[#21a1ce] font-semibold text-sm\">\n                  {getUserInitials()}\n                </span>\n              ) : (\n                <User className=\"w-4 h-4 text-[#21a1ce]\" aria-hidden=\"true\" />\n              )}\n            </button>\n            \n            {/* Profile Dropdown */}\n            {showProfileDropdown && (\n              <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50 profile-dropdown\">\n                {isAuthenticated ? (\n                  <>\n                    <div className=\"px-4 py-2 border-b border-gray-100\">\n                      <p className=\"text-sm font-medium text-gray-900\">{user?.name || 'User'}</p>\n                      <p className=\"text-xs text-gray-500\">{user?.email}</p>\n                    </div>\n                    \n                    <button\n                      onClick={() => setActiveTab('profile')}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors\"\n                    >\n                      Profile Settings\n                    </button>\n                    \n                    {/* Admin Dashboard Link - Only show for admin users */}\n                    {(user?.is_admin || user?.role === 'ADMIN' || user?.role === 'MODERATOR') && (\n                      <button\n                        onClick={() => {\n                          setActiveTab('admin')\n                          setShowProfileDropdown(false)\n                        }}\n                        className=\"w-full text-left px-4 py-2 text-sm text-purple-700 hover:bg-purple-50 transition-colors border-t border-gray-100 bg-purple-50\"\n                      >\n                        <div className=\"flex items-center\">\n                          <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756 2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a0 3 3 0 11-6 0 3 3 0 016 0z\" />\n                          </svg>\n                          {user?.role === 'MODERATOR' && !user?.is_admin ? 'Go to Moderator Dashboard' : 'Go to Admin Dashboard'}\n                        </div>\n                      </button>\n                    )}\n                    \n                    <button\n                      onClick={handleLogout}\n                      className=\"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors\"\n                    >\n                      Sign Out\n                    </button>\n                    <a\n                      href=\"/privacy.html\"\n                      className=\"block w-full text-left px-4 py-2 text-xs text-gray-500 hover:bg-gray-50 transition-colors border-t border-gray-100\"\n                    >\n                      Privacy Policy\n                    </a>\n                  </>\n                ) : (\n                  <>\n                    <button\n                      onClick={() => {\n                        setActiveTab('login')\n                        setShowProfileDropdown(false)\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors\"\n                    >\n                      Sign In\n                    </button>\n                    \n                    <button\n                      onClick={() => {\n                        setActiveTab('register')\n                        setShowProfileDropdown(false)\n                      }}\n                      className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors\"\n                    >\n                      Create Account\n                    </button>\n                    <a\n                      href=\"/privacy.html\"\n                      className=\"block w-full text-left px-4 py-2 text-xs text-gray-500 hover:bg-gray-50 transition-colors border-t border-gray-100\"\n                    >\n                      Privacy Policy\n                    </a>\n                  </>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"px-6 py-6 pb-24 max-w-none\">\n        {renderContent()}\n      </main>\n\n      {/* Footer intentionally minimal (no legal links shown) */}\n\n      {/* Password Generator Modal */}\n      {showPasswordGenerator && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto\">\n            <div className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-bold text-gray-900\">Password Generator</h2>\n                <button \n                  onClick={() => setShowPasswordGenerator(false)}\n                  className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n              <PasswordGenerator onUse={handlePasswordUse} />\n            </div>\n          </div>\n        </div>\n      )}\n\n\n\n      {/* Bottom Navigation */}\n      <nav className=\"fixed left-0 right-0 bg-white border-t border-gray-200 px-4 pt-2 pb-6 pb-safe\" style={{ bottom: 'calc(env(safe-area-inset-bottom) + 12px)' }}>\n        <div className=\"flex justify-around\">\n          {tabs\n            .filter(tab => {\n              // Hide admin tab for non-admin/moderator users\n              if (tab.id === 'admin') {\n                return user?.is_admin || user?.role === 'ADMIN' || user?.role === 'MODERATOR'\n              }\n              return true\n            })\n            .map((tab) => (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id)}\n                className={`flex items-center justify-center w-12 h-12 rounded-2xl transition-all duration-200 ${\n                  activeTab === tab.id\n                    ? 'text-[#21a1ce] bg-[#21a1ce] bg-opacity-15 shadow-lg scale-110'\n                    : 'text-gray-500 hover:text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                <span className=\"text-2xl\">{tab.icon}</span>\n              </button>\n            ))}\n        </div>\n      </nav>\n    </div>\n  )\n}\n\nexport default App\n\n","/// <reference types=\"@capacitor/cli\" />\nexport var Style;\n(function (Style) {\n    /**\n     * Light text for dark backgrounds.\n     *\n     * @since 1.0.0\n     */\n    Style[\"Dark\"] = \"DARK\";\n    /**\n     * Dark text for light backgrounds.\n     *\n     * @since 1.0.0\n     */\n    Style[\"Light\"] = \"LIGHT\";\n    /**\n     * The style is based on the device appearance.\n     * If the device is using Dark mode, the statusbar text will be light.\n     * If the device is using Light mode, the statusbar text will be dark.\n     *\n     * @since 1.0.0\n     */\n    Style[\"Default\"] = \"DEFAULT\";\n})(Style || (Style = {}));\nexport var Animation;\n(function (Animation) {\n    /**\n     * No animation during show/hide.\n     *\n     * @since 1.0.0\n     */\n    Animation[\"None\"] = \"NONE\";\n    /**\n     * Slide animation during show/hide.\n     * It doesn't work on iOS 15+.\n     *\n     * @deprecated Use Animation.Fade or Animation.None instead.\n     *\n     * @since 1.0.0\n     */\n    Animation[\"Slide\"] = \"SLIDE\";\n    /**\n     * Fade animation during show/hide.\n     *\n     * @since 1.0.0\n     */\n    Animation[\"Fade\"] = \"FADE\";\n})(Animation || (Animation = {}));\n/**\n * @deprecated Use `Animation`.\n * @since 1.0.0\n */\nexport const StatusBarAnimation = Animation;\n/**\n * @deprecated Use `Style`.\n * @since 1.0.0\n */\nexport const StatusBarStyle = Style;\n//# sourceMappingURL=definitions.js.map","import { registerPlugin } from '@capacitor/core';\nconst StatusBar = registerPlugin('StatusBar');\nexport * from './definitions';\nexport { StatusBar };\n//# sourceMappingURL=index.js.map","import React, { useEffect } from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.jsx'\nimport './index.css'\nimport { Capacitor } from '@capacitor/core'\nimport { StatusBar, Style } from '@capacitor/status-bar'\nimport { SocialLogin } from '@capgo/capacitor-social-login'\n\nfunction Root() {\n  useEffect(() => {\n    if (Capacitor.getPlatform() === 'ios') {\n      StatusBar.setOverlaysWebView({ overlay: false }).catch(() => {})\n      StatusBar.setStyle({ style: Style.Dark }).catch(() => {})\n      StatusBar.setBackgroundColor({ color: '#21a1ce' }).catch(() => {})\n\n      // Initialize Social Login (Google) on iOS if client ID is provided\n      try {\n        const googleClientId = import.meta.env.VITE_GOOGLE_IOS_CLIENT_ID\n        if (googleClientId) {\n          SocialLogin.initialize({ google: { iOSClientId: googleClientId } }).then(() => {\n            console.log('[SocialLogin] Initialized with iOSClientId')\n          }).catch((e) => { console.log('[SocialLogin] init error', e) })\n        }\n      } catch {}\n    }\n  }, [])\n  return <App />\n}\n\nReactDOM.createRoot(document.getElementById('root')).render(\n  <React.StrictMode>\n    <Root />\n  </React.StrictMode>,\n)\n\n"],"file":"assets/index-877e7e10.js"}